<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.294">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Structural Dynamics - 4&nbsp; Numerical Solutions of the SDOF Equation of Motion</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<link href="./eqsdof.html" rel="next">
<link href="./singledofforced.html" rel="prev">
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
</head><body class="nav-sidebar floating">$$

% 05/16 change, define new env to convert multlined to multline* in HTML
\newenvironment{multlined}{\begin{multline*}}{\end{multline*}}

% define the command for indenting the first line of paragraphs after the first
\newcommand{\newpara}{ }

%\DeclareMathOperator{\expo}{e}
\def\expo{\mathrm{e}}
\def\expon#1{\expo^{#1}}

% \renewcommand\pi{\uppi} % date: 03/29 change: comment out this line since \uppi cannot be understood by qmd

\def\abs#1{\left| #1 \right|}
\def\matabs#1{\Bigl| #1 \Bigr|} % determinant

\def\RB#1{\mathcal{#1}}

% \def\rem#1{{\bfseries{#1}}} % regular emphasis
% \def\mem#1{{\bfseries{#1}}} % much emphasis
% date: 03/30 change \bfseries to \textbf
\def\rem#1{{\textit{#1}}} % regular emphasis
\def\mem#1{{\textit{#1}}} % much emphasis
% date: 03/30 change \emph to ** in qmd
% \def\lem#1{\emph{#1}} % less emphasis

\def\unit#1{\mathrm{\, #1}}
\def\punit#1{\mathrm{#1}}

\DeclareMathOperator{\dif}{d}
\def\diff{\dif \!}
\def\dt{\diff t} % dt

%%%%%%%%%%% VECTORS
\def\vctr#1{\underline{\mathrm{#1}}} % vectors with roman letters
\def\svctr#1{\underline{#1}} % vectors with symbols
\def\pvctr#1{\, \underline{\mathrm{#1}}} % vectors with roman letters and prior spacing
\def\vmag#1{\left| #1 \right|} % magnitude of a vector
\def\subvec#1#2{\vctr{#1}_{#2}} % vector (roman letter) with subscript
%%%%%%%%%%%

%%%%%%%%%%% MATRICES
\def\mtrx#1{[\mathrm{#1}]} % matrices with roman letters
\def\smtrx#1{[\mathnormal{#1}]} % matrices with symbols
\def\mmat{\mtrx{M}} % mass matrix
\def\cmat{\mtrx{C}} % damping matrix
\def\kmat{\mtrx{K}} % stiffness matrix
\def\nvec#1{\underline{{#1}}} % column matrix (vector) for symbols
\def\snvec#1{\underline{{#1}}} %  column matrix (vector) for symbols
% \def\nvec#1{\underset{\sim}{\mathrm{#1}}} % column matrix (vector) for symbols
% \def\snvec#1{\underset{\sim}{\mathnormal{#1}}} %  column matrix (vector) for symbols
\def\colmat#1{\left\{ \begin{array}{c} #1 \end{array} \right\}} % column matrix array
% \def\nvec#1{\undertilde{\mathrm{#1}}} % column matrix (vector) for symbols
% \def\snvec#1{\undertilde{#1}} %  column matrix (vector) for symbols
% 03/31 \undertilde not found 
\def\onecol{\nvec{1}}
\def\idmat{\mtrx{I}}
\def\zerocol{\nvec{0}}
\def\zeromat{\mtrx{0}}
\def\barmmat{\mtrx{{M'}}} % mass matrix in barred coordinates
\def\barcmat{\mtrx{{C'}}} % damping matrix in barred coordinates
\def\barkmat{\mtrx{{K'}}} % stiffness matrix in barred coordinates
%%%%%%%%%%%

\def\sint{\int \!}
\def\lsint#1#2{\int_{#1}^{#2} \hspace{-1ex}}

\def\divp#1#2{\frac{\diff #1}{\diff #2}}
\def\divt#1{\frac{\diff \, #1}{\diff t}}
\def\ddivt#1{\frac{\diff^2 #1}{\diff t^2}}
\def\pardiv#1#2{\frac{\partial #1}{\partial #2}}

\def\pdivt#1{\dot{#1}}
\def\pddivt#1{\ddot{#1}}

%\def{\ssum}{\mathsmaller{\sum}}
\DeclareMathOperator{\ssum}{\scaleobj{0.8}{\sum}}
\def\lowsum#1{\displaystyle{\ssum\limits_{#1}^{}}}
\def\allsum#1#2{\ssum\limits_{#1}^{#2}}

\def\volume{V}
\def\area{A}
\def\dV{\diff \volume} % differential volume
\def\dA{\diff \area} % differential area
\def\dm{\diff m} % differential mass
\def\totm{{m}} % total mass of a system of particles

\def\mden{\varrho} % mass density
\def\mlen{\widehat{m}} % mass per unit length

\def\gravity{\mathrm{g}}

\def\com{\mathrm{cm}} % center of mass
\def\cok{\mathrm{ck}} % center of stiffness


%%%%%%%%%%% GENERALIZED COORDINATE
\def\gc{q} % generalized coordinate
\def\dgc{\dot{q}} % dot-time derivative of gen. coord.
\def\ddgc{\ddot{q}} % second dot-time derivative of gen. coord.
\def\gct{\gc (t)} 
\def\dgct{\dgc (t)}
\def\ddgct{\ddgc (t)}
\def\gcic{\gc_o} % \initial condition for gen. coord.
\def\dgcic{\dgc_o} % \initial condition for gen. vel.
%%%%%%%%%%%

%%%%%%%%%%% GENERALIZED SDOF SYSTEM
\def\gengc{q^{*}} % generalized coordinate in generalized SDOF sys
\def\dgengc{\dot{q}^{*}} % dot-time derivative of gen. coord. in generalized SDOF sys
\def\ddgengc{\ddot{q}^{*}} % second dot-time derivative of gen. coord. in generalized SDOF sys
\def\gengct{\gengc(t)}
\def\dgengct{\dgengc(t)}
\def\ddgengct{\ddgengc(t)}
\def\gengcic{\gc_o} % initial condition for gen. coord. in generalized SDOF sys
\def\gendgcic{\dgc_o} % initial condition for gen. vel. in generalized SDOF sys
\def\genm{m^{\ast}} % generalized mass
\def\genc{c^{\ast}} % generalized damping
\def\genk{k^{\ast}} % generalized stiffness
\def\genf{f^{\ast}} % generalized force
\def\gendamp{\damp^{\ast}} % generalized damping ratio
\def\shpf{\psi} % continuous shape function in generalized SDOF approach
% \def\vshpf{\snvec{\uppsi}} % shape function column matrix in generalized SDOF approach
%% \uppsi cannot be understood by qmd for html, replace \uppsi with \Psi
\def\vshpf{\snvec{\psi}} % shape function column matrix in generalized SDOF approach
\def\pvshpf#1{\psi_{#1}} % component of shape function column matrix in generalized SDOF approach
\def\genfreq{\freq^{\ast}} % undamped natural frequency in generalized SDOF sys.
%%%%%%%%%%%

% \def\u{u}
% \def\uvec{\nvec{\u}}
% \def\uvect{\nvec{\u}(t)}
% \def\du{\dot{\u}}
% \def\ddu{\ddot{\u}}
% \def\duvec{\dot{\nvec{\u}}}
% \def\duvect{\dot{\nvec{\u}}(t)}
% \def\dduvec{\ddot{\nvec{\u}}}
% \def\dduvect{\ddot{\nvec{{\u}}}(t)}
% \def\dmprat{\zeta}
% \def\ut{{\u}(t)}
% \def\dut{\dot{\u}(t)}
% \def\ddut{\ddot{\u}(t)}

% \def\gdis{\u_{g}}
% \def\gvel{\du_{g}}
% \def\gacc{\ddu_{g}}
% \def\gdist{\u_{g}(t)}
% \def\gvelt{\du_{g}(t)}
% \def\gacct{\ddu_{g}(t)}
% \def\maxgdis{D_{g}}
% \def\maxgvel{{V}_{g}}
% \def\maxgacc{{A}_{g}}
%\def\maxgdis{\u_{g,\mathrm{max}}}
%\def\maxgvel{\du_{g,\mathrm{max}}}
%\def\maxgacc{\ddu_{g,\mathrm{max}}}

%%%%%%%%%%% GROUND MOTION
\def\gdis{g} % ground displacement
\def\gvel{\dot{\gdis}} % ground velocity
\def\gacc{\ddot{\gdis}} % ground acceleration
\def\gdist{\gdis(t)} % ground displacement with time
\def\gvelt{\gvel(t)} % ground velocity with time
\def\gacct{\gacc(t)} % ground acceleration with time
\def\maxgdis{\mathsf{D}_{\! \gdis}} % absolute maximum ground displacement
\def\maxgvel{\mathsf{V}_{\!\gdis}} % absolute maximum ground velocity
\def\maxgacc{\mathsf{A}_{\!\gdis}} % absolute maximum ground acceleration
\def\adis{\alpha} % absolute displacement (earthquake analysis)
\def\avel{\dot{\adis}} % absolute velocity
\def\aacc{\ddot{\adis}} % absolute acceleration
\def\adisvec{\snvec{{\adis}}} % absolute acceleration
\def\aaccvec{\snvec{\ddot{\adis}}} % absolute acceleration
\def\gdisvec{\nvec{\gdis}} % multiple support motion displacement column 
\def\gaccvec{\nvec{\gacc}} % multiple support motion acceleration column
\def\ininfmat{\mtrx{b}} % input influence matrix
\def\ininfvec{\nvec{b}} % input influence vector
%%%%%%%%%%%

%%%%%%%%%%% EARTHQUAKE RESPONSE
\def\baseshear{V_{b}} % base shear
\def\overturn{M_{b}} % overturning moment
\def\estat{f_{es}} % equivalent static force
\def\estati#1{f_{es,#1}} % equivalent static force
\def\estatvec{\nvec{f_{es}}} % equivalent static force
\def\modbaseshear#1{V_{b}^{(#1)}} % modal base shear
\def\modoverturn#1{M_{b}^{(#1)}} % modal overturning moment
\def\modestatvec#1{\nvec{f_{es}^{(#1)}}} % modal equivalent static force
\def\ccor#1{\varrho_{#1}}
\def\excifact{L} % earthquake excitation factor
\def\modpart{\Gamma} % modal participation factor
%%%%%%%%%%% SPECTRA
\def\dspec{\mathsf{D}} % disp spectral resp
\def\vspec{\mathsf{V}} % vel spectral resp
\def\aspec{\mathsf{A}} % acc  spectral resp
\def\maxstifforce{\extforce_{el}} % max spring force (SDOF)
\def\maxlindisp{\gc_{el}} % maximum linear disp
\def\maxtotdisp{\gc_{max}} % maximum total disp
\def\yielddisp{\gc_{yl}} % yield displacement 
\def\redfac{R} % Yield strength reduction factor
\def\duct{\mu} % ductility factor
\def\ydspec{\dspec_{yl}}
\def\yvspec{\vspec_{yl}}
\def\yaspec{\aspec_{yl}}
%%%%%%%%%%%

%%%%%%%%%%% FORCE
\def\extforce{f} % external force 
\def\extforcet{f (t)} % external force with time (t)
\def\extf{\nvec{\extforce}} % external force vector
\def\extft{\extf (t)} % external force vector with time (t)
\def\fvec{\vctr{f}} % resultant force vector
\def\compf{f} % scalar components of the resultant force
\def\sforce{F} % scalar single external force, amplitude of external force
\def\force{\vctr{\mathrm{\sforce}}} % single external force vector
\def\stifforce{\extforce_{S}}
\def\intf{\nvec{\extforce_{I}}} % inertia force vector
\def\stff{\nvec{\extforce_{S}}} % stiffness force vector
\def\dmpf{\nvec{\extforce_{D}}} % damping force vector
\def\ldvec{\nvec{\extforce}} % load (force) vector in MDOF systems
\def\ldtvec{\ldvec (t)} % load (force) vector with time in MDOF systems
\def\barldvec{\nvec{\extforce'}} % load (force) vector in MDOF systems barred coord
\def\resistforce{\extforce_{R}} % resisting force (stiffness or stiffness+damping)
%%%%%%%%%%%

%%%%%%%%%%% GENERALIZED COORDINATE VECTORS
\def\gcvec{\nvec{\gc}} % generalized coordinate vector
\def\dgcvec{\dot{\gcvec}} % generalized velocity vector
\def\ddgcvec{\ddot{\gcvec}} % generalized acceleration vector
\def\gctvec{\gcvec (t)} % generalized coordinate vector with time
\def\dgctvec{\dgcvec (t)} % generalized velocity vector with time
\def\ddgctvec{\ddgcvec (t)} % generalized acceleration vector with time
\def\adisvec{\snvec{\alpha}} % absolute displacement column (earthquake analysis)
\def\avelvec{\dot{\adisvec}} % absolute velocity column
\def\aaccvec{\ddot{\adisvec}} % absolute acceleration column
\def\gcvecic{\nvec{\gc_o}} % initial displacement column
\def\dgcvecic{\nvec{\dot{\gc}_o}} % initial displacement column
\def\bargcvec{\nvec{{\gc}}'} % barred generalized coordinates
\def\bardgcvec{\nvec{{\dot{\gc}}}'} % barred generalized velocities
\def\barddgcvec{\nvec{{\ddot{\gc}}}'} % barred generalized accelerations
%%%%%%%%%%%

%%%%%%%%%%% MODAL COORDINATES
\def\modcor{z} % modal coordinates
\def\modcort{\modcor(t)} % modal coordinate with time
\def\dmodcor{\dot{\modcor}} % modal velocity
\def\ddmodcor{\ddot{\modcor}} % modal acceleration
\def\modcorvec{\nvec{\modcor}} % modal coordinate vector
\def\modcortvec{\nvec{\modcor}(t)} % modal coordinate vector with time
\def\dmodcorvec{\dot{\modcorvec}} % modal velocity vector
\def\ddmodcorvec{\ddot{\modcorvec}} % modal acceleration vector
\def\modm{\widehat{M}} % modal mass
\def\modc{\widehat{C}} % modal damping matrix coefficient
\def\modk{\widehat{K}} % modal stiffness
\def\modmmat{\mtrx{\widehat{M}}} % modal mass matrix
\def\modcmat{\mtrx{\widehat{C}}} % modal damping matrix
\def\modcmatm{\mtrx{\widehat{C}^{\sharp}}} % modal damping matrix modified
\def\modkmat{\mtrx{\widehat{K}}} % modal stiffness matrix
\def\modcoric#1{{\modcor_{#1 o}}} % initial ith modal coordinate 
\def\dmodcoric#1{{\dmodcor_{#1 o}}} % initial ith modal velocity 
\def\modcorvecic{\nvec{\modcor_o}} % initial modal coordinate vector
\def\dmodcorvecic{\nvec{\dot{\modcor}_{o}}} % initial modal velocity vector
\def\modcoramp{Z} % amplitude of free vibration in modal coordinates
\def\modextforce{\widehat{\extforce}} % load (force) component in modal coords
\def\modldvec{\nvec{\modextforce}} % load (force) vector in modal coords
\def\modgcvec#1{\nvec{\gc}^{(#1)}}
%%%%%%%%%%%

% absolute disp variable ua MDOF (currently same as gen coord.)
% \def\ua{q}
% \def\dua{\dot{\ua}}
% \def\ddua{\ddot{\ua}}
% \def\dmprat{\zeta}
% \def\uat{\ua(t)}
% \def\duat{\dot{\ua}(t)}
% \def\dduat{\ddot{\ua}(t)}
% \def\uavec#1{\nvec{\ua}_{#1}}
% \def\xuavec{\nvec{\ua}} % modified on 06/20 because $\uavec{}_{N\times1}$ does not work in html
% \def\duavec#1{\dot{\nvec{\ua}_{#1}}}
% %\def\dduavec#1{\nvec{\ddua}_{#1}}
% \def\xduavec{\dot{\nvec{\ua}}}
% \def\xdduavec{\ddot{\nvec{\ua}}}
% \def\uavect{\xuavec (t)}
% \def\duavect{\xduavec (t)}
% \def\dduavect{\xdduavec (t)}

%%%%% EIGENVALUES; EIGENVECTORS; RAYLEIGH-RITZ
\def\eigvecs{\phi} % mode shape symbol
\def\eigvec{\snvec{\eigvecs}} % mode shape vector
\def\eigveci#1{\snvec{\eigvecs_{#1}}} % mode shape vector for the ith mode
\def\meigveci#1{\snvec{\overline{\eigvecs_{#1}}}} % mass normalized mode shape
\def\teigveci#1{\snvec{\eigvecs_{#1}}^T} % mode shape vector transposed for the ith mode
\def\rayvecs{\psi} % rayleigh vector symbol
\def\rayvec{\snvec{\rayvecs}} % rayleigh vector
\def\trayvec{\snvec{\rayvecs}^T} % rayleigh vector
\def\ritzvec#1{\snvec{\rayvecs_{#1}}}
\def\tritzvec#1{\snvec{\rayvecs_{#1}}^T}
\def\ritzcandvec#1{\nvec{u_{#1}}}
\def\tritzcandvec#1{\snvec{u_{#1}}^T}
\def\ritzmat{\mtrx{U}}
\def\rayfreq{\freq^{\ast}} % Rayleigh's quotient
\def\ritzfreq#1{\freq^{\ast}_{#1}} % Ritz frequencies
\def\ritzmmat{\mtrx{M^{\ast}}}
\def\ritzkmat{\mtrx{K^{\ast}}}
\def\deigvec{\snvec{\widehat{\eigvecs}}}
\def\deigveci{\snvec{\widehat{\eigvecs_{i}}}}
\def\eigval{\lambda}
% \def\modmat{\smtrx{\Phiup}}
\def\modmat{\mtrx{\Phi}} % date: 05/01 change
\def\spectmat{\mtrx{\omega^2}} % date: 05/01 change
\def\dmodmat{\mtrx{\widehat{\Phi}}}
%%%%%%%%%%

%%%%%%%%%%% TIME STEPPING &amp; NONLINEARITY
% \def\dsct#1#2{#1_{#2}}
% \def\edsct#1#2#3{#1^{(#3)}_{#2}}
\def\dsct#1#2{#1_{[#2]}}
\def\edsct#1#2#3{#1^{(#3)}_{[#2]}}
\def\yieldforce{\extforce_{yl}}
% \def\residual{\Delta \stifforce}
\def\residual{\Delta \resistforce}
%%%%%%%%%%%%

\def\puvec#1{\, \vctr{u}_{#1}}

% Cartesian rectangular unit vectors
\def\xuvec{\, \vctr{i}}
\def\yuvec{\, \vctr{j}}
\def\zuvec{\, \vctr{k}}


\def\pos{r} % position variable
\def\vel{v} % velocity
\def\acc{a} % acceleration
\def\posrelcom{R} % position relative to the center of mass

\def\pvec{\vctr{\pos}} % position vector
\def\vvec{\vctr{\vel}} % velocity vector
\def\avec{\vctr{\acc}} % acceleration vector
\def\zerovec{\vctr{0}} % zero vector

%\def\pdpvec{\vctr{\pdivt{\pos}}} % time (dot) derivative of the position vector
%\def\pdvvec{\vctr{\pdivt{\vel}}} % time (dot) derivative of the velocity vector

\def\pdpvec{\pdivt{\pvec}} % time (dot) derivative of the position vector
\def\pdvvec{\pdivt{\vvec}} % time (dot) derivative of the velocity vector

\def\prelcom{\vctr{\posrelcom}} % position vector relative to the center of mass
\def\vrelcom{\pdivt{\prelcom}} % velocity vector relative to the center of mass
\def\arelcom{\pddivt{\prelcom}} % velocity vector relative to the center of mass


\def\dpvec{\diff \pvec} % differential of position vector
\def\dvvec{\diff \vvec} % differential of velocity vector

\def\angvel{\omega} % scalar angular velocity
\def\dtangvel{\pdivt{\angvel}} % dot-time derivative of scalar angular velocity
%\def\vecangvel{\svctr{\angvel}} % angular velocity vector
\def\angvelvec{\svctr{\omega}} % angular velocity vector
\def\dtangvelvec{\pdivt{\svctr{\angvel}}} % dot-time derivative of angular velocity vector

\def\angacc{\alpha} % scalar angular acceleration
\def\angaccvec{\vctr{\angacc}} % angular acceleration vector

%\def\om{\Omega}
%\def\omvec{\vctr{\om}}

\def\vprod{\times} % vector product
\def\sprod{\cdot} % scalar product
\def\spvprod{\!\! \times} % vector product with spacing adjusted
\def\spsprod{\!\! \cdot} % scalar product with spacing adjusted

\def\linmom{\vctr{\mathrm{L}}} % linear momentum vector
\def\angmom#1{\vctr{\mathrm{H}}_{#1}} % angular momentum vector with respect to point #1

\def\dlinmom{\pdivt{\vctr{\mathrm{L}}}} % dot-time derivative of the linear momentum vector
\def\dangmom#1{\pdivt{\vctr{\mathrm{H}}}_{#1}} % dot-time derivative of the angular momentum vector with respect to point #1



\def\smoment{{M}}
\def\moment#1{\vctr{\mathrm{\smoment}}_{#1}}
\def\pmoment#1#2{\vctr{\mathrm{\smoment}}_{#1}^{(#2)}}

%%%%%%%%%%%%%%% FREQUENCIES etc.
\def\freq{\omega} % undamped natural frequency
\def\cfreq{f} % undamped cyclic frequency
\def\period{T} % period
\def\dfreq{\overline{\freq}} % damped frequency
\def\dperiod{\overline{\period}} % damped period
\def\phs{\theta} % phase angle
\def\damp{\zeta} % damping ratio
\def\extfreq{\Omega} % frequency of external harmonic excitation
\def\extphs{\varphi} % phase of external harmonic excitation
\def\ratfreq{\rho}
\def\ratdur{\beta}

%%%%%%%%%%%%% INERTIA
%\DeclareMathOperator{\inrt}{\mathds{I}}
\def\inrt{{I}} % symbol for inertia
\def\inertia#1{\mkern1mu \inrt_{#1}} % inertia with subscript
\def\dtinertia#1{\mkern1mu \pdivt{\inrt}_{#1}} % dot-time derivative of inertia with subscript


\def\ke{\mathscr{T}} % kinetic energy
\def\pe{\mathscr{V}} % potential energy
\def\te{\mathscr{E}} % total energy
\def\work{\mathscr{W}} % work

\def\virt{\delta} % virtual (variation, work, etc.)
% \def\virt{\updelta} % virtual (variation, work, etc.) date: 03/29 change: comment out this line
\def\vgc{\virt q} % (virtual) variation in gen. coord.
\def\vgengc{\virt \gengc} % (virtual) variation in gen. coord. in generalized SDOF sys
\def\vwork{\virt \mathscr{W}} % virtual work

\def\lagrangian{\mathscr{L}}
\def\vforce{\mathscr{F}} % Lagrangian force; coefficient of the virtual disp. in virtual work.


\def\wnc{{\mathscr{W}}^{nc}} % work of non-conservative forces
\def\vwnc{{\mathscr{W}}^{nc}} % work of non-conservative forces

\def\pwork#1{\mathscr{W}_{#1}} % work on some particle called #1
\def\pwnc#1{{\mathscr{W}}^{nc}_{#1}} % work of non-conservative forces on some particle called #1

\def\dbar{{\mathchar'26\mkern-12mu \mathrm{d}}} % not total derivative
\def\grad{\vctr{\nabla}} % gradient operator

\def\imag{\mathrm{j}}

\def\curv{\kappa} % curvature (as in moment-curvature)

\def\ratio#1#2{\displaystyle{\frac{#1}{#2}}}

\def\dfrm{\Delta} % deformation
\def\maxdfrm{\Delta_{\mathrm{max}}} % deformation

% \def\impresp{\mathscr{h}} %impulse response function
% \def\frf{\mathscr{H}} %frequency response function
\def\impresp{\mathsf{h}} %impulse response function
\def\frf{\mathsf{H}} %frequency response function

\def\tshift{t_{\star}}

\def\cosp#1{\cos \left( #1 \right)}
\def\sinp#1{\sin \left( #1 \right)}

\def\dynamp{\mathbb{D}}
\def\dynampr{\dynamp (\ratfreq,\damp)}

\def\tstep{t_{\Delta}}
\def\ststep{{t^2_{\Delta}}}

%%% State Space Models
% \def\dscs#1{\nvec{{x}_{#1}}}
%\def\dscs#1{\nvec{x}_{#1}}
%\def\dscf#1{\nvec{{f}}_{#1}}
\def\dscs#1{\nvec{x}_{[#1]}}
\def\dscf#1{\nvec{{f}}_{[#1]}}
\def\dscA{\mtrx{A}}
\def\dscB{\mtrx{B}}

\def\eigval{\lambda}
\def\eigvecmat{\mtrx{V}}
% \def\eigvalmat{\mtrx{\uplambda}}
\def\eigvalmat{\mtrx{\lambda}} %05/01 change
$$
<script>
window.MathJax = {
tex: {
    tags: 'ams'
}
};
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>





<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./numericalsdof.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Numerical Solutions of the SDOF Equation of Motion</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Structural Dynamics</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Fundamentals of Dynamics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./singledof.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Free Vibrations of Single Degree of Freedom Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./singledofforced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forced Vibrations of Single Degree of Freedom Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numericalsdof.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Numerical Solutions of the SDOF Equation of Motion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eqsdof.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Seismic Analysis of Single Degree of Freedom Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multidof.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Models for Linear Multi Degree of Freedom Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multidoffreevib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Free Vibrations of Multi Degree of Freedom Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multidofforcedvib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Forced Vibrations of Linear Multi Degree of Freedom Systems</span></span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#preliminary-ideas" id="toc-preliminary-ideas" class="nav-link active" data-scroll-target="#preliminary-ideas"><span class="header-section-number">4.1</span> Preliminary Ideas</a></li>
  <li><a href="#linear-interpolation-of-the-excitation" id="toc-linear-interpolation-of-the-excitation" class="nav-link" data-scroll-target="#linear-interpolation-of-the-excitation"><span class="header-section-number">4.2</span> Linear Interpolation of the Excitation</a></li>
  <li><a href="#central-difference-method" id="toc-central-difference-method" class="nav-link" data-scroll-target="#central-difference-method"><span class="header-section-number">4.3</span> Central Difference Method</a></li>
  <li><a href="#sec-numericalinterlude" id="toc-sec-numericalinterlude" class="nav-link" data-scroll-target="#sec-numericalinterlude"><span class="header-section-number">4.4</span> Interlude</a></li>
  <li><a href="#houbolts-method" id="toc-houbolts-method" class="nav-link" data-scroll-target="#houbolts-method"><span class="header-section-number">4.5</span> Houbolt’s Method</a></li>
  <li><a href="#sec-newmark" id="toc-sec-newmark" class="nav-link" data-scroll-target="#sec-newmark"><span class="header-section-number">4.6</span> Newmark’s Method</a>
  <ul class="collapse">
  <li><a href="#general-formulation" id="toc-general-formulation" class="nav-link" data-scroll-target="#general-formulation"><span class="header-section-number">4.6.1</span> General Formulation</a></li>
  <li><a href="#various-interpretations-of-newmarks-method" id="toc-various-interpretations-of-newmarks-method" class="nav-link" data-scroll-target="#various-interpretations-of-newmarks-method"><span class="header-section-number">4.6.2</span> Various Interpretations of Newmark’s Method</a></li>
  </ul></li>
  <li><a href="#numerical-integration-for-nonlinear-sdof-systems" id="toc-numerical-integration-for-nonlinear-sdof-systems" class="nav-link" data-scroll-target="#numerical-integration-for-nonlinear-sdof-systems"><span class="header-section-number">4.7</span> Numerical Integration for Nonlinear SDOF Systems</a>
  <ul class="collapse">
  <li><a href="#central-difference-method-for-nonlinear-sdof-systems" id="toc-central-difference-method-for-nonlinear-sdof-systems" class="nav-link" data-scroll-target="#central-difference-method-for-nonlinear-sdof-systems"><span class="header-section-number">4.7.1</span> Central Difference Method for Nonlinear SDOF Systems</a></li>
  <li><a href="#newmarks-method-for-non-linear-systems" id="toc-newmarks-method-for-non-linear-systems" class="nav-link" data-scroll-target="#newmarks-method-for-non-linear-systems"><span class="header-section-number">4.7.2</span> Newmark’s Method for Non-linear Systems</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-Numerical_Solutions_of_the_SDOF_Equation_of_Motion" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Numerical Solutions of the SDOF Equation of Motion</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="preliminary-ideas" class="level2" data-number="4.1">
<h2 data-number="4.1" data-anchor-id="preliminary-ideas"><span class="header-section-number">4.1</span> Preliminary Ideas</h2>
<p>The equation of motion for a viscously damped linear SDOF system under the action of an external force was shown in previous sections to be <span id="eq-1"><span class="math display">\[
   m \ddgct + c \dgct + k \gct = \extforcet
\qquad(4.1)\]</span></span> with the specialized equation for the case of a system excited by a ground motion given by <span id="eq-2"><span class="math display">\[
   m \ddgct + c \dgct + k \gct = - m \gacct
\qquad(4.2)\]</span></span> Although we have discussed the analytical solutions of these equations for an important subset of excitations, it has to be said that most often analytical solutions are beyond our reach and numerical techniques must be employed to obtain values for the response at various instances. While discussing numerical techniques, we will employ the force excitation form of the equation only to minimize repetitive expositions; clearly the formulations may be specialized for ground motion excitation by substituting <span class="math inline">\(- m \gacc (t)\)</span> for <span class="math inline">\(\extforce(t)\)</span>.</p>
<p>The need for use of numerical techniques may arise from various reasons: it may be that the form of excitation is so complex that no known analytical solutions exist, it may be that the excitation is known only at discrete instances of time to begin with, or it may be that the nonlinearity of the system is prohibitive for any closed form solutions. In all cases, the method of attack for all numerical techniques is similar: a. time is discretized into a finite number of instances (using, if possible, small intervals in-between them); b. the behavior, in-between the time instances, of the force or the system or both is approximated via straight lines or simple curves; and c.&nbsp;the solution progresses from one step to the next through solution of algebraic equations.</p>
<p>In what follows, we will try to adhere to the following notation so as to provide some common language for all the methods to be discussed. We will assume that continuous time <span class="math inline">\(t\)</span> is discretized into a total of <span class="math inline">\(l+1\)</span> instances, each denoted by <span class="math inline">\(t_j\)</span> for <span class="math inline">\(j=0,1,2,\ldots,l\)</span>. The difference between any two consecutive instances is called a <em>time step</em>, to be denoted by <span class="math inline">\(\tstep = \dsct{t}{j+1} - \dsct{t}{j}\)</span>. The time step does not in general have to be constant, but when working on linear systems with relatively smooth inputs, it often is. To emphasize the discrete nature of the calculations, we’ll use brackets: for some time dependent variable <span class="math inline">\(\gc(t)\)</span>, <span class="math inline">\(\dsct{\gc}{j}\)</span> will denote the value of that variable at time <span class="math inline">\(t=\dsct{t}{j}\)</span> where, for constant time step, <span class="math inline">\(\dsct{t}{j} = j \tstep\)</span>. The construction of the numerical solution up to and including the final time, corresponding to step <span class="math inline">\(l+1\)</span> (counting time <span class="math inline">\(t=0\)</span> as the first time step) will require knowledge of the input <span class="math inline">\(\dsct{\extforce}{j}\)</span> for <span class="math inline">\(j=0,1,2,...,l\)</span> and the initial conditions <span class="math inline">\(\dsct{\gc}{0}\)</span>, <span class="math inline">\(\dsct{\dgc}{0}\)</span>.</p>
</section>
<section id="linear-interpolation-of-the-excitation" class="level2" data-number="4.2">
<h2 data-number="4.2" data-anchor-id="linear-interpolation-of-the-excitation"><span class="header-section-number">4.2</span> Linear Interpolation of the Excitation</h2>
<p>For linear SDOF systems, it is relatively straightforward to develop a numerical progression based on analytical solutions developed for simply varying forces. The fundamental idea is linear interpolation of the excitation in-between two consecutive time steps. Consider the sketch given in <a href="#fig-pem">Figure&nbsp;<span>4.1</span></a>. According to the this approach which we shall refer to as the <em>piecewise linear excitation</em><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> (PLE), the excitation <span class="math inline">\(\extforce(t)\)</span> is assumed to vary linearly between its values at <span class="math inline">\(\dsct{t}{j}\)</span> and <span class="math inline">\(\dsct{t}{j+1}\)</span> so that for <span class="math inline">\(\dsct{t}{j} \leq t \leq \dsct{t}{j+1}\)</span> the excitation is approximated by <span class="math display">\[
\extforce(t) \approx \extforce(\dsct{t}{j}) + \frac{\extforce(\dsct{t}{j+1}) - \extforce(\dsct{t}{j})}{\dsct{t}{j+1}-\dsct{t}{j}} (t - \dsct{t}{j}) = \dsct{\extforce}{j} + \frac{\dsct{\extforce}{j+1} - \dsct{\extforce}{j}}{\tstep} (t - \dsct{t}{j})  \quad
\]</span> It is easier to express this equation using a shifted time variable <span class="math inline">\(\tau=t-\dsct{t}{j}\)</span> such that (replacing the approximation with an equality) <span class="math display">\[
\extforce(\tau+\dsct{t}{j})=\dsct{\extforce}{j} + \frac{\dsct{\extforce}{j+1} - \dsct{\extforce}{j}}{\tstep} \tau  \quad \text{for} \quad 0 \leq \tau \leq \tstep
\]</span> For a linear system, it is possible to employ superposition to develop the ‘exact’ response of the system under such an excitation: The response <span class="math inline">\(\gc (t)\)</span> for <span class="math inline">\(\dsct{t}{j} \leq t \leq \dsct{t}{j+1}\)</span> may be considered to be the superposition of the following three responses, all of which were previously developed:</p>
<ul>
<li>The response due to nonzero initial conditions <span class="math inline">\(\dsct{\gc}{j}\)</span> and <span class="math inline">\(\dsct{\dgc}{j}\)</span> at time <span class="math inline">\(t=\dsct{t}{j}\)</span>. This response is given (see <a href="singledof.html"><span>Chapter&nbsp;2</span></a>) by <span class="math display">\[
\gc (\tau + \dsct{t}{j}) = \expon{- \damp \freq \tau} \left(\dsct{\gc}{j} \cos \dfreq \tau + \frac{\dsct{\dgc}{j} + \damp \freq \dsct{\gc}{j}}{\dfreq} \sin \dfreq \tau \right)
\]</span></li>
<li>The response due to the constant force <span class="math inline">\(\dsct{\extforce}{j}\)</span> acting on a system initially at rest. This response is given (see <a href="singledofforced.html"><span>Chapter&nbsp;3</span></a>) by <span class="math display">\[
\gc (\tau + \dsct{t}{j}) = \frac{\dsct{\extforce}{j}}{k} \left[1-\expon{- \damp \freq \tau} \left(\cos \dfreq \tau + \frac{\damp}{\sqrt{1 - \damp^2}} \sin \dfreq \tau \right) \right]
\]</span></li>
<li>The response due to the linearly varying (ramp) force <span class="math inline">\((\dsct{\extforce}{j+1} - \dsct{\extforce}{j}) \tau / \tstep\)</span> acting on a system initially at rest. This response is given (see <a href="singledofforced.html"><span>Chapter&nbsp;3</span></a>) by <span class="math display">\[
\gc (\tau + \dsct{t}{j}) =   \frac{1}{k} \frac{\dsct{\extforce}{j+1} - \dsct{\extforce}{j}}{\tstep} \expon{- \damp \freq \tau} \left(\frac{2 \damp}{\freq} \cos \dfreq \tau + \left[\frac{2 \damp^2}{\dfreq} - \frac{1}{\dfreq}\right] \sin \dfreq \tau \right)
+ \frac{1}{k}\frac{\dsct{\extforce}{j+1} - \dsct{\extforce}{j}}{\tstep} \left[\tau  -\frac{2 \damp}{\freq} \right]
\]</span> By taking the derivatives of these expressions we may obtain expressions for velocity, which will also be the superposition of the contributions from the three cases considered above.</li>
</ul>
<div id="fig-pem" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/pem.png" class="quarto-discovered-preview-image img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.1: Approximating the force as a series of linear segments.</figcaption><p></p>
</figure>
</div>
<p>The displacement at <span class="math inline">\(\tau = \tstep\)</span> (corresponding to <span class="math inline">\(t=\dsct{t}{j+1}\)</span>) is therefore given by <span class="math display">\[\begin{align*}
  \gc(\dsct{t}{j+1}) = \dsct{\gc}{j+1}  &amp; = \expon{- \damp \freq \tstep} \left(\dsct{\gc}{j} \cos \dfreq \tstep + \frac{\dsct{\dgc}{j} + \damp \freq \dsct{\gc}{j}}{\dfreq} \sin \dfreq \tstep \right) \\
   &amp; \quad + \frac{\dsct{\extforce}{j}}{k} \left[1-\expon{- \damp \freq \tstep} \left(\cos \dfreq \tstep + \frac{\damp}{\sqrt{1 - \damp^2}} \sin \dfreq \tstep \right) \right]\\
   &amp; \quad \quad + \frac{\dsct{\extforce}{j+1} - \dsct{\extforce}{j}}{k \tstep} \expon{- \damp \freq \tstep} \left(\frac{2 \damp}{\freq} \cos \dfreq \tstep + \left[\frac{2 \damp^2}{\dfreq} - \frac{1}{ \dfreq}\right] \sin \dfreq \tstep \right) \\
   &amp; \quad \quad \quad + \frac{\dsct{\extforce}{j+1} - \dsct{\extforce}{j}}{k \tstep} \left[\tstep  -\frac{2 \damp}{\freq} \right]
\end{align*}\]</span> Despite the somewhat complicated structure of this result, it is actually composed of a number of coefficients such as <span class="math inline">\(\cos \dfreq \tstep\)</span>, <span class="math inline">\(\sin \dfreq \tstep\)</span>, etc, multiplying the time-varying variables <span class="math inline">\(\gc\)</span>, <span class="math inline">\(\dgc\)</span> and <span class="math inline">\(\extforce\)</span>. Rearranging the terms, it is possible to express the result above as <span id="eq-pemgc"><span class="math display">\[
\dsct{\gc}{j+1} = A_1 \dsct{\gc}{j+1} + A_2 \dsct{\dgc}{j} + A_3 \dsct{\extforce}{j} + A_4 \dsct{\extforce}{j+1}
\qquad(4.3)\]</span></span> where <span id="eq-pemai"><span class="math display">\[
\begin{array}{l}
  A_1 =  \expon{- \damp \freq \tstep} \left(\cos \dfreq \tstep + \frac{\damp}{\sqrt{1 - \damp^2}} \sin \dfreq \tstep \right) \\
  A_2 =  \expon{- \damp \freq \tstep} \left(\frac{1}{\dfreq} \sin \dfreq \tstep \right) \\
  A_3 = \frac{1}{k} \left[\frac{2 \damp}{\freq \tstep} + \expon{- \damp \freq \tstep} \left( - \left[1 + \frac{2 \damp}{\freq \tstep} \right]\cos \dfreq \tstep + \left[\frac{1 - 2 \damp^2}{\dfreq \tstep} - \frac{\damp}{\sqrt{1-\damp^2}} \right] \sin \dfreq \tstep \right) \right] \\
  A_4 =\frac{1}{k} \left[1 - \frac{2 \damp}{\freq \tstep} + \expon{- \damp \freq \tstep} \left( \frac{2 \damp}{\freq \tstep} \cos \dfreq \tstep + \frac{2 \damp^2-1}{\dfreq \tstep} \sin \dfreq \tstep \right) \right]
\end{array}
\qquad(4.4)\]</span></span> It is noteworthy that these coefficients are time invariant if a constant time step is used, in which case they would have to be calculated only once. Similarly, if we obtain the velocity by differentiating <span class="math inline">\(\gc (\tau + t_{j})\)</span> and evaluate its value at <span class="math inline">\(\tau = \tstep\)</span>, we find that this value may also be expressed in the form <span id="eq-pemdgc"><span class="math display">\[
\dsct{\dgc}{j+1} = B_1 \dsct{\gc}{j} + B_2 \dsct{\dgc}{j} + B_3 \dsct{\extforce}{j} + B_4 \dsct{\extforce}{j}
\qquad(4.5)\]</span></span> where <span id="eq-pembi"><span class="math display">\[
\begin{array}{l}
  B_1 =  - \expon{- \damp \freq \tstep} \left(\frac{\freq}{\sqrt{1 - \damp^2}} \sin \dfreq \tstep \right) \\
  B_2 =  \expon{- \damp \freq \tstep} \left(\cos \dfreq \tstep - \frac{\damp}{\sqrt{1 - \damp^2}} \sin \dfreq \tstep \right) \\
  B_3 = \frac{1}{k \tstep} \left[-{1} + \expon{- \damp \freq \tstep} \left( \cos \dfreq \tstep + \frac{\freq \tstep + \damp}{\sqrt{1-\damp^2}} \sin \dfreq \tstep \right) \right] \\
  B_4 =\frac{1}{k \tstep} \left[1 - \expon{- \damp \freq \tstep} \left( \cos \dfreq \tstep + \frac{\damp}{\sqrt{1 - \damp^2}} \sin \dfreq \tstep \right) \right]
\end{array}
\qquad(4.6)\]</span></span> and once again all coefficients are independent of time if a constant time step is used. Once the displacement and the velocity at an instant are evaluated, the acceleration at that instant may be calculated via the the equation of motion as: <span id="eq-pemddgc"><span class="math display">\[
    \dsct{\ddgc}{j} = \frac{1}{m}(\dsct{\extforce}{j} - c \dsct{\dgc}{j} - k \dsct{\gc}{j}) = \frac{\dsct{\extforce}{j}}{m} - 2 \damp \freq \dsct{\dgc}{j} - \freq^2 \dsct{\gc}{j}
\qquad(4.7)\]</span></span> Having developed the analytical results based on the initial assumptions, the flow of the PLE implemented with a constant time step may be summarized as in <a href="#fig-algpem">Figure&nbsp;<span>4.2</span></a>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Pseudocode for the Piecewise Linear Excitation method.</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>viscously damped SDOF system, for constant time step</em></p>
<p><strong>Input</strong>: <span class="math inline">\(m\)</span>, <span class="math inline">\(\damp\)</span> (or <span class="math inline">\(c\)</span>), <span class="math inline">\(k\)</span>, <span class="math inline">\(\tstep\)</span>, <span class="math inline">\(\dsct{\gc}{0}\)</span>, <span class="math inline">\(\dsct{\dgc}{0}\)</span>, <span class="math inline">\(\left\{\dsct{\extforce}{0}, \ldots, \dsct{\extforce}{l} \right\}\)</span></p>
<p><strong>Initialize</strong>: calculate <span class="math inline">\(A_1,A_2,A_3,A_4,B_1,B_2,B_3,B_4\)</span> using <a href="#eq-pemai">Equation&nbsp;<span>4.4</span></a> and <a href="#eq-pembi">Equation&nbsp;<span>4.6</span></a></p>
<p><strong>for</strong> <span class="math inline">\(j=0,\ldots,l-1\)</span>:</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\gc}{j+1}=A_1 \dsct{\gc}{j} + A_2 \dsct{\dgc}{j} + A_3 \dsct{\extforce}{j} + A_4 \dsct{\extforce}{j+1}\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\dgc}{j+1}=B_1 \dsct{\gc}{j} + B_2 \dsct{\dgc}{j} + B_3 \dsct{\extforce}{j} + B_4 \dsct{\extforce}{j+1}\)</span></p>
<p><strong>for</strong> <span class="math inline">\(j=0,\ldots,l\)</span>:</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\ddgc}{j} = \frac{1}{m}(\dsct{\extforce}{j} - c \dsct{\dgc}{j} - k \dsct{\gc}{j})\)</span></p>
</div>
</div>
<div id="fig-algpem" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blank.png" style="width:0.0%" height="0" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.2: Pseudocode for PLE.</figcaption><p></p>
</figure>
</div>
<section id="sec-sdofnum" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="sec-sdofnum">EXAMPLE 4 .1</h4>
<p>A single story structure, initially at rest, is idealized as an SDOF system for studying its lateral vibrations when subjected to unidirectional, pulse type lateral forces. The mass<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> of the structure is assumed to be condensed at a certain level and estimated as <span class="math inline">\(125 \unit{tons}\)</span>, its lateral stiffness is estimated as <span class="math inline">\(2\times 10^5 \unit{kN/m}\)</span>, and it is assumed to be viscously damped with a damping ratio of <span class="math inline">\(2\%\)</span>. The equivalent model of the system and the forces it is subjected to are shown in <a href="#fig-numericalex1">Figure&nbsp;<span>4.3</span></a>. Consider a constant time step of <span class="math inline">\(\tstep = 0.01 \unit{seconds}\)</span>, which corresponds to less than one-tenth of the system’s period, and let us say we want to evaluate the response of the system for a duration of <span class="math inline">\(1 \unit{second}\)</span>, so that a total of <span class="math inline">\(101\)</span> time instances are to be taken into consideration including the initial time <span class="math inline">\(t=0\)</span>.</p>
<div id="fig-numericalex1" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/numericalex1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.3: (a) SDOF model of a single story structure, (b) triangular pulse with duration <span class="math inline">\(0.2 \unit{seconds}\)</span>, (c) half-sine pulse with duration <span class="math inline">\(0.4 \unit{seconds}\)</span>.</figcaption><p></p>
</figure>
</div>
<p>Let us start with the analysis of the triangular pulse with an amplitude of <span class="math inline">\(100 \unit{kN}\)</span> and duration <span class="math inline">\(t_d = 0.2 \unit{seconds}\)</span>. The force increases linearly until it reaches its peak value of <span class="math inline">\(100 \unit{kN}\)</span> at <span class="math inline">\(t = t_d / 2 = 0.1 \unit{seconds}\)</span> corresponding to <span class="math inline">\(j = 10\)</span>, after which it declines linearly until it disappears at <span class="math inline">\(t = t_d / 2 = 0.1 \unit{seconds}\)</span> corresponding to <span class="math inline">\(j = 20\)</span>. The value of the force may therefore be defined at instances <span class="math inline">\(j\)</span> as <span class="math display">\[
\dsct{\extforce}{j} = \begin{cases} 100 \frac{\dsct{t}{j}}{t_d/2} = 10 j \unit{kN} &amp; \text{for } j = 0,1,\ldots,10 \\
200 - 200 \frac{\dsct{t}{j}}{t_d} = 200 - 10 j \unit{kN} &amp; \text{for } j = 11,12,\ldots,20 \\
0 &amp; \text{for } j = 21, 22, \ldots, 100
\end{cases}
\]</span> The first order of business is to calculate the coefficients <span class="math inline">\(A\)</span>’s and <span class="math inline">\(B\)</span>’s that appear in the recursive formulas of <a href="#eq-pemgc">Equation&nbsp;<span>4.3</span></a> and <a href="#eq-pemdgc">Equation&nbsp;<span>4.5</span></a>. These coefficients are evaluated using the expressions given in <a href="#eq-pemai">Equation&nbsp;<span>4.4</span></a> and <a href="#eq-pembi">Equation&nbsp;<span>4.6</span></a> to obtain: <span class="math display">\[
\begin{array}{rr}
A_{1} = 9.2148 \times 10^{-1}, &amp; A_{2} = 9.6580\times 10^{-3} \\
A_{3} = 2.6086\times 10^{-7}, &amp; A_{4} = 1.3174\times 10^{-7} \\
B_1 = -1.5453\times 10^{1}, &amp; B_2 = 9.0603 \times 10^{-1} \\
B_3 = 3.8004\times 10^{-5}, &amp; B_4 = 3.9260\times 10^{-5}
\end{array}
\]</span> Note that these coefficients are independent of the force insofar as the time step does not change. The next step is to calculate the displacement and the velocity through <a href="#eq-pemgc">Equation&nbsp;<span>4.3</span></a> and <a href="#eq-pemdgc">Equation&nbsp;<span>4.5</span></a>, and the acceleration at each time step through <a href="#eq-pemddgc">Equation&nbsp;<span>4.7</span></a>. At the initial instance corresponding to <span class="math inline">\(j=0\)</span> the system is at rest, and so <span class="math inline">\(\dsct{\gc}{0} = 0\)</span>, <span class="math inline">\(\dsct{\dgc}{0} = 0\)</span>. Since <span class="math inline">\(\dsct{\extforce}{0} = 0\)</span>, we find <span class="math inline">\(\dsct{\ddgc}{0} = 0\)</span> as well. <span class="math inline">\(\dsct{\gc}{1}\)</span> and <span class="math inline">\(\dsct{\dgc}{1}\)</span> are to be evaluated from <span class="math display">\[\begin{align*}
\dsct{\gc}{1} &amp; = 9.2148 \times 10^{-1} \dsct{\gc}{0} + 9.6580\times 10^{-3} \dsct{\dgc}{0} + 2.6086\times 10^{-7} \dsct{\extforce}{0} \\
    &amp; \phantom{9.2148} + 1.3174\times 10^{-7} \dsct{\extforce}{1} = (1.3174\times 10^{-7})(10) =  1.3174\times 10^{-6} \unit{m} \\
\dsct{\dgc}{1} &amp; = -1.5453\times 10^{1} \dsct{\gc}{0} + 9.0603 \times 10^{-1} \dsct{\dgc}{0} + 3.8004\times 10^{-5} \dsct{\extforce}{0} \\
    &amp; \phantom{-1.5} + 3.9260\times 10^{-5}  \dsct{\extforce}{1} = (3.9260\times 10^{-5} )(10) = 3.9260\times 10^{-4}  \unit{m/s} \\
\end{align*}\]</span> and the acceleration at <span class="math inline">\(j=1\)</span> is consequently given by <span class="math display">\[
    \dsct{\ddgc}{1} = \frac{1}{m}(\dsct{\extforce}{1} - c \dsct{\dgc}{1} - k \dsct{\gc}{1}) = 7.7264 \times 10^{-2} \unit{m/s}
\]</span> The calculations proceed in this manner, and the instances until <span class="math inline">\(t=0.1 \unit{seconds}\)</span> are obtained as: <span class="math display">\[
\small{
\begin{array}{rrr}
\dsct{\gc}{0} = 0.0000 \times 10^{-3} \unit{m}, &amp; \dsct{\dgc}{0} = 0.0000 \times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{0} = 0.0000  \unit{m/s^2}\\
\dsct{\gc}{1} = 0.0013\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{1} = 0.3926\times 10^{-3}  \unit{m/s}, &amp; \dsct{\ddgc}{1} = 0.0773  \unit{m/s^2}\\
\dsct{\gc}{2} = 0.0102\times 10^{-3} \unit{m}, &amp; \dsct{\dgc}{2} = 1.5006\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{2} = 0.1412 \unit{m/s^2}\\
\dsct{\gc}{3} = 0.0331\times 10^{-3} \unit{m}, &amp; \dsct{\dgc}{3} = 3.1391\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{3} = 0.1820 \unit{m/s^2}\\
\dsct{\gc}{4} = 0.0739\times 10^{-3} \unit{m}, &amp; \dsct{\dgc}{4} = 5.0430\times 10^{-3} \unit{m/s}, &amp;  \dsct{\ddgc}{4} = 0.1937 \unit{m/s^2}\\
\dsct{\gc}{5} = 0.1338 \times 10^{-3} \unit{m}, &amp; \dsct{\dgc}{5} = 6.9100 \times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{5} = 0.1748 \unit{m/s^2}\\
\dsct{\gc}{6} = 0.2110\times 10^{-3} \unit{m}, &amp; \dsct{\dgc}{6} = 8.4482\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{6} = 0.1289 \unit{m/s^2}\\
\dsct{\gc}{7} = 0.3009\times 10^{-3} \unit{m}, &amp; \dsct{\dgc}{7} = 9.4219\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{7} = 0.0635  \unit{m/s^2}\\
\dsct{\gc}{8} = 0.3971\times 10^{-3} \unit{m}, &amp; \dsct{\dgc}{8} = 9.6876\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{8} = -0.0108  \unit{m/s^2}\\
\dsct{\gc}{9} = 0.4922\times 10^{-3} \unit{m}, &amp; \dsct{\dgc}{9} = 9.2149\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{9} = -0.0823  \unit{m/s^2}\\
\dsct{\gc}{10} = 0.5792\times 10^{-3} \unit{m}, &amp; \dsct{\dgc}{10} = 8.0896\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{10} = -0.1397  \unit{m/s^2}
\end{array}
}
\]</span> These values are provided as reference for readers wishing to check the answers they obtain through their calculations and thereby verify their codes. The response obtained for the whole <span class="math inline">\(1 \unit{second}\)</span> duration is plotted in <a href="#fig-numericalex1pem">Figure&nbsp;<span>4.4</span></a>.</p>
<div id="fig-numericalex1pem" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/numericalex1pem.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.4: Displacement, velocity and acceleration response calculated for the system of <a href="#fig-numericalex1">Figure&nbsp;<span>4.3</span></a> subjected to the triangular pulse. The response quantities calculated by the PLE are marked with solid circles while the dashed lines are interpolations included for visualisation.</figcaption><p></p>
</figure>
</div>
<p>Let us repeat the analysis for the case of the half-sine pulse, of amplitude <span class="math inline">\(100 \unit{kN}\)</span> and duration <span class="math inline">\(0.4 \unit{seconds}\)</span>, shown in <a href="#fig-numericalex1">Figure&nbsp;<span>4.3</span></a>.c.&nbsp;This time the force is defined by <span class="math display">\[
\dsct{\extforce}{j} = \begin{cases} 100 \sinp{\frac{\pi}{0.4}\dsct{t}{j}} = 100 \sinp{\frac{\pi}{40}j}; &amp; j = 0,1,\ldots,40 \\
0; &amp; j = 41, 42, \ldots, 100
\end{cases}
\]</span></p>
<div id="fig-numericalex1pem2" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/numericalex1pem2.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.5: Displacement, velocity and acceleration response calculated for the system of <a href="#fig-numericalex1">Figure&nbsp;<span>4.3</span></a> subjected to the half-sine pulse. The response quantities calculated by the PLE are marked with solid circles while the dashed lines are interpolations included for visualisation.</figcaption><p></p>
</figure>
</div>
<p>Since the coefficients <span class="math inline">\(A\)</span>’s and <span class="math inline">\(B\)</span>’s of the PLE do not depend on the input but only on the system parameters and the time step, the values calculated previously for the triangular pulse case are still valid. Proceeding with the recursive calculations, the response quantities until <span class="math inline">\(t=0.1 \unit{seconds}\)</span> are obtained as follows, presented for reference: <span class="math display">\[
\small{
\begin{array}{rrr}
\dsct{\gc}{0} = 0.0000\times 10^{-4}    \unit{m}, &amp; \dsct{\dgc}{0} = 0.0000 \times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{0}= 0.0000  \unit{m/s^2} \\
\dsct{\gc}{1}= 0.0103\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{1}= 0.3080\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{1}= 0.0606  \unit{m/s^2} \\
\dsct{\gc}{2}= 0.0804\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{2}= 1.1755\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{2}= 0.1104  \unit{m/s^2} \\
\dsct{\gc}{3}= 0.2591\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{3}= 2.4518\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{3}= 0.1414  \unit{m/s^2} \\
\dsct{\gc}{4}= 0.5772\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{4}= 3.9214\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{4}= 0.1486  \unit{m/s^2} \\
\dsct{\gc}{5}= 1.0416\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{5}= 5.3378\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{5}= 0.1310  \unit{m/s^2} \\
\dsct{\gc}{6}= 1.6350\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{6}= 6.4633\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{6}= 0.0913  \unit{m/s^2} \\
\dsct{\gc}{7}= 2.3181\times 10^{-4} \unit{m}, &amp; \dsct{\dgc}{7}= 7.1061\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{7}= 0.0357  \unit{m/s^2} \\
\dsct{\gc}{8}= 3.0361\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{8}= 7.1495\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{8}= -0.0270  \unit{m/s^2} \\
\dsct{\gc}{9}= 3.7271\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{9}= 6.5696\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{9}= -0.0873  \unit{m/s^2} \\
\dsct{\gc}{10}= 4.3315\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{10}= 5.4370\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{10}= -0.1361  \unit{m/s^2}
\end{array}
}
\]</span> The displacement, velocity and acceleration responses calculated for the first <span class="math inline">\(1 \unit{second}\)</span> are plotted in <a href="#fig-numericalex1pem2">Figure&nbsp;<span>4.5</span></a>.</p>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-section" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>This approach is referred in many references as the <em>piecewise exact method</em> which we think is somewhat misleading in that the ‘exactness’ alluded to with this name pertains only the analytical expressions used and not to the accurateness of the method itself.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Many structures involve relatively large masses such that in practice metric ton (<span class="math inline">\(\punit{ton}\)</span> or <span class="math inline">\(\punit{t}\)</span>) is often used, with <span class="math inline">\(1 \unit{ton} = 1000 \unit{kg}\)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<section id="sec-sdofnum2" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="sec-sdofnum2">EXAMPLE 4 .2</h4>
<p>To illustrate how the calculations would proceed for an SDOF system subjected to ground motion, let us consider the system of <a href="#sec-sdofnum">Ex. 4 .1</a>, subjected to a ground motion defined by <span class="math display">\[
\gdist = \begin{cases} \ratio{\maxgvel}{2}t - \ratio{\maxgvel t_{d}}{2 \pi} \sinp{\ratio{2\pi}{t_{d}}t}; 0 \leq t \leq t_{d} \\
\ratio{\maxgvel t_{d}}{2}; t &gt; t_{d}\end{cases}
\]</span> with <span class="math inline">\(\maxgvel = 1 \unit{m/s}\)</span> and <span class="math inline">\(t_{d} = 0.4 \unit{s}\)</span>. The ground acceleration is therefore given for <span class="math inline">\(0 \leq t \leq t_{d}\)</span> by <span class="math display">\[
\gacct = \ratio{\pi \maxgvel}{t_{d}} \sinp{\ratio{2\pi}{t_{d}}t} = 2.5 \pi \sinp{{5 \pi}t}
\]</span> and it is zero at all other times. Recall that for this system, <span class="math inline">\(\damp = 2 \%\)</span>.</p>
<div id="fig-numericalex2" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/numericalex2.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.6: (a) SDOF model of a single story structure subjected to ground motion, (b) A velocity-pulse type ground motion with duration <span class="math inline">\(0.5 \unit{s}\)</span>.</figcaption><p></p>
</figure>
</div>
<p>The model and the ground acceleration are shown in <a href="#fig-numericalex2">Figure&nbsp;<span>4.6</span></a>, and the governing equation of motion for <span class="math inline">\(0 \leq t \leq 0.4 \unit{s}\)</span> is given by <span class="math display">\[
m \ddgct + c \dgct + k \gct = - m \gacct  \rightarrow 125 \ddgct + c \gct + 2 \times 10^5 \gct = - 312.5 \pi \sinp{5 \pi t}
\]</span> subjected to initial conditions <span class="math inline">\(\gc (0) = 0, \dgc (0) = 0\)</span>; or equivalently by <span class="math display">\[
\ddgct + 2 \zeta \freq \dgct + \freq^2 \gct = - \gacct \rightarrow \ddgct +  1.6 \gct + 1600 \gct = - 2.5 \pi \sinp{5 \pi t}
\]</span> where we have taken into consideration that <span class="math inline">\(\damp = 0.02\)</span> and <span class="math inline">\(\freq = \sqrt{k/m} = 40 \unit{rad/s}\)</span> as per the properties stated for the system. Free vibrations ensue after <span class="math inline">\(t = 0.4 \unit{s}\)</span>. Either form of the equation of motion may be used while calculating the response, but note that for the second equation the numerical values for the mass, damping and stiffness coefficients would have to be defined as <span class="math inline">\(m = 1\)</span>, <span class="math inline">\(c = 1.6\)</span> and <span class="math inline">\(k = 1600\)</span>, respectively. Let us use this second form in our calculations with a constant time step of <span class="math inline">\(\tstep=0.01 \unit{s}\)</span>. The input is defined at each step by <span class="math display">\[
\dsct{\extforce}{j} = - m\dsct{\gacc}{j} = \begin{cases} - 7.854 \sinp{0.1571 j} &amp; \text{for } j = 0,1,\ldots,40 \\
0 &amp; \text{for } j = 41, \ldots, 100
\end{cases}
\]</span></p>
<div id="fig-numericalex2pem" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/numericalex2pem.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.7: Relative displacement, relative velocity and relative acceleration response calculated for the system of <a href="#fig-numericalex2">Figure&nbsp;<span>4.6</span></a> subjected to the pulse-type ground motion. The response quantities calculated by the PLE are marked with solid circles while the dashed lines are interpolations included for visualisation.</figcaption><p></p>
</figure>
</div>
<p>For <span class="math inline">\(m=1\)</span>, <span class="math inline">\(\damp=0.02\)</span> and <span class="math inline">\(k=1600\)</span>, the coefficients for the PLE are calculated via <a href="#eq-pemai">Equation&nbsp;<span>4.4</span></a> and <a href="#eq-pembi">Equation&nbsp;<span>4.6</span></a> to obtain <span class="math display">\[
\begin{array}{rrrr}
A_{1} = 9.2148\times 10^{-1}, &amp; A_{2} = 9.6580\times 10^{-3} \\
A_{3} = 3.2607\times 10^{-5}, &amp; A_{4} = 1.6468\times 10^{-5} \\
B_1 = -1.5453\times 10^{1}, &amp; B_2 = 9.0603 \times 10^{-1} \\
B_3 = 4.7504\times 10^{-3}, &amp; B_4 = 4.9076\times 10^{-3}
\end{array}
\]</span> The recursive calculations via <a href="#eq-pemgc">Equation&nbsp;<span>4.3</span></a>, <a href="#eq-pemdgc">Equation&nbsp;<span>4.5</span></a> and <a href="#eq-pemddgc">Equation&nbsp;<span>4.7</span></a> yield, for the first few steps, the following results:</p>
<p><span class="math display">\[
\small{
\begin{array}{rrr}
\dsct{\gc}{ 0 } = 0.0000\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 0 } = 0.0000\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 0 } = -0.0000  \unit{m/s^2} \\
\dsct{\gc}{ 1 } = -0.0202\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 1 } = -0.0603\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 1 } = -1.1866  \unit{m/s^2} \\
\dsct{\gc}{ 2 } = -0.1569\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 2 } = -0.2290\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 2 } = -2.1393  \unit{m/s^2} \\
\dsct{\gc}{ 3 } = -0.5036\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 3 } = -0.4735\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 3 } = -2.6841  \unit{m/s^2} \\
\dsct{\gc}{ 4 } = -1.1136\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 4 } = -0.7471\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 4 } = -2.7151  \unit{m/s^2} \\
\dsct{\gc}{ 5 } = -1.9897\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 5 } = -0.9967\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 5 } = -2.2106  \unit{m/s^2} \\
\dsct{\gc}{ 6 } = -3.0818\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 6 } = -1.1712\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 6 } = -1.2357  \unit{m/s^2} \\
\dsct{\gc}{ 7 } = -4.2934\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 7 } = -1.2302\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 7 } = 0.0683  \unit{m/s^2} \\
\dsct{\gc}{ 8 } = -5.4955\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 8 } = -1.1501\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 8 } = 1.5073  \unit{m/s^2} \\
\dsct{\gc}{ 9 } = -6.5461\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 9 } = -0.9284\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 9 } = 2.8651  \unit{m/s^2} \\
\dsct{\gc}{ 10 } = -7.3110\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 10 } = -0.5835\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 10 } = 3.9370 \unit{m/s^2}
\end{array}
}
\]</span> The relative displacement, relative velocity and relative acceleration responses calculated for the first <span class="math inline">\(1 \unit{second}\)</span> are plotted in <a href="#fig-numericalex2pem">Figure&nbsp;<span>4.7</span></a>.</p>
</section>
</section>
<section id="central-difference-method" class="level2" data-number="4.3">
<h2 data-number="4.3" data-anchor-id="central-difference-method"><span class="header-section-number">4.3</span> Central Difference Method</h2>
<p>A family of numerical methods commonly referred to as <em>finite difference methods</em> makes use of the Taylor series expansion of response and assumes that the series may be truncated after some terms with negligible error if the time step is relatively small. What is known as the Central Difference Method makes use of a one step forward and a one step backward expansion to reduce the order of error. Recall that for some sufficiently smooth continuous function <span class="math inline">\(\gc = \gc (t)\)</span>, Taylor series expansion expresses the value of the function at <span class="math inline">\(t=t_2\)</span> as a function of the value of itself and its derivatives at <span class="math inline">\(t=t_1\)</span> through <span class="math display">\[\begin{align*}
\gc(t_2) &amp; = \gc(t_1) + (t_2 - t_1) \frac{\diff \gc }{\dt}\biggr|_{t=t_1}  \!\!\!\!\! + \frac{(t_2 - t_1)^2}{2}\frac{\diff^2 \gc}{\dt^2}\biggr|_{t=t_1}  \!\!\!\!\! +  \frac{(t_2 - t_1)^3}{6} \frac{\diff^3 \gc}{\dt^3}\biggr|_{t=t_1}  \!\!\!\!\! + \cdots \\
&amp; = \gc(t_1) + \sum_{j=1}^{\infty} \frac{(t_2 - t_1)^j}{j!}\frac{\diff^j \gc}{\dt^j}\biggr|_{t=t_1}
\end{align*}\]</span> Consider now the Taylor series expansions for displacement <span class="math inline">\(\gct\)</span> at <span class="math inline">\(t+\tstep\)</span> and <span class="math inline">\(t - \tstep\)</span>, given by <span class="math display">\[\begin{align*}
  \gc (t + \tstep) &amp; = \gc (t) + \dgc (t) \tstep + \frac{1}{2}\ddgc (t) \tstep^2 + o(\tstep^3) \\
  \gc (t - \tstep) &amp; = \gc (t) - \dgc (t) \tstep + \frac{1}{2}\ddgc (t) \tstep^2 - o(\tstep^3)
\end{align*}\]</span> where <span class="math inline">\(o(\tstep^p)\)</span> is the remainder of the expansion with leading term of order <span class="math inline">\(\tstep^p\)</span>. The sum of the two equations above leads to <span class="math display">\[
  \gc (t + \tstep) + \gc (t - \tstep) = 2 \gc (t) + \ddgc (t) \tstep^2 + o(\tstep^4)  
\]</span> and if the fourth-order remainder were to be neglected, the acceleration at time <span class="math inline">\(t\)</span> could be approximated by <span id="eq-cemacc"><span class="math display">\[
    \ddgc (t) \approx \frac{\gc (t + \tstep) - 2 \gc (t) + \gc (t - \tstep)}{\tstep^2}
\qquad(4.8)\]</span></span> The error so incurred is expected to decrease in an absolute sense as <span class="math inline">\(\tstep\)</span> decreases. On the other hand, the difference of the two expansions leads to <span class="math display">\[
  \gc (t + \tstep) - \gc (t - \tstep) = 2 \dgc  (t) \tstep + + o(\tstep^3)
\]</span> so that neglecting the third order remainder yields the following approximation for the velocity: <span id="eq-cemvel"><span class="math display">\[
    \dgc  (t) \approx \frac{\gc (t + \tstep) - \gc (t - \tstep)}{2 \tstep}
\qquad(4.9)\]</span></span> <a href="#eq-cemacc">Equation&nbsp;<span>4.8</span></a> and <a href="#eq-cemvel">Equation&nbsp;<span>4.9</span></a> are called the central difference approximations to the acceleration and the velocity, respectively. These approximations may be used in the equation of motion to express the equation solely in terms of the generalized displacement. Substituting the central difference approximations into the equation of motion and considering that time is discretized with constant time step <span class="math inline">\(\tstep\)</span> so that <span class="math inline">\(t = j \tstep\)</span> and <span class="math inline">\(t \pm \tstep = (j \pm 1) \tstep\)</span>, we get <span class="math display">\[\begin{align*}
  m \ddgc (t) + c \dgc  (t) + k \gc (t) &amp; =   m \dsct{\ddgc}{j} + c \dsct{\dgc}{j} + k \dsct{\gc}{j}  \\
  &amp; = m  \frac{\dsct{\gc}{j+1} - 2 \dsct{\gc}{j} + \dsct{\gc}{j-1}}{\tstep^2} + c  \frac{\dsct{\gc}{j+1} - \dsct{\gc}{j-1}}{2 \tstep} + k \dsct{\gc}{j} = \extforce(t)= \dsct{\extforce}{j}
\end{align*}\]</span> It is straightforward to recast this expression into a regression type formula so that given the response up to and including time <span class="math inline">\(t\)</span> (time step <span class="math inline">\(p\)</span>), the response at <span class="math inline">\(t+\tstep\)</span> (time step <span class="math inline">\(p+1\)</span>) may then be estimated using <span id="eq-cdmq"><span class="math display">\[
  A_1 \dsct{\gc}{j+1} = \left(\dsct{\extforce}{j} - A_2 \dsct{\gc}{j} - A_3 \dsct{\gc}{j-1} \right)
\qquad(4.10)\]</span></span> where <span id="eq-cdmai"><span class="math display">\[
\begin{array}{l}
  A_1 = {\ratio{m}{\tstep^2} + \ratio{c}{2 \tstep}} = m \left[\ratio{1}{\tstep^2} + \ratio{\damp \freq}{\tstep} \right] \\
  A_2 =  k - \ratio{2m}{\tstep^2} = m \left[\freq^2 - \ratio{2}{\tstep^2} \right] \\
  A_3 = \ratio{m}{\tstep^2} - \frac{c}{2 \tstep} = m \left[\ratio{1}{\tstep^2} - \ratio{\damp \freq}{\tstep} \right] \\
  A_4 = \ratio{1}{2\tstep}\\
  A_5 = \ratio{1}{\tstep^2}
\end{array}
\qquad(4.11)\]</span></span> Once again, for a constant time step <span class="math inline">\(\tstep\)</span>, the coefficients <span class="math inline">\(A_i\)</span> are to be calculated only once. At each time step, the velocity is to be calculated from the central difference approximation in <a href="#eq-cemvel">Equation&nbsp;<span>4.9</span></a>, which may be written in discrete form as <span id="eq-cdmdq"><span class="math display">\[
  \dsct{\dgc}{j} = \frac{1}{2\tstep}(\dsct{\gc}{j+1} - \dsct{\gc}{j-1}) = A_4 (\dsct{\gc}{j+1} - \dsct{\gc}{j-1})
\qquad(4.12)\]</span></span> and in the case of SDOF systems the acceleration may be calculated using the equilibrium equation for that time step via the discretized form: <span id="eq-cdmddq"><span class="math display">\[
  m \dsct{\ddgc}{j} = \left(\dsct{\extforce}{j} - c \dsct{\dgc}{j} - k \dsct{\gc}{j} \right)
\qquad(4.13)\]</span></span> In the case of systems with numerous degrees of freedom the matrix computations involved above may be prohibitive and the accelerations may instead be calculated via the central difference approximations: <span id="eq-cdmddq2"><span class="math display">\[
\dsct{\ddgc}{j} = \frac{\dsct{\gc}{j+1}- 2 \dsct{\gc}{j} + \dsct{\gc}{j-1}}{\tstep^2} = A_5 (\dsct{\gc}{j+1}- 2 \dsct{\gc}{j} + \dsct{\gc}{j-1})
\qquad(4.14)\]</span></span></p>
<p>For initial conditions <span class="math inline">\(\dsct{\gc}{0}\)</span> and <span class="math inline">\(\dsct{\dgc}{0}\)</span>, the first iteration would be given by <span class="math display">\[
  A_1 \dsct{\gc}{1} = \left(\dsct{\extforce}{0} - A_2 \dsct{\gc}{0} - A_3 \dsct{\gc}{-1} \right)
\]</span> where <span class="math inline">\(\dsct{\gc}{-1}\)</span> is needed. One practice for a system at rest may be to assume <span class="math inline">\(\dsct{\gc}{-1} = 0\)</span>. An alternative is to use a value consistent with the central difference approximation which may be derived as follows: The central difference approximations for the acceleration and the velocity at time <span class="math inline">\(t = 0\)</span> are <span class="math display">\[
\dsct{\ddgc}{0} = \frac{\dsct{\gc}{1} - 2 \dsct{\gc}{0} + \dsct{\gc}{-1}}{\tstep^2}, \quad \dsct{\dgc}{0} = \frac{\dsct{\gc}{1} - \dsct{\gc}{-1}}{2 \tstep}
\]</span> so that using these two equations to eliminate the <span class="math inline">\(\dsct{\gc}{1}\)</span> term, <span class="math inline">\(\dsct{\gc}{-1}\)</span> is given by <span class="math display">\[
\dsct{\gc}{-1} = \dsct{\gc}{0} - \tstep \dsct{\dgc}{0} - \frac{\tstep^2}{2} \dsct{\ddgc}{0}
\]</span> where the initial acceleration term <span class="math inline">\(\dsct{\ddgc}{0}\)</span> is to be calculated from the equilibrium equation at time <span class="math inline">\(t=0\)</span>: <span class="math display">\[
  \dsct{\ddgc}{0} = \frac{1}{m} \left(\dsct{\extforce}{0} - c \dsct{\dgc}{0} - k \dsct{\gc}{0} \right)
\]</span> The calculations involved are summarized in <a href="#fig-algcdm">Figure&nbsp;<span>4.8</span></a>.</p>
<div id="label-name" class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Pseudocode for the Central Difference Method</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>viscously damped SDOF system, for constant time step</em></p>
<p><strong>Input</strong>: <span class="math inline">\(m\)</span>, <span class="math inline">\(\damp\)</span> (or <span class="math inline">\(c\)</span>), <span class="math inline">\(k\)</span>, <span class="math inline">\(\tstep\)</span>, <span class="math inline">\(\dsct{\gc}{0}\)</span>, <span class="math inline">\(\dsct{\dgc}{0}\)</span>, <span class="math inline">\(\left\{\dsct{\extforce}{0}, \ldots, \dsct{\extforce}{l} \right\}\)</span></p>
<p><strong>Initialize</strong>: calculate</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(A_1,A_2,A_3\)</span>, <span class="math inline">\(A_4\)</span> and <span class="math inline">\(A_5\)</span> using <a href="#eq-cdmai">Equation&nbsp;<span>4.11</span></a>, <span class="math inline">\(A_1^{-1}\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\ddgc}{0} = \frac{1}{m}(\dsct{\extforce}{0} - c \dsct{\dgc}{0} - k\dsct{\gc}{0})\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\gc}{-1} = \dsct{\gc}{0} - \tstep \dsct{\dgc}{0} - \frac{\tstep^2}{2} \dsct{\ddgc}{0}\)</span></p>
<p><strong>for</strong> <span class="math inline">\(j=0,\ldots,l-1\)</span>:</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\gc}{j+1} = A_1^{-1} \left(\dsct{\extforce}{j} - A_2 \dsct{\gc}{j} - A_3 \dsct{\gc}{j-1} \right)\)</span></p>
<p><strong>for</strong> <span class="math inline">\(j=1,\ldots,l\)</span>:</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\dgc}{j} = A_4(\dsct{\gc}{j+1} - \dsct{\gc}{j-1})\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\ddgc}{j} = A_5 (\dsct{\gc}{j+1}- 2 \dsct{\gc}{j} + \dsct{\gc}{j-1})\)</span></p>
</div>
</div>
<div id="fig-algcdm" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blank.png" class="img-fluid figure-img" style="width:0.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.8: Pseudocode for the central difference method.</figcaption><p></p>
</figure>
</div>
<p>It is extremely important to note that for the response to stay stable, meaning not to eventually get excessively and unphysically large so as to render all results useless, the time step used must be such that <span class="math display">\[
  \tstep \leq \frac{T}{\pi}
\]</span> where <span class="math inline">\(T = 2 \pi \sqrt{m}/\sqrt{k}\)</span> is the natural period of the system. Because of this constraint, the CDM is said to be a <em>conditionally stable</em> method, as opposed to those that are stable for any time step (which are called <em>unconditionally stable</em>). Note that this condition does not necessarily guarantee accuracy, but only stability. In general, the smaller the time step, the more accurate the results would be expected to be; a commonly suggested value is <span class="math inline">\(\tstep &lt; T/10\)</span>.</p>
<p>Geometrically, the central difference method is equivalent to fitting a second order curve passing through three data points <span class="math inline">\(\dsct{\gc}{j-1}\)</span>, <span class="math inline">\(\dsct{\gc}{j}\)</span> and <span class="math inline">\(\dsct{\gc}{j+1}\)</span>, and evaluating the derivatives (velocity and acceleration in this case) at the midpoint. Assume a discretization with constant time step <span class="math inline">\(\tstep\)</span> and consider a time variable <span class="math inline">\(\tau = t - (j-1) \tstep\)</span>, such that <span class="math display">\[
\dgc (t=\tau + (j-1) \tstep) = \frac{\diff \gc(\tau)}{\diff \tau}, \quad \ddgc (t=\tau + (j-1) \tstep) = \frac{\diff^2 \gc (\tau)}{\diff \tau^2}
\]</span> for <span class="math inline">\(j\tstep \leq t \leq (j+1)\tstep\)</span> and <span class="math inline">\(0 \leq \tau \leq 2\tstep\)</span>. Given three data points <span class="math inline">\(\dsct{\gc}{j-1}\)</span>, <span class="math inline">\(\dsct{\gc}{j}\)</span> and <span class="math inline">\(\dsct{\gc}{j+1}\)</span>, there is a unique second order curve <span class="math inline">\(\gc(\tau)\)</span> that passes through all the three points as shown in <a href="#fig-numericalparabolic">Figure&nbsp;<span>4.9</span></a>. Such a curve is defined by the equation <span class="math display">\[
\gc (\tau) = C_1 \tau^2 + C_2 \tau + C_3
\]</span> where <span class="math inline">\(C_i\)</span> are constants that may be determined through the available information. In fact, we have, <span class="math display">\[\begin{align*}
q(\tau = 0) &amp; = C_3 = \dsct{\gc}{j-1} \\
q(\tau = \tstep) &amp; = \tstep^2 C_1 + \tstep C_2 + C_3 = \dsct{\gc}{j} \\
q(\tau = 2\tstep) &amp; = 4 \tstep^2 C_1 + 2 \tstep C_2 + C_3 = \dsct{\gc}{j+1}
\end{align*}\]</span></p>
<!-- margin figure to normal figure -->
<div id="fig-numericalparabolic" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/numericalparabolic.png" class="img-fluid figure-img" style="width:40.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.9: Second order curve passing through data three points.</figcaption><p></p>
</figure>
</div>
<p>Solving for the coefficients leads to <span class="math display">\[
C_1 = \ratio{1}{2 \tstep^2}(\dsct{\gc}{j+1} - 2 \dsct{\gc}{j} + \dsct{\gc}{j-1}), \quad C_2 = \ratio{1}{2 \tstep}(-\dsct{\gc}{j+1} + 4 \dsct{\gc}{j} - 3 \dsct{\gc}{j-1}), \quad C_3 = \dsct{\gc}{j-1}
\]</span> so that the velocity and acceleration at the midpoint, i.e.&nbsp;at <span class="math inline">\(t=i \tstep\)</span> or <span class="math inline">\(\tau = \tstep\)</span>, are given by <span class="math display">\[
\dsct{\dgc}{j}=\dgc (t=j \tstep) = \frac{\diff \gc(\tau)}{\diff \tau}\biggr|_{\tau = \tstep} = (2 C_1 \tau + C_2)\bigr|_{\tau=\tstep} = \ratio{\dsct{\gc}{j+1}-\dsct{\gc}{j-1}}{2\tstep}
\]</span> <span class="math display">\[
\dsct{\ddgc}{j}=\ddgc (t=j \tstep) = \frac{\diff^2 \gc(\tau)}{\diff \tau^2}\biggr|_{\tau = \tstep} = (2 C_1)\bigr|_{\tau=\tstep} = \ratio{\dsct{\gc}{j+1}-2\dsct{\gc}{j}+\dsct{\gc}{j-1}}{\tstep^2}
\]</span> which are in fact the finite difference approximations used for these two quantities in the central difference method.</p>
<section id="sec-sdofnum3" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="sec-sdofnum3">EXAMPLE 4 .3</h4>
<p>To illustrate how the central difference calculations proceed, let us consider the system discussed previously in <a href="#sec-sdofnum">Ex. 4 .1</a>, subjected to the half-sine pulse shown in <a href="#fig-numericalex1">Figure&nbsp;<span>4.3</span></a>.c.&nbsp;The system is defined by parameters <span class="math inline">\(m=125 \unit{tons}\)</span>, <span class="math inline">\(k=200 \, 000 \unit{kN/m}\)</span> and <span class="math inline">\(\damp = 0.02\)</span> (or, equivalently, <span class="math inline">\(c = 2 \damp \freq m = 200 \unit{kN \cdot s / m}\)</span>). With a time step of <span class="math inline">\(\tstep = 0.01 \unit{seconds} \approx 0.06 \period\)</span>, the force is again given by <span class="math display">\[
\dsct{\extforce}{j} = \begin{cases} 100 \sinp{\frac{\pi}{40}j} &amp; \text{for } j = 0,1,\ldots,40 \\
0 &amp; \text{for } j = 41, 42, \ldots, 100
\end{cases}
\]</span> and the coefficients to be used in the central difference method are calculated via <a href="#eq-cdmai">Equation&nbsp;<span>4.11</span></a> as: <span class="math display">\[
A_{1} ^{-1}= 7.9365\times 10^{-7}, \; A_{2} = -2300 \times 10^{3},  \; A_{3} = 1240 \times 10^{3}, \; A_{4} = 50, \; A_{5} = 10^{4}
\]</span> With zero initial conditions so that <span class="math inline">\(\dsct{\gc}{0} = 0\)</span> and <span class="math inline">\(\dsct{\dgc}{0} = 0\)</span>, <span class="math inline">\(\dsct{\ddgc}{0}\)</span> and <span class="math inline">\(\dsct{\gc}{-1}\)</span> are calculated to obtain <span class="math display">\[
\dsct{\ddgc}{0} = \frac{1}{m} (\dsct{\extforce}{0} - c \dsct{\dgc}{0} - k \dsct{\gc}{0}) = 0, \quad  \dsct{\gc}{-1} = \dsct{\gc}{0} - \tstep \dsct{\dgc}{0} - \frac{\tstep^2}{2} \dsct{\ddgc}{0} = 0
\]</span> after which, through the recursive formulas given by <a href="#eq-cdmq">Equation&nbsp;<span>4.29</span></a>, <a href="#eq-cdmdq">Equation&nbsp;<span>4.12</span></a> and <a href="#eq-cdmddq2">Equation&nbsp;<span>4.14</span></a>, the following values are calculated for the first few time steps: <span class="math display">\[
\small{
\begin{array}{rrr}
\dsct{\gc}{ 0 } = 0.0000\times 10^{-4} \unit{m}, &amp; \dsct{\dgc}{ 0 } = 0.0000\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{ 0 } = 0.0000  \unit{m/s^2} \\
\dsct{\gc}{ 1 } = 0.0000\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{ 1 } = 0.3114\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{ 1 } = 0.0623  \unit{m/s^2} \\
\dsct{\gc}{ 2 } = 0.0623\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{ 2 } = 1.1891\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{ 2 } = 0.1133  \unit{m/s^2} \\
\dsct{\gc}{ 3 } = 0.2378\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{ 3 } = 2.4792\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{ 3 } = 0.1447 \unit{m/s^2} \\
\dsct{\gc}{ 4 } = 0.5581\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{ 4 } = 3.9608\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{ 4 } = 0.1516  \unit{m/s^2} \\
\dsct{\gc}{ 5 } = 1.0300\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{ 5 } = 5.3824\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{ 5 } = 0.1327  \unit{m/s^2} \\
\dsct{\gc}{ 6 } = 1.6346\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{ 6 } = 6.5023\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{ 6 } = 0.0913  \unit{m/s^2} \\
\dsct{\gc}{ 7 } = 2.3304\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{ 7 } = 7.1272\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{ 7 } = 0.0337  \unit{m/s^2} \\
\dsct{\gc}{ 8 } = 3.0600\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{ 8 } = 7.1418\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{ 8 } = -0.0308  \unit{m/s^2} \\
\dsct{\gc}{ 9 } = 3.7588\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{ 9 } = 6.5263\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{ 9 } = -0.0923  \unit{m/s^2} \\
\dsct{\gc}{ 10 } = 4.3653\times 10^{-4}  \unit{m}, &amp; \dsct{\dgc}{ 10 } = 5.3582\times 10^{-3} \unit{m/s}, &amp; \dsct{\ddgc}{ 10 } = -0.1413 \unit{m/s^2}
\end{array}
}
\]</span></p>
<div id="fig-numericalex1cdm" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/numericalex1cdm.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.10: Displacement, velocity and acceleration response calculated for the system of <a href="#fig-numericalex1">Figure&nbsp;<span>4.3</span></a> subjected to the half-sine pulse. The response quantities calculated with the central difference method are marked with solid circles while the dashed lines are interpolations included for visualisation.</figcaption><p></p>
</figure>
</div>
<p>The displacement, velocity and acceleration response calculated for the first <span class="math inline">\(1 \unit{second}\)</span> are plotted in <a href="#fig-numericalex1cdm">Figure&nbsp;<span>4.10</span></a>.</p>
</section>
<section id="sec-sdofnum4" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="sec-sdofnum4">EXAMPLE 4 .4</h4>
<p>For a second application of the central difference method, let us consider the system and base motion of <a href="#fig-numericalex2">Figure&nbsp;<span>4.6</span></a>. The equation of motion for <span class="math inline">\(0 \leq t \leq 0.4 \unit{seconds}\)</span> was shown (see <a href="#sec-sdofnum2">Ex. 4 .2</a>) to be given by <span class="math display">\[
\ddgct +  1.6 \gct + 1600 \gct = - 2.5 \pi \sinp{5 \pi t}, \quad \{\gc (0) = 0, \dgc (0) = 0\}
\]</span> while for <span class="math inline">\(t &gt; 0.4 \unit{s}\)</span>, free vibrations ensue. With a time step of <span class="math inline">\(\tstep=0.01 \unit{s}\)</span>, the input is defined by <span class="math display">\[
\dsct{\extforce}{j} = \begin{cases}- 7.854 \sinp{0.1571 j} &amp; \text{for } j = 0,1,\ldots,40 \\
0 &amp; \text{for } j = 41, 42, \ldots, 100
\end{cases}
\]</span></p>
<div id="fig-numericalex2cdm" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/numericalex2cdm.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.11: Relative displacement, relative velocity and relative acceleration response calculated for the system of <a href="#fig-numericalex2">Figure&nbsp;<span>4.6</span></a> subjected to the pulse-type ground motion. The response quantities calculated by the central difference method are marked with solid circles while the dashed lines are interpolations included for visualisation.</figcaption><p></p>
</figure>
</div>
<p>For <span class="math inline">\(m=1\)</span>, <span class="math inline">\(\damp=0.02\)</span> and <span class="math inline">\(k=1600\)</span>, the coefficients for the central difference method are calculated via <a href="#eq-cdmai">Equation&nbsp;<span>4.11</span></a> to obtain <span class="math display">\[
A_{1}^{-1} = 9.9206\times 10^{-5}, \; A_{2} = 18 \; 400,  \; A_{3} = 9920, \; A_{4} = 50, \; A_{5} = 10^{4}
\]</span> With zero initial conditions so that <span class="math inline">\(\dsct{\gc}{0} = 0\)</span> and <span class="math inline">\(\dsct{\dgc}{0} = 0\)</span>, <span class="math inline">\(\dsct{\ddgc}{0}\)</span> and <span class="math inline">\(\dsct{\gc}{-1}\)</span> are calculated to obtain <span class="math display">\[
\dsct{\ddgc}{0} = \frac{1}{m} (\dsct{\extforce}{0} - c \dsct{\dgc}{0} - k \dsct{\gc}{0}) = 0, \quad  \dsct{\gc}{-1} = \dsct{\gc}{0} - \tstep \dsct{\dgc}{0} - \frac{\tstep^2}{2} \dsct{\ddgc}{0} = 0
\]</span> after which, the recursive calculations via <a href="#eq-cdmq">Equation&nbsp;<span>4.29</span></a>, <a href="#eq-cdmdq">Equation&nbsp;<span>4.12</span></a> and <a href="#eq-cdmddq2">Equation&nbsp;<span>4.14</span></a> yield, for the first few steps, the following results:</p>
<p><span class="math display">\[
\small{
\begin{array}{rrr}
\dsct{\gc}{ 0 } = 0.0000\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 0 } = 0.0000\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 0 } = 0.0000  \unit{m/s^2} \\
\dsct{\gc}{ 1 } = 0.0000\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 1 } = -0.0609\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 1 } = -1.2189  \unit{m/s^2} \\
\dsct{\gc}{ 2 } = -0.1219\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 2 } = -0.2316\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 2 } = -2.1949  \unit{m/s^2} \\
\dsct{\gc}{ 3 } = -0.4633\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 3 } = -0.4788\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 3 } = -2.7478  \unit{m/s^2} \\
\dsct{\gc}{ 4 } = -1.0794\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 4 } = -0.7546\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 4 } = -2.7686  \unit{m/s^2} \\
\dsct{\gc}{ 5 } = -1.9725\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 5 } = -1.0049\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 5 } = -2.2369  \unit{m/s^2} \\
\dsct{\gc}{ 6 } = -3.0892\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 6 } = -1.1779\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 6 } = -1.2229  \unit{m/s^2} \\
\dsct{\gc}{ 7 } = -4.3282\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 7 } = -1.2328\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 7 } = 0.1244  \unit{m/s^2} \\
\dsct{\gc}{ 8 } = -5.5547\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 8 } = -1.1465\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 8 } = 1.6014  \unit{m/s^2} \\
\dsct{\gc}{ 9 } = -6.6212\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 9 } = -0.9173\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 9 } = 2.9833  \unit{m/s^2} \\
\dsct{\gc}{ 10 } = -7.3892\times 10^{-3}  \unit{m}, &amp; \dsct{\dgc}{ 10 } = -0.5651\times 10^{-1} \unit{m/s}, &amp; \dsct{\ddgc}{ 10 } = 4.0592  \unit{m/s^2} \\
\end{array}
}
\]</span> The relative displacement, relative velocity and relative acceleration responses calculated for the first <span class="math inline">\(1 \unit{second}\)</span> are plotted in <a href="#fig-numericalex2cdm">Figure&nbsp;<span>4.11</span></a>.</p>
</section>
</section>
<section id="sec-numericalinterlude" class="level2" data-number="4.4">
<h2 data-number="4.4" data-anchor-id="sec-numericalinterlude"><span class="header-section-number">4.4</span> Interlude</h2>
<p>Having discussed two numerical integration methods and gained a sense of how numerical integration schemes operate, it may be worthwhile to look into how the “success” of a numerical method should be judged. It is not our intention to provide a complete coverage of the analysis of numerical integration schemes. For interested readers, there are various studies and books in which thorough investigations may be found.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Rather we aim to simply introduce some of the concepts and keywords that are encountered in such analyses so as to allude to certain pros and cons of the numerical methods that have been and will be introduced in this chapter.</p>
<p>To begin with, we may try to get a sense of how well a particular approach does by comparing its predictions in those problems for which analytical solutions are available. This is obviously not the best approach since there is no guarantee that if a method works well in a particular problem it should also work well in some other: certain qualities of the system and/or the excitation may lead to variations in how well a numerical integration scheme works for that particular problem. Having expressed this disclaimer, it is still worthwhile to get a sense of what happens through visuals. Let us consider the sinusoidal pulse type ground motion that was investigated in <a href="#sec-sdofnum2">Ex. 4 .2</a> and <a href="#sec-sdofnum4">Ex. 4 .4</a>. The analytical solution to such an input was developed as given in <a href="singledofforced.html#eq-pulseGMsol_1">Equation&nbsp;<span>3.88</span></a> and <a href="singledofforced.html#eq-pulseGMpart4">Equation&nbsp;<span>3.90</span></a>, and so the true value of the response may be calculated at all times provided the following values are used in the analytical solution: <span class="math display">\[
\maxgvel = 1 \unit{m/s}, t_{d} = 0.4 \unit{s}, \extfreq' = \ratio{2 \pi}{t_{d}} = 5 \pi, \freq = 40 \unit{rad/s}, \damp = 0.02, \ratfreq = \ratio{\extfreq'}{\freq}=\ratio{\pi}{8}
\]</span> Consider, for example, the estimates that would be obtained by the central difference method for this problem. <a href="#fig-numericalcdmcomp">Figure&nbsp;<span>4.12</span></a> shows the estimates obtained with the central difference method employed with three different step sizes, i.e.&nbsp;<span class="math inline">\(0.002\)</span>, <span class="math inline">\(0.01\)</span> and <span class="math inline">\(0.02 \unit{seconds}\)</span>, along with the true values that are given by the analytical solution. Note that all the solutions are stable since they all remain bounded: this is to be expected since all time steps are smaller than the critical time step given by <span class="math inline">\(\period/\pi = 0.05 \unit{seconds}\)</span>. That a solution is stable does not mean it is necessarily sufficiently accurate. The good news seems to be that as the time step gets smaller, the central difference estimates tend to match very well with the true values and in fact it is visually very difficult to distinguish in <a href="#fig-numericalcdmcomp">Figure&nbsp;<span>4.12</span></a> between the true values and the estimates obtained with <span class="math inline">\(\tstep = 0.002 \unit{seconds}\)</span>.</p>
<div id="fig-numericalcdmcomp" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/numericalcdmcomp.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.12: Plots of results obtained for the sinusoidal pulse type ground motion (see <a href="#sec-sdofnum2">Ex. 4 .2</a> and <a href="#sec-sdofnum2">Ex. 4 .2</a>) with the central different method for various values of time step. True response is the continuous red line, with solid (red) circles marking the results for <span class="math inline">\(\tstep = 0.002 \unit{s}\)</span>, hollow (blue) circles for <span class="math inline">\(\tstep = 0.01 \unit{s}\)</span>, and plus signs (green) for <span class="math inline">\(\tstep = 0.02 \unit{s}\)</span>.</figcaption><p></p>
</figure>
</div>
<p>As the time step gets larger, some systematic issues begin to appear. One obvious concern is whether or not the response amplitude at a given instance is estimated well. Some part of the response relates to the input: whether or not the time step used is small enough to capture the variations in the excitation will naturally directly affect the results. Assuming that the excitation is captured appropriately, there could still be an issue with what is generally called <em>artificial damping</em> or <em>numerical damping</em>. Some numerical techniques introduce, by virtue of their approximations, an artificial dissipation which causes errors in amplitude estimates. The central difference method is not known to suffer from this error. The second and perhaps more surprising problem is that some numerical methods introduce a <em>change in the period</em> of the system (sometimes referred to as <em>period elongation</em>) , and this seems to be a particular issue with the central difference method, as may be observed from the response curves. As the time step increases, the central difference method seems to lead to a decrease in the period, very evident especially in the free vibration phase. That this effect is inherent to the method and not specific to a particular example may be shown by direct analysis of the finite difference equations.</p>
<p>Whether or not a numerical integration scheme is conditionally or unconditionally stable is a fundamental question that in most cases precede accuracy. The analysis of stability generally proceeds with either the analytical solution of the finite difference equations or a state space analysis. For illustration purposes let us focus on the state space analysis by again taking the central difference method as a case study, and further simplify the problem by assuming that the system is undamped. The central difference estimate of the response for such a system is given (<a href="#eq-cdmq">Equation&nbsp;<span>4.29</span></a> and <a href="#eq-cdmai">Equation&nbsp;<span>4.11</span></a> with <span class="math inline">\(c = 0\)</span>) by <span class="math display">\[
\dsct{\gc}{j+1} = (2-\tstep^2 \freq^2) \dsct{\gc}{j} - \dsct{\gc}{j-1} + \ratio{\tstep^2}{m} \dsct{\extforce}{j}
\]</span> This equation may be complemented by the identity <span class="math inline">\(\dsct{\gc}{j}=\dsct{\gc}{j}\)</span> so that, by defining a state vector <span class="math display">\[
\dscs{j} = \colmat{\dsct{\gc}{j} \\ \dsct{\gc}{j-1}}
\]</span> the central difference estimation may be cast into state space format as <span class="math display">\[
\dscs{j+1} = \dscA \dscs{j} + \dscB \dscf{j}
\]</span> where the state transition matrix is given by <span class="math display">\[
\dscA = \begin{bmatrix} (2-\tstep^2 \freq^2) &amp; -1 \\ 1 &amp; 0 \end{bmatrix}
\]</span> Through repeated substitutions, the state after <span class="math inline">\(p\)</span> time steps may be shown to be given by <span class="math display">\[
\dscs{i+p} = \dscA^p \dscs{j} + \sum_{j=0}^{p-1} \dscA^{p-1-j}\dscB \dscf{i+j}
\]</span> whence it should be apparent that whether or not the response estimates indefinitely grow with increasing <span class="math inline">\(p\)</span> depends on how <span class="math inline">\(\dscA^{p}\)</span> behaves. From linear algebra we know that a real valued matrix <span class="math inline">\(\dscA\)</span> may be expressed using its eigenvalue matrix<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> <span class="math inline">\(\eigvalmat\)</span> and eigenvector matrix <span class="math inline">\(\eigvecmat\)</span> as <span class="math display">\[
\dscA = \eigvecmat^{-1} \eigvalmat \eigvecmat
\]</span> where, for our <span class="math inline">\(2 \times 2\)</span> state transition matrix <span class="math inline">\(\dscA\)</span>, the eigenvalues are the roots of the characteristic equation given by: <span class="math display">\[
\det\left(\begin{bmatrix} (2-\tstep^2 \freq^2) - \eigval  &amp; -1 \\ 1 &amp; 0-\eigval\end{bmatrix}\right) = \eigval^2 + (\tstep^2 \freq^2 - 2) \eigval + 1 = 0
\]</span> Solving this quadratic equation and using the relationship <span class="math inline">\(\freq = 2 \pi / \period\)</span> yields <span class="math display">\[
\eigval_{1,2} = 1 - {2}\left(\ratio{\tstep \pi}{\period} \right)^2 \mp 2 \left(\ratio{\tstep \pi}{\period} \right)\sqrt{\left(\ratio{\tstep \pi}{\period} \right)^2-1}
\]</span> Using the eigendecomposition, the <span class="math inline">\(p\)</span>th power of <span class="math inline">\(\dscA\)</span> may be expressed as <span class="math display">\[
\dscA^p = \underbrace{\eigvecmat^{-1} \eigvalmat \eigvecmat\eigvecmat^{-1} \eigvalmat \eigvecmat\cdots\eigvecmat^{-1} \eigvalmat \eigvecmat}_{p \text{ times}} = \eigvecmat^{-1} \eigvalmat^{p} \eigvecmat
\]</span> so that the stability (or boundedness) depends directly on whether or not any of the eigenvalues have a magnitude bigger than unity, inwhich case <span class="math inline">\(\eigval^p\)</span> would increase without bound as <span class="math inline">\(p\)</span> continues to increase. For our state space model of the central difference method, it is straightforward to see that when <span class="math inline">\(\tstep \pi / T &gt; 1\)</span>, the magnitude of at least one of the roots exceeds 1 and so the system becomes unstable. When <span class="math inline">\(\tstep \pi / T &lt; 1\)</span>, we have complex valued roots given by <span class="math display">\[
\eigval_{1,2} = 1 - {2}\left(\ratio{\tstep \pi}{\period} \right)^2 \mp \imag 2 \left(\ratio{\tstep \pi}{\period} \right)\sqrt{1-\left(\ratio{\tstep \pi}{\period} \right)^2}
\]</span> so that the magnitude of the eigenvalues, which are a pair of complex conjugate numbers in this case, is given by <span class="math display">\[
\vmag{\eigval_1} = \vmag{\eigval_2} = \left[1 - {2}\left(\ratio{\tstep \pi}{\period} \right)^2\right]^2 + \left[2\left(\ratio{\tstep \pi}{\period} \right)\sqrt{1-\left(\ratio{\tstep \pi}{\period} \right)^2} \right]^2 = 1
\]</span> and therefore the <span class="math inline">\(n\)</span>th power of the eigenvalues remain bounded, making the system stable. The magnitude of the maximum eigenvalue of a matrix is called the <em>spectral radius</em> of that matrix, and the stability criterion is sometimes expressed as the spectral radius being less than or equal to 1.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>The foregoing analysis is presented to introduce some key concepts in the evaluation of numerical techniques for solving the equation of motion. By now it should be obvious why the step size <span class="math display">\[
\tstep^{cr} = \ratio{T}{\pi}
\]</span> is critical, and that the algorithm should be run with a time step less than this value. While discussing other numerical methods we will not dwell on detailed analyses, but we will use some terminology like <em>artificial (or numerical) damping</em>, <em>period elongation</em> and <em>conditionally stable</em>, all of which have been discussed or illustrated in the context of the central difference method.</p>
<p>Since most of the problems go away if one were to choose a small enough time-step, why do we care, why not choose a very very small time step and be done with it? The computational cost for single degree of freedom systems is negligible and by all means the problems may be alleviated by using as small a time step as desired. The significant problem lies with systems having multiple degrees of freedom. We will eventually see that the response of such systems may be thought of as some linear combination of the responses of many contributing single degree of freedom systems with varying frequencies. Consider a system with thousands of degrees of freedom: the choice of a very small time step may drastically increase computational burden while using a larger time step may lead to stability problems in some of those contributing single degree of freedom systems. It is therefore crucial to understand possible problems that may be encountered while employing numerical integration schemes so that the analyst may correctly interpret the results obtained and perhaps optimize the choice of time step.</p>
<p>Another consideration that factors in predominantly when working on multi degree of freedom nonlinear systems is whether or not an integration scheme is <em>explicit</em> or <em>implicit</em>. If an integration scheme is such that all the information necessary to calculate the displacement response at time step <span class="math inline">\(j+1\)</span> is limited to those already known at the end of time step <span class="math inline">\(j\)</span>, the method is said to be <em>explicit</em>. Mathematically this is analogous to a relationship of the sort <span class="math inline">\(\dsct{\gc}{j+1} =\mathfrak{F}(\dsct{\gc}{j} ,\dsct{\dgc}{j} ,\dsct{\ddgc}{j} )\)</span> where <span class="math inline">\(\mathfrak{F}(\cdot)\)</span> is some function, and it stems from the practice of evaluating the equilibrium equation at time step <span class="math inline">\(j\)</span> into which the response at step <span class="math inline">\(j+1\)</span> enters as some component. The central difference method is an explicit method because to calculate <span class="math inline">\(\dsct{\gc}{j+1}\)</span>, we just need to know <span class="math inline">\(\dsct{\gc}{j}\)</span> and <span class="math inline">\(\dsct{\gc}{j-1}\)</span>, both of which are known at the end of the <span class="math inline">\(j\)</span>-th step.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> Explicit methods may be more cost effective, especially in the analysis of multi degree of freedom systems, but generally suffer from a need to work with relatively small time steps to minimize errors. Implicit methods, on the other hand, make use of some information pertaining to time step <span class="math inline">\((j+1)\)</span> while solving for the response at that time step, and thereby may require iterative techniques. The equilibrium equation considered is that at time step <span class="math inline">\(j+1\)</span>. Mathematical expressions of implicit methods are analogous to the form <span class="math inline">\(\mathfrak{F'}(\dsct{\gc}{j},\dsct{\dgc}{j},\dsct{\dgc}{j}, \dsct{\gc}{j+1}, \dsct{\dgc}{j+1} ,\dsct{\ddgc}{j+1})=0\)</span> where <span class="math inline">\(\mathfrak{F'}(\cdot)\)</span> is some function such that a simple forward time marching is not possible. Their solution is generally more costly due to the need to iterate in between and may also involve costly matrix factorizations.</p>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-section" role="doc-endnotes">
<hr>
<ol start="3">
<li id="fn3"><p>see, e.g.: <br> N. M. Newmark and S.P. Chan, <em>A Comparison of Numerical Methods for Analyzing the Dynamic Response of Structures</em>, Civil Engineering Studies SRS-036, University of Illinois at Urbana-Champaign, 1952. <br> S. Levy and W.D. Kroll, <em>Errors Introduced by Finite Space and Time Increments in Dynamic Response Computation</em>, J. of Research of the National Bureau of Standarts, Vol. 51, No.&nbsp;1, pp.&nbsp;57-68, 1953. <br> R. E. Nickell, <em>On the Stability of Approximation Operators in Problems of Structural Dynamics</em>, Int. J. Solids Structures, Vol. 7, pp.&nbsp;301-319, 1971. <br> K.-J. Bathe, <em>Finite Element Procedures</em>, Prentice Hall, 1996.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Jordan canonical form, which is not necessarily diagonal in the presence of repeated eigenvalues.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>When <span class="math inline">\(\tstep \pi / T = 1\)</span>, two roots are identical as <span class="math inline">\(\eigval_1 = \eigval_2 = \eigval\)</span> but their magnitude remains <span class="math inline">\(\vmag{\eigval}=1\)</span> and stability is maintained.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>There is also information coming from the excitation but the excitation is assumed to be known and hence does not affect the discussion.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<section id="houbolts-method" class="level2" data-number="4.5">
<h2 data-number="4.5" data-anchor-id="houbolts-method"><span class="header-section-number">4.5</span> Houbolt’s Method</h2>
<p>There are many variations to the theme of finite differences, and the one that we will now discuss as an alternative is generally referred to as Houbolt’s method. Originally in an effort to improve dynamic analyses of aircraft subjected to gusts,<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> Houbolt’s method employs a four-point expansion whereby in the more commonly employed variation the response at steps <span class="math inline">\(j\)</span>, <span class="math inline">\(j-1\)</span> and <span class="math inline">\(j-2\)</span> are expressed in terms of the response quantities at time step <span class="math inline">\(j+1\)</span>: <span class="math display">\[\begin{align*}
\dsct{\gc}{j} &amp; = \dsct{\gc}{j+1} -  \tstep \dsct{\dgc}{j+1}  + \ratio{\tstep^2}{2} \dsct{\ddgc}{j+1} - \ratio{\tstep^3}{6} \dsct{\dddot{\gc}}{j+1} + o(\tstep^4) \\
\dsct{\gc}{j-1} &amp; = \dsct{\gc}{j+1} -  (2\tstep) \dsct{\dgc}{j+1}  + \ratio{(2\tstep)^2}{2} \dsct{\ddgc}{j+1} - \ratio{(2\tstep)^3}{6} \dsct{\dddot{\gc}}{j+1} + o(\tstep^4) \\
\dsct{\gc}{j-2} &amp; = \dsct{\gc}{j+1} -  (3\tstep) \dsct{\dgc}{j+1}  + \ratio{(3\tstep)^2}{2} \dsct{\ddgc}{j+1} - \ratio{(3\tstep)^3}{6} \dsct{\dddot{\gc}}{j+1} + o(\tstep^4)
\end{align*}\]</span></p>
<p>Taking into account the third order derivatives makes this a higher order approach than the central difference method and the error introduced by truncating the Taylor series in this case is <span class="math inline">\(o(\tstep^4)\)</span>. Solving for <span class="math inline">\(\dsct{\dgc}{j+1}\)</span>, <span class="math inline">\(\dsct{\ddgc}{j+1}\)</span>, <span class="math inline">\(\dsct{\dddot{\gc}}{j+1}\)</span> in terms of <span class="math inline">\(\dsct{\gc}{j+1}\)</span>, <span class="math inline">\(\dsct{\gc}{j}\)</span>, <span class="math inline">\(\dsct{\gc}{j-1}\)</span> and <span class="math inline">\(\dsct{\gc}{j-1}\)</span> while ignoring higher order terms leads to <span class="math display">\[\begin{align*}
\dsct{\dgc}{j+1} &amp; = \ratio{1}{6\tstep} (11 \dsct{\gc}{j+1} - 18 \dsct{\gc}{j} + 9 \dsct{\gc}{j-1} - 2 \dsct{\gc}{j-2} )\\
\dsct{\ddgc}{j+1} &amp; = \ratio{1}{\tstep^2} (2 \dsct{\gc}{j+1} - 5 \dsct{\gc}{j} + 4 \dsct{\gc}{j-1} - \dsct{\gc}{j-2} )
\end{align*}\]</span> Substituting these approximations into the equation of motion at time <span class="math inline">\(t=(j+1)\tstep\)</span>, given by <span class="math display">\[
m\dsct{\ddgc}{j+1} + c \dsct{\dgc}{j+1} + k \dsct{\gc}{j+1} = \dsct{\extforce}{j+1}
\]</span> and after rearranging the terms, we get <span id="eq-houbolt"><span class="math display">\[
    A_1 \dsct{\gc}{j+1} = \dsct{\extforce}{j+1} + A_2 \dsct{\gc}{j} + A_3 \dsct{\gc}{j-1} + A_4 \dsct{\gc}{j-2}
\qquad(4.15)\]</span></span> where <span id="eq-houboltai"><span class="math display">\[
\begin{array}{l}
A_1 = k + \ratio{2}{\tstep^2}m + \ratio{11}{6 \tstep} c = k \left[1 + \ratio{2}{(\freq \tstep)^2} + \ratio{11 \damp }{3 (\freq \tstep)}\right] \\
A_2 = \ratio{5}{\tstep^2} m + \ratio{3}{ \tstep} c = k \left[\ratio{5}{(\freq \tstep)^2} + \ratio{6 \damp}{ (\freq \tstep)}  \right] \\  
A_3 = - \ratio{4}{\tstep^2} m - \ratio{3}{2 \tstep} c = -k \left[\ratio{4}{(\freq \tstep)^2} + \ratio{3\damp}{(\freq \tstep)} \right] \\
A_4 = \ratio{1}{\tstep^2} m + \ratio{1}{3 \tstep} c = k \left[\ratio{1}{(\freq \tstep)^2} + \ratio{2 \damp}{3 (\freq \tstep)}   \right] \\
A_5 =  \ratio{1}{6\tstep}\\
A_6 = \ratio{1}{\tstep^2}
\end{array}
\qquad(4.16)\]</span></span></p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Pseudocode for Houbolt’s Method</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>viscously damped SDOF system, for constant time step</em></p>
<p><strong>Input</strong>: <span class="math inline">\(m\)</span>, <span class="math inline">\(\damp\)</span> (or <span class="math inline">\(c\)</span>), <span class="math inline">\(k\)</span>, <span class="math inline">\(\tstep\)</span>, <span class="math inline">\(\dsct{\gc}{0}\)</span>, <span class="math inline">\(\dsct{\dgc}{0}\)</span>, <span class="math inline">\(\left\{\dsct{\extforce}{0}, \ldots, \dsct{\extforce}{l} \right\}\)</span></p>
<p><strong>Initialize</strong>: calculate</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(A_1,A_2,A_3, A_4, A_5\)</span> and <span class="math inline">\(A_6\)</span> using <a href="#eq-houboltai">Equation&nbsp;<span>4.16</span></a>, <span class="math inline">\(A_1^{-1}\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\ddgc}{0} = \frac{1}{m}(\dsct{\extforce}{0} - c \dsct{\dgc}{0} - k\dsct{\gc}{0})\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\gc}{1}, \dsct{\gc}{2}, \dsct{\dgc}{1}, \dsct{\dgc}{2}, \dsct{\ddgc}{1}, \dsct{\ddgc}{2}\)</span> by some method</p>
<p><strong>for</strong> <span class="math inline">\(j=2,\ldots,l-1\)</span>:</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\gc}{j+1} = A_1^{-1}(\dsct{\extforce}{j+1} + A_2 \dsct{\gc}{j} + A_3 \dsct{\gc}{j-1} + A_4 \dsct{\gc}{j-2})\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\dgc}{j+1} = A_5 (11 \dsct{\gc}{j+1} - 18 \dsct{\gc}{j} + 9 \dsct{\gc}{j-1} - 2 \dsct{\gc}{j-2} )\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\ddgc}{j+1} = A_6 (2 \dsct{\gc}{j+1} - 5 \dsct{\gc}{j} + 4 \dsct{\gc}{j-1} - \dsct{\gc}{j-2} )\)</span></p>
</div>
</div>
<div id="fig-alghoubolt" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blank.png" class="img-fluid figure-img" style="width:0.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.13: Pseudocode for Houbolt’s method.</figcaption><p></p>
</figure>
</div>
<p>Houbolt’s method is unconditionally stable so that relatively larger time steps may be used without stability concerns compared to the central difference method. On the other hand, it introduces artificial damping and period elongation which become pronounced with increasing step size. It is an implicit method since the equilibrium equation is evaluated at time step <span class="math inline">\(p+1\)</span>, and consequently the stiffness term that appears in coefficient <span class="math inline">\(A_1\)</span> has to be inverted to obtain a solution. Although this is a trivial matter in the case of SDOF models, in the context of MDOF models it may mean the inversion (usually by some type of matrix factorization) of a large dimensional non-diagonal matrix, possibly at each time step if considering nonlinear systems with varying stiffness, which may be computationally very costly. Another issue is the initiation, in that to calculate <span class="math inline">\(\dsct{\gc}{1}\)</span> and <span class="math inline">\(\dsct{\gc}{2}\)</span> one needs to know <span class="math inline">\(\dsct{\gc}{-1}\)</span> and <span class="math inline">\(\dsct{\gc}{-2}\)</span> which, unfortunately, are not directly available. It turns out that the method may be quite sensitive to these initial conditions and that, for example, prescribing zero values for <span class="math inline">\(\dsct{\gc}{-1}\)</span> and <span class="math inline">\(\dsct{\gc}{-2}\)</span> may lead to unacceptable results. The common procedure is to estimate <span class="math inline">\(\dsct{\gc}{1}\)</span> and <span class="math inline">\(\dsct{\gc}{2}\)</span> via some other method and start the Houbolt progression with the third step.</p>
<p>Geometrically, Houbolt’s method amounts to fitting a cubic curve to four data points and evaluating the derivatives at the end point. Consider the data points shown in <a href="#fig-numericalcubic">Figure&nbsp;<span>4.14</span></a>. A cubic curve may be fit to these four points, to be defined by the equation <span class="math display">\[
\gc (\tau) = C_1 \tau^3 + C_2 \tau^2 + C_3 \tau + C_4
\]</span> where <span class="math inline">\(C_i\)</span> are constants that may be determined through the available information. In fact, we have, <span class="math display">\[\begin{align*}
q(\tau = 0) &amp; = C_4 = \dsct{\gc}{j-2} \\
q(\tau = \tstep) &amp; = \tstep^3 C_1 + \tstep^2 C_2 + \tstep C_3 + C_4= \dsct{\gc}{j-1} \\
q(\tau = 2\tstep) &amp; = 8 \tstep^3 C_1 + 4 \tstep^2 C_2 + 2 \tstep C_3 + C_4 = \dsct{\gc}{j}\\
q(\tau = 2\tstep) &amp; = 27 \tstep^3 C_1 + 9 \tstep^2 C_2 + 3 \tstep C_3 + C_4 = \dsct{\gc}{j+1}
\end{align*}\]</span></p>
<div id="fig-numericalcubic" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/numericalcubic.png" class="img-fluid figure-img" style="width:45.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.14: Second order curve passing through data three points.</figcaption><p></p>
</figure>
</div>
<p>Solving for the coefficients one gets <span class="math display">\[
\begin{array}{c}
C_1 = \ratio{1}{6 \tstep^3}(\dsct{\gc}{j+1} - 3 \dsct{\gc}{j} + 3 \dsct{\gc}{j-1}-\dsct{\gc}{j-2}) \\
C_2 = \ratio{1}{2 \tstep^2}(-\dsct{\gc}{j+1} + 4 \dsct{\gc}{j} - 5 \dsct{\gc}{j-1}+2\dsct{\gc}{j-2})\\
C_3 = \ratio{1}{6 \tstep}(2\dsct{\gc}{j+1} -9 \dsct{\gc}{j} +18 \dsct{\gc}{j-1}-11\dsct{\gc}{j-2}), \qquad C_4 = \dsct{\gc}{j-2}
\end{array}
\]</span> so that the velocity and acceleration at the end point, i.e.&nbsp;at <span class="math inline">\(t=(j+1) \tstep\)</span> or equivalently at <span class="math inline">\(\tau = 3\tstep\)</span>, are given by <span class="math display">\[\begin{align*}
\dsct{\dgc}{j+1} &amp; =\dgc (t=(j+1) \tstep) = \frac{\diff \gc(\tau)}{\diff \tau}\biggr|_{\tau = 3\tstep} = (3 \tau^2 C_1  + 2 \tau C_2 + C_3)\bigr|_{\tau=3\tstep} \\
&amp; = \ratio{11 \dsct{\gc}{j+1}-18 \dsct{\gc}{j}+9\dsct{\gc}{j-1}-2\dsct{\gc}{j-2}}{6\tstep}
\end{align*}\]</span> <span class="math display">\[\begin{align*}
\dsct{\ddgc}{j+1} &amp; =\ddgc (t=(j+1) \tstep) = \frac{\diff^2 \gc(\tau)}{\diff \tau^2}\biggr|_{\tau = 3\tstep} = (18 \tau C_1 + 2 C_2)\bigr|_{\tau=3\tstep} \\
&amp; = \ratio{2 \dsct{\gc}{j+1}-5 \dsct{\gc}{j}+4\dsct{\gc}{j-1}-\dsct{\gc}{j-2}}{\tstep^2}
\end{align*}\]</span> which are in fact the finite difference approximations used for these two quantities in Houbolt’s method.</p>
<section id="sec-sdofnum5" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="sec-sdofnum5">EXAMPLE 4 .5</h4>
<p>To illustrate how Houbolt’s method proceeds and to provide some comparison with the central difference method, let us consider the relatively simple problem of free vibrations.</p>
<p>Consider an undamped system with frequency <span class="math inline">\(\freq\)</span>, subjected to initial conditions <span class="math inline">\(\gc (0) = \gc_o\)</span> and <span class="math inline">\(\dgc (0) = 0\)</span>, so that it is governed by <span class="math display">\[
\ddgct + \freq^2 \gct = 0, \quad \left\{\gc (0) = \gc_o, \dgc (0) = 0\right\}
\]</span> and its response is given by <span class="math display">\[
\gct = \gc_o \cos \freq t
\]</span> This response with a single known period and amplitude will allow a direct observation of any period elongation or artificial damping introduced by a numerical method. Since the right hand side of the equation is zero, the problem represents all undamped and unforced linear SDOF systems, and the results may be discussed in terms of the ratio of the time step to the period of the system. Here we will discuss the estimates for three different time steps. To provide a numerical check for the reader for Houbolt’s method, for a time step of <span class="math inline">\(\tstep = 0.1 \unit{seconds}\)</span> and <span class="math inline">\(\tstep / \period = 0.01\)</span>, the system’s frequency is calculated as <span class="math inline">\(\freq = 2 \pi / 10\)</span>, and the coefficients in Houbolt’s method for this undamped system are given by: <span class="math display">\[
\ratio{A_1}{m} = 200.394784, \quad \ratio{A_2}{m} = 500, \quad \ratio{A_3}{m} = -400, \quad \ratio{A_4}{m} = 100
\]</span> Given the initial condition <span class="math inline">\(\dsct{\gc}{0}=\gc_o\)</span>, the estimates for <span class="math inline">\(\dsct{\gc}{-1}\)</span> and <span class="math inline">\(\dsct{\gc}{1}\)</span> are calculated using the central difference approximations to obtain <span class="math display">\[
\ratio{\dsct{\gc}{-1}}{\gc_o} = 1.001974, \quad \ratio{\dsct{\gc}{1}}{\gc_o} = 0.994078
\]</span> Once these two values are calculated, the recursive equation of Houbolt’s method may be employed to obtain estimates for <span class="math inline">\(\dsct{\gc}{2}, \dsct{\gc}{3}, \ldots\)</span>. Displacement estimates for the first few time steps are calculated as <span class="math display">\[\begin{align*}
\ratio{\dsct{\gc}{2}}{\gc_o} &amp; = 0.984240, \quad \ratio{\dsct{\gc}{3}}{\gc_o} = 0.970527 \\
\ratio{\dsct{\gc}{4}}{\gc_o} &amp; = 0.952996, \quad \ratio{\dsct{\gc}{5}}{\gc_o} = 0.931717 \\
\ratio{\dsct{\gc}{6}}{\gc_o} &amp; = 0.906774, \quad \ratio{\dsct{\gc}{7}}{\gc_o} = 0.878266 \\
\ratio{\dsct{\gc}{8}}{\gc_o} &amp; = 0.846304, \quad \ratio{\dsct{\gc}{9}}{\gc_o} = 0.811014
\end{align*}\]</span></p>
<p>How the two phenomena previously discussed become more or less pronounced with increasing time step size is quite easily observed in the plots of <a href="#fig-numericalhoubolt">Figure&nbsp;<span>4.15</span></a>. These three plots show the variation of the displacement response, normalized by the maximum displacement (which is equal to the initial displacement), for the first four cycles of oscillation. The solid line in these plots show the response calculated via the analytical solution. The hollow circles are the response values calculated with the central difference method, and the plus signs mark those calculated with Houbolt’s method.</p>
<div id="fig-numericalhoubolt" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/numericalhoubolt.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.15: The free vibration of undamped SDOF systems subjected to initial displacement <span class="math inline">\(\dsct{\gc}{o}\)</span> calculated using the analytical solution (solid line), the central difference method (circles) and Houbolt’s method (stars). (a) <span class="math inline">\(\tstep /\period = 0.01\)</span>, (a) <span class="math inline">\(\tstep / \period = 0.05\)</span>, (c) <span class="math inline">\(\tstep / \period = 0.1\)</span>. Plots presented for normalized displacements and normalized time.</figcaption><p></p>
</figure>
</div>
<p>For a relatively small time step such as <span class="math inline">\(\tstep / \period = 0.01\)</span>, both methods provide good estimates for the analytical solution, although some errors are present as would be observed if one were to zoom in. Period elongations or artificial damping are not perceptible in the four cycles although they are present albeit in negligible amounts. These effects become more pronounced with increasing time step size. For the time step of <span class="math inline">\(\tstep / \period = 0.05\)</span>, the two methods lead to perceptibly different results in that the central difference method leads to period shortening (its estimates slightly lagging the analytical solution) and Houbolt’s method leads to period elongation (its estimates slightly leading the analytical solution). With the time step of <span class="math inline">\(\tstep / \period = 0.10\)</span>, the trend becomes painfully obvious. The errors in the central difference estimates increase relative to those of smaller time steps, yet the algorithm does not have any artificial damping since the response amplitudes remain quite consistent. In comparison, the artificial damping in Houbolt’s approach looks quite detrimental and the amplitude estimate by the end of the fourth cycle is about half of the analytical response. Both algorithms reflect increasing errors in period estimates with the period shortening (central difference method) and elongation (Houbolt’s method) effects becoming even more pronounced with increasing time step size.</p>
<p>This of course is just one simple illustration of the critical issues in numerical integration and it is by no means conclusive. A thorough analysis requires analytical investigations of the numerical techniques but we refrain from further analysis as such an in depth critique is not the main focus here. The brief discussion in <a href="#sec-numericalinterlude"><span>Section&nbsp;4.4</span></a> and the references cited therein should give a flavour of what such an in depth analysis requires. It may however be pertinent to note that the complexity of a numerical integration scheme does not necessarily guarantee accuracy. Being a higher order finite difference technique, one may initially suppose that Houbolt’s method would outperform the central difference method in all cases but this presupposition is clearly not well founded as exemplified by the observations above.</p>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-section" role="doc-endnotes">
<hr>
<ol start="7">
<li id="fn7"><p>J.C. Houbolt, <em>A Recurrence Matrix Solution for the Dynamic Response of Aircraft in Gusts</em>, NACA Technical Report 1010, 1951.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</section>
<section id="sec-newmark" class="level2" data-number="4.6">
<h2 data-number="4.6" data-anchor-id="sec-newmark"><span class="header-section-number">4.6</span> Newmark’s Method</h2>
<p>A family of algorithms proposed by Newmark<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> have proven to be quite popular with their intrinsic properties and their relation to various existing approaches. The approach is designed to employ information pertaining to acceleration at time step <span class="math inline">\((j+1)\)</span> step while solving for the velocity and displacement at time step <span class="math inline">\((j+1)\)</span>. Since the information at step <span class="math inline">\((j+1)\)</span> is not available at the end of the <span class="math inline">\(j\)</span>-th step, such an approach in principle requires an initial prediction and then subsequent corrections of the future value. In this sense, Newmark’s method essentially belongs to a family known as <em>predictor-corrector methods</em>.</p>
<section id="general-formulation" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" data-anchor-id="general-formulation"><span class="header-section-number">4.6.1</span> General Formulation</h3>
<p>Newmark’s formulation is based on the following estimation equations: <span id="eq-newmark"><span class="math display">\[
\begin{array}{lc}
\dsct{\dgc}{j+1} = \dsct{\dgc}{j} + (1-\gamma) \tstep \dsct{\ddgc}{j} + \gamma \tstep \dsct{\ddgc}{j+1} &amp; \text{(a)}\\
\dsct{\gc}{j+1} = \dsct{\gc}{j} + \tstep \dsct{\dgc}{j} + \left(\frac{1}{2} - \beta\right)\tstep^2 \dsct{\ddgc}{j} + \beta \tstep^2 \dsct{\ddgc}{j+1}  &amp; \text{(b)}
\end{array}
\qquad(4.17)\]</span></span></p>
<p>In principle, <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\beta\)</span> are two free parameters that may be chosen by the analyst. Soon after the method was introduced, however, it became clear that unless <span class="math inline">\(\gamma = 1/2\)</span>, artificial damping is introduced and that this damping is proportional to <span class="math inline">\((\gamma - 1/2)\)</span>. Therefore it has become the mode of operation to take <span class="math inline">\(\gamma=1/2\)</span> and cast Newmark’s method as <span id="eq-newmarkb"><span class="math display">\[
\begin{array}{lc}
\dsct{\dgc}{j+1} = \dsct{\dgc}{j} + \ratio{\tstep}{2} \dsct{\ddgc}{j} + \ratio{\tstep}{2} \dsct{\ddgc}{j+1} &amp; \text{(a)}\\
\dsct{\gc}{j+1} = \dsct{\gc}{j} + \tstep \dsct{\dgc}{j} + \left(\frac{1}{2} - \beta\right) \tstep^2 \dsct{\ddgc}{j} + \beta \tstep^2 \dsct{\ddgc}{j+1}  &amp; \text{(b)}
\end{array}
\qquad(4.18)\]</span></span> With dependence on only the single parameter <span class="math inline">\(\beta\)</span>, this formulation is often referred as the Newmark-<span class="math inline">\(\beta\)</span> Method.</p>
<p>Using the estimations from <a href="#eq-newmarkb">Equation&nbsp;<span>4.18</span></a>, the equilibrium equation is written at time step <span class="math inline">\(j+1\)</span> so that <span class="math display">\[
m \dsct{\ddgc}{j+1} + c \dsct{\dgc}{j+1} + k \dsct{\gc}{j} = \dsct{\extforce}{j+1}
\]</span> and the acceleration term is solved for using <span id="eq-newmarkacc"><span class="math display">\[
\dsct{\ddgc}{j+1}  = \ratio{1}{m} \dsct{\extforce}{j+1} - \ratio{c}{m} \dsct{\dgc}{j+1} - \ratio{k}{m} \dsct{\gc}{j} = \ratio{1}{m} \dsct{\extforce}{j+1} - 2 \damp \freq \dsct{\dgc}{j+1} - \freq^2 \dsct{\gc}{j}
\qquad(4.19)\]</span></span> Herein lies the fundamental issue: to calculate <span class="math inline">\(\dsct{\dgc}{j+1}\)</span> and <span class="math inline">\(\dsct{\gc}{j+1}\)</span> via <a href="#eq-newmarkb">Equation&nbsp;<span>4.18</span></a> we need to know <span class="math inline">\(\dsct{\ddgc}{j+1}\)</span>, which in turn is to be calculated via <a href="#eq-newmarkacc">Equation&nbsp;<span>4.19</span></a> using <span class="math inline">\(\dsct{\dgc}{j+1}\)</span> and <span class="math inline">\(\dsct{\gc}{j+1}\)</span>! Essentially <a href="#eq-newmarkb">Equation&nbsp;<span>4.18</span></a> is the predictor and <a href="#eq-newmarkacc">Equation&nbsp;<span>4.19</span></a> is the corrector, and in one formulation of the method the acceleration is iteratively improved until convergence (within a desired tolerance) is achieved. To discuss how such iterations proceed, say that all response variables have been calculated for time step <span class="math inline">\(j\)</span> so that <span class="math inline">\(\dsct{\gc}{j}\)</span>, <span class="math inline">\(\dsct{\dgc}{j}\)</span> and <span class="math inline">\(\dsct{\ddgc}{j}\)</span> are known. An initial estimate of <span class="math inline">\(\dsct{\ddgc}{j+1}\)</span> is used to calculate initial estimates for <span class="math inline">\(\dsct{\dgc}{j+1}\)</span> and <span class="math inline">\(\dsct{\gc}{j+1}\)</span>. Let these initial estimates be denoted by <span class="math display">\[
\edsct{\ddgc}{j+1}{0}, \quad \edsct{\dgc}{j+1}{0}, \quad \edsct{\gc}{j+1}{0}
\]</span> so that <span class="math display">\[\begin{align*}
\edsct{\dgc}{j+1}{0} &amp; = \dsct{\dgc}{j} + \ratio{\tstep}{2} \dsct{\ddgc}{j} + \ratio{\tstep}{2} \edsct{\ddgc}{j+1}{0} \\
\edsct{\gc}{j+1}{0} &amp; = \dsct{\gc}{j} + \tstep \dsct{\dgc}{j} + (\frac{1}{2} - \beta) \tstep^2 \dsct{\ddgc}{j} + \beta \tstep^2 \edsct{\ddgc}{j+1}{0}
\end{align*}\]</span> These initial estimates are used to calculate the next estimate <span class="math inline">\(\edsct{\ddgc}{j+1}{1}\)</span> using the equilibrium equation at time step <span class="math inline">\((j+1)\)</span>; for example, for a linear system, this equation would be <span class="math display">\[
\edsct{\ddgc}{j+1}{1}  = \ratio{1}{m} \dsct{\extforce}{j+1} - \ratio{c}{m} \edsct{\dgc}{j+1}{0} - \ratio{k}{m} \edsct{\gc}{j+1}{0}
\]</span> and we check whether <span class="math display">\[
\edsct{\dgc}{j+1}{1} - \edsct{\dgc}{j+1}{0} \leq \text{predetermined tolerance}
\]</span> If this condition is satisfied, then desired accuracy is reached and we set <span class="math display">\[
\dsct{\ddgc}{j+1} = \edsct{\ddgc}{j+1}{1}
\]</span> and calculate <span class="math display">\[\begin{align*}
\dsct{\dgc}{j+1}  &amp; = \dsct{\dgc}{j} + \ratio{\tstep}{2} \dsct{\ddgc}{j} + \ratio{\tstep}{2} \dsct{\ddgc}{j+1} \\
\dsct{\gc}{j+1} &amp; = \dsct{\gc}{j} + \tstep \dsct{\dgc}{j} + (\frac{1}{2} - \beta) \tstep^2 \dsct{\ddgc}{j} + \beta \tstep^2 \dsct{\ddgc}{j+1}
\end{align*}\]</span> but if the condition is not satisfied, then we calculate the next estimates <span class="math inline">\(\edsct{\dgc}{j+1}{1}\)</span> and <span class="math inline">\(\edsct{\gc}{j+1}{1}\)</span> using the most recent estimate <span class="math inline">\(\edsct{\ddgc}{j+1}{1}\)</span> via <span class="math display">\[\begin{align*}
\edsct{\dgc}{j+1}{1} &amp; = \dsct{\dgc}{j} + \ratio{\tstep}{2} \dsct{\ddgc}{j} + \ratio{\tstep}{2} \edsct{\ddgc}{j+1}{1} \\
\edsct{\gc}{j+1}{1} &amp; = \dsct{\gc}{j} + \tstep \dsct{\dgc}{j} + (\frac{1}{2} - \beta) \tstep^2 \dsct{\ddgc}{j} + \beta \tstep^2 \edsct{\ddgc}{j+1}{1}
\end{align*}\]</span> and repeat the iterations until convergence is achieved.</p>
<p>It is possible to formulate the Newmark-<span class="math inline">\(\beta\)</span> method without the need for iterations. For this we need to formulate the equilibrium equation in terms of the displacement, which requires the velocity and acceleration quantities to be expressed in terms of the unknown displacement and other known quantities. Note that using <a href="#eq-newmarkb">Equation&nbsp;<span>4.18</span></a>, <span class="math inline">\(\dsct{\ddgc}{j+1}\)</span> and <span class="math inline">\(\dsct{\dgc}{j+1}\)</span> may be expressed in terms of <span class="math inline">\(\dsct{\gc}{j+1}\)</span> and response quantities of time step <span class="math inline">\(j\)</span> as <span id="eq-newmarkbrev"><span class="math display">\[
\begin{array}{lc}
\dsct{\ddgc}{j+1} = \ratio{1}{\beta \tstep^2} \dsct{\gc}{j+1} - \ratio{1}{\beta \tstep^2} \dsct{\gc}{j} - \ratio{1}{\beta \tstep}  \dsct{\dgc}{j} + \left(1 - \ratio{1}{2 \beta} \right) \dsct{\ddgc}{j} &amp; \text{(a)}\\
\dsct{\dgc}{j+1} = \ratio{1}{2\beta \tstep} \dsct{\gc}{j+1} - \ratio{1}{2\beta \tstep} \dsct{\gc}{j} + \left(1 - \ratio{1}{2 \beta} \right) \dsct{\dgc}{j} + \left(1 - \ratio{1}{4 \beta} \right) \tstep \dsct{\ddgc}{j}  &amp; \text{(b)}
\end{array}
\qquad(4.20)\]</span></span> With these estimates, the equilibrium equation at time step <span class="math inline">\((j+1)\)</span> for a viscously damped SDOF system yields <span class="math display">\[\begin{align*}
m \dsct{\ddgc}{j+1} &amp; + c \dsct{\dgc}{j+1} + k \dsct{\gc}{j+1} = \\
&amp; m \left[ \ratio{1}{\beta \tstep^2} \dsct{\gc}{j+1} - \ratio{1}{\beta \tstep^2} \dsct{\gc}{j} - \ratio{1}{\beta \tstep}  \dsct{\dgc}{j} + \left(1 - \ratio{1}{2 \beta} \right) \dsct{\ddgc}{j} \right] \\
&amp; \phantom{XX} + c \left[ \ratio{1}{2\beta \tstep} \dsct{\gc}{j+1} - \ratio{1}{2\beta \tstep} \dsct{\gc}{j} + \left(1 - \ratio{1}{2 \beta} \right) \dsct{\dgc}{j} + \left(1 - \ratio{1}{4 \beta} \right)\tstep \dsct{\ddgc}{j} \right] \\
&amp; \phantom{XXXX} + k \dsct{\gc}{j+1} = \dsct{\extforce}{j+1}
\end{align*}\]</span> and rearranging the equation leads to <span id="eq-newmarkfin"><span class="math display">\[
    A_1 \dsct{\gc}{j+1} =  \dsct{\extforce}{j+1} + A_2  \dsct{\gc}{j} + A_3  \dsct{\dgc}{j}+ A_4  \dsct{\ddgc}{j}
\qquad(4.21)\]</span></span> where <span id="eq-newmarkai"><span class="math display">\[
\begin{array}{l}
    A_1  = k + \ratio{m}{\beta \tstep^2} + \ratio{c}{2\beta \tstep} = k \left[1 + \ratio{1}{\beta(\freq \tstep)^2} + \ratio{\damp }{\beta (\freq \tstep)}\right]\\
    A_2  = \ratio{m}{\beta \tstep^2} + \ratio{c}{2 \beta \tstep} = k \left[\ratio{1}{\beta(\freq \tstep)^2} + \ratio{\damp }{\beta (\freq \tstep)}\right]\\
    A_3  = \ratio{m}{\beta \tstep} + {c}\left(\ratio{1}{2 \beta} - 1 \right) = \ratio{k}{\freq} \left[\ratio{1}{\beta(\freq \tstep)} +  \left(\ratio{\damp }{\beta} - 2 \damp\right)\right]\\
    A_4  = m \left(\frac{1}{2 \beta} -1 \right) + c \tstep \left(\frac{1}{4 \beta} - 1 \right)= \ratio{k}{\freq^2} \left[\ratio{1}{2 \beta} - 1 +  2 \damp (\freq \tstep) \left(\ratio{1}{4  \beta} - 1\right)\right]
\end{array}
\qquad(4.22)\]</span></span> The flow of the algorithm for Newmark’s method as it would be applied to viscously damped linear SDOF systems is shown below.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Pseudocode for Newmark’s Method (Newmark-<span class="math inline">\(\beta\)</span>)</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>viscously damped SDOF system, for constant time step</em></p>
<p><strong>Input</strong>: <span class="math inline">\(m\)</span>, <span class="math inline">\(\damp\)</span> (or <span class="math inline">\(c\)</span>), <span class="math inline">\(k\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\tstep\)</span>, <span class="math inline">\(\dsct{\gc}{0}\)</span>, <span class="math inline">\(\dsct{\dgc}{0}\)</span>, <span class="math inline">\(\left\{\dsct{\extforce}{0}, \ldots, \dsct{\extforce}{l} \right\}\)</span></p>
<p><strong>Initialize</strong>: calculate</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(A_1,A_2,A_3\)</span> and <span class="math inline">\(A_4\)</span> using <a href="#eq-newmarkai">Equation&nbsp;<span>4.22</span></a>, <span class="math inline">\(A_1^{-1}\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(A_5=\frac{1}{2\beta \tstep}\)</span>, <span class="math inline">\(A_6 = 1 - \frac{1}{2\beta}\)</span>, <span class="math inline">\(A_7 = \tstep \left(1 - \frac{1}{4 \beta}\right)\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(A_8= \frac{1}{\beta \tstep^2}\)</span>, <span class="math inline">\(A_9 = - \frac{1}{\beta \tstep}\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\ddgc}{0} = \frac{1}{m}(\dsct{\extforce}{0} - c \dsct{\dgc}{0} - k\dsct{\gc}{0})\)</span></p>
<p><strong>for</strong> <span class="math inline">\(j=0,\ldots,l-1\)</span>:</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\gc}{j+1} = A_1^{-1}(\dsct{\extforce}{j+1} + A_2 \dsct{\gc}{j} + A_3 \dsct{\dgc}{j} + A_4 \dsct{\ddgc}{j})\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\dgc}{j+1} = A_5 (\dsct{\gc}{j+1} - \dsct{\gc}{j} ) + A_6 \dsct{\dgc}{j} + A_7 \dsct{\ddgc}{j}\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\ddgc}{j+1} = A_8 (\dsct{\gc}{j+1} - \dsct{\gc}{j}) + A_9 \dsct{\dgc}{j} + A_6 \dsct{\ddgc}{j}\)</span></p>
</div>
</div>
<div id="fig-algnewmark" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blank.png" class="img-fluid figure-img" style="width:0.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.16: Pseudocode for Newmark’s method.</figcaption><p></p>
</figure>
</div>
<p>Newmark’s method is self starting in that initial conditions suffice to begin the iterations (along with <span class="math inline">\(\dsct{\ddgc}{0}\)</span>, which itself is calculated based on <span class="math inline">\(\dsct{\dgc}{0}\)</span> and <span class="math inline">\(\dsct{\gc}{0}\)</span> alone). Its stability, however, depends on the value of <span class="math inline">\(\beta\)</span>. This issue is what we discuss next, along with the relations between this framework and some previously developed methods which may be considered to be special cases of Newmark’s approach.</p>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-section" role="doc-endnotes">
<hr>
<ol start="8">
<li id="fn8"><p>N. M. Newmark and S.P. Chan, <em>A Comparison of Numerical Methods for Analyzing the Dynamic Response of Structures</em>, Civil Engineering Studies SRS-036, University of Illinois at Urbana-Champaign, 1952. <br> N.M. Newmark, <em>A Method of Computation for Structural Dynamics</em>, ASCE Journal of the Engineering Mechanics Division, Vol. 85, No.&nbsp;EM 3, pp.&nbsp;67-94, 1959.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<section id="various-interpretations-of-newmarks-method" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" data-anchor-id="various-interpretations-of-newmarks-method"><span class="header-section-number">4.6.2</span> Various Interpretations of Newmark’s Method</h3>
<p>Newmark’s formulation provides a general framework from which various methods developed previously may be derived as special cases. The free parameters <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\beta\)</span> are what makes this possible, and its value determines the nature of the assumed variation of acceleration within a time step. If, for example, <span class="math inline">\(\gamma = 0\)</span> and <span class="math inline">\(\beta=0\)</span>, Newmark’s velocity and displacement approximations in <a href="#eq-newmark">Equation&nbsp;<span>4.17</span></a> yield <span class="math display">\[\begin{align*}
\dsct{\dgc}{j+1} &amp; = \dsct{\dgc}{j} + \tstep \dsct{\ddgc}{j} \\
\dsct{\gc}{j+1} &amp; = \dsct{\gc}{j} + \tstep \dsct{\dgc}{j} + \frac{1}{2} \tstep^2 \dsct{\ddgc}{j}
\end{align*}\]</span> so that this choice is essentially equivalent to keeping the acceleration constant <span class="math inline">\(j\tstep \leq t &lt; (j+1)\tstep\)</span> at its value at time step <span class="math inline">\(j\)</span>. This approach, which is not so popular due to want of accuracy and stability, is called the <em>constant acceleration method</em>.</p>
<p>Next, consider the case with <span class="math inline">\(\gamma=1/2\)</span> and <span class="math inline">\(\beta = 1/4\)</span>. The approximations now yield <span id="eq-constacc"><span class="math display">\[
\begin{array} {lc}
\dsct{\dgc}{j+1} = \dsct{\dgc}{j} +  \tstep \frac{\dsct{\ddgc}{j} + \dsct{\ddgc}{j+1}}{2} =  \dsct{\dgc}{j} +  \tstep \ddgc_{avg} &amp; \text{(a)} \\
\dsct{\gc}{j+1} = \dsct{\gc}{j} + \tstep \dsct{\dgc}{j} + \frac{1}{2} \tstep^2 \frac{\dsct{\ddgc}{j} + \dsct{\ddgc}{j+1}}{2} = \dsct{\gc}{j} + \tstep \dsct{\dgc}{j} + \frac{1}{2} \tstep^2 \ddgc_{avg} &amp; \text{(b)}
\end{array}
\qquad(4.23)\]</span></span> which amounts to assuming that the acceleration is constant for <span class="math inline">\(j \tstep \leq t &lt; (j+1) \tstep\)</span> at an average value of <span class="math display">\[
\ddgc_{avg} = \frac{\dsct{\ddgc}{j} + \dsct{\ddgc}{j+1}}{2}
\]</span> This approach is called the <em>constant average acceleration method</em> or, according to Newmark and Chan,<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> <em>Timoshenko’s modified acceleration method</em>.</p>
<p>Finally, when <span class="math inline">\(\gamma=1/2\)</span> and <span class="math inline">\(\beta = 1/6\)</span>, the approximations yield <span id="eq-linacc"><span class="math display">\[
\begin{array}{lc}
\dsct{\dgc}{j+1} = \dsct{\dgc}{j} + \frac{1}{2} \tstep \dsct{\ddgc}{j} + \frac{1}{2} \tstep \dsct{\ddgc}{j+1} &amp; \text{(a)}\\
\dsct{\gc}{j+1} = \dsct{\gc}{j} + \tstep \dsct{\dgc}{j} + \frac{1}{3} \tstep^2 \dsct{\ddgc}{j} + \frac{1}{6} \tstep^2 \dsct{\ddgc}{j+1} &amp; \text{(b)}
\end{array}
\qquad(4.24)\]</span></span> These approximations are identical to those one would obtain if one were to assume that the acceleration varied linearly for <span class="math inline">\(j\tstep \leq t &lt; (j+1)\tstep\)</span> from a value of <span class="math inline">\(\dsct{\ddgc}{j}\)</span> to a value of <span class="math inline">\(\dsct{\ddgc}{j+1}\)</span> since if, for <span class="math inline">\(\tau = t - j \tstep\)</span>, <span class="math display">\[
\ddgc (\tau) = \dsct{\ddgc}{j} + \ratio{\dsct{\ddgc}{j+1} - \dsct{\ddgc}{j}}{\tstep} \tau
\]</span> then integration leads to <span class="math display">\[\begin{align*}
\dgc (\tau) &amp; = \dsct{\dgc}{j} + \dsct{\ddgc}{j} \tau  + \ratio{\dsct{\ddgc}{j+1} - \dsct{\ddgc}{j}}{2 \tstep} \tau^2 \\
\gc (\tau) &amp; = \dsct{\gc}{j} + \dsct{\dgc}{j} \tau + \ratio{1}{2} \dsct{\ddgc}{j} \tau^2  + \ratio{\dsct{\ddgc}{j+1} - \dsct{\ddgc}{j}}{6 \tstep} \tau^3
\end{align*}\]</span> which yield exactly the same expressions as those in <a href="#eq-linacc">Equation&nbsp;<span>4.24</span></a> for <span class="math inline">\(\tau = \tstep\)</span>; hence, this approach is called the <em>linear acceleration method</em>.</p>
<p>It is not surprising that the stability of Newmark’s method depends on the values of <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\beta\)</span>. Consider the commonly used case with <span class="math inline">\(\gamma = 1/2\)</span> and recall the discussion of <a href="#sec-numericalinterlude"><span>Section&nbsp;4.4</span></a>. For an undamped system,<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> it is possible to construct a state space model in the form <span class="math display">\[
\dscs{j} = \colmat{\dsct{\gc}{j} \\ \dsct{\dgc}{j} \\\dsct{\ddgc}{j}}
\]</span> so that Newmark’s estimates may be cast into state space format as <span class="math display">\[
\dscs{j+1} = \dscA \dscs{j} + \dscB \dscf{j+1}
\]</span> where, for <span class="math inline">\(\eta=\freq \tstep\)</span>, the state transition matrix is given by <span class="math display">\[
\dscA = \begin{bmatrix}  
1 - \frac{\beta \eta^2}{1+\beta \eta^2} &amp; \tstep \left( 1 - \frac{\beta \eta^2}{1+\beta \eta^2} \right) &amp; \tstep^2 (\beta - \frac{1}{2}) \left( \frac{\beta \eta^2 }{1+\beta \eta^2} -1 \right) \\
-\frac{1}{\tstep}\frac{\eta^2}{2(1+\beta \eta^2)} &amp; 1- \frac{\eta^2}{2(1+\beta \eta^2)} &amp; \tstep \left(\frac{\eta^2(\beta-1/2)}{2(1+\beta \eta^2)} + \frac{1}{2}\right) \\
- \frac{1}{\tstep^2} \frac{\eta^2}{1+\beta \eta^2} &amp; - \frac{1}{\tstep} \frac{\eta^2}{1+\beta \eta^2} &amp; \frac{\eta^2(\beta-1/2)}{1+\beta \eta^2}
\end{bmatrix}
\]</span> This matrix has three eigenvalues, one of which is <span class="math inline">\(\lambda_3 = 0\)</span>. The other two are given by <span class="math display">\[
\lambda_{1,2} = 1 - \frac{\eta^2}{2(1+\beta \eta^2)} \pm \frac{\eta}{2(1+\beta \eta^2)} \sqrt{\eta^2 - 4 \beta \eta^2 - 4}
\]</span> Stability of the system is governed by the magnitude of the largest eigenvalue, called the spectral radius, as discussed in <a href="#sec-numericalinterlude"><span>Section&nbsp;4.4</span></a>. For <span class="math inline">\(\beta = 1/4\)</span>, we have <span class="math display">\[
\abs{\lambda_{1}}= \abs{\lambda_{2}} = 1
\]</span> so that the <em>constant average acceleration method (Newmark’s method with <span class="math inline">\(\gamma = 1/2, \beta = 1/4\)</span>) is unconditionally stable</em>. For <span class="math inline">\(\beta = 1/6\)</span>, the eigenvalues are given by <span class="math display">\[
\lambda_{1,2} = 1 - \frac{3\eta^2}{(6+\eta^2)} \pm \frac{2\eta}{(6+ \eta^2)} \sqrt{\frac{\eta^2}{3}- 4}
\]</span></p>
<div id="fig-newmarkspectrum" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/newmarkspectrum.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.17: Spectral radii for two commonly employed Newmark-<span class="math inline">\(\beta\)</span> methods as a function of the ratio of the time step <span class="math inline">\(h\)</span> to the period <span class="math inline">\(T\)</span> of the undamped SDOF system.</figcaption><p></p>
</figure>
</div>
<p>When <span class="math inline">\(\eta^2 = 12\)</span>, we have <span class="math inline">\(\lambda_{1} = \lambda_{2} = -1\)</span>, and this in fact is the transition point from a stable to an unstable scheme since for <span class="math inline">\(\eta^2 &gt; 12\)</span> the spectral radius, i.e.&nbsp;the largest value of the magnitude of the eigenvalues, will exceed <span class="math inline">\(1\)</span>. The stability condition is therefore <span class="math display">\[
\eta^2 = (\freq \tstep)^2 = \left(\frac{2 \pi }{\period}\tstep \right)^2 \leq 12 \quad \rightarrow \quad \frac{\tstep}{\period} \leq \frac{\sqrt{3}}{\pi} \approx 0.551
\]</span> and the <em>linear acceleration method (Newmark’s method with <span class="math inline">\(\gamma = 1/2, \beta = 1/6\)</span>) is conditionally stable</em>. The variation of the spectral radii for the two methods is shown in <a href="#fig-newmarkspectrum">Figure&nbsp;<span>4.17</span></a>.</p>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-section" role="doc-endnotes">
<hr>
<ol start="9">
<li id="fn9"><p>N.M. Newmark and S.P. Chan, <em>A Comparison of Numerical Methods for Analyzing the Dynamic Response of Structures</em>, Civil Engineering Studies SRS-036, University of Illinois at Urbana-Champaign, 1952.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>For a more detailed discussion with linear viscous damping included see, e.g., Chapter 9 in K.-J. Bathe, <em>Finite Element Procedures</em>, Prentice Hall, 1996.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</section>
<section id="numerical-integration-for-nonlinear-sdof-systems" class="level2" data-number="4.7">
<h2 data-number="4.7" data-anchor-id="numerical-integration-for-nonlinear-sdof-systems"><span class="header-section-number">4.7</span> Numerical Integration for Nonlinear SDOF Systems</h2>
<p>A predominant assumption in most structural engineering practice is that for small deformations and displacements, the structural members behave as linear elastic materials and geometric changes are small so as to not give rise to any sources of geometric nonlinearity. That said, in applications such as seismic design where extreme events like strong ground motions from rare earthquakes must be considered, linear elastic behavior is most probably not a valid assumption. The current design principles stipulate that overconservative approaches leading to structures that remain linear elastic even under extreme loadings may yield suboptimum/uneconomical designs.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<div id="fig-nonlinearity" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/nonlinearity.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.18: a) Linear vs.&nbsp;nonlinear behavior of structural elements. b) Elastic-perfectly plastic assumption, where material stiffness vanishes past the yield point but elastic response is recovered as the displacement direction reverses.</figcaption><p></p>
</figure>
</div>
<p>Most notably in the context of seismic design, it is reasonable to assume that structural members may undergo yielding and permanent deformations, and in doing so dissipate great amounts of energy through mechanisms such as cracking and spalling, yielding of joints and reinforcement bars, shearing of gusseted connections etc. The concept of nonlinear response and energy dissipation are schematically illustrated in <a href="#fig-nonlinearity">Figure&nbsp;<span>4.18</span></a>. The energy dissipated in a hysteretic cycle is the area enclosed by the hysteresis loop and dissipation through plastic deformations may reach levels much more prominent than the dissipation provided solely by the viscous damping model. It is therefore important to understand how yielding behavior and other nonlinearities in the load-bearing members would influence the response of the structure. In the context of SDOF systems, maximum relative or absolute displacement observed under an excitation may be important design considerations. Intuitively, we can imagine that yielding beyond a critical point may promote additional energy dissipation and thereby reduce maximum displacement, at the expense of resulting in some permanent deformation. A member that yields at a relatively low critical level of force however may result in excessive deformations, either transient and permanent, and these may reach unallowable levels for design purposes. Even for a simple SDOF system in which the nonlinear behavior of the material is idealized as elastic-perfectly plastic, often shortly referred to as <em>elastoplastic</em>, the response depends on the loading and deformation time-history, yield strength and other parameters, and thus generalized analytical solutions are elusive. Numerical methods presented in the previous sections, however, are broadly applicable to situations where structural members behave nonlinearly.</p>
<p>There has been much progress in our understanding of the behavior of nonlinear systems in recent decades, which has allowed identification of simple design rules that allow us to predict the expected total response of structures without any nonlinear analysis. These rules of thumb commonly employed in building codes have been based on documented behavior of nonlinear response of buildings from simulations and thereby projecting outcomes based on their elastic properties and approximated yield response. In doing so, engineers have simplified seismic design in building codes to the extent that nonlinear analysis is often not mandatory and dynamical response variables may be estimated from linear analysis on the basis of typical expectations of ground motions in a region, soil properties, and the degree to which the system may safely exhibit ductility without loss of all load bearing capacity. Nevertheless, simulation of nonlinear systems remains an important topic, at a minimum to reinforce the underpinnings of these design methods and in many instances to attain more accurate and economical structural solutions.</p>
<p>In this section, we will revisit a couple of the methods presented previously, the central difference method and the Newmark-<span class="math inline">\(\beta\)</span> approach to illustrate their application to nonlinear systems.</p>
<section id="central-difference-method-for-nonlinear-sdof-systems" class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" data-anchor-id="central-difference-method-for-nonlinear-sdof-systems"><span class="header-section-number">4.7.1</span> Central Difference Method for Nonlinear SDOF Systems</h3>
<p>The approximations presented in <a href="#eq-cemacc">Equation&nbsp;<span>4.8</span></a> and <a href="#eq-cemvel">Equation&nbsp;<span>4.9</span></a> for the central difference method are readily adopted to study nonlinear systems as well, since these are simply mathematical approximations of the basic variables describing the motion of the system in time. That said, it will be shown later that system characteristics such as the yield point will influence the accuracy of the method relative to other numerical methods. CDM is arguably the easiest method to apply to nonlinear systems given the simplicity of the algorithm and transferability to a generalized scenario where the spring term behaves nonlinearly. On the other hand, given its explicit nature, it is prone to error as it will generally have difficulty accurately reproducing member forces around the yielding point.</p>
<p>The generalized nonlinear equation of motion for SDOF systems subject to an external forced excitation may be expressed as <span id="eq-nlsdofeomfa"><span class="math display">\[
m \ddgct + \extforce' (\gct, \dgct) = \extforcet
\qquad(4.25)\]</span></span> but often (unless structural elements such as suppplemental dampers make it necessary) it is assumed that the velocity dependent damping term may be modeled by the linear viscous damping model so that the governing equation is expressed as: <span id="eq-nlsdofeomfb"><span class="math display">\[
m \ddgct + c \dgct + \stifforce (\gct) = \extforcet
\qquad(4.26)\]</span></span> If, for example, the excitation is ground motion, then the equation of motion will be given by <span id="eq-nlsdofbaseeomfnl"><span class="math display">\[
m \ddgct + c \dgct + \stifforce (\gct) = - m \gacct
\qquad(4.27)\]</span></span> and in discretized form, equilibrium at time step <span class="math inline">\(j\)</span> will require <span id="eq-nlsdofeomfdsc"><span class="math display">\[
m \dsct{\ddgc}{j} + c \dsct{\dgc}{j} + \dsct{\left\{\stifforce (\gc)\right\}}{j} = \dsct{\extforce}{j}
\qquad(4.28)\]</span></span> In these equations, <span class="math inline">\(\stifforce\)</span> represents the nonlinear spring force and in general it is a function of the displacement time history <span class="math inline">\(\gct\)</span> up until the current time. If the central difference approximations of <a href="#eq-cemacc">Equation&nbsp;<span>4.8</span></a> and <a href="#eq-cemvel">Equation&nbsp;<span>4.9</span></a> are employed and the displacement at time step <span class="math inline">\(j+1\)</span> is isolated as the unknown as was done in linear analysis, one gets <span id="eq-cdmq"><span class="math display">\[
A_1 \dsct{\gc}{j+1} = \dsct{\extforce}{j}  - A_2 \dsct{\gc}{j} - A_3 \dsct{\gc}{j-1} -  \dsct{\left\{\stifforce (\gc) \right\}}{j}
\qquad(4.29)\]</span></span> where <span id="eq-cdmainl"><span class="math display">\[
\begin{array}{l}
  A_1 = {\ratio{m}{\tstep^2} + \ratio{c}{2 \tstep}}  \\
  A_2 = - \ratio{2m}{\tstep^2} \\
  A_3 = \ratio{m}{\tstep^2} - \frac{c}{2 \tstep}  \\
  (\text{and for use further down the line: }A_4 = \ratio{1}{2\tstep}, \; A_5 = \ratio{1}{\tstep^2})
\end{array}
\qquad(4.30)\]</span></span></p>
<!-- In the context of the central difference method, we can revisit the formula that estimates, given the response up to and including time $t$ (time step $p$), the response at $t+\tstep$ (time step $p+1$). In the non-linear formulation, only the term involving the spring force changes. As such, the regression expression becomes:  
$$
  A_1 \dsct{\gc}{j+1} = \left(\extforce_{j} - (\stifforce)_i - A_2 \dsct{\gc}{j-1} + 2mA_4 \dsct{\gc}{j} \right)
$${#eq-cdmq}
where
$$
\begin{array}{l}
  A_1 = {\ratio{m}{\tstep^2} + \ratio{c}{2 \tstep}}  \\
  A_2 = \ratio{m}{\tstep^2} - \frac{c}{2 \tstep}  \\
  A_3 = \ratio{1}{2\tstep}\\
  A_4 = \ratio{1}{\tstep^2}
\end{array}
$${#eq-cdmainl} -->
<p>Note that the definition of <span class="math inline">\(A_2\)</span> is different than its previous version used in linear systems since the spring force now appears separately in <span class="math inline">\(\stifforce (\gc)\)</span> Once again, for a constant time step <span class="math inline">\(\tstep\)</span>, all of the coefficients <span class="math inline">\(A_i\)</span> are to be calculated only once. At each time step, the velocity is to be calculated from the central difference approximation in <a href="#eq-cemvel">Equation&nbsp;<span>4.9</span></a>, which may be written in discrete form as <span id="eq-cdmdqnl"><span class="math display">\[
  \dsct{\dgc}{j} = \frac{1}{2\tstep}(\dsct{\gc}{j+1} - \dsct{\gc}{j-1}) = A_4 (\dsct{\gc}{j+1} - \dsct{\gc}{j-1})
\qquad(4.31)\]</span></span> <!-- $$
  \dsct{\dgc}{j} = \frac{1}{2\tstep}(\dsct{\gc}{j+1} - \dsct{\gc}{j-1}) = A_3 (\dsct{\gc}{j+1} - \dsct{\gc}{j-1})
$${#eq-cdmdqnl} --> and the acceleration may be calculated using the equilibrium equation for that time step given by <span id="eq-cdmddqnl"><span class="math display">\[
m \dsct{\ddgc}{j} = \dsct{\extforce}{j} - c \dsct{\dgc}{j} - \dsct{\left\{\stifforce (\gc) \right\}}{j}
\qquad(4.32)\]</span></span> or from the central difference approximation given by <span id="eq-cdmddq2nl"><span class="math display">\[
\dsct{\ddgc}{j} = \frac{\dsct{\gc}{j+1}- 2 \dsct{\gc}{j} + \dsct{\gc}{j-1}}{\tstep^2} = A_5 (\dsct{\gc}{j+1}- 2 \dsct{\gc}{j} + \dsct{\gc}{j-1})
\qquad(4.33)\]</span></span> <!-- $$
 \dsct{\ddgc}{j} = \frac{\dsct{\gc}{j+1}- 2 \dsct{\gc}{j} + \dsct{\gc}{j-1}}{\tstep^2} = A_4 (\dsct{\gc}{j+1}- 2 \dsct{\gc}{j} + \dsct{\gc}{j-1})
$${#eq-cdmddq2nl} --></p>
<p>The nonlinear spring force <span class="math inline">\(\stifforce\)</span> will generally depend on the model used for describing the nonlinearity of the element. For the idealized case of an elastic-perfectly-plastic spring subject to loading cycle as shown in <a href="#fig-nonlinearity">Figure&nbsp;<span>4.18</span></a>, member deforms elastically up to the yield point, in which case the force generated is <span class="math inline">\(\stifforce = k \gc\)</span>. In the post-yield regime, force generated by the member remains constant <span class="math inline">\(\stifforce = \yieldforce\)</span>. When the unloading begins, which may be determined based on the direction (sign) of velocity, the spring force follows a straight path parallel to the initial loading line. Once the unloading reaches a level such that yielding is initiated in the opposite direction, the spring force once again takes on a constant value, given now by <span class="math inline">\(\stifforce = - \yieldforce\)</span>. This loading - unloading sequence goes on as the direction of velocity is reversed. An example pseudo-code is provided below for the special case of perfect elastoplastic SDOF systems with viscous damping.</p>
<div id="label-name" class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Pseudocode for the Central Difference Method for Nonlinear Systems</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>viscously damped SDOF system with nonlinear spring, for constant time step</em></p>
<p><strong>Input</strong>: <span class="math inline">\(m\)</span>, <span class="math inline">\(\damp\)</span> (or <span class="math inline">\(c\)</span>), <span class="math inline">\(\stifforce (\gc)\)</span> (or for elastoplastic, <span class="math inline">\(k\)</span>, and <span class="math inline">\(f_y\)</span> or <span class="math inline">\(q_y\)</span>), <span class="math inline">\(\tstep\)</span>, <span class="math inline">\(\dsct{\gc}{0}\)</span>, <span class="math inline">\(\dsct{\dgc}{0}\)</span>, <span class="math inline">\(\left\{\dsct{\extforce}{0}, \ldots, \dsct{\extforce}{l} \right\}\)</span></p>
<p><strong>Initialize</strong>: calculate</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(A_1,A_2,A_3\)</span>, <span class="math inline">\(A_4\)</span> and <span class="math inline">\(A_5\)</span> using <a href="#eq-cdmainl">Equation&nbsp;<span>4.30</span></a>, <span class="math inline">\(A_1^{-1}\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\ddgc}{0} = \frac{1}{m}(\dsct{\extforce}{0} - c \dsct{\dgc}{0} - \dsct{\left\{\stifforce (\gc) \right\}}{0})\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\gc}{-1} = \dsct{\gc}{0} - \tstep \dsct{\dgc}{0} - \frac{\tstep^2}{2} \dsct{\ddgc}{0}\)</span></p>
<p><strong>for</strong> <span class="math inline">\(j=0,\ldots,l-1\)</span>:</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\gc}{j+1} = A_1^{-1} \left(\dsct{\extforce}{j}- A_2 \dsct{\gc}{j} - A_3 \dsct{\gc}{j-1} - \dsct{\left\{\stifforce (\gc) \right\}}{j}\right)\)</span></p>
<p><strong>for</strong> <span class="math inline">\(j=1,\ldots,l-1\)</span>:</p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\dgc}{j} = A_4(\dsct{\gc}{j+1} - \dsct{\gc}{j-1})\)</span></p>
<p><span class="math inline">\(\phantom{xxxxxxxxxx}\)</span> <span class="math inline">\(\dsct{\ddgc}{j} = A_5 (\dsct{\gc}{j+1}- 2 \dsct{\gc}{j} + \dsct{\gc}{j-1})\)</span></p>
</div>
</div>
<div id="fig-nonlinearCDM" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blank.png" class="img-fluid figure-img" style="width:0.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.19: Pseudocode for the Central Difference Method for Nonlinear Systems.</figcaption><p></p>
</figure>
</div>
<!-- ::: {.callout-note icon=false #label-name}
## **Pseudocode for the Central Difference Method for Nonlinear Systems**
*viscously damped SDOF system with nonlinear spring, for constant time step* 

**Input**: $m$, $\damp$ (or $c$), $\stifforce (\gc)$ (or for elastoplastic,$k$ and $f_y$, or $q_y$), $\tstep$, $\dsct{\gc}{0}$, $\dsct{\dgc}{0}$, $\left\{\extforce_{0} \ldots \extforce_{n} \right\}$


**Initialize**: calculate

$\phantom{xxxxxxxxxx}$ $A_1,A_2,A_3$, $A_4$ and using @eq-cdmainl, $A_1^{-1}$

$\phantom{xxxxxxxxxx}$ $\dsct{\ddgc}{0}  = \frac{1}{m}(\extforce_{0} - c \dsct{\dgc}{0} - k\dsct{\gc}{0})$

$\phantom{xxxxxxxxxx}$ $\dsct{\gc}{-1}  = \dsct{\gc}{0} - \tstep \dsct{\dgc}{0} - \frac{\tstep^2}{2} \dsct{\ddgc}{0}$

**for** $i=0,\ldots,n-1$:

$\phantom{xxxxxxxxxx}$ $\dsct{\gc}{j+1} = A_1^{-1} \left(\extforce_{j} - (\stifforce)_i - A_2 \dsct{\gc}{j-1} + + 2mA_4 \dsct{\gc}{j} \right)$

**for** $i=1,\ldots,n$:

$\phantom{xxxxxxxxxx}$ $\dsct{\dgc}{j} = A_3(\dsct{\gc}{j+1} - \dsct{\gc}{j-1})$

$\phantom{xxxxxxxxxx}$ $\dsct{\ddgc}{j} = A_4 (\dsct{\gc}{j+1}- 2 \dsct{\gc}{j} + \dsct{\gc}{j-1})$
::: -->
<section id="sec-sdofnum6" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="sec-sdofnum6">EXAMPLE 4 .6</h4>
<p>To identify some fundamental behavioral concepts, consider the analysis of an elastoplastic toy model with mass <span class="math inline">\(m=1\)</span> kg, viscous damping ratio <span class="math inline">\(\damp = 0.05\)</span>, and initial undamped period <span class="math inline">\(\period=1 \unit{second}\)</span>, subject to a cyclic base acceleration given as <span class="math inline">\(\gacc (t) = \sin{\freq t} \unit{m/s^2}\)</span>. If the yield limit is <span class="math inline">\(\yieldforce = 3 \unit{N}\)</span> and similar behavior is observed in tension and compression, what will be the maximum displacement?</p>
<p>The response of this model is calculated via CDM with an example <a href="https://colab.research.google.com/drive/103owEPsyFJs0YovSOuXgDyAj3nNh1R5I?usp=sharing">code</a> and the maximum displacement is found to be <span class="math inline">\(0.098 \unit{m}\)</span>. The code illustrates the simplicity of the central difference algorithm, owing to the explicit nature of the approach, which makes calculations of the spring force easy as they only depend on the previous time step. The implementation, however, has relatively low accuracy, especially in systems where there is an abrupt change in stiffness due to yielding. The elastoplastic case is an extreme example in this regard, since the post-yield stiffness is zero.</p>
<p>Some important physical insights can be gained from this simple example. First, the yielding behavior of the elastoplastic system provides energy dissipation through hysteresis, with the size of the hysteresis loop giving us a sense of energy dissipated in each cycle. In this particular case, the dissipation energy in viscous and spring forces are comparable, and this helps further reduce the peak displacement of the system relative to the purely elastic case (<span class="math inline">\(0.098 \unit{m}\)</span> vs.&nbsp;<span class="math inline">\(0.253 \unit{m}\)</span> for elastic). <a href="#fig-pem">Figure&nbsp;<span>4.1</span></a> illustrates these findings. These observations support the notion that yielding of elements may provide an economical way of reducing peak displacements under strong dynamic excitations, i.e.&nbsp;ground motion. The caveat, however, is that there is permanent deformation, which can be calculated from the mean of the steady state response, which in the case of harmonic deformation is small. As <span class="math inline">\(\yieldforce\)</span> is reduced, more energy can be dissipated, up to a practical limit beyond which either the hysteresis loop becomes too small and peak displacements increase, or plastic deformations become excessively large. The degree of plastic deformation will be proportional to the ratio of the peak displacement recorded in the linear elastic case vs.&nbsp;<span class="math inline">\(\yieldforce/k\)</span>, that is the displacement limit for yield. We will consider this ratio further in seismic design, to be visited in later chapters. These concepts can be further explored in the case of harmonic excitation by modifying the example code provided, for instance to explore how yield limit, excitation characteristics, and viscous damping parameters influence the relative role of yielding on reducing peak displacements.</p>
<div id="fig-cdmnl" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/cdmnl.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.20: a) Example displacement time history for an elastoplastic system subject to harmonic ground excitation; b) spring force vs.&nbsp;displacement showing the hysteresis loop; c) damping force vs.&nbsp;displacement, showing viscous dissipation. The Python scripts used to calculate the response can be found <a href="https://colab.research.google.com/drive/103owEPsyFJs0YovSOuXgDyAj3nNh1R5I?usp=sharing">here</a>.</figcaption><p></p>
</figure>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-section" role="doc-endnotes">
<hr>
<ol start="11">
<li id="fn11"><p>There is much to say about this with many recent earthquakes demonstrating that the social and economic losses that accumulate after significant earthquakes may reach devastating levels. ``Resilience’’ is likely to be a central concept in the coming years.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</section>
<section id="newmarks-method-for-non-linear-systems" class="level3" data-number="4.7.2">
<h3 data-number="4.7.2" data-anchor-id="newmarks-method-for-non-linear-systems"><span class="header-section-number">4.7.2</span> Newmark’s Method for Non-linear Systems</h3>
<p>While explicit methods such as central difference are easy to implement for nonlinear systems, implicit approaches are often preferred due to their higher accuracy and stability. In this context, the Newmark family of algorithms are quite popular, and they will be briefly discussed in this section to exemplify how their implementation in nonlinear cases differs from linear cases and explicit methods. As in the case of linear systems, the implicit nature of the method requires that force at each time step be calculated taking into account information from that same time step. In a system where the spring or damping forces are non-linear, this requires iterative calculations within each time step to precisely capture possible variations in system properties. The fundamental approximation involved is the assumption that properties of the system are considered to be constant at very short time intervals (within a time step) but vary over time. Within each step, iterative solutions determine how the system variables change, and displacements, velocities and accelerations are calculated consistently to satisfy the equations of motion. A commonly used iteration method is illustrated herein first for a static problem, and then integrated into Newmark’s method to solve SDOF structural dynamics problems.</p>
<section id="newton-raphson-iteration" class="level4" data-number="4.7.2.1">
<h4 data-number="4.7.2.1" data-anchor-id="newton-raphson-iteration"><span class="header-section-number">4.7.2.1</span> Newton-Raphson Iteration</h4>
<p>Consider a scenario in which the spring force - deformation relationship is nonlinear as shown in <a href="#fig-nonlinearity">Figure&nbsp;<span>4.18</span></a>. Assume the system is subject (or rather will eventually be subject after deformation) to a static external force <span class="math inline">\(\sforce\)</span>. The system resists the external force by some <span class="math inline">\(\resistforce\)</span> and if the nonlinear spring is the only element then the resisting force is simply the force in the spring. There may be other components, say for example dampers or other terms coming from numerical approximations, which may contribute to this resistance and so we use the term resisting force to denote their cumulative act. Assume for simplicity that the resisting force is a function of only the generalized displacements, i.e.&nbsp;<span class="math inline">\(\resistforce = \resistforce (\gc)\)</span>. If the initial displacement is <span class="math inline">\(\gc^{(0)}\)</span>, which may or may not be equal to zero, the resisting force is given by <span class="math inline">\(\resistforce^{(0)} = \resistforce (\gc^{(0)})\)</span>. Unless by a very fortuitous surprise, the system is most likely not balanced in that <span class="math inline">\(\resistforce^{(0)} \neq \sforce\)</span>, and we have not yet reached equilibrium. The system will have to deform further to reach equilibrium, and the question is, by how much?</p>
<p>The Newton-Raphson approach tries to answer this question by iteratively updating the displacement and the unbalanced force until a specific condition is set and the convergence is deemed acceptable. Mathematically it is a root finding method, adopted here to minimize the residual <span class="math inline">\(\residual = \sforce - \resistforce (\gc)\)</span>. The objective of the iteration is to reduce <span class="math inline">\(\residual\)</span> below an acceptable threshold, which represents the acceptable error in force calculations. The underlying approximation may be discussed via Taylor expansion of <span class="math inline">\(\resistforce\)</span>: consider that an estimate of the state and the resisting force, which is essentially a known function of the estimate of state, is available for the <span class="math inline">\(p\)</span>-th iteration, i.e.&nbsp;<span class="math inline">\(\gc^{(p)}\)</span> and <span class="math inline">\(\resistforce^{(p)}\)</span> are known. The linearized Taylor series expansion approximation for the resisting force in the next iteration (i.e.&nbsp;essentially the resisting force at some other state) can be expressed as <span class="math display">\[
\resistforce^{(p+1)} \approx \resistforce^{(p)} + \left. \pardiv {\resistforce}{\gc} \right|_{\gc^{(p)}} \left (\gc^{(p+1)} - \gc ^{(p)} \right) = \resistforce^{(p)} + \bar{k}_t^{(p)} \Delta \gc^{(p)}
\]</span> where <span class="math inline">\(\bar{k}_t^{(p)} = \left. ({\partial \resistforce}/{\partial \gc}) \right|_{\gc^{(p)}}\)</span> is the <em>equivalent tangent stiffness</em> at <span class="math inline">\(\gc^{(p)}\)</span>, and <span class="math inline">\(\Delta \gc^{(p)} = \gc^{(p+1)} - \gc ^{(p)}\)</span> is the <em>state step</em> (as opposed to the time step we have referred to previously). Recall that we have assumed the resisting force to be a function of the generalized displacement alone; for more complicated cases, for example involving generalized velocities, the tangent stiffness may have to be a matrix. The setback is that we do not know the next point in the expansion, i.e.&nbsp;we do not yet know <span class="math inline">\(\gc^{(p+1)}\)</span> or, equivalently, <span class="math inline">\(\Delta \gc^{(p)}\)</span>. We may try to estimate the state step using the current imbalance in the system, i.e.<br>
<span class="math display">\[
\Delta \gc ^{(p)} = \frac{(\sforce- \resistforce^{(p)})} {\bar{k}_t^{(p)}} = \frac{\residual^{(p)}}{\bar{k}_t^{(p)}}
\]</span> where <span class="math inline">\(\residual^{(p)}\)</span> is called the <em>residual</em> or the <em>imbalance</em> at iteration <span class="math inline">\(p\)</span>. But now that we have a new estimate for the state, given by <span class="math display">\[
\gc^{(p+1)} = \gc ^{(p)} + \Delta \gc^{(p)}
\]</span> we may calculate a new estimate for the resisting force, i.e.&nbsp;<span class="math inline">\(\resistforce^{(p+1)}\)</span>, and check whether the system is in equilibirum or not. An exact equality may be too much to ask but we may be satisfied with an approximate answer such that the error is less than some tolerance, so that we may check whether <span class="math display">\[
\residual^{(p+1)} = \sforce - \resistforce^{(p+1)} \leq \text{force tolerance}
\]</span> or whether <span class="math display">\[
\gc^{(p+1)} - \gc^{(p)} \leq \text{state tolerance}
\]</span> If the convergence condition is satisfied we may stop the iterations and use the final values as our best estimates, otherwise we may proceed further with the iterations by simply repeating the steps involved for the next iteration. All this may be graphically easier to grasp via the schematic description in <a href="#fig-newtonrhapson">Figure&nbsp;<span>4.21</span></a> (a). A simplified version that is often referred to may be conducted by keeping the same tangent stiffness in all iterations, which is also graphically depicted in <a href="#fig-newtonrhapson">Figure&nbsp;<span>4.21</span></a> (b); the benefit being the savings obtained by minimizing the number of tangent stiffness calculations at the cost of possibly more iterations. The good news is that the Newton-Raphson approach is quite general and it may be used for other type of nonlinear interactions, such as for example a nonlinear damper.</p>
<div id="fig-newtonrhapson" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/newtonrhapson.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.21: Newton-Raphson iteration method for calculating nonlinear spring forces.</figcaption><p></p>
</figure>
</div>
<p>A very simple example may suffice to demonstrate the steps involved. Consider a spring for which the force-displacement relationship is given by <span class="math display">\[
\stifforce = k_{nl} \sqrt{q}  \quad \text{for } \gc \text{ in mm} \geq 0
\]</span> with <span class="math inline">\(k_{nl} = 10 \unit{N / \sqrt{mm}}\)</span>, and assume that the spring is subjected to an external force of <span class="math inline">\(50 \unit{N}\)</span>, as sketched in <a href="#fig-xnewtonrhapson">Figure&nbsp;<span>4.22</span></a>.</p>
<div id="fig-xnewtonrhapson" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/xnewtonrhapson.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.22: Simple nonlinear spring subjected to an external force.</figcaption><p></p>
</figure>
</div>
<p>The exact solution is obvious: the spring has to deform <span class="math inline">\(25 \unit{mm}\)</span> for the system to equilibriate. Let us try to see if we can apply the Newton-Rhapson iterations to obtain this result. Assume our initial guess for the displacement is <span class="math inline">\(\gc^{(0)} = 1 \unit{mm}\)</span> (note that an initial guess of <span class="math inline">\(0\)</span> would yield an infinite tangent stiffness so that it would not be useful to start from). Since the only resisting element is a spring, we have <span class="math inline">\(\resistforce = \stifforce\)</span>. The unbalanced force and the tangent stiffness at this step are <span class="math display">\[
\begin{array}{c}
\residual^{(0)} = \sforce - \resistforce^{(0)} = 50 - \left.(10 \sqrt{q})\right|_{\gc^{(0)}} = 40 \unit{N},\\
\bar{k}_t^{(0)} = \left. \pardiv {\resistforce}{\gc} \right|_{\gc^{(0)}} = \left.\ratio{5}{\sqrt{q}}\right|_{\gc^{(0)}} \! \! = 5 \unit{N / mm}
\end{array}
\]</span> The state step is therefore given by <span class="math display">\[
\Delta \gc^{(0)} = \ratio{\residual^{(0)}}{\bar{k}_t^{(0)}} = 8 \unit{mm}
\]</span> and the next estimate is calculated as <span class="math display">\[
\gc^{(1)} = \Delta \gc^{(0)} + \gc^{(0)} = 9 \unit{mm}
\]</span> with the new resisting (spring) force <span class="math display">\[
\resistforce^{(1)} = \left.(10 \sqrt{q})\right|_{\gc^{(1)}} = 30 \unit{N}
\]</span> Repeating the steps above will lead to the following results: <span class="math display">\[\begin{align*}
\gc^{(1)}  &amp; = 9 \unit{mm}, \quad  \resistforce^{(1)} = 30 \unit{N}, \quad \residual^{(1)} = 20 \unit{N}, \quad \bar{k}_t^{(1)} = \ratio{5}{3} \unit{N / mm}, \quad \Delta \gc^{(1)} = 12 \unit{mm} \\
\gc^{(2)}  &amp; = 21 \unit{mm}, \quad  \resistforce^{(2)} = 45.83 \unit{N}, \quad \residual^{(2)} = 4.17 \unit{N}, \quad \bar{k}_t^{(2)} = 2.45 \unit{N / mm}, \quad \Delta \gc^{(2)} = 1.70 \unit{mm} \\
\gc^{(3)}  &amp; = 22.70 \unit{mm}, \quad  \resistforce^{(3)} = 47.64 \unit{N}, \quad \residual^{(3)} = 2.36 \unit{N}, \quad \bar{k}_t^{(3)} = 1.05 \unit{N / mm}, \quad \Delta \gc^{(3)} = 2.25 \unit{mm} \\
\gc^{(4)}  &amp; = 24.95 \unit{mm}, \quad  \resistforce^{(4)} = 49.95 \unit{N}, \quad \residual^{(4)} = 0.05 \unit{N}, \quad \bar{k}_t^{(4)} = 1.00 \unit{N / mm}, \quad \Delta \gc^{(4)} = 0.05 \unit{mm} \\
\gc^{(5)}  &amp; = 25 \unit{mm}, \quad  \resistforce^{(5)} = 50 \unit{N}, \quad \residual^{(5)} = 0 \unit{N}
\end{align*}\]</span> With the residual falling to zero, we may safely stop the iterations and identify the solution as <span class="math inline">\(25 \unit{mm}\)</span>, which happens to coincide with the exact solution. In more realistic problems we would have to accept some small error to avoid excessive number of iterations in order to save on computations.</p>
</section>
<section id="newmark-with-newton-rhapson" class="level4" data-number="4.7.2.2">
<h4 data-number="4.7.2.2" data-anchor-id="newmark-with-newton-rhapson"><span class="header-section-number">4.7.2.2</span> Newmark with Newton-Rhapson</h4>
<p>Now that we have established the procedure for solving nonlinear equilibrium equations, we can proceed with formulating Newmark’s algorithm for nonlinear systems. For simplicity, we consider here an SDOF system with a nonlinear spring force, with equation of motion given by <a href="#eq-nlsdofeomfb">Equation&nbsp;<span>4.26</span></a>. The discretized form of this equation for time step <span class="math inline">\((j+1)\)</span> will be given by <span id="eq-nlnewmarkeom"><span class="math display">\[
m \dsct{\ddgc}{j+1} + c \dsct{\dgc}{j+1} + \dsct{\left\{\stifforce (\gc) \right\}}{j+1} = \dsct{\extforce}{j+1}
\qquad(4.34)\]</span></span> No matter what the spring force looks like, Newmark’s approximations for the velocity and acceleration, given by <a href="#eq-newmarkbrev">Equation&nbsp;<span>4.20</span></a>, remain the same. Therefore the velocity and acceleration estimates <span class="math inline">\(\dsct{\gc}{j+1}\)</span> and <span class="math inline">\(\dsct{\dgc}{j+1}\)</span> will be given by<br>
<span id="eq-nlnewmarkvelacc"><span class="math display">\[
\begin{array}{rcl}
\dsct{\dgc}{j+1} &amp; \!\!\! = &amp; \!\!\! \ratio{1}{2\beta \tstep} \dsct{\gc}{j+1} - \ratio{1}{2\beta \tstep} \dsct{\gc}{j} + \left(1 - \ratio{1}{2 \beta} \right) \dsct{\dgc}{j} + \left(1 - \ratio{1}{4 \beta} \right) \tstep \dsct{\ddgc}{j} \\
\dsct{\ddgc}{j+1} &amp; \!\!\! = &amp; \!\!\! \ratio{1}{\beta \tstep^2} \dsct{\gc}{j+1} - \ratio{1}{\beta \tstep^2} \dsct{\gc}{j} - \ratio{1}{\beta \tstep}  \dsct{\dgc}{j} + \left(1 - \ratio{1}{2 \beta} \right) \dsct{\ddgc}{j}
\end{array}
\qquad(4.35)\]</span></span> With these estimates, the equilibrium equation in <a href="#eq-nlnewmarkeom">Equation&nbsp;<span>4.34</span></a> may be written as <span class="math display">\[\begin{align*}
m \dsct{\ddgc}{j+1} &amp; +  c \dsct{\dgc}{j+1} + \dsct{\left\{\stifforce (\gc)\right\}}{j+1} = \\
&amp; m \left[ \ratio{1}{\beta \tstep^2} \dsct{\gc}{j+1} - \ratio{1}{\beta \tstep^2} \dsct{\gc}{j} - \ratio{1}{\beta \tstep}  \dsct{\dgc}{j} + \left(1 - \ratio{1}{2 \beta} \right) \dsct{\ddgc}{j} \right] \\
&amp; \phantom{XX} + c \left[ \ratio{1}{2\beta \tstep} \dsct{\gc}{j+1} - \ratio{1}{2\beta \tstep} \dsct{\gc}{j} + \left(1 - \ratio{1}{2 \beta} \right) \dsct{\dgc}{j} + \left(1 - \ratio{1}{4 \beta} \right)\tstep \dsct{\ddgc}{j} \right] \\
&amp; \phantom{XXX} + \dsct{\left\{\stifforce (\gc)\right\}}{j+1} = \dsct{\extforce}{j+1}
\end{align*}\]</span> The coefficients may be grouped together to obtain<br>
<span id="eq-newmarkfinnl"><span class="math display">\[
A_1 \dsct{\gc}{j+1} =  \dsct{\extforce}{j+1} + A_1  \dsct{\gc}{j} + A_2  \dsct{\dgc}{j}+ A_3  \dsct{\ddgc}{j} - \dsct{\left\{\stifforce (\gc) \right\}}{j+1}
\qquad(4.36)\]</span></span> where <span id="eq-newmarkainl"><span class="math display">\[
\begin{array}{c}
A_1 = \ratio{m}{\beta \tstep^2} + \ratio{c}{2 \beta \tstep}, \quad A_2 = \ratio{m}{\beta \tstep} + {c}\left(\ratio{1}{2 \beta} - 1 \right), \\
\quad A_3 = m \left(\ratio{1}{2 \beta} -1 \right) + c \tstep \left(\ratio{1}{4 \beta} - 1 \right)
\end{array}
\qquad(4.37)\]</span></span> This equation is very similar to the equation we tried to solve while discussing the static load application in that we have <span class="math display">\[
\underbrace{A_1 \dsct{\gc}{j+1} + \dsct{\left\{\stifforce (\gc) \right\}}{j+1}}_{\text{like $\resistforce$ of the static case}} =  \underbrace{\dsct{\extforce}{j+1} + A_1  \dsct{\gc}{j} + A_2  \dsct{\dgc}{j}+ A_3  \dsct{\ddgc}{j}}_{\text{like $\sforce$ of the static case}}
\]</span> and the question is whether or not the equality holds. Most probably it will not, and we will have to iteratively solve for the value of <span class="math inline">\(\dsct{\gc}{j+1}\)</span> which will balance the equation, and in a dynamic progession we will have to do this for each time step separately.</p>
<p>For implementation details, consider that we have solved the state for all time steps until <span class="math inline">\(j\)</span>, so that <span class="math inline">\(\dsct{\gc}{j}\)</span>, <span class="math inline">\(\dsct{\dgc}{j}\)</span> and <span class="math inline">\(\dsct{\ddgc}{j}\)</span> are all known, along with all values of the excitation. Within time step <span class="math inline">\(j+1\)</span>, we may be in iteration <span class="math inline">\(p\)</span>, for which we check whether the equation <span class="math display">\[
A_1 \dsct{\gc^{(p)}}{j+1} + \dsct{\left\{\stifforce (\gc) \right\}^{(p)}}{j+1} =  \dsct{\extforce}{j+1} + A_1  \dsct{\gc}{j} + A_2  \dsct{\dgc}{j}+ A_3  \dsct{\ddgc}{j}
\]</span> is satisfied (within some eror tolerance). If it is, then we set <span class="math display">\[
\dsct{\gc}{j+1} = \dsct{\gc^{(p)}}{j+1}
\]</span> and calculate the velocity and the acceleration for time step <span class="math inline">\(j+1\)</span> via <a href="#eq-nlnewmarkvelacc">Equation&nbsp;<span>4.35</span></a>. If it is not satisfied, however, we need to update our estimate, for which we first calculate <span class="math display">\[
\begin{array}{c}
\resistforce^{(p)} = A_1 \dsct{\gc}{j+1}^{(p)} + \dsct{\left\{\stifforce (\gc) \right\}^{(p)}}{j+1} \\
\residual^{(p)} = \left(\dsct{\extforce}{j+1} + A_1  \dsct{\gc}{j} + A_2  \dsct{\dgc}{j}+ A_3  \dsct{\ddgc}{j}\right) - \resistforce^{(p)}\\
\bar{k}_t^{(p)} = \left. \pardiv {\resistforce}{\gc} \right|_{\dsct{\gc^{(p)}}{j+1}} = A_1 + \left. \pardiv {\stifforce}{\gc} \right|_{\dsct{\gc^{(p)}}{j+1}} = A_1 + k_t^{(p)}
\end{array}
\]</span> where <span class="math inline">\(k_t^{(p)} = \left({\partial \stifforce}/{\partial \gc}) \right|_{\dsct{\gc^{(p)}}{j+1}}\)</span> is the <em>tangent stiffness</em>, which is the contribution of the actual physical stiffness terms to the equivalent tangent stiffness. The state step is to be determined via <span class="math display">\[
\Delta \dsct{\gc^{(p)}}{j+1} = \ratio{\residual^{(p)}}{\bar{k}_t^{(p)}}
\]</span> and the new estimate for the generalized displacement is given by <span class="math display">\[
\dsct{\gc^{(p+1)}}{j+1} = \dsct{\gc^{(p)}}{j+1} + \Delta \dsct{\gc^{(p)}}{j+1}
\]</span> and use this new estimate to calculate <span class="math inline">\(\dsct{\left\{\stifforce (\gc) \right\}^{(p)}}{j+1}\)</span> and the other quantities involved. We check if another update is necessary, by either checking <span class="math display">\[
\residual^{(p+1)}  \leq \text{force tolerance}
\]</span> or <span class="math display">\[
\dsct{\gc^{(p+1)}}{j+1} - \dsct{\gc^{(p+1)}}{j} \leq \text{state tolerance}
\]</span> and decide whether to proceed with further updates. Say that iteration <span class="math inline">\(p*\)</span> is the iteration at which we have satisfied the error condition, with the final value calculated given by <span class="math inline">\(\dsct{\gc^{(p*)}}{j+1}\)</span>. Then we set <span class="math display">\[
\dsct{\gc}{j+1} = \dsct{\gc^{(p*)}}{j+1}
\]</span> using which we calculate the velocity and acceleration for time step <span class="math inline">\(j+1\)</span> via <a href="#eq-nlnewmarkvelacc">Equation&nbsp;<span>4.35</span></a>, and move on to the next time step. The algorithm is summarized in <a href="#fig-algnewmark">Figure&nbsp;<span>4.23</span></a>. <!-- 
The nonlinear spring force $\stifforce$ in this case appears on the right hand side of the equation and depends on $\dsct{\gc}{j+1}$. Thus, @eq-newmarkfinnl must  be iteratively solved consistently for the pairing of $\dsct{\gc}{j+1}$ and $\dsct{\left\{\stifforce (\gc) \right\}}{j+1}$ that satisfies the equality at each time step. If we adopt the Newton-Raphson scheme presented previously, we can define the residual (error) of the spring force at each iteration step $j$ as: 
$$
   \dsct{ (\residual)}{j+1}^{(j)} =  \dsct{\extforce}{j+1} + A_1  \dsct{\gc}{j} + A_2  \dsct{\dgc}{j}+ A_3  \dsct{\ddgc}{j} - \dsct{\left\{\stifforce (\gc) \right\}}{j+1}^{(j)} - A_1 \dsct{\gc}{j+1}^{(j)}
$$

As in the static Newton-Raphson iteration, a Taylor expansion of the displacement dependent terms can be used to compute the incremental displacement at step $p+1$ as: 
$$\delta \gc ^{(j)} = \frac{(\residual)^{(j)}} {{\bar{k}_t^{(j)}}+A_1}$$ 

Following this, the displacement is given as: 
$$\dsct{ \gc}{j+1}^{(j+1)} = \dsct{ \gc}{j+1}^{(j)} + \delta \gc ^{(j)} $$

Here, the term $A_1$ comes from the Taylor expansion of the spring force where dynamical terms are coming into play.  

Once the $\dsct{\gc}{j+1}$ is iteratively determined, the $\dsct{\dgc}{j+1}$ and $\dsct{\ddgc}{j+1}$ are given as: 
$$\dsct{\dgc}{j+1} = A_4 (\dsct{\gc}{j+1} - \dsct{\gc}{j} ) + A_5 \dsct{\dgc}{j} + A_6 \dsct{\ddgc}{j}$$
$$\dsct{\ddgc}{j+1} = A_7 (\dsct{\gc}{j+1} - \dsct{\gc}{j}) + A_8 \dsct{\dgc}{j} + A_5 \dsct{\ddgc}{j}$$ --></p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Pseudocode for Newmark’s Method - Non-linear Spring (Newmark-<span class="math inline">\(\beta\)</span>)</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>viscously damped SDOF system with non-linear spring, for constant time step</em></p>
<p><strong>Input</strong>: <span class="math inline">\(m\)</span>, <span class="math inline">\(\damp\)</span> (or <span class="math inline">\(c\)</span>), <span class="math inline">\(\stifforce(q)\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\tstep\)</span>, <span class="math inline">\(\dsct{\gc}{0}\)</span>, <span class="math inline">\(\dsct{\dgc}{0}\)</span>, <span class="math inline">\(\left\{\dsct{\extforce}{0}, \ldots, \dsct{\extforce}{l} \right\}\)</span>, tolerance(s)</p>
<p><strong>Initialize</strong>: calculate</p>
<p><span class="math inline">\(\phantom{xxxx}\)</span> <span class="math inline">\(A_1 = \frac{m}{\beta \tstep^2} + \frac{c}{2 \beta \tstep}\)</span>, <span class="math inline">\(A_2 = \frac{m}{\beta \tstep} + {c}\left(\frac{1}{2 \beta} - 1 \right)\)</span>,</p>
<p><span class="math inline">\(\phantom{xxxx}\)</span> <span class="math inline">\(A_3 = m \left(\frac{1}{2 \beta} -1 \right) + c \tstep \left(\frac{1}{4 \beta} - 1 \right)\)</span>,</p>
<p><span class="math inline">\(\phantom{xxxx}\)</span> <span class="math inline">\(A_4=\frac{1}{2\beta \tstep}\)</span>, <span class="math inline">\(A_5 = 1 - \frac{1}{2\beta}\)</span>, <span class="math inline">\(A_6 = \tstep \left(1 - \frac{1}{4 \beta}\right)\)</span>,</p>
<p><span class="math inline">\(\phantom{xxxx}\)</span> <span class="math inline">\(A_7= \frac{1}{\beta \tstep^2}\)</span>, <span class="math inline">\(A_8 = - \frac{1}{\beta \tstep}\)</span>,</p>
<p><span class="math inline">\(\phantom{xxxx}\)</span> <span class="math inline">\(\dsct{\ddgc}{0} = \frac{1}{m}(\dsct{\extforce}{0} - c \dsct{\dgc}{0} - \stifforce(\dsct{\gc}{0}))\)</span></p>
<p><strong>for time steps</strong> <span class="math inline">\(j=0,\ldots,l-1\)</span>:</p>
<p><span class="math inline">\(\phantom{xxxx}\)</span> <strong>Initialize</strong>: set <span class="math inline">\(\dsct{\gc^{(0)}}{j+1} = \dsct{\gc}{j}\)</span></p>
<p><span class="math inline">\(\phantom{xxxx}\)</span> <span class="math inline">\(\sforce_{j+1} = \dsct{\extforce}{j+1} + A_1 \dsct{\gc}{j} + A_2 \dsct{\dgc}{j}+ A_3 \dsct{\ddgc}{j}\)</span></p>
<p><span class="math inline">\(\phantom{XXXXXXX}\)</span> <strong>for state step</strong> <span class="math inline">\(p=0,\ldots\)</span> convergence:</p>
<p><span class="math inline">\(\phantom{XXXXXXXXXX}\)</span> <span class="math inline">\(\stifforce^{(p)} = \stifforce (\gc)\biggr|_{\dsct{\gc^{(p)}}{j+1}}\)</span></p>
<p><span class="math inline">\(\phantom{XXXXXXXXXX}\)</span> <span class="math inline">\(\resistforce^{(p)} = \stifforce^{(p)} + A_1 \dsct{\gc}{j+1}^{(p)}\)</span></p>
<p><span class="math inline">\(\phantom{XXXXXXXXXX}\)</span> <span class="math inline">\(\residual^{(p)} = \sforce_{j+1} - \resistforce^{(p)}\)</span></p>
<p><span class="math inline">\(\phantom{XXXXXXXXXX}\)</span> <span class="math inline">\(\bar{k}^{(p)}_t = A_1 + \left. \pardiv {\stifforce}{\gc} \right|_{\dsct{\gc^{(p)}}{j+1}}\)</span></p>
<p><span class="math inline">\(\phantom{XXXXXXXXXX}\)</span> <span class="math inline">\(\Delta \gc ^{(p)} = \frac{\residual^{(p)}} {\bar{k}_t^{(p)}}\)</span></p>
<p><span class="math inline">\(\phantom{XXXXXXXXXX}\)</span> <span class="math inline">\(\dsct{\gc}{j+1}^{(p+1)} = \dsct{\gc}{j+1}^{(p)} + \Delta \gc ^{(p)}\)</span></p>
<p><span class="math inline">\(\phantom{XXXXXXXXXX}\)</span> if tolerance(s) satisfied, set <span class="math inline">\(\dsct{\gc}{j+1} = \dsct{\gc}{j+1}^{(p+1)}\)</span></p>
<p><span class="math inline">\(\phantom{xxxx}\)</span> Compute velocity and accelerations:</p>
<p><span class="math inline">\(\phantom{xxxx}\)</span> <span class="math inline">\(\dsct{\dgc}{j+1} = A_4 (\dsct{\gc}{j+1} - \dsct{\gc}{j} ) + A_5 \dsct{\dgc}{j} + A_6 \dsct{\ddgc}{j}\)</span></p>
<p><span class="math inline">\(\phantom{xxxx}\)</span> <span class="math inline">\(\dsct{\ddgc}{j+1} = A_7 (\dsct{\gc}{j+1} - \dsct{\gc}{j}) + A_8 \dsct{\dgc}{j} + A_5 \dsct{\ddgc}{j}\)</span></p>
</div>
</div>
<div id="fig-algnewmark" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blank.png" class="img-fluid figure-img" style="width:0.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.23: Pseudocode for Newmark’s method with nonlinear spring force.</figcaption><p></p>
</figure>
</div>
</section>
<section id="sec-sdofnum7" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="sec-sdofnum7">EXAMPLE 4 .7</h4>
<p>Consider a SDF system with <span class="math inline">\(m=10000 \unit{kg}\)</span> and <span class="math inline">\(\damp = 0.02\)</span>. The restoring force-deformation relation is elastoplastic with stiffness <span class="math inline">\(k=200 \unit{kN/m}\)</span> before yield and yield force <span class="math inline">\(f_Y=18 \unit{kN}\)</span>. The system is subjected to a sinosoidal force excitation given as <span class="math inline">\(f=10\mathrm{sin}(\pi t) \unit{kN}\)</span>. Determine the response of this system (starting from rest) within <span class="math inline">\(0 \leq t \leq 5.0\unit{sec}\)</span> using the Central Difference Method and Newmark-<span class="math inline">\(\beta\)</span> constant and linear acceleration methods, with <span class="math inline">\(h=0.1\unit{sec}\)</span>. Compare the results.</p>
<p>The comparison of the response computed using Newmark-<span class="math inline">\(\beta\)</span> method (with <span class="math inline">\(\beta = 1/4\)</span> and <span class="math inline">\(\beta = 1/6\)</span> ) are shown in <a href="#fig-NLcompare">Figure&nbsp;<span>4.24</span></a>. It can be seen that the various methods give rise to small but noticable differences in the response calculation, which can have an effect on the peak response quantities obtained from the time histories obtained using different integration methods. In general, these differences may become more prominent with greater nonlinearities and coarser time step choices.</p>
<!-- ```{python}
#| eval: false
import numpy as np
import matplotlib.pyplot as plt
#plt.rcParams['figure.dpi'] = 200

from google.colab import files

h = 0.1 # Time step for discretization
tn = 5 # Total time of analysis

# excitation
fo = 10000 # Amplitude of the excitation in N
w = np.pi # Frequency of the pulse
t = np.arange(0,tn+h,h)
f = fo*np.sin(w*t) # excitation at every timestep

## system properties
m = 10000 # mass in kg
k = 200000 # stiffness in N/m
fy = 18000 # yielding force in N
zeta = 0.02 # Damping ratio
wn = (k/m)**0.5 # frequency in rad/s
wd = wn*(1-zeta**2)**0.5 # damped natural frequency
Tn = 2*np.pi/wn # Natural period
c = 2*zeta*m*wn # damping coeff

######## Numerical Solution #############
beta1 = 1/4 # constant average acceleration method (vectors q_c, qd_c and qdd_c)
beta2 = 1/6 # # linear acceleration method (vectors q_l, qd_l and qdd_l)

def newmark_NR(beta):
    # allocation
    q = 0*t
    qd = 0*t
    qdd = 0*t
    fs = 0*t
    kT = 0*t
    P = 0*t
    # Initial calculations
    A1 = m/(beta*h**2) + c/(2*beta*h)
    A2 = m/(beta*h) + (1/(2*beta)-1)*c
    A3 = (1/(2*beta)-1)*m + h*(1/(4*beta)-1)*c
    A4 = 1/(2*beta*h)
    A5 = 1-1/(2*beta)
    A6 = h*(1-1/(4*beta))
    A7 = 1/(beta*h**2)
    A8 = -1/(beta*h)

    fs[0] = 0 # state determination
    kT[0] = k # state determination
    qdd[0] = (f[0]-c*qd[0]-fs[0])/m

    maxiter = 10000 # max number of steps of NR
    tolerance = 1e-3 # tolerance for NR

    ######################## Time Integration #######################
    for ii in range(len(t)-1):

        # allocation of arrays at time step ii (we use __i to differentiate it from __)
        dfsi = np.zeros(maxiter)
        fsi = np.zeros(maxiter)
        qi = np.zeros(maxiter)
        kTi = np.zeros(maxiter)
        dqi = np.zeros(maxiter)
        # initialization for NR
        qi[0] = q[ii]
        fsi[0] = fs[ii]
        kTi[0] = kT[ii]

        P[ii+1] = f[ii+1] +A1*q[ii] +A2*qd[ii] +A3*qdd[ii]

        # use Newton-Raphson method to calculate next step's q, fs, kT
        for jj in range(maxiter-1):
            dfsi[jj] = P[ii+1] -fsi[jj] -A1*qi[jj]
            if np.abs(dfsi[jj]) > tolerance:
                dqi[jj] = dfsi[jj]/(kTi[jj] +A1)
                qi[jj+1] = qi[jj] + dqi[jj]
                temp = fs[ii] +k*(qi[jj+1]-q[ii])
                if temp > fy:
                    fsi[jj+1] = fy
                    kTi[jj+1] = 0
                elif temp < -fy:
                    fsi[jj+1] = -fy
                    kT[jj+1] = 0
                else:
                    fsi[jj+1] = temp
                    kTi[jj+1] = k
            else:
                q[ii+1] = qi[jj]
                fs[ii+1] = fsi[jj]
                kT[ii+1] = kTi[jj]
                break

        # update qd, qdd
        qd[ii+1] = A4*(q[ii+1]-q[ii]) + A5*qd[ii] + A6*qdd[ii]
        qdd[ii+1]= A7*(q[ii+1]-q[ii]) + A8*qd[ii] + A5*qdd[ii]

    return q, qd, qdd, fs, kT


def CDM():
    # allocation
    q = 0*t
    qd = 0*t
    qdd = 0*t
    fs = 0*t
    kT = 0*t

    # Initial calculations
    A1 = m/(h**2) + c/(2*h)
    A2 = m/(h**2) - c/(2*h)
    A3 = 1/(2*h)
    A4 = 1/(h**2)

    fs[0] = 0 # state determination
    kT[0] = k # state determination
    fs[0] = k*q[0]
    qdd[0] = (f[0]-c*qd[0]-fs[0])/m
    qneg1 = q[0] -h*qd[0] -h**2/2*qdd[0]

    ######################## Time Integration #######################

    # step at ii=0
    q[1] = (f[0]-fs[0]-A2*qneg1)/A1
    temp = fs[0] + k*(q[1]-q[0])
    # update fs and kT
    if temp > fy:
        fs[1] = fy
        kT[1] = 0
    elif temp < -fy:
        fs[1] = -fy
        kT[1] = 0
    else:
        fs[1] = temp
        kT[1] = k

    # step at ii>0
    for ii in range(1, len(t)-1):
        # update qd, qdd
        q[ii+1] = (f[ii]-fs[ii]-A2*q[ii-1] +2*m*A4*q[ii])/A1
        qd[ii] = A3*(q[ii+1]-q[ii-1])
        qdd[ii]= A4*(q[ii+1]-2*q[ii]+q[ii-1])

        # update fs and kT
        temp = fs[ii] + k*(q[ii+1]-q[ii])
        if temp > fy:
            fs[ii+1] = fy
            kT[ii+1] = 0
        elif temp < -fy:
            fs[ii+1] = -fy
            kT[ii+1] = 0
        else:
            fs[ii+1] = temp
            kT[ii+1] = k
    return q, qd, qdd, fs, kT

q_c, qd_c, qdd_c, fs_c, kT_c = newmark_NR(beta1) # Constant Average Acceleration
q_l, qd_l, qdd_l, fs_l, kT_l = newmark_NR(beta2) # Linear Acceleration
q_CDM, qd_CDM, qdd_CDM, fs_CDM, kT_CDM = CDM() # Central Difference Method

################# Plot #################
fig = plt.figure(figsize=[8,9])
ax = [0,0,0]
# plot displacement
ax[0] = fig.add_subplot(3,1,1)
ax[0].plot(t, 100*q_c, label=f'Newmark $\\beta={beta1:.2f}$')
ax[0].plot(t, 100*q_l, '--', label=f'Newmark $\\beta={beta2:.2f}$')
ax[0].plot(t, 100*q_CDM, '-.', label=f'CDM')
#ax[0].set_xlabel("Time (sec)")
ax[0].set_ylabel("Displacement (cm)")
ax[0].set_xlim(0,5)
# plot velocity
ax[1] = fig.add_subplot(3,1,2)
ax[1].plot(t, 100*qd_c, label=f'Newmark $\\beta={beta1:.2f}$')
ax[1].plot(t, 100*qd_l, '--', label=f'Newmark $\\beta={beta2:.2f}$')
ax[1].plot(t[:-1], 100*qd_CDM[:-1], '-.', label=f'CDM') # note the last qd, qdd haven't been calculated in the for loop
#ax[1].set_xlabel("Time (sec)")
ax[1].set_ylabel("Velocity (cm/sec)")
ax[1].set_xlim(0,5)
# plor fs
ax[2] = fig.add_subplot(3,1,3)
ax[2].plot(t, fs_c/1000, label=f'Newmark $\\beta={beta1:.2f}$')
ax[2].plot(t, fs_l/1000, '--', label=f'Newmark $\\beta={beta2:.2f}$')
ax[2].plot(t, fs_CDM/1000, '-.', label=f'CMD')
ax[2].set_xlabel("Time (sec)")
ax[2].set_ylabel("fs (kN)")
ax[2].set_xlim(0,5)

ax[0].legend(loc='upper right')
ax[1].legend(loc='upper right')
ax[2].legend(loc='upper right')
plt.savefig("plots.eps")
files.download("plots.eps")
``` -->
<div id="fig-NLcompare" class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/NLcompare2.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.24: Comparison of central Difference Method (CDM) and Newmark - <span class="math inline">\(\beta\)</span> algorithms for Ex. 4 .7 displacement, velocity, and nonlinear spring force time histories. The Python scripts used to calculate the response can be found <a href="https://colab.research.google.com/drive/1juK7v9bjCyhf35asXtsscqxl40W-M6Dw?usp=sharing">here</a>.</figcaption><p></p>
</figure>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./singledofforced.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forced Vibrations of Single Degree of Freedom Systems</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./eqsdof.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Seismic Analysis of Single Degree of Freedom Systems</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Structural Dynamics",
    "section": "",
    "text": "Preface\nThis textbook represents our effort to make freely available to students and practitioners the theory and common applications of structural dynamics. The presentation is hoped to inspire interest and active learning. The book’s content is expected to evolve and expand in time so we truly welcome suggestions from readers and colleagues.\nTo make available in a timely manner, the first upload/edition has been limited topics that could be covered in a senior level undergraduate or an introductory level graduate course in a single semester. Given the vastness of the theory and practical details, such a compromise was inevitable. On the other hand we hope that by continuing to expand the contents at certain intervals the material will eventually cover a very significant portion of the relevant literature and current practices. This living nature of the electronic medium was what motivated us to undertake this project to begin with.\nWe thank Northwestern University Libraries for their interest in this textbook, and we express our gratitude to Xinyan Yang for her help in solving many problems we encountered along the way.\nThis textbook is published by Northwestern University Libraries, with funding from Northwestern University’s Affordable Instructional Resources initiative.\nCopyright © 2024 Hilmi Luş and Sinan Keten. Licensed Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC-BY-NC-SA 4.0).\nPreferred attribution: Luş, H., and Keten, S. 2024. Structural Dynamics. Northwestern University Libraries."
  },
  {
    "objectID": "fundamentals.html#sec-Basic_Definitions",
    "href": "fundamentals.html#sec-Basic_Definitions",
    "title": "1  Fundamentals of Dynamics",
    "section": "1.1 Basic Definitions",
    "text": "1.1 Basic Definitions\nThe fundamental framework that will be used throughout will be Newtonian and there are certain a priori concepts in this framework that we generally take for granted.\nIn classical mechanics, motion of a body is geometrically described by the positions (locations) of its constituents in \\(\\mem{space}\\), and the variation of these positions in \\(\\mem{time}\\). The existence of space and time as two independent, ‘absolute’ entities are accepted without proof; these are intuitive concepts that lay the foundations for all that is to follow, as the geometric description of motion depends solely on these two concepts.\nTo define the position of an object, we need a reliable reference, for instance a stationary set of rigid “rulers” against which to measure distances, and a clock with which to measure time. Such a combination is called a \\(\\mem{frame of reference}\\). The acceptance of space and time as absolute quantities is equivalent to assuming the existence of at least one \\(\\mem{inertial frame of reference}\\) in which the laws of motion as stated by Newton are valid. In fact, any reference frame that is in a state of pure translation with constant velocity relative to this initial, absolute(ly standing still) frame would serve equally well as an inertial frame of reference. The key here is to use a non-accelerating (with respect to the ‘absolute’ space) frame of reference. Motion on a curved line, even with constant speed, and rotations lead to centripetal accelerations and hence reference frames undergoing such motions will generally not serve as inertial frames.\nBut then again, the earth, of course, is one such rotating and translating frame. So how come we use it, as we do in most earthbound dynamical analysis in engineering, as our frame of reference? The answer to this may not be given a priori but the validity of the choice must be evaluated a posteriori. It may be said that for many earthbound problems that involve distances and time spans comparable to those we commonly encounter in our everyday experiences, treating the earth as an inertial frame does not lead to significant errors, at least not significant enough to have any impact on the predictions deduced. We accept to err but we hope it is inconsequential. Hoping to err less, we can take into account the earth’s rotation about its polar axis, then expand further to take into account the earth’s rotation around the sun, then expand further to include the motion of the whole solar system in the milky way, then expand … How far one should go will depend on the specific problem studied. Unless otherwise explicitly stated, we will assume that the reference frames we use in our discussions are inertial (or may be treated as such for the particular problem at hand).\n\\(\\mem{Mass}\\) is another prior that we take for granted based on our experiences with weight. One definition of mass is to say that it is a measure of a body’s resistance to motion. This definition does implicitly refer to Newton’s equation of motion - force is equal to mass times acceleration - but it serves to hint at a difference between what are called gravitational mass and inertial mass. No difference between these two have been detected experimentally and so mass as far as we are concerned will be the quantity of matter that we can measure through its weight.\nA fundamental idealization of dynamics is that of a \\(\\mem{particle}\\), a geometric point, devoid of size but endowed with mass. The fundamental Newtonian law governing the motion of a particle is the well known (more on this later) \\[\n\\fvec = \\totm \\avec\n\\] with \\(\\totm\\) denoting the mass of the particle, \\(\\avec\\) denoting its acceleration, and \\(\\fvec\\) denoting the resultant force acting on the particle. Please note that this is a vector equation, with underlined miniscule roman letters denoting vectors and italic miniscule roman letters denoting scalar variables. This is a convention we will adhere to throughout the text.\nA body may be defined as a collection of particles. Legitimate objections are raised against this definition challenging the coherency of extending a geometrically non-dimensional entity to a geometrically finite dimensional system, and it may be preferred to define a body through a continuous medium to address this issue. If the distances between the particles are constant throughout the motion, or in other words if there is no deformation in the body, then the model is called a \\(\\mem{rigid body}\\). The rigid body is another fundamental idealization of dynamics, used in the analysis of many problems. The main advantage brought about by this idealization is the significant reduction in the number of variables required to describe motion. Whenever deformations may be estimated to be negligible compared with the size of the body and such deformations have very limited impact on the motion of the whole, the body may be idealized as rigid to analyze its overall motion."
  },
  {
    "objectID": "fundamentals.html#sec-dof",
    "href": "fundamentals.html#sec-dof",
    "title": "1  Fundamentals of Dynamics",
    "section": "1.2 Degree of Freedom",
    "text": "1.2 Degree of Freedom\nWe define the \\(\\mem{degree of freedom}\\) of a system to be the number of independent ways a system may move; equivalently, it is the dimension of the system’s configuration space. Mechanical systems may translate and rotate. A particle unconstrained in any way has three degrees of freedom as it can, for example, translate independently along the three coordinate axes of a rectangular coordinate system. Consider now two particles, connected by an inextensible rod: even though one needs 6 coordinates to locate both particles, these coordinates are not all independent since the inextensible rod will always make sure that the distance between the particles will not change, and so the particles may not move independently. In this case, then, the system of two particles will have a smaller number of degrees of freedom. A constraint is any kinematic relationship that prescribes limitations on the motion of the system or any of its parts; the inextensibility of the rod in the two particle system, enforcing that the distance between the particles remains constant, is a constraint. Such constraints may be in the form of algebraic equations, in which case they are called holonomic, or they may be in differential, non-integrable forms, in which case they are called non-holonomic. We limit all our discussions to holonomic systems.\n\\(\\mem{Generalized coordinates}\\) are the specific variables that are used to describe the motion; accordingly, any kinematic quantity pertaining to a system (such as the position, velocity and/or acceleration of any point in the system) may be expressed as functions of the generalized coordinates (and their derivatives) chosen to model that system. The choice of generalized coordinates for a specific system is not unique and different sets of variables may serve equally well to formulate the system’s dynamics. The term generalized is historically used to note that these variables do not necessarily have to be directly associated with a coordinate basis. For any system with holonomic constraints one can always find a set of independent generalized coordinates, as many as the degree of freedom of the system, to describe all of kinematics.\n\n\n\nFigure 1.1: Particle constrained to move on a circle lying on the \\(xy\\)-plane.\n\n\nTo elucidate these definitions, consider, for example, a particle constrained to move on a circular path as shown in Figure 1.1. Assume that the circular path’s center is located at \\((x=0,y=0,z=0)\\) so that the path lies on the \\(xy\\)-plane. Then at any time \\(t\\) the particle is constrained to move on the \\(xy\\)-plane so that: \\[\nz(t) = 0 \\qquad \\forall t\n\\] This is a constraint equation. The second constraint equation for this particle would have to specify that it is moving on a circular path of radius \\(R\\): \\[\nx^2(t) + y^2(t)= R^2 \\qquad \\forall t\n\\] What remains is essentially just one degree of freedom (the particle may only rotate about the \\(z\\)-axis while it remains in the \\(xy\\)-plane), and the particle’s position can be located with only one generalized coordinate. For example, if one knows the value of \\(x(t)\\) at some time \\(t\\) then the other two rectangular coordinates may be calculated via the constraint equations as \\(z(t)=0\\) and \\(y(t) = \\pm \\sqrt{R^2 - x^2(t)}\\) (the sign is surprisingly not trivial but we’ll not dwell on it). One could easily well choose \\(y(t)\\) as the independent variable and treat the others as dependent. Better yet, one could define the angle \\(0 \\leq \\theta(t) &lt; 2\\pi\\) between the line \\(op\\) and the \\(x\\)-axis as the generalized coordinate, so that knowing \\(\\theta(t)\\) one can locate wherever the particle is on the circle. In any case, for the single particle system of this example, its degree of freedom is \\[\n3 - (\\text{number of constraint equations}) = 3 - 2 = 1\n\\] If the system comprises \\(n_p\\) particles and there are \\(b\\) many constraint equations, then the degree of freedom \\(N\\) of the system is given by \\[\nN = 3n_p - b\n\\]\n\n\n\nFigure 1.2: A rigid body constrained to move on the \\(xy\\)-plane.\n\n\nIt may be shown that an unconstrained rigid body has \\(6\\) degrees of freedom. Generally the motion is described through translations of a single point, most often the center of mass which we will denote by \\(\\com\\), and three rotations of the rigid body about that point. If the rigid body is constrained so that its motion is planar1, as seen in Figure 1.2, then at most 3 degrees of freedom are possible. The location of all points on such a rigid body may be determined by tracking the translation of one point on it and the body’s rotation about the axis perpendicular to the plane in which that translation takes place.\nIn holonomic systems use of the phrases ‘generalized coordinate’ and ‘degree of freedom’ tend to intertwine such that ‘degree of freedom’ is sometimes used to refer to a specific generalized coordinate and the phrase ‘number of degrees of freedom’ is used to signify our original definition of degree of freedom. We’ll try to maintain the distinction but say that a system has \\(N\\) degrees of freedom (that it is an \\(N\\)-DOF system), if \\(N\\) independent variables suffice to completely describe the configuration of the system, and we will need \\(N\\) generalized coordinates to model the dynamics. To emphasize the independence of the generalized coordinates from specific coordinate systems, it is customary to denote a generalized coordinate by the letter \\(\\gc\\). Employing this symbolism and based on the terminology elaborated above, if, in this text, a system is said to have \\(N\\)-DOFs, then its dynamics will be governed by the \\(N\\) generalized coordinates \\[\n\\gc_1(t), \\gc_2(t), \\ldots, \\gc_N(t)\n\\]"
  },
  {
    "objectID": "fundamentals.html#footnotes",
    "href": "fundamentals.html#footnotes",
    "title": "1  Fundamentals of Dynamics",
    "section": "",
    "text": "At the risk of repeating ourselves, we must emphasize that these derivations implicitly assume that all horizontal motion is so small as to be completely negligible, which would be possible only for small vertical motions. If it were not so, the position vectors and their time derivatives would have to be modified, and the resulting equations would be nonlinear. So please note that the discussion here is strictly limited to small amplitude vertical motion.↩︎\nWe could argue that since no external forces are present in the horizontal direction and since we are neglecting all horizontal accelerations by restricting vertical motion to small amplitudes, the horizontal reaction forces will be zero. It may be so in this case, but it would be somewhat easy to err in such arguments, and a more rigorous demonstration should be preferred unless we are absolutely sure.↩︎\nNote that these results are not unique in the sense that adding or subtracting any multiple of Equation \\(\\ref{eq:Axg}\\) to the right side of the equations would not change the values of the reaction forces.↩︎"
  },
  {
    "objectID": "fundamentals.html#sec-Fundamental_Laws",
    "href": "fundamentals.html#sec-Fundamental_Laws",
    "title": "1  Fundamentals of Dynamics",
    "section": "1.3 Fundamental Laws",
    "text": "1.3 Fundamental Laws\nFormulating the governing equations of motion for any system in classical mechanics is possible through a few different formulations and principles that may be shown to be equivalent. Throughout this text we will employ the Newton-Euler formulation, the virtual work formulation with d’Alembert’s principle, and/or the Lagrangian formulation. In this section we will present the fundamental issues without going into the details of the derivations for which the reader may consult various books on classical mechanics.2 It is important to note that the differences that will strike the reader are more procedural than essential in that all formulations will lead to identical (possibly up to a linear transformation) equations of motion for a given system. The choice of which method to use in the context of a specific problem is generally a matter of ease of application, personal experience and preference.\n\n1.3.1 Newton-Euler Formulation\nIt is only natural to start with this formulation since historically Newton3 is the first scientist to have formulated some laws of motion, still used today, in a rigorous, mathematical manner and apply them for the solution of various problems. These laws as stated by Newton read as follows:\n\n\nEvery body perseveres in its state of rest, or of uniform motion in a right line, unless it is compelled to change that state by forces impressed thereon.\nThe alteration of motion is ever proportional to the motive force impressed; and is made in the direction of the right line in which that force is impressed.\nTo every action there is always opposed an equal reaction: or the mutual actions of two bodies upon each other are always equal, and directed to contrary parts.\n\nIt is generally accepted that by body, Newton implies a particle or a finite sized body that could be treated as a particle; by motion, what we currently call (linear) momentum, i.e. the product of mass with velocity.\nThe first law is essentially a statement about the existence of an inertial frame in which the second law is applicable, and defines uniform motion (motion with a constant velocity along a straight line) as a state equivalent to that of rest.\nThe second law, in modern vectorial notation, postulates \\[\n\\fvec = \\divt{\\linmom} = \\divt{(\\totm \\vvec)}  = \\totm \\avec\n\\qquad(1.1)\\] where the last equality follows for closed systems in which there is no mass transfer in and out of the system boundaries so that \\(\\totm\\) is constant in time. We have introduced the notation \\(\\linmom = \\totm \\vvec\\) to denote the linear momentum of a particle and we will use the same notation when we are talking about the linear momentum of a system comprising more than one particle. It is important to emphasize again that the velocity \\(\\vvec\\) of the particle is measured in an inertial frame, as is its acceleration \\(\\avec\\); otherwise, this law does not hold in its current form.\nThe third law states that when two particles interact, they do so through a pair of forces, equal in magnitude but opposite in direction, acting along the central line hypothetically connecting the two particles; its validity is generally accepted unless the velocities considered are so large that the velocity of propagation of interaction may have to be taken into account. In structural dynamics we assume this law is always valid.\nThe generalization of the laws of particles to bodies of finite sizes is generally attributed to Euler, who discussed governing equations of motion of rigid bodies in various works starting in the 1750s4 until the middle of the 1770s5. To somewhat economize on the notation, let us denote time derivatives by dots placed over the variables so that \\(\\pdivt{\\upsilon}\\) denotes the first derivative in an inertial frame, with respect to time, of some variable \\({\\upsilon}\\), and \\(\\pddivt{\\upsilon}\\) denotes its second derivative. In modern language, the laws governing the dynamics of a closed system of particles, including rigid bodies, may be expressed as follows:\n\n\n: The time derivative of the linear momentum of a system of particles is equal to the net resultant force of all the external forces acting on the particles composing the system. In a closed system with total mass \\(\\totm\\), this law may be stated as: \\[\n\\dlinmom = \\fvec = \\totm \\avec_{\\com}\n\\qquad(1.2)\\] where \\(\\avec_{\\com}\\) is the acceleration of the center of mass of the system and the last equality will be demonstrated below.\n: The time derivative of the angular momentum of a system of particles, with respect to a stationary point \\(o\\) or the center of mass of the system \\(\\com\\), is equal to the resultant moment at the same point all the external forces acting on the system: \\[\n\\dangmom{o} = \\moment{o} \\quad \\text{or} \\quad \\dangmom{\\com} = \\moment{\\com}\n\\qquad(1.3)\\] where \\(\\dangmom{o}\\) and \\(\\dangmom{\\com}\\) are the angular momenta of the system about points \\(o\\) and \\(\\com\\), respectively, and \\(\\moment{o}\\) and \\(\\moment{\\com}\\) are the resultant moments of the external forces and couples at the same points.\n\nThere are many details involved in applying these principles to a specific system but it may be best to define some of the quantities specified in these laws through illustration.\nConsider the rigid body \\(\\RB{B}\\) shown in Figure 1.3.6 An arbitrary point on the rigid body, having an infinitesimal mass \\(\\dm\\), is located at position \\(\\pvec\\) at some time \\(t\\), relative to a stationary observer in an inertial frame of reference. The linear momentum of this infinitesimal piece is defined as \\(\\vvec \\dm\\), where \\(\\vvec = \\pdivt{\\pvec}\\) is the (absolute) velocity of \\(\\dm\\) in the inertial frame. The linear momentum of the whole body is then defined as the sum (integral) of the linear momenta of all the infinitesimal masses:\n\\[\n\\linmom \\equiv \\int_{\\RB{B}} \\vvec \\dm\n\\qquad(1.4)\\]\nThe center of mass of a system of particles turns out to be a significant point of reference. The location of the center of mass of the rigid body \\(\\RB{B}\\) relative to a point, say in this case the stationary point \\(o\\), is defined through \\[\n    \\pvec_{\\com} \\equiv \\frac{\\int_{\\RB{B}} \\pvec \\dm}{\\int_{\\RB{B}} \\dm} = \\frac{\\int_{\\RB{B}} \\pvec \\dm}{\\totm}  \n\\qquad(1.5)\\] where \\(\\totm\\) is the mass of the whole body. For a closed system with no mass transfer and constant mass, the direct time derivative of this expression may be used to define the velocity and acceleration of the center of mass in the inertial frame of reference as \\[\n    \\vvec_{\\com}=\\frac{\\int_{\\RB{B}} \\vvec \\dm}{\\totm}, \\qquad   \\avec_{\\com}=\\frac{\\int_{\\RB{B}} \\avec \\dm}{\\totm}\n\\qquad(1.6)\\] where \\(\\avec\\) is the acceleration of the infinitesimal mass \\(\\dm\\) in the inertial frame. With these definitions, the linear momentum of the whole body may be shown to be equal to \\[\n\\linmom = \\int_{\\RB{B}} \\vvec \\dm = \\totm \\vvec_{\\com}\n\\qquad(1.7)\\] and that its time derivative in the inertial frame may be shown, using Newton’s second and third laws, to yield, \\[\n\\dlinmom = \\totm \\avec_{\\com} = \\fvec\n\\qquad(1.8)\\] where \\(\\fvec\\) is the force resultant of all the external forces. The principle of linear momentum for a rigid body therefore boils down to the analysis of a single hypothetical particle, of mass equal to the total mass of the rigid body, which is located at the center of mass of the body and onto which acts the force resultant of all the external forces that act on whole rigid body.\n\n\n\nFigure 1.3: An arbitrary rigid body.\n\n\nAngular momentum is defined as the “moment of momentum”. The angular momentum of the infinitesimal mass \\(\\dm\\), relative to a stationary point \\(o\\), is therefore defined as \\(\\pvec \\times \\vvec \\dm\\), and the angular momentum of the whole body is given by \\[\n    \\angmom{o} \\equiv \\int_{\\RB{B}} \\pvec \\times \\vvec \\dm\n\\qquad(1.9)\\] It may be shown, using Newton’s second and third laws, that the time derivative of the angular momentum in the inertial frame yields \\[\n    \\dangmom{o} = \\moment{o}\n\\qquad(1.10)\\] where \\(\\moment{o}\\) is the resultant moment, at point \\(o\\), of all the external forces and couples.7 It turns out that even though \\(\\com\\) is in general non-stationary, the principle of angular momentum leads to analogous results when \\(\\com\\) is taken as the reference point. If the position of the infinitesimal mass \\(\\dm\\) relative to \\(\\com\\) is denoted by \\(\\prelcom\\), then the angular momentum of the rigid body with respect to its center of mass may be defined in two equivalent ways as \\[\n    \\angmom{\\com} = \\int_{\\RB{B}} \\prelcom \\vprod \\vvec \\dm = \\int_{\\RB{B}} \\prelcom \\vprod \\vrelcom \\dm\n\\qquad(1.11)\\] where the last equality is not immediate but may quickly be arrived at through the definition of the center or mass.8 It may be shown that the time derivative, in the inertial frame, of the angular momentum with respect to the center of mass leads to a result analogous to Equation 1.10: \\[\n\\dangmom{\\com} = \\moment{\\com}\n\\qquad(1.12)\\]\nFor general three dimensional motion of a rigid body, the principle of angular momentum will in general lead to nonlinear first order differential equations in angular velocities. For the simpler case of two dimensional motion, however, the equations simplify significantly: it may be shown that for a two dimensional rigid body motion that takes place in some plane with normal \\(\\widehat{\\vctr{n}}\\), the principle of angular momentum leads, through Equation 1.10 or Equation 1.12, to a relationship of the form \\[\n    \\smoment_{o} \\widehat{\\vctr{n}} = \\inertia{o} \\dtangvel \\widehat{\\vctr{n}} \\qquad \\mathrm{or} \\qquad \\smoment_{\\com} \\widehat{\\vctr{n}} = \\inertia{\\com} \\dtangvel \\widehat{\\vctr{n}}\n\\qquad(1.13)\\] where \\(\\inertia{o}\\) and \\(\\inertia{\\com}\\) are moments of inertia9 of the body, with respect to the axes perpendicular to the plane at points \\(o\\) and \\(\\com\\), respectively, \\(\\angvel\\) is the angular velocity (rate of rotation) of the body, and its time derivative \\(\\dtangvel\\) is the body’s angular acceleration.\nTo present an application of this formulation, let us work on deriving the equation of motion of a pendulum made of a rigid, homogeneous bar, as shown in Figure 1.4(a). The bar has mass per unit length \\(\\mlen\\) and total mass \\(m=\\mlen \\ell\\). It is pinned to a stationary point \\(o\\) (in an inertial frame) and is acted upon by gravity \\(\\gravity\\) along the vertical direction, directed downward. This is a single degree of freedom since essentially the only thing that the whole body may do is rotate about point \\(o\\); therefore, knowing, for example, the angle \\(\\gc\\) the bar makes with the vertical, it is possible to locate all the points in the body and hence define its configuration. Let us choose this angle \\(\\gc\\) as our generalized coordinate and formulate the equation of motion of the bar in terms of this variable.\n\n\n\nFigure 1.4: A homogeneous bar pinned to an inertial frame.\n\n\nOne of the fundamental steps in the analysis of dynamical problems is the sketch of appropriate free body diagrams, which is an isolated sketch of the body, from which all geometric constraints are removed but the constraint forces are shown, along with all other external forces and geometrical dimensions. There is, however, a difference in the analysis of most systems in static equilibrium and the analysis of systems moving. When analyzing static equilibrium problems in structural mechanics, especially those focusing on linear elastic systems, the free body diagrams are often sketched assuming that the systems retain their initial configuration.10 The premise is that when displacements remain comparatively very small, it may be assumed that the difference between the deformed and the undeformed configurations will be negligible, and that equilibrium analysis may be conducted using the undeformed configuration. When motion is analyzed, however, the free body diagram must necessarily be sketched for a displaced and deformed configuration such that all forces that act on the system, some of which may be caused or modified by the motion itself, may be observed. We generally consider an instant such that the the generalized coordinates and their time derivatives have non-zero, positive values to ensure consistency in algebraic signs of variables.\nThe free body diagram of our bar is shown in Figure 1.4(b). Included in this figure are the unit vectors we will employ in our formulations, \\(\\vctr{n}\\) and \\(\\vctr{t}\\), which are attached to the bar and hence are moving with it.11 With the third unit vector \\(\\zuvec\\) defined through \\(\\zuvec = \\vctr{n} \\vprod \\vctr{t}\\), we have a right handed orthogonal vector basis, with the angular velocity expressed as \\(\\angvelvec = \\omega \\pvctr{k}\\).\nSince this is a single degree of freedom system, all kinematic quantities should be expressible in terms of \\(\\gc\\). The center of mass of the bar will be located at the middle of the bar since the bar is homogeneous, and its acceleration may be derived as \\[\\begin{align*}\n\\pvec_{\\com} & = \\frac{\\ell}{2} \\pvctr{n} \\\\\n\\vvec_{\\com} & = \\frac{\\ell}{2}  \\pdivt{\\pvctr{n}} = \\frac{\\ell}{2}  (\\angvelvec \\vprod \\pvctr{n}) = \\frac{\\ell}{2} \\dgc \\pvctr{t} \\\\\n\\avec_{\\com} & = \\frac{\\ell}{2} \\ddgc \\pvctr{t}  + \\frac{\\ell}{2} \\dgc \\pdivt{\\pvctr{t}} = \\frac{\\ell}{2} \\ddgc \\pvctr{t} + \\frac{\\ell}{2}\\dgc (\\angvelvec \\vprod \\vctr{t}) = - \\frac{\\ell}{2} \\dgc^2 \\pvctr{n} + \\frac{\\ell}{2} \\ddgc \\pvctr{t}\n\\end{align*}\\] The principle of linear momentum for this system may now be expressed as \\[\nm \\avec_{\\com} = - m \\frac{\\ell}{2} \\dgc^2 \\pvctr{n} + m \\frac{\\ell}{2} \\ddgc \\pvctr{t}\n= \\fvec = ( m \\gravity \\cos \\gc -R_{n})\\pvctr{n} + (R_{t} - m \\gravity \\sin \\gc) \\pvctr{t}\n\\qquad(1.14)\\] These two equations, one for each direction, include three unknowns: \\(R_{n}\\), \\(R_{t}\\) and \\(\\gc\\). A third equation may be obtained via the principle of angular momentum. To apply this principle to the system at hand, we may either try to evaluate the time derivative of the angular momentum from basic principles, or use previously derived results regarding moments of inertia. To go over the steps involved, let us choose the first option and try to find out the angular momentum of the system relative to the stationary point \\(o\\). The infinitesimal segment \\(\\dm = \\mlen \\diff s\\) shown in Figure 1.4(c), located at \\(\\pvec = s \\pvctr{n}\\) relative to \\(o\\), has velocity \\(\\vvec = s \\dgc \\pvctr{t}\\) so that its angular momentum is given by \\[\n\\pvec \\vprod \\vvec \\dm = s^2 \\dgc (\\vctr{n} \\vprod \\vctr{t}) \\dm = s^2 \\dgc \\mlen \\diff s \\zuvec\n\\] When integrated over the whole bar, the angular momentum of the system about point \\(o\\) will be obtained as \\[\n\\angmom{o} = \\int \\pvec \\vprod \\vvec \\dm = \\int_{0}^{\\ell} s^2 \\dgc \\mlen \\diff s \\zuvec = \\frac{\\mlen \\ell^3}{3} \\dgc \\zuvec = \\frac{m \\ell^2}{3} \\dgc \\zuvec\n\\qquad(1.15)\\] Noting that the unit vector \\(\\zuvec\\) maintains its magnitude (unit vector by definition) and direction at all times, the time derivative of the angular momentum yields \\[\n\\dangmom{o} = \\frac{m \\ell^2}{3} \\ddgc \\zuvec\n\\qquad(1.16)\\] and the principle of angular momentum gives \\[\n\\dangmom{o} = \\moment{o} \\quad \\rightarrow \\quad \\frac{m \\ell^2}{3} \\ddgc \\zuvec = - \\frac{\\ell}{2} m \\gravity \\sin \\gc  \\zuvec\n\\qquad(1.17)\\] so that the equation of motion governing the time evolution of \\(\\gc\\) is found to be \\[\n\\frac{m \\ell^2}{3} \\ddgc =  - \\frac{\\ell}{2} m \\gravity \\sin \\gc \\quad \\rightarrow \\quad \\ddgc + \\frac{3 \\gravity}{2 \\ell} \\sin \\gc = 0\n\\qquad(1.18)\\] Point \\(o\\) was a somewhat obvious choice to refer to since the unknown reaction forces \\(R_{n}\\) and \\(R_{t}\\) do not contribute to the resultant moment at \\(o\\) and hence an equation addressing only \\(\\gc\\) is constructed directly.\nThe Newton-Euler approach and the other methods that we will discuss differ mainly in this initial step, i.e. constructing the governing equation of motion. The solution procedure is likely to proceed as follows: the governing equation of motion, \\[\n\\ddgc + \\frac{3 \\gravity}{2 \\ell} \\sin \\gc = 0\n\\qquad(1.19)\\] will have to be solved to find \\(\\gc (t)\\). As this is a second order nonlinear differential equation, its solution is not trivial. On the other hand, if the motion takes place in the vicinity of the equilibrium configuration so that \\(\\gc\\) and \\(\\dgc\\) remain relatively small, then \\(\\sin \\gc\\) may be approximated by \\(\\sin \\gc \\approx \\gc\\), and the linearized equation of motion will be obtained as \\[\n\\ddgc + \\frac{3 \\gravity}{2 \\ell} \\gc = 0\n\\qquad(1.20)\\] Once \\(\\gc (t)\\) is obtained, the unknown reaction forces may be calculated via the principle of linear momentum.\n\n\n\n\nsee, for example, H. Goldstein’s Classical Mechanics, first published in 1950 by Addison-Wesley Publishing Company, or D.T. Greenwoods’s Classical Dynamics, first published by Prentice-Hall in 1997.↩︎\nI. Newton, Philosophiae Naturalis Principia Mathematica, or simply the Principia as it has come to be known. The original, published in 1687, is in Latin and here we will be quoting from its translation by A. Motte, specifically the version published in 1846 in New York by D. Adee.↩︎\nL. Euler, “Découverte d’un nouveau principe de mécanique.” Mémoires de l’académie des sciences de Berlin, Vol. 6, pp. 185-217, 1752.↩︎\nL. Euler, L, “Nova Methodus Motum Corporum Rigidorum Determinandi.” Novi Commentarii Academiae Scientiarum Petropolitanae, Vol. 20, pp. 208-238, 1776.↩︎\nTo minimize the details, we just discuss the expressions that pertain to rigid bodies. Most of the results discussed, in particular the fundamental laws, are valid for systems comprising discrete particle masses, with summations over all the particles replacing the integrals pertaining to rigid bodies.↩︎\nNote that moment of a momentum (angular momentum) or a force will depend on the point with respect to which it is calculated. The angular momentum of a particle with respect to some point is in general not equal to its angular momentum with respect to some other point. This is not the case for linear momentum in that a particle will have a unique linear momentum in a given inertial frame.↩︎\nAs \\(\\vrelcom\\) is essentially the relative velocity of \\(\\dm\\) with respect to \\(\\com\\) in the inertial frame, the last integral is sometimes referred to as the relative angular momentum. The difference may be important for an arbitrary reference point but for the center of mass the two integrals in Equation 1.11 yield the same result.↩︎\nRecall that the moment of inertia of a body \\(\\RB{B}\\) with respect to some axis is defined as \\(\\inrt \\equiv \\int_{\\RB{B}} r^2 \\dm\\) where \\(r\\) is the distance between the axis and \\(\\dm\\).↩︎\nSome systems do in fact require that deformed configuration be considered in static analysis as well but structural analysis of many systems do indeed consider small deformations and deformation gradients so that force equilibrium is established in the undeformed configuration.↩︎\nWhen unit vectors are rotating in an inertial frame, their time derivatives are non-zero since their direction changes. If \\(\\vctr{u}\\) is such a unit vector which is rotating with angular velocity $ $ in an inertial frame, then its time derivative in that frame is given by \\(\\pdivt{\\vctr{u}} =\\angvelvec \\vprod \\vctr{u}\\).↩︎\n\n\n\n1.3.2 \\(\\mathrm{d}\\)’Alembert’s Principle and Virtual Work\nEven though it is within the realm of the Newton-Euler formulations, d’Alembert’s principle has proven to be quite a useful rephrasing, especially for those well trained in static analysis. There are slightly different variations of the statement and here we phrase it in the form most conducive to static analysis tools: If one considers a hypothetical force to act on a particle, acting in opposite direction to the particle’s acceleration and with magnitude equal to the product of the particle’s mass with its acceleration, then the particle would be in static equilibrium instantaneously under the joint action of this hypothetical force and all the external forces acting on it.\nFor a single particle, this statement amounts to saying \\[\n\\fvec - m \\avec = \\zerovec\n\\qquad(1.21)\\] where it seems the only thing we have done is to move the right hand side of Equation 1.1 to the left of the equality sign. While it may be so, the emphasis is not on the algebra but rather on the treatment of the problem.\nThe real benefit of this rephrasing will generally be more pronounced for systems of rigid bodies. For ease of reference, let us call the aforementioned hypothetical force the d’Alembert force. When the corresponding d’Alembert forces are acted on at each point in a system of particles or even a rigid body, each particle, and consequently the whole system, will instantaneously be in a state of static equilibrium. It may be shown that when these forces are taken into account, one can write the following equations for the instantaneous static equilibrium of a two dimensional rigid body: \\[\n    \\fvec - \\totm \\avec_{\\com} = \\zerovec, \\qquad \\begin{array}{c} \\smoment_{o} - \\inertia{o}  \\dtangvel = 0 \\\\ \\text{or} \\\\ \\smoment_{\\com} - \\inertia{\\com} \\dtangvel = 0 \\end{array}\n\\qquad(1.22)\\] The term \\(- \\totm \\avec_{\\com}\\) is the force resultant and \\(- \\inertia{o} \\dtangvel\\) is the moment resultant, at point \\(o\\), of all the d’Alembert forces that should be acting on the system; similarly, \\(- \\inertia{\\com} \\dtangvel\\) is their moment resultant at point \\(\\com\\).\n\n\n\nFigure 1.5: Accelerations and d’Alembert forces on the rigid bar pendulum.\n\n\nLet us go back to the pendulum example, sketched again in Figure 1.5. The acceleration of the infinitesimal piece of mass \\(\\dm\\), located at a distance of \\(s\\) to the stationary point \\(o\\) is given by12\n\\[\n\\avec = -s \\dgc^2 \\vctr{n} + s \\ddgc \\vctr{t}\n\\] and the components are shown in Figure 1.5 (a). For each of these infinitesimal segments, we could add the corresponding d’Alembert forces so that each segment may be considered to be instantaneously in static equilibrium. When all the d’Alembert forces are included in the free body diagram, as shown in Figure 1.5 (b), the whole system may now be considered to be in static equilibrium at the instant considered. The d’Alembert forces shown with dotted lines and arrows are distributed loads per unit length, acting in the directions indicated by the arrows. Therefore we now have, from static equilibrium equations, \\[\n\\sum \\sforce_{t} = 0  \\quad \\rightarrow \\quad     R_{t} - \\frac{1}{2} (\\mlen\\ell\\ddgc)(\\ell) - m \\gravity \\sin \\gc = 0\n\\qquad(1.23)\\] \\[\n\\sum \\sforce_{n} = 0  \\quad \\rightarrow \\quad     R_{n} - \\frac{1}{2} (\\mlen\\ell\\dgc^2)(\\ell) - m \\gravity \\cos \\gc = 0\n\\qquad(1.24)\\] \\[\n\\sum \\smoment_{o} = 0 \\quad \\rightarrow \\quad  - \\frac{\\ell}{2} m \\gravity \\sin \\gc  - \\frac{2 \\ell}{3}\\frac{1}{2} (\\mlen\\ell\\ddgc)(\\ell)= 0\n\\qquad(1.25)\\] which leads, after some rearranging, to the following equation of motion for \\(\\gc\\): \\[\n\\ddgc - \\frac{3}{2} \\frac{\\gravity}{\\ell} \\sin \\gc  = 0\n\\qquad(1.26)\\] It must be noted that this equation is identical to Equation 1.19. \nd’Alembert’s principle finds its full potential when virtual work is used in complex systems usually involving multiple degrees of freedom. In order to focus on the general principle we will define and briefly present the application of the virtual work approach to the simple pendulum problem we have been studying, but there will be ample opportunities to revisit the principle in latter chapters.\nIn modern language, the \\(\\rem{principle of virtual work}\\) states that if a system is in static equilibrium, then the internal virtual work that would be done by the system, if it were to go through some virtual displacements and deformations consistent with the imposed constraints, would have to be equal to the work done by the external forces as the system moves through such displacements and deformations. This statement is more appropriately called the principle of virtual displacements; there is also an alternative statement of virtual work in which the forces rather than the displacements are fictitious. Since we want to emphasize the concept of work, we will refer to the more general principle of virtual work.13\nTo apply the principle of virtual work to our rigid bar pendulum, we must consider a virtual variation in the generalized coordinate \\(\\gc\\). Let us denote this virtual variation as \\(\\vgc\\), as shown in Figure 1.6. Since the inclusion of d’Alembert forces allows us to treat the dynamic problem as an equivalent static problem, the principal of virtual work leads to \\[\n\\vwork_{int} = \\vwork_{ext}\n\\qquad(1.27)\\] where \\(\\vwork_{int}\\) is the virtual work done by the internal forces during the virtual displacement \\(\\vgc\\), and \\(\\vwork_{ext}\\) is the external forces during the same virtual displacement.\n\n\n\nFigure 1.6: The bar going through virtual displacement \\(\\vgc\\).\n\n\nSince the bar is rigid and there is no deformation in any of the components during the virtual displacement, the internal virtual work is zero for the system., i.e. \\(\\vwork_{int} = 0\\). As for the external virtual work, the only external forces that will do work during the virtual displacement are the tangential d’Alembert forces and the tangential component of the weight. The reaction forces \\(R_{n}\\) and \\(R_{t}\\) do no work since no displacement results at the point of application of these forces during the virtual displacement: this is a direct consequence of our choice of imposing virtual displacements consistent with the kinematic constraints. The d’Alembert forces along the radial direction will do no work either since the displacements that will occur, due to the virtual displacement \\(\\vgc\\), at the points of application of these forces will be perpendicular to the forces; the same is true for the radial component of the weight of the bar. Since the single force resultant of the triangular distribution of tangential d’Alembert forces is given by \\(\\mlen \\ell^2 \\ddgc / 2 = m\\ell \\ddgc / 2\\) and this resultant acts at a distance \\(2\\ell/3\\) to the center of rotation, as shown in Figure 1.6 (b), the virtual work done by the external forces as the bar goes through \\(\\vgc\\) is given by \\[\n\\vwork_{ext} = - (m \\gravity \\sin \\gc)\\left(\\frac{\\ell}{2} \\vgc \\right) - \\left(\\frac{m\\ell \\ddgc}{2} \\right)\\left(\\frac{2\\ell}{3} \\vgc \\right)\n\\] where we have assumed \\(\\vgc\\) is small enough so the paths travelled by the points of application of the forces involved, which would be circular arcs for large values of \\(\\vgc\\), may be approximated by straight lines of the tangents, given by \\(\\ell \\vgc /2\\) and \\(2 \\ell \\vgc /3\\). The principal of virtual work for this system therefore leads to \\[\n\\vwork_{ext} = - \\left(m \\gravity \\frac{\\ell}{2} \\sin \\gc + m\\frac{\\ell^2}{3} \\ddgc \\right) \\vgc  = 0\n\\] and since this result must be valid for arbitrary values of \\(\\vgc\\), the term in the parentheses must be zero, leading to \\[\nm\\frac{\\ell^2}{3} \\ddgc + m \\gravity \\frac{\\ell}{2} \\sin \\gc = 0 \\quad \\rightarrow \\quad  \\ddgc + \\frac{3 \\gravity}{2 \\ell} \\sin \\gc = 0\n\\] The final equation is, of course, identical to the ones previously derived through alternative methods.\n\n\n\n\nOne can start with the position vector \\(\\pvec = s \\vctr{n}\\), take its time derivative to get to the velocity as \\(\\vvec = \\pdivt{\\pvec} = s \\pdivt{\\vctr{n}} = s (\\angvelvec \\vprod \\vctr{n}) = s \\dgc \\vctr{t}\\), and then take the time derivative of the velocity to get \\(\\avec = \\pdivt{\\vvec} = s \\ddgc \\vctr{t} + s \\dgc \\pdivt{t} = -s \\dgc^2 \\vctr{n} + s \\ddgc \\vctr{t}\\). Note that the time derivative of \\(s\\) is zero on virtue of the body being rigid so that the distance between any two points on the body does not change with time.↩︎\n“Virtual,” because this is essentially a thought experiment; these displacements and deformations do not actually take place in some finite time as real displacements do, they are assumed to hypothetically take place with time frozen at some instant. Although not absolutely necessary, the virtual displacements and deformations are generally taken to be (very) “small” so that the geometry is not highly deformed during these deformations, and the variations in the force field do not alter conditions of equilibrium.↩︎\n\n\n\n1.3.3 Lagrange’s Equations\nLagrange14 is credited for transforming mechanics from the realm of geometry to the realm of analysis in his seminal work ‘Analytical Mechanics’ published almost exactly after one hundred years from the Principia. His equations of motion, referred to as Lagrange’s equations, may be derived via virtual work and d’Alembert’s principle, as well as the principle of least action. In this section we will not provide the derivation of these famous equations but will just aim to highlight the fundamental issues and equations.\nAt the heart of Lagrangian formulation is the concept of energy. Let us assume that a (holonomic) system has \\(N\\)-DOFs, with its kinematics defined by generalized coordinates \\(\\gc_{1}, \\gc_{2}, \\ldots, \\gc_{N}\\). The kinetic energy \\(\\ke\\) of the system will in general be an explicit function of these generalized coordinates as well as their time derivatives, called the generalized velocities, and possibly also of time: \\[\n\\ke = \\ke(\\gc_{1}, \\gc_{2}, \\ldots, \\gc_{N}, \\dgc_{1}, \\dgc_{2}, \\ldots, \\dgc_{N}, t)\n\\] The forces that act on the system are generally classified as those that may be derived from a potential, i.e. conservative forces, and those that may not, i.e. non-conservative forces. The potential \\(\\pe\\) of the conservative forces will in general will be an explicit function of the generalize coordinates and possibly also of time: \\[\n\\pe = \\pe(\\gc_{1}, \\gc_{2}, \\ldots, \\gc_{N}, t)\n\\] If there are no non-conservative forces acting on the system, then Lagrange’s equations may be expressed in the following form: \\[\n\\frac{\\diff}{\\diff t} \\left(\\frac{\\partial \\ke}{\\partial \\dgc_{i}}\\right) - \\frac{\\partial \\ke}{\\partial \\gc_{i}} + \\frac{\\partial \\pe}{\\partial \\gc_{i}} = 0 \\qquad \\text{for} \\quad i=1,2,\\ldots,N\n\\qquad(1.28)\\] Note that these represent \\(N\\) equations, one for each generalized coordinate \\(i=1,2,\\ldots,N\\), but each equation may contain all the other generalized coordinates as well so that the resulting equations are in general coupled.\nIf there are non-conservative forces as well, then the equations in Equation 1.28 will have to be modified. Let \\(\\vwnc\\) denote the work done by the non-conservative forces during virtual displacements \\(\\vgc_{1}, \\vgc_{2}, \\ldots, \\vgc_{N}\\). In a holonomic system this work will be a simple linear function of the virtual displacements that may be expressed as \\[\n\\vwnc = \\vforce_{1} \\vgc_{1} + \\vforce_{2} \\vgc_{2} + \\ldots + \\vforce_{N} \\vgc_{N}\n\\] where the coefficients of the virtual displacements, \\(\\vforce_{i}\\), are called generalized forces. It may be shown that in this case, Lagrange’s equations will be of the form:15 \\[\n\\frac{\\diff}{\\diff t} \\left(\\frac{\\partial \\ke}{\\partial \\dgc_{i}}\\right) - \\frac{\\partial \\ke}{\\partial \\gc_{i}} + \\frac{\\partial \\pe}{\\partial \\gc_{i}} = \\vforce_{i} \\qquad \\text{for} \\quad i=1,2,\\ldots,N\n\\qquad(1.29)\\]\nFinally, using the Lagrangian \\(\\lagrangian\\), defined conventionally as \\(\\lagrangian = \\ke - \\pe\\), the equations may also be expressed as \\[\n\\frac{\\diff}{\\diff t} \\left(\\frac{\\partial \\lagrangian}{\\partial \\dgc_{i}}\\right) - \\frac{\\partial \\lagrangian}{\\partial \\gc_{i}} = \\vforce_{i} \\qquad \\text{for} \\quad i=1,2,\\ldots,N\n\\qquad(1.30)\\] since \\(\\pe\\) is not a function of the generalized velocities \\(\\dgc_{i}\\).\nBefore discussing further details, let us apply this approach to the rigid bar pendulum we have been studying. Consider the sketch shown in Figure 1.7. The velocity of an infinitesimal segment of the bar, located at a distance \\(s\\) to the center of rotation \\(o\\), is given by \\(\\vvec = s \\dgc \\pvctr{t}\\). The kinetic energy of this segment will then be equal to \\(\\frac{1}{2}(\\vvec \\sprod \\vvec) \\dm = \\frac{1}{2}(\\vvec \\sprod \\vvec) \\mlen \\diff s\\). The kinetic energy of the whole bar is calculated by summing the contributions of all the segments that make up the bar so that \\[\n\\ke = \\int_{0}^{\\ell} \\frac{1}{2}(\\vvec \\sprod \\vvec) \\mlen \\diff s = \\int_{0}^{\\ell} \\frac{\\mlen}{2} \\dgc^2 s^2 \\diff s =  \\frac{m\\ell^2}{6} \\dgc^2\n\\] As for the potential energy, we first note that the conservative force acting on the system is the weight. Let us assume that the potential energy of the system when \\(\\gc = 0\\) is some unknown value \\(\\pe_o\\); there is always the possibility that the system possesses some potential even if it is not moving but this initial value would have to be independent of the generalized coordinates. As the bar moves, the center of mass, which we assume to coincide with the center of gravity when the variations in the gravitational field may be neglected, rises by an amount of \\((\\frac{\\ell}{2} - \\frac{\\ell}{2}\\cos \\gc)\\), and so the potential energy of the system at some arbitrary instant is given by: \\[\n\\pe = \\pe_o + m \\gravity \\left(\\frac{\\ell}{2} - \\frac{\\ell}{2}\\cos \\gc\\right)\n\\]\n\n\n\nFigure 1.7: Rigid bar pendulum revisited.\n\n\nNote that there are no non-conservative forces acting except perhaps the constraint forces, i.e. the support reactions \\(R_{n}\\) and \\(R_{t}\\). One of the characteristics of the Lagrangian approach is that such constraint forces never do work through any virtual displacements so that constraint forces never contribute to the generalized forces. Therefore we may simply use the form of the Lagrange’s equations given by Equation 1.28 for this system. Evaluating the individual terms yields \\[\n\\frac{\\partial \\ke}{\\partial \\dgc} = \\frac{m\\ell^2}{3} \\dgc, \\quad \\frac{\\diff}{\\diff t}\\left(\\frac{\\partial \\ke}{\\partial \\dgc}\\right) = \\frac{m\\ell^2}{3} \\ddgc, \\quad \\frac{\\partial \\ke}{\\partial \\gc} =0, \\quad \\frac{\\partial \\pe}{\\partial \\gc} = \\frac{m \\gravity \\ell}{2} \\sin \\gc\n\\] so that Equation 1.28 leads to: \\[\n\\frac{m\\ell^2}{3} \\ddgc + \\frac{m \\gravity \\ell}{2} \\sin \\gc = 0 \\quad \\rightarrow \\quad \\ddgc + \\frac{3 \\gravity}{2\\ell} \\sin \\gc = 0\n\\]\nWhen working with rigid bodies, it may not be necessary to calculate the kinetic energy from basic principles. In fact, it may be shown that the kinetic energy of a rigid body may be expressed as \\[\n\\ke = \\frac{1}{2} \\totm (\\vvec_{\\com} \\sprod \\vvec_{\\com}) + \\frac{1}{2} \\angmom{\\com} \\sprod \\angvelvec\n\\qquad(1.31)\\] where \\(\\totm\\) is the total mass of the body, \\(\\vvec_{\\com}\\) is the velocity of the body’s center of mass, \\(\\angmom{\\com}\\) is the body’s angular momentum about its center of mass, and \\(\\angvelvec\\) is its angular velocity. When the body is planar, as for example we may assume a floor plate to be, with planar dimensions much bigger than the depth and the plate moving in that plane, the kinetic energy expression will simplify to \\[\n\\ke = \\frac{1}{2} \\totm \\vel_{\\com}^2  + \\frac{1}{2} \\inertia{\\com} \\angvel^2\n\\qquad(1.32)\\] where \\(\\vel_{\\com}\\) is the speed with which the center of mass moves, \\(\\inertia{\\com}\\) is the moment of inertia of the body about the axis perpendicular to the plane of motion and passing through point \\(\\com\\), and \\(\\angvel\\) is the angular speed. Finally, if the planar body is simply rotating in a plane about a fixed point \\(o\\), then the kinetic energy expression further simplifies to \\[\n\\ke =  \\frac{1}{2} \\inertia{o} \\angvel^2\n\\qquad(1.33)\\] where \\(\\inertia{o}\\) is the moment of inertia of the body about the axis perpendicular to the plane of motion and passing through point \\(o\\). Since the moments of inertia of most regularly shaped homogeneous bodies are tabulated in many references, the use of these expressions may be most beneficial. For example, if we look up the moment of inertia of a homogeneous rod, of length \\(\\ell\\) and total mass \\(\\totm\\), about a perpendicular axis passing through one of its ends, we’ll see that it is given by \\(\\inertia{o} = \\totm \\ell^2 / 3\\). Since the angular speed of our rigid bar pendulum is \\(\\omega = \\dgc\\), use of Equation 1.33 for our rigid bar pendulum will simply lead to \\[\n\\ke =  \\frac{1}{2} \\inertia{o} \\angvel^2 = \\frac{m \\ell^2}{6} \\dgc^2\n\\]\n\n\n\n\nJ.L. Lagrange, Mécanique Analytique, 1788. A famous quote from his preface to the first edition is: “No figures will be found in this work. The methods I present require neither constructions nor geometrical or mechanical arguments, but solely algebraic operations subject to a regular and uniform procedure.” We quote from the English translation by A. Boissonnade and V.N. Vagliente, 1997.↩︎\nGeneralized force are not necessarily actual forces; if the generalized coordinate is a rotation, for example, the generalized force will have units of moment.↩︎\n\n\n\n1.3.4 Constraint Forces\nThe preceding presentation is too concise to include much of the finer details. In any case it should be clear that all the approaches discussed above will ultimately yield the same equations of motion (possibly up to a linear transformation) for a given system when one employs the same generalized coordinates to describe the kinematics. Which approach to use in the analysis of a particular problem will generally depend on the experience and personal preference of the analyst as well as the complexity of the system. There is, however, an important issue that must be brought to attention since it may have a significant affect on the choice, and that is whether or not the analyst is interested in calculation of constraint forces, which may actually be quite important for design purposes.\nWhile using the Newton-Euler approach, or static equilibrium equations via d’Alembert’s principle, the constraint forces appear explicitly in at least some of the equations of motion. Once the motion is solved for, the reaction forces may then be solved directly from these equations. Recall, for example, the equations we derived for the equilibrium of the rigid bar pendulum employing d’Alembert’s principle, i.e. Equation 1.23-Equation 1.26. The motion of the pendulum is to be evaluated from the equation of motion, i.e. Equation 1.26, by solving for \\(\\gc (t)\\). Once the time history of \\(\\gc\\) is obtained, Equation 1.23 and Equation 1.24 may be used to solve for the reaction forces.\nThese reaction forces, or any other constraint force for that matter, will not show up explicitly in the equations of motion when we use virtual work or Lagrange’s equations, since in both of these approaches, the virtual displacements will be chosen to be compatible with geometric constraints. If we want to evaluate constraint forces, then we will have to derive additional equations through other means after we solve the equation of motion that is obtained via these methods. This is not necessarily a drawback since we will see that derivation and solution of the equations of motion will be the main effort in structural dynamics, and most often not having the constraint forces appear explicitly in the equations will provide immense simplification.\n\nEXAMPLE 1 .1\nAs an exercise in a simple multi-DOF (MDOF) system, let us try to derive the equations of motion for the two horizontally moving blocks shown in Figure 1.8.\n\n\n\nFigure 1.8: A system of two horizontally moving blocks.\n\n\nThis system comprises two masses, \\(m_1\\) and \\(m_2\\), which are connected by two linear springs, with spring coefficients \\(k_1\\) and \\(k_2\\). The second mass is acted upon by an external force \\(\\sforce(t)\\). The system has two degrees of freedom since both masses may translate only along the horizontal direction. We’ll use the translations \\(\\gc_1 (t)\\) and \\(\\gc_2 (t)\\) as our generalized coordinates. Both are defined positive towards the right, as indicated in the figure, of their respective references; these reference points correspond to the state when masses are standing still and there are no deformations in the springs. We assume friction to be negligible and gravity is acting downward so that it has no bearing on the horizontal internal or external forces. We will try to derive the equations that govern the motion of this system using all the methods we have been discussing above. In the following discussions we will omit explicit reference to time in most places to keep the symbolism as simple as possible.\n\n\n\nFigure 1.9: Free body diagrams of the horizontally moving blocks.\n\n\nOnce the generalized coordinates are chosen, the free body diagrams of the components may be sketched. Since this system has two distinct bodies, each of which may be treated as a rectilinearly translating particle, we have to sketch two free body diagrams, one corresponding to each body. Such free body diagrams are shown in Figure 1.9. While sketching these free body diagrams, we have implicitly assumed a few key issues which we now verbalize. First and foremost, we have sketched the diagrams for an instant at which \\(\\gc_{1} &gt; 0\\) and \\(\\gc_{2} &gt; 0\\); this is to ensure that the sign convention is properly established in the scalar variables (since we are not using vectors in this one dimensional problem); the implied directions of the forces are consistent with this initial assumption, and the forces that depend on the generalized coordinates will automatically reverse when the signs of the generalized coordinates reverse. Note that once the sign convention for the generalized coordinates is set, i.e. in this case \\(\\gc_{i}&gt;0\\) if it is to the right of the reference point, this choice also has consequences for the derivatives of the coordinates as well, so that velocities \\(\\dgc_{i}\\) and accelerations \\(\\ddgc_{i}\\) are now also positive if they are directed rightward. Secondly, we have not shown frictional forces since we had assumed friction was negligible, and we have simply not shown any forces in the vertical direction because the system is in static equilibrium in that direction, i.e. the masses do not move in the vertical direction and the vertical forces will not contribute to the horizontal equations of motion. The latter part of this clause is not necessary but is helpful in that it limits overcrowding of the sketches. Third, we have assumed, as indicated by the directions of the spring forces acting between the masses, that at this instant \\(\\gc_{2} &gt; \\gc_{1}\\); this assumption has no bearing on the results, and the only important issue is the compliance of the assumed directions of the forces with this assumption.\nNewton-Euler laws of motion demand that for each mass, we’ll have \\(\\fvec = \\totm \\avec\\). Expressing this condition in the horizontal direction alone will lead to \\[\\begin{align*}\n    - k_{1}  \\gc_{1} + k_{2} (\\gc_{2}-\\gc_{1}) & = m_{1} \\ddgc_{1}\\\\\n    - k_{2} (\\gc_{2}-\\gc_{1}) + \\sforce & = m_{2} \\ddgc_{2}\n\\end{align*}\\] and when the equations are re-arranged, we’ll have \\[\\begin{align*}\n    m_{1} \\ddgc_{1}(t) + (k_{1}  + k_{2}) \\gc_{1}(t) - k_{2} \\gc_{2}(t) & = 0 \\\\\n    m_{2} \\ddgc_{2}(t) - k_{2} \\gc_{1}(t) + k_{2} \\gc_{2}(t)  & = \\sforce(t)\n\\end{align*}\\] which could be written in matrix form as \\[\n\\begin{bmatrix} m_1 & 0 \\\\ 0 & m_2 \\end{bmatrix} \\begin{Bmatrix} \\ddgc_1 (t) \\\\ \\ddgc_2 (t) \\end{Bmatrix} + \\begin{bmatrix} k_1 + k_2 & -k_2 \\\\ -k_2 & k_2 \\end{bmatrix} \\begin{Bmatrix} \\gc_1 (t) \\\\ \\gc_2 (t) \\end{Bmatrix} = \\begin{Bmatrix} 0 \\\\ \\sforce (t) \\end{Bmatrix}\n\\] or more generally as \\[\n\\mmat \\ddgcvec (t) + \\kmat \\gcvec (t) = \\ldvec (t)\n\\] which, as we will so often see in the latter chapters, is one of the classical forms of the equations of motion for systems with multi degrees of freedom.\nTo use virtual work with d’Alembert’s principle, we first have to sketch the free body diagrams with the d’Alembert’s forces that will bring each mass into instantaneous static equilibrium. Such free body diagrams are shown in Figure 1.10. Since we have discarded all the springs and shown the spring forces as acting on the mass externally, all the forces shown in this free body diagram are external to the individual components. The virtual work done by the external forces through arbitrary virtual displacements \\(\\vgc_{1}\\) and \\(\\vgc_{2}\\) should therefore be equal to zero: \\[\n[- k_{1}  \\gc_{1} + k_{2} (\\gc_{2}-\\gc_{1}) - m_{1} \\ddgc_{1}] \\vgc_{1} + [- k_{2} (\\gc_{2}-\\gc_{1}) + \\sforce - m_{2} \\ddgc_{2}] \\vgc_{2} = 0\n\\] Since this condition must be satisfied for arbitrary virtual displacements, including when \\(\\vgc_{1} = 0\\) and \\(\\vgc_{2} &gt; 0\\) or vice versa, it must be true that the coefficients of the virtual displacements must be zero. Therefore we have \\[\\begin{align*}\n- k_{1}  \\gc_{1} + k_{2} (\\gc_{2}-\\gc_{1}) - m_{1} \\ddgc_{1} & = 0\\\\\n- k_{2} (\\gc_{2}-\\gc_{1}) + \\sforce - m_{2} \\ddgc_{2} & = 0\n\\end{align*}\\] and rearranging the equations leads again to \\[\\begin{align*}\n    m_{1} \\ddgc_{1}(t) + (k_{1}  + k_{2}) \\gc_{1}(t) - k_{2} \\gc_{2}(t) & = 0 \\\\\n    m_{2} \\ddgc_{2}(t) - k_{2} \\gc_{1}(t) + k_{2} \\gc_{2}(t)  & = \\sforce (t)\n\\end{align*}\\]\n\n\n\nFigure 1.10: Free body diagrams of the horizontally moving blocks, including d’Alembert forces.\n\n\nAs for Lagrange’s equations, the spring forces, being conservative, may be derived from the following potential energy function \\[\n\\pe = \\frac{1}{2}k_{1} \\gc^2_{1} + \\frac{1}{2}k_{2}(\\gc_{2}-\\gc_{1})^2\n\\] since \\(\\gc_{1}\\) and \\((\\gc_{2}-\\gc_{1})\\) are the elongations in the two springs. We have assumed \\(\\pe_{o} = 0\\) since it is independent of the generalized coordinates; it is just a constant value to be added so that it has no bearing on the final equations. The kinetic energy of the system is given by \\[\n\\ke = \\frac{1}{2} m_{1} (\\vvec_{1}\\sprod\\vvec_{1}) + \\frac{1}{2} m_{2} (\\vvec_{2}\\sprod\\vvec_{2}) = \\frac{1}{2} m_{1} \\dgc^{2}_{1} + \\frac{1}{2} m_{2} \\dgc^{2}_{2}\n\\] The only non-conservative force, apart from any support reactions and constraint forces that do not contribute to the virtual work expression, is the external force \\(\\sforce\\). The work done by the external non-conservative forces through virtual displacements \\(\\vgc_{1}\\) and \\(\\vgc_{2}\\) therefore becomes \\[\n\\vwnc = (0) \\vgc_{1} + (\\sforce) \\vgc_{2} = \\vforce_{1} \\vgc_{1} + \\vforce_{2} \\vgc_{2}\n\\] Lagrange’s equations now lead to, \\[\\begin{gather*}\n\\frac{\\diff}{\\diff t} \\left(\\frac{\\partial \\ke}{\\partial \\dgc_{1}}\\right) - \\frac{\\partial \\ke}{\\partial \\gc_{1}} + \\frac{\\partial \\pe}{\\partial \\gc_{1}} = m_1 \\ddgc_{1} - 0 + (k_1 \\gc_{1} - k_2 (\\gc_{2}-\\gc_{1})) = \\vforce_{1} = 0 \\\\\n\\frac{\\diff}{\\diff t} \\left(\\frac{\\partial \\ke}{\\partial \\dgc_{2}}\\right) - \\frac{\\partial \\ke}{\\partial \\gc_{2}} + \\frac{\\partial \\pe}{\\partial \\gc_{2}} = m_2 \\ddgc_{2} - 0 + k_2 (\\gc_{2}-\\gc_{1}) = \\vforce_{2} = \\sforce\n\\end{gather*}\\] and rearranging the terms once again leads to the following equations of motion: \\[\\begin{align*}\n    m_{1} \\ddgc_{1}(t) + (k_{1}  + k_{2}) \\gc_{1}(t) - k_{2} \\gc_{2}(t) & = 0 \\\\\n    m_{2} \\ddgc_{2}(t) - k_{2} \\gc_{1}(t) + k_{2} \\gc_{2}(t)  & = \\sforce(t)\n\\end{align*}\\]\n\n\nEXAMPLE 1 .2\nLet us try to derive the equation of motion that would govern the small amplitude vertical motion of the assembly shown in Figure 1.11.\n\n\n\nFigure 1.11: Assembly of massless rigid bars.\n\n\nThe bars are rigid but massless, and the springs are linear with the coefficients indicated. Gravity is to be ignored in the analysis.\nFor all its complex looking construct with multiple bars, this is a relatively simple single DOF system when one considers small amplitude motion around the initial equilibrium configuration shown. As the assembly moves, the two horizontal bars will rotate about their respective supports, and the vertical bar that connects the two will remain vertical and move along the vertical direction. One possible choice for the generalized coordinate is the vertical displacement of the end of the top bar. To refer to the components directly, let us consider the free body diagram of the whole system as shown in Figure 1.12. With the specific points denoted by letters \\(A\\) through \\(F\\), the free end of the top bar is point \\(C\\). Let us denote the vertical displacement of point \\(C\\) by \\(\\gc\\) and try to formulate the equations governing its time evolution. We define a stationary rectangular set of axes \\(xyz\\) originating at stationary point \\(D\\) as shown; \\(\\xuvec\\) is the unit vector along \\(x\\), \\(\\yuvec\\) is the unit vector along \\(y\\), and \\(\\zuvec = \\xuvec \\vprod \\yuvec\\) is the unit vector along \\(z\\).\nIf we were to analyze the problem using the Newton-Euler approach, we might first locate the center of mass of the whole system, and then use the principle of linear momentum and the principle of angular momentum, most probably with reference to either the center of mass or a fixed point, and try to eliminate all unknowns but \\(\\gc\\). Since there are only two concentrated masses, located at \\(B\\) and \\(E\\), the center of mass of the system will lie along the vertical line connecting \\(B\\) and \\(E\\). In fact, with regards to the origin of the coordinates, these two points are located at \\[\n\\pvec_{B} = 3 \\ell \\xuvec + (\\ell - \\frac{3}{4}\\gc) \\yuvec, \\qquad \\pvec_{E} = 2 \\ell \\xuvec  - \\frac{1}{2}\\gc \\yuvec\n\\] so that the center of mass \\(\\com\\) is located at16\n\\[\n\\pvec_{\\com} = \\frac{m \\pvec_{B} + 2m \\pvec_{E}}{m + 2m} = \\frac{7\\ell}{3} \\xuvec + \\left(\\frac{5 \\ell}{3} - \\frac{7}{12}\\gc\\right) \\yuvec\n\\] and its velocity and acceleration are given by \\[\n\\vvec_{\\com} = \\pdpvec_{\\com} = - \\frac{7}{12}\\dgc \\yuvec, \\qquad \\avec = \\pdvvec_{\\com} = - \\frac{7}{12}\\ddgc \\yuvec\n\\] The principle of linear momentum for this assembly leads to \\[\n3m \\avec_{\\com} = - \\frac{7}{4}m\\ddgc \\yuvec = (A_{x} + D_{x}) \\xuvec + \\left(A_{y} + D_{y} + \\frac{5k}{2}\\gc\\right) \\yuvec = \\fvec\n\\]\n\n\n\nFigure 1.12: Free body diagram of the rigid bar assembly.\n\n\nTo use the principle of angular momentum with respect to the fixed point \\(D\\), let us first calculate the angular momentum of the system with respect to that same point. Since there are only two point masses in the system, its angular momentum \\(\\angmom{D}\\) is given by \\[\n\\angmom{D} = \\pvec_{B} \\vprod (m \\vvec_{B}) + \\pvec_{E} \\vprod (2m \\vvec_{E})\n\\] where \\(\\vvec_{B} = \\pdpvec_{B} = - \\frac{3}{4}\\dgc \\yuvec\\) is the velocity of mass \\(m\\) located at \\(B\\), and \\(\\vvec_{F} = \\pdpvec_{F} = - \\frac{1}{2}\\dgc \\yuvec\\) is the velocity of mass \\(2m\\) located at \\(E\\). Evaluating the cross products in the angular momentum expression therefore leads to \\[\n\\angmom{D} = - \\frac{17}{4} m \\ell \\dgc \\zuvec\n\\] and the principle of angular momentum yields \\[\n\\dangmom{D} =  -\\frac{17}{4} m \\ell \\ddgc \\zuvec = (-\\ell A_{x} + 9 k \\ell \\gc) \\zuvec =\\moment{D}\n\\] When the equations are written out separately for each vector component, it is easy to see that we have three equations in five unknowns: \\[\\begin{equation*}\\label{eq:Axa}\n0  = A_{x} + D_{x} \\tag{Ex.1.2.a}\n\\end{equation*}\\] \\[\\begin{equation*}\\label{eq:Axb}\n-\\frac{7}{4}m\\ddgc = A_{y} + D_{y} + \\frac{5k}{2}\\gc \\tag{Ex.1.2.b}\n\\end{equation*}\\] \\[\\begin{equation*}\\label{eq:Axc}\n- \\frac{17}{4} m \\ell \\ddgc  = -\\ell A_{x} + 9 k \\ell \\gc \\tag{Ex.1.2.c}\n\\end{equation*}\\] from which we may deduce \\[\\begin{equation*}\\label{eq:Axd}\nA_{x} = \\frac{17}{4} m \\ddgc + 9 k  \\gc = -D_{x} \\tag{Ex.1.2.d}\n\\end{equation*}\\] but this is as much as we can conclude with the information that we currently have. Note that another angular momentum equation, such as \\(\\dangmom{A}=\\moment{A}\\), will yield no new (independent) information and that whatever we may obtain through such an endeavour will be limited to some linear combination of the equations above.\n\n\n\nFigure 1.13: Free body diagrams of the individual bars in the assembly.\n\n\nClearly more equations are needed to proceed further, and for such equations we may analyze each rigid bar in the assembly separately.17 The free body diagrams of the individual bars are presented in Figure 1.13. We can now apply Newton-Euler equations to each of the individual bars separately and try to eliminate some of the unknowns. Since the vertical bar \\(CF\\) is massless, we know that static equilibrium equations hold for this bar at any instant (i.e. its linear and angular momenta are always zero by virtue of it having no mass), such that \\[\\begin{align*}\n0 & = C_{x} - F_{x} \\\\\n0 & = C_{y} - F_{y} \\\\\n0 & = \\frac{\\ell}{2} C_{x} + \\frac{\\ell}{2} F_{x}\n\\end{align*}\\] where the first two equations are force equilibrium equations and the third one is moment equilibrium. We may deduce from these equations that \\[\\begin{equation*}\\label{eq:Axe}\nC_{x}=F_{x}= 0, \\qquad C_{y} = F_{y} \\tag{Ex.1.2.e}\n\\end{equation*}\\]\nConsidering bar \\(ABC\\), application of the principle of linear momentum will yield \\[\n-m \\frac{3}{4}\\ddgc \\yuvec = (A_{x}+C_{x}) \\xuvec + \\left(A_{y} - C_{y} + \\frac{k}{2}\\gc\\right) \\yuvec\n\\] whence we deduce, via Equation \\(\\ref{eq:Axe}\\), that \\[\\begin{equation*}\\label{eq:Axf}\nA_{x}=- C_{x}= 0 \\tag{Ex.1.2.f}\n\\end{equation*}\\] and combining this information with Equation \\(\\ref{eq:Axd}\\) leads to \\[\\begin{equation*}\\label{eq:Axg}\n\\frac{17}{4} m \\ddgct + 9 k \\gct = 0 \\tag{Ex.1.2.g}\n\\end{equation*}\\] This is an equation that governs the time evolution of the generalized coordinate \\(\\gct\\) with no other unknowns appearing in it; this is the equation of motion we were looking for. Note that we would get the same equation if we were to analyze bar \\(DEF\\) instead. Once we solve this equation we can use the results to evaluate the unknown reaction forces. It may be shown, through applying the principles of linear momentum and angular momentum to bars \\(ABC\\) and \\(DEF\\), that18 \\[\\begin{equation*}\\label{eq:Axh}\nA_{y} = -\\frac{3m}{16}\\ddgct - \\frac{k}{4}\\gct, \\qquad D_{y}= -\\frac{m}{2}\\ddgct \\tag{Ex.1.2.h}\n\\end{equation*}\\] and so once \\(\\dgct\\) is determined, the vertical reaction forces may be calculated using the results in Equation \\(\\ref{eq:Axh}\\).\n\n\n\nFigure 1.14: The rigid bar assembly with d’Alembert forces. Although not good practice, we keep the supports in the free body diagram to emphasize that the support reactions, being constraint forces, will play no role in the virtual work calculations.\n\n\nTo analyze this system with virtual work, we need to include the d’Alembert forces as shown in Figure 1.14 at an instant \\(t\\). The d’Alembert forces for this system will be two concentrated forces, acting at points \\(B\\) and \\(E\\), i.e. the locations of the concentrated masses, with magnitudes determined by the product of the masses with their accelerations. With the addition of the d’Alembert forces, the system is in static equilibrium at the instant shown. The question now is, what would be the virtual work done by the internal and external forces if a small virtual displacement \\(\\vgc\\) were to be imposed?\nSince the spring forces are treated as external to the bar assembly and the bars bear no deformations, there will be no internal work done during \\(\\vgc\\). The displacements that occur at the force locations due to \\(\\vgc\\) will be \\(\\vgc/2\\) at \\(B'\\), \\(3\\vgc/4\\) at \\(B\\), \\(\\vgc\\) at \\(F\\), and \\(\\vgc/2\\) at \\(E\\). Clearly there will be no displacements at the supports \\(A\\) and \\(D\\). The principle of virtual work therefore will lead to: \\[\\begin{align*}\n\\vwork_{ext} & = - \\left(\\frac{k\\gc}{2}\\right)\\frac{\\vgc}{2} - \\left(\\frac{3 m \\ddgc}{4}\\right) \\frac{3\\vgc}{4} - (2k\\gc) \\vgc - (m\\ddgc) \\frac{\\vgc}{2} \\\\\n& = - \\left(\\frac{k\\gc}{4}+\\frac{9 m \\ddgc}{16}+2k\\gc+\\frac{m\\ddgc}{2}\\right) \\vgc = 0\n\\end{align*}\\] This equation has to be valid for an arbitrary value of \\(\\vgc\\), the only possibility for this condition to hold is to have the term in the parenthesis equal to zero, i.e. we must have \\[\n\\frac{k\\gc}{4}+\\frac{9 m \\ddgc}{16}+2k\\gc+\\frac{m\\ddgc}{2} = 0\n\\] or, in a rewritten form, \\[\\begin{equation*}\n\\frac{17}{4}m \\ddgct + 9k\\gct = 0 \\tag{Ex.1.2.i}\n\\end{equation*}\\] which of course is the same equation as Equation \\(\\ref{eq:Axg}\\).\n\n\n\nFigure 1.15: Free body diagrams of the rigid bars including d’Alembert forces.\n\n\nOnce the equation of motion is solved and \\(\\gct\\) is determined, d’Alembert’s principle may be used to determine unknown reaction forces in a relatively easy manner. Consider the free body diagrams, including d’Alembert forces, of the individual bars shown in Figure 1.15. With the inclusion of d’Alembert forces, each bar is now in static equilibrium. Therefore, equilibrium of bar \\(CF\\) demands \\[\nC_{x}=F_{x}= 0, \\qquad C_{y} = F_{y}\n\\] so that from the horizontal force equilibrium of bar \\(ABC\\) we have \\[\nA_{x}=C_{x}= 0\n\\] and since the sum of moments about point \\(C\\) in \\(ABC\\) must be zero, \\[\n4\\ell A_{y} + 2\\ell \\frac{k}{2}\\gc + \\ell \\frac{3m}{4}\\ddgc = 0 \\quad \\rightarrow \\quad A_{y} = - \\frac{3m}{16}\\ddgct - \\frac{k}{4}\\gct\n\\] Similarly, for bar \\(DEF\\), horizontal force equilibrium leads to \\[\nD_{x} = F_{x} = 0\n\\] and equating the sum of moments about point \\(F\\) to zero leads to \\[\n4\\ell D_{y} + 2\\ell m \\ddgc = 0 \\quad \\rightarrow \\quad D_{y} = - \\frac{m}{2}\\ddgct\n\\]\nFinally, to derive the governing equation of motion using Lagrange’s equations, we note the the kinetic energy of the assembly is given by \\[\n\\ke = \\frac{1}{2} m \\left(\\frac{3}{4} \\dgc \\right)^2 + \\frac{1}{2} (2m) \\left(\\frac{1}{2} \\dgc \\right)^2 = \\frac{17}{32}m\\dgc^2\n\\] and its potential energy given by \\[\n\\pe = \\frac{1}{2} k \\left(\\frac{1}{2} \\gc \\right)^2 + \\frac{1}{2} (2k) \\gc^2 = \\frac{9}{8} k \\gc^2\n\\] Since there are no non-conservative forces acting (except the constraint forces), Equation 1.28 may be used to derive the equation of motion:\n\\[\n\\frac{\\diff}{\\diff t} \\left(\\frac{\\partial \\ke}{\\partial \\dgc}\\right) - \\frac{\\partial \\ke}{\\partial \\gc} + \\frac{\\partial \\pe}{\\partial \\gc} = 0 = \\frac{17}{16}m\\ddgc + \\frac{9}{4} k \\gc\n\\] which may be rewritten as \\[\\begin{equation*}\n\\frac{17}{4}m \\ddgct + 9k\\gct = 0 \\tag{Ex.1.2.j}\n\\end{equation*}\\]\n\n\n\n\nAt the risk of repeating ourselves, we must emphasize that these derivations implicitly assume that all horizontal motion is so small as to be completely negligible, which would be possible only for small vertical motions. If it were not so, the position vectors and their time derivatives would have to be modified, and the resulting equations would be nonlinear. So please note that the discussion here is strictly limited to small amplitude vertical motion.↩︎\nWe could argue that since no external forces are present in the horizontal direction and since we are neglecting all horizontal accelerations by restricting vertical motion to small amplitudes, the horizontal reaction forces will be zero. It may be so in this case, but it would be somewhat easy to err in such arguments, and a more rigorous demonstration should be preferred unless we are absolutely sure.↩︎\nNote that these results are not unique in the sense that adding or subtracting any multiple of Equation \\(\\ref{eq:Axg}\\) to the right side of the equations would not change the values of the reaction forces.↩︎\n\n\n\n\n1.3.5 Wrapping Up\nNeither the theory, the surface of which we have barely scratched in this chapter, nor the details of application have by no means been exhaustively discussed. Our aim was simply to provide a refresher about some of the fundamental frameworks which we will make use of throughout the rest of the book. Newton-Euler framework is fundamental since it provides the stage for latter developments, and for systems in which constraint forces need to be evaluated, the Newton-Euler laws may provide all the necessary equations. It is likely that d’Alembert’s principle will be most often referred to since most engineers are familiar with the concept of static equilibrium, and also because the inclusion of d’Alembert forces generally lead to simpler analysis of constraint forces even if other methods are used to derive the governing equations of motion. For generalized single degree of freedom systems, the fundamental framework will be d’Alembert’s principle and virtual work; virtual work will also be directly employed in the context of Lagrange’s equations whenever non-conservative forces are present. The choice of method that will be used in the analysis of a specific problem may stem from a variety of reasons, not least from familiarity and personal choice. On the other hand it is also true, as hopefully demonstrated by the examples discussed, that some methods may provide a more direct reach to a specific goal for a particular system."
  },
  {
    "objectID": "singledof.html#sec-Motivation",
    "href": "singledof.html#sec-Motivation",
    "title": "2  Free Vibrations of Single Degree of Freedom Systems",
    "section": "2.1 Motivation and Preliminary Discussions",
    "text": "2.1 Motivation and Preliminary Discussions\nThe fundamental step in the analysis of any system is idealization and conceptual modeling. In engineering analysis, the idealized model should be simple enough so as to allow extraction of predictive results, but it should still have sufficient complexity to reflect all the salient features of the particular problem studied. The claim to validity may only be tested against experiments which are neither feasible nor even possible for many structural systems. Some simple models have however provided acceptable predictive accuracy in numerous previous trials so that structural engineers take many such models for granted while thinking about real, complex structures.\nThe static analysis of structures makes ample use of simple behavioural models; trusses, beams, plates or shells, elastic or inelastic, with or without time dependent properties have been used in the design and analysis of many structures still standing. The degree of freedom of a structural element in static analysis is associated with deformation patterns that are included in the model. A truss element is assumed, based on connection details and loading patterns, to deform only axially so that the final form of the bar is completely determined by translations of its two end points. A beam element, on the other hand, has rotational deformations so that its deformed shape is determined by end translations, end rotations, and the deformational patterns imposed by the loads applied inbetween its two ends.\nSince the concept of degree of freedom in dynamics is intimately connected to mass distribution and forces associated with accelerations, it may be the case that static and dynamic degrees of freedom of a system do not map one-to-one. In dynamics, inertia-related degrees of freedom govern and the static degrees of freedom will often need to be condensed since, in developing simple models of deformable structures, we will often assume that the mass is concentrated at certain locations.1 To discuss how such a simplification may proceed, let us consider the portal frame shown in Figure 2.1.\n\n\n\nFigure 2.1: (a) Degrees of freedom in static analysis, (b) masses lumped at the nodes, (c) dynamic degree of freedom, (d) free body diagram of the mass.\n\n\nUnder the action of a general static loading, one needs to keep track of the three degrees of freedom shown in Figure 2.1(a) to be able to specify the deformations that take place: The lateral translation \\(u_1\\) of the joints, and the joint rotations \\(u_2\\) and \\(u_3\\).2 The dominant issue in modeling a system for dynamic analysis, however, is the distribution of the mass or, relatedly, the inertial effects produced by the distribution of the mass and their accelerations in the system (think of d’Alembert forces). It is common to consider that in such structural frames most of the mass will be concentrated in the level of the floor plate and the beams attached to it; furthermore, the accelerations at this level will also be relatively more significant than say the accelerations near the supports. Should one wish to incorporate the contribution of the columns to the mass, it may be argued that some , but not all, of the column mass will have an significant effect on the dynamics. With this line of thought, a model in which masses are lumped to the two joints may be developed. An important question that must be raised is whether or not rotational accelerations will have a significant affect. This is a question without an obvious a priori answer but past experiences indicate that under the action of common load effects, rotational accelerations at the joints and the inertial effects thereby generated remain inconsequential compared to those related to lateral translation; in a sense these rotations are predominantly secondary effects caused by lateral translation and compatibility. If rotational accelerations are thus neglected, angular momentum equations for the joints will be in essence static equilibrium equations, and no mass need to be assigned to the rotational degrees of freedom. This model, commonly employed in finite element analysis of frame structures, is referred to as the lumped mass model.\nSince the lateral translation is assumed to be common to both joints, we could consider a single mass \\(m=m_1 + m_2\\) which would be dynamically equivalent, and the motion of this mass may be completely defined by the single generalized coordinate \\(\\gc \\equiv u_1\\) as in Figure 2.1(c). What is left to determine for the formulation of the equation governing the motion of this mass is the lateral stiffness of the frame, i.e. the resistance with which it tries to pull the mass back to the initial equilibrium position.3 This cumulative resistance will stem from the deformations of columns and beams, and from static analysis we know that under the action of the lateral load \\(\\extforce\\), static equilibrium equations for the joints may be expressed as\n\\[\n\\begin{bmatrix} k_{11} & k_{12} & k_{13} \\\\ k_{21} & k_{22} & k_{23} \\\\k_{31} & k_{32} & k_{33} \\end{bmatrix} \\begin{Bmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{Bmatrix} = \\begin{Bmatrix} \\extforce \\\\ 0 \\\\ 0 \\end{Bmatrix}\n\\qquad(2.1)\\] where \\(k_{ij}\\) are stiffness coefficients. Since rotational accelerations and the associated d’Alembert moments are to be neglected, the right hand sides of the second and third equations that represent moment equilibrium of the joints will remain zero in dynamic equilibrium analysis. Consequently, \\(\\{u_2,u_3\\}\\) are not independent: noting that \\(\\gc \\equiv u_1\\), the relation between \\(\\gc\\) and \\(\\{u_2,u_3\\}\\) at any instant will be given by \\[\n- \\begin{bmatrix} k_{22} & k_{23} \\\\k_{32} & k_{33} \\end{bmatrix}^{-1}\\begin{bmatrix}  k_{21}  \\\\k_{31} \\end{bmatrix} \\gc = \\begin{Bmatrix}  u_2 \\\\ u_3 \\end{Bmatrix}\n\\qquad(2.2)\\] so that eliminating the rotational degrees of freedom from Equation 2.1 with the help of Equation 2.2 leads to a single expression relating the lateral displacement directly to the lateral force, \\[\n\\left( k_{11}- \\begin{bmatrix}  k_{12}  & k_{13} \\end{bmatrix} \\begin{bmatrix} k_{22} & k_{23} \\\\k_{32} & k_{33} \\end{bmatrix}^{-1}\\begin{bmatrix}  k_{21}  \\\\k_{31} \\end{bmatrix} \\right) \\gc = \\extforce \\rightarrow k \\gc = \\extforce\n\\qquad(2.3)\\] where the coefficient \\(k\\) is called the lateral stiffness of the frame. This procedure of eliminating the dynamically indirect degrees of freedom from the model is referred to as static condensation and it is widely used to simplify the structural models through elimination of those degrees of freedom onto which no mass or moment of inertia is assigned. It is important to note that even though inertial properties are alluded to, especially with respect to their existence or nonexistence, determination of the stiffness properties of a system is essentially a matter of static analysis.\nNow that the conceptual model is finalized, we may use any of the frameworks previously reviewed to derive the equation that will govern the motion of the mass, i.e. the time variation of \\(\\gc (t)\\). For example, making use of d’Alembert’s principle and the free body diagram shown in Figure 2.1(d), the sum of forces in the horizontal direction would lead to \\[\nm \\ddgc (t) + k \\gc (t) = \\extforce (t)\n\\] which, as we will so often see, is the canonical equation governing the dynamics of undamped linear single degree of freedom systems under the action of external load effects."
  },
  {
    "objectID": "singledof.html#footnotes",
    "href": "singledof.html#footnotes",
    "title": "2  Free Vibrations of Single Degree of Freedom Systems",
    "section": "",
    "text": "There may be many components of the external force and the generalized force will then be the superposition of all the contributions; it is essentially the coefficient that multiplies \\(\\vgengc\\) in the calculation of the work done by all external forces.↩︎\nAgain, there may be other contributions to the damping, and at the end of the day generalized (viscous) damping is the name given to the coefficient of the velocity in the virtual work expression.↩︎"
  },
  {
    "objectID": "singledof.html#sec-ThePrototype",
    "href": "singledof.html#sec-ThePrototype",
    "title": "2  Free Vibrations of Single Degree of Freedom Systems",
    "section": "2.2 The Prototype",
    "text": "2.2 The Prototype\nAs the equation of motion has the same form for all single degree of freedom (SDOF) systems, a single simple model suffices to conceptually represent all undamped SDOF systems. This model, sketched in Figure 2.2, comprises a mass, representing the inertial features that contribute to the equation of motion through accelerations, and a spring, representing flexiblility features that contribute to the equation of motion through deformations. The mass is assumed to be travelling on a frictionless surface (the wheels are there to hint, admittedly erroneously, at motion unhindered by interaction with the ground) and there are no other dissipative sources either. Physical properties of the system are assumed to be invariant in time. Each component of the model may indeed correspond to a single entity of some system but most likely each will represent the contribution of multiple sources. It may therefore be more appropriate to think of the mass and stiffness coefficients as equivalent mass and equivalent stiffness of the system, but we refrain from emphasizing this distinction through symbols or scripts to in an effort to keep notational complexity at a minimum.\n\n\n\nFigure 2.2: Prototype for undamped single degree of freedom systems.\n\n\nTo provide a few examples on how such a model could be so vastly representative, let us first derive the equation of motion for the system of Figure 2.2. The free body diagram of the system including the d’Alembert force is provided in Figure 2.3. Sum of forces in the horizontal direction leads to the following equation of motion governing the time variation of the single coordinate \\(\\gc\\): \\[\n\\extforce (t) - m \\ddgc (t) - k \\gc (t) = 0 \\quad \\rightarrow \\quad m \\ddgc (t) + k \\gc (t) = \\extforce (t)\n\\qquad(2.4)\\]\n\n\n\nFigure 2.3: Free body diagram of the prototype single degree of freedom system including the d’Alembert force.\n\n\nAlternatively we could use the Lagrangian approach which would proceed as follows: The kinetic and potential energies of the system are given by \\[\n  \\ke = \\frac{1}{2}m \\dgc^2, \\quad \\pe = \\frac{1}{2} k \\gc^2\n\\] while the virtual work done by the external forces through a virtual displacement is given by \\[\n\\vwork_{e} = \\extforce \\vgc = \\vforce \\vgc\n\\] so that the generalized force is simply \\(\\vforce = \\extforce\\). Therefore Lagrange’s equations lead to \\[\n  \\frac{\\diff}{\\diff t} \\left(\\frac{\\partial \\ke}{\\partial \\dgc}\\right) - \\frac{\\partial \\ke}{\\partial \\gc} + \\frac{\\partial \\pe}{\\partial \\dgc}= \\vforce \\quad \\rightarrow \\quad m \\ddgc (t) + k \\gc (t) = \\extforce (t)\n\\] which, of course, is identical to the equation of motion in Equation 2.4.\nLet us now consider the systems shown in Figure 2.4. The simply supported beam in Figure 2.4(a), assumed to behave linear elastically, is supposed to be very light compared to the heavy mass \\(m\\) so that it is to be modeled as massless. The system has a single degree of freedom since the mass may only translate vertically (assuming the deflections are small so that lateral motion due to beam deformations is negligible). The critical issue in modeling this system is the determination of its stiffness, which is due to the deformation resistance of the beam. By definition, a stiffness coefficient is numerically equal to the external force that should be imposed along the degree of freedom to induce a unit displacement.4 If the beam is undergoing uniaxial bending with bending rigidity \\(EI\\) (i.e. the product of modulus of elasticity \\(E\\) and the second moment of the cross sectional area about the bending axis \\(I\\)) and length \\(\\ell\\), from structural analysis we know that the relationship between a force \\(\\extforce\\) applied at the midspan of the beam and the deflection \\(\\Delta\\) under the force is given by\n\\[\n\\extforce = \\frac{48 EI}{\\ell^3} \\Delta\n\\] so that if \\(\\Delta=1\\), then the force that has to be applied is numerically equal to \\({48 EI}/{\\ell^3}\\). While this interpretation is more direct for experimental determination of stiffness, in the analytical derivation the stiffness is simply identified as the coefficient that multiplies the displacement in the linear force-displacement relationship, i.e. \\({48 EI}/{\\ell^3}\\). Whichever way it is interpreted the bottom line is that, as far the vertical motion of the mass is concerned, the massless beam is equivalent to a linear spring with equivalent spring coefficient \\[\nk = \\frac{48 EI}{\\ell^3}\n\\] and the equation of motion governing the time variation of \\(\\gc\\) may be shown to be \\[\nm \\ddgc (t) + \\frac{48 EI}{\\ell^3} \\gc (t) = 0\n\\] since there are no external forces acting on the mass. This statement may immediately trigger the question ‘what happened to gravity?’ In structural dynamics, it is generally assumed that the deformations due to gravity loads and the deformations due to dynamic loads may be analyzed separately and the results so obtained may be superposed afterwards. This of course is strictly possible only if the deformations resulting from either is relatively small so that the geometry is not significantly altered and the response remains linear. There are important exceptions to this approach, most notably for systems in which second order effects and/or nonlinearity is pronounced.\n\n\n\nFigure 2.4: (a) A beam carrying a heavy mass, (b) a heavy disc attached to a shaft, (c) truss and springs supporting a heavy mass.\n\n\nThe shaft in Figure 2.4(b) is again assumed to be massless. It is supporting a disc with moment of inertia \\(\\inertia{\\ell}\\) about the longitudinal axis of the shaft. When torsional vibrations are to be studied, the system has a single degree of freedom since the disc will only be rotating about the longitudinal axis. Consider now an instant at which the disc has rotated by an amount \\(\\gc\\). If the shaft of length \\(\\ell\\) is assumed to behave linear elastically with torsional rigidity \\(GJ\\) (i.e. the product of the shear modulus \\(G\\) and the polar moment of the cross sectional area \\(J\\)), then the resisting moment acted upon the disc by the shaft at that instant may be shown to be in opposite direction to \\(\\gc\\) and of magnitude \\[\n\\smoment = \\frac{GJ}{\\ell} \\gc\n\\] Sketching the free body diagram of the disc and applying the principle of angular momentum will then yield the equation of motion \\[\n\\inertia{\\ell} \\ddgc (t) + \\frac{GJ}{\\ell} \\gc (t) = 0\n\\] which once again has a form identical to that of Equation 2.4: If one could build a physical model that looks like the system shown in Figure 2.2, adjust its mass \\(m\\) to be numerically equal to \\(\\inertia{\\ell}\\), and adjust its stiffness \\(k\\) to be numerically equal to \\(GJ/\\ell\\), then the response of that built model would perfectly match the response of the disc-shaft system under numerically similar load effects. Such similarities are generally referred to as mechanical analogies and with this terminology, the system of Figure 2.2 may be referred to as the mechanical analogue for all undamped linear single degree of freedom systems.\n\n\n\nFigure 2.5: Equivalent springs with parallel and series connections.\n\n\nSlightly more complicated is the system shown Figure 2.4(c), where a three member truss, supported by two identical springs, is carrying a heavy mass attached to its top node. To simplify the problem, it is assumed that the truss members have negligible mass, and that the supports are restrained to move vertically. Due to symmetry, the mass will translate in the vertical direction alone, assuming no external forces are present to explicitly force any other motion. The system therefore again has only one degree of freedom. If we were to consider an instant at which the mass has moved down an amount of \\(\\gc\\), it is clear that some of that displacement will be due to the deformation of the truss bars and the rest will be due to the deformation of the springs. A detailed analysis may be undertaken to analyze the bar forces and associated displacements to find the equivalent stiffness of the system but the following analogy may help while thinking about this and similar problems. The combined system of Figure 2.5(a), with the massless truss and springs, is mechanically analogous to the springs shown in Figure 2.5(b) where the truss has been replaced by a spring with stiffness \\(k_t\\). This spring is representative of the force-displacement relationship of the truss alone, with displacement here referring to the relative vertical translation of node \\(c\\) with respect to nodes \\(a\\) and \\(b\\) which, due to symmetry, will behave identically. It may be shown through structural analysis that the relative vertical displacement \\(\\Delta\\) of node \\(c\\) under the action of a vertical force \\(\\extforce\\) applied at \\(c\\) is given by \\[\n\\Delta = \\frac{2\\ell}{3EA}\\extforce\n\\] so that the equivalent spring coefficient \\(k_t\\) may be defined as \\[\nk_t = \\frac{3EA}{2\\ell}\n\\] As for the two springs supporting the truss, they may be said to be connected in parallel; their displacement is the same but each will carry a portion of the total force in proportion to its stiffness. Consider any two linear springs, with coefficients \\(k_1\\) and \\(k_2\\), connected in parallel. Let the total force they transmit be \\(\\extforce\\), and assume they both displace by the same amount \\(\\Delta\\). The relation between force and displacement for such a system would be \\[\n\\extforce = \\underbrace{k_1 \\Delta}_{{\\text{force in $1$}}} + \\underbrace{k_2 \\Delta}_{{\\text{force in $2$}}} = (k_1 + k_2) \\Delta\n\\] so that the response of such a system would be equivalent to a system with a single spring of stiffness \\(k_1 + k_2\\).5 Therefore the system of Figure 2.5(b) may be replaced by the system of Figure 2.5(c).\nNow we have two springs in series, with stiffness coefficients \\(k_t\\) and \\(2k_s\\). For any two linear springs, say with stiffness coefficients \\(k_1\\) and \\(k_2\\), that are connected in series, the force transmitted through each will be the same, but each will contribute to the displacement in proportion to their stiffness. The relationship between the force \\(\\sforce\\) through such a system and the total displacement \\(\\Delta\\) is given by \\[\n\\Delta = \\underbrace{\\frac{\\extforce}{k_1}}_{{\\text{deformation in $1$}}} + \\underbrace{\\frac{\\extforce}{k_2}}_{{\\text{deformation in $2$}}} = \\left(\\frac{1}{k_1} + \\frac{1}{k_2}\\right) \\extforce\n\\] so that such a series system would be equivalent to a single spring with spring coefficient6 \\[\n\\frac{1}{\\frac{1}{k_1} + \\frac{1}{k_2}}\n\\] Applying this result to our system leads finally to the single equivalent spring shown in Figure 2.5(d), with equivalent spring coefficient \\(k\\) given by \\[\nk = \\frac{1}{\\frac{1}{k_t} + \\frac{1}{2k_s}} = \\frac{6EAk_s}{4\\ell k_s + 3 EA}\n\\] and the equation of motion for the system of Figure 2.4(c) would finally be derived as \\[\nm \\ddgc (t) + k \\gc (t) = m \\ddgc (t) + \\frac{6EAk_s}{4\\ell k_s + 3 EA} \\gc (t) = 0\n\\]\nWe should recall that, although various details on a number of issues have been mentioned, the main point of this exercise was to motivate the use of the prototype single degree of freedom model. Whether or not a system may be effectively represented by a single degree of freedom model, however, is a question that does not have a straightforward answer, as hopefully illustrated by even the relatively simple systems discussed above. There is no shortcut or a single foolproof recipe that we know of which would be applicable in all situations; as such, this book will mainly focus on the methods of analysis that will be applicable to different models, assuming that those models are representative of whatever real life system they are aspiring to replicate the behavior of. The success or failure of the modeling approach will eventually boil down to how accurately the model will be able to predict the real response. The only way we know of to increase one’s model developing abilities is simply by doing: working on many textbook exercises and more realistic problems to get acquainted with a diverse set of cases, identifying the strengths and caveats of modeling assumptions and approximations, so as to be able to make rational choices based on reliable experience and information. We therefore highly recommend the reader to attempt all the solved and unsolved exercises that will be provided in the text in an effort to start on this arduous journey which will in all likelihood continue, as ours still do, indefinitely."
  },
  {
    "objectID": "singledof.html#sec-Undamped",
    "href": "singledof.html#sec-Undamped",
    "title": "2  Free Vibrations of Single Degree of Freedom Systems",
    "section": "2.3 Undamped Free Vibrations",
    "text": "2.3 Undamped Free Vibrations\nIf a system in natural (static) equilibrium is set to motion by imposing some initial displacement and/or velocity but then left to move around the initial equilibrium configuration on its own, without imposing any external load effects, then the system is said to be executing free vibrations.\nIn order to introduce some basic concepts and definitions, let us first analyze a system in which there is no energy dissipation. Such a system would be governed by Equation 2.4 but with no external force so that \\[\nm \\ddgc (t) + k \\gc (t) = 0\n\\] but this equation alone is not sufficient to describe the problem completely. To be able to determine the time variation of \\(\\gc (t)\\), one needs to know the state of the system at some time so as to be able to track the system thereafter. The state of a single degree of freedom system at some instant \\(t=t_o\\) refers collectively to its displacement and velocity, i.e. \\(\\{\\gc(t_o),\\dgc(t_o)\\}\\), since these two variables are sufficient to determine all that happens to the system along with the governing equation of motion. This ‘instant’ \\(t_o\\) is generally taken to be the start of the time interval considered corresponding to \\(t=0\\), and the values of displacement and velocity at this initial instant are called initial conditions for the system. These initial conditions are so often utilized that we shall denote them by special symbols: the initial displacement will be denoted by \\(\\gcic\\) and the initial velocity by \\(\\dgcic\\). A more proper statement of the problem may now be expressed as: \\[\nm \\ddgc (t) + k \\gc (t) = 0 \\, ; \\quad  \\left\\{\\gc(0)= \\gcic,\\dgc(0) = \\dgcic\\right\\}\n\\qquad(2.5)\\]\nEquation 2.5 is a second order linear differential equation with constant coefficients. Its solution may be expressed in the form \\[\n\\gc (t) = A \\expon{st}\n\\qquad(2.6)\\] where \\(A\\) and \\(s\\) are in general complex valued and as yet undetermined. Substituting this proposed solution to the equation of motion in Equation 2.5 yields \\[\n(m s^2 + k) A \\expon{st} = 0\n\\] If this equality is to be satisfied for all time \\(t\\), then there are two possibilities that should be considered. It could be that \\(A = 0\\), in which case equilibrium is automatically satisfied since the system is not moving; this is called the trivial solution. The second possibility, which is the non-trivial solution, requires \\(s\\) to be such that \\[\nms^2 + k = 0\n\\] which yields two solutions for \\(s\\): \\[\ns_1 = + \\sqrt{-\\frac{k}{m}} = + \\imag \\freq, \\quad s_2 = - \\sqrt{-\\frac{k}{m}} = - \\imag \\freq\n\\] where \\(\\imag\\), defined through \\(\\imag^2 \\equiv -1\\), is the unit imaginary number, and we have introduced \\(\\freq \\equiv + \\sqrt{k/m}\\). This variable \\(\\freq\\) is of fundamental importance; it is called the (undamped) natural frequency of the system for reasons that will soon be clear. Since both of the solutions for \\(s\\) will satisfy the equation of motion, the general solution will be the superposition of the two, so that \\[\n\\gc (t) = A_1 \\expon{s_1 t} + A_2 \\expon{s_2 t} = A_1 \\expon{\\imag \\freq t} + A_2 \\expon{-\\imag \\freq t}\n\\qquad(2.7)\\] and finally, since \\(\\gc (t)\\) is real valued, it must be that \\(A_1\\) and \\(A_2\\) are complex conjugates, so that with \\(A = A_1 = a+\\imag b = A_2^* = (a-\\imag b)^*\\), we have the following general solution: \\[\n\\gc (t) = A \\expon{\\imag \\freq t} + A^* \\expon{-\\imag \\freq t}\n\\qquad(2.8)\\] Equation 2.8 is referred to as the general solution since the response of all SDOF systems to initial conditions will be of this form. The two coefficients \\(a\\) and \\(b\\) in \\(A = a + \\imag b\\) will have to be determined based on the specific initial conditions of the particular problem being studied. This form of the solution, however, is not very conducive to direct physical interpretation, and most often expressing the solution in terms of well known trigonometric functions is preferred. Euler’s formula says that \\[\n\\expon{\\pm \\imag \\theta} = \\cos \\theta \\pm \\imag \\sin \\theta\n\\qquad(2.9)\\] and when this expansion is used in Equation 2.8 with \\(\\theta = \\freq t\\), we arrive after some algebra to the following form for the general solution: \\[\n\\gc (t) = C_1 \\cos \\freq t + C_2 \\sin \\freq t\n\\qquad(2.10)\\] When expressed in this form, the nature of the time variation of \\(\\gc\\) is much more obvious. The displacements that will occur in a SDOF system after it is set to motion will be of sinusoidal nature, with frequency \\(\\freq\\) and an amplitude that depends on the particular initial conditions. In fact, for \\(\\gc(0) = \\gcic\\) and \\(\\dgc (0) = \\dgcic\\), the coefficients \\(C_1\\) and \\(C_2\\) will be evaluated as \\[\\begin{align*}\n\\gc (0) = \\gcic & = C_1 \\cos 0 + C_2 \\sin 0 \\quad \\rightarrow \\quad C_1 = \\gcic \\\\\n\\dgc (0) = \\dgcic & = - \\freq C_1 \\sin 0 + \\freq C_2 \\cos 0 \\quad \\rightarrow \\quad C_1 = \\frac{\\dgcic}{\\freq}\n\\end{align*}\\] so that the general solution now takes the form \\[\n\\gc (t) = \\gcic \\cos \\freq t + \\frac{\\dgcic}{\\freq} \\sin \\freq t\n\\qquad(2.11)\\] That this solution corresponds in fact to a single sinusoidal wave may be shown mathematically through the use of the following expansion formula: \\[\n\\cos (\\theta \\pm \\varphi) = \\cos \\theta \\cos \\varphi \\mp  \\sin \\theta \\sin \\varphi\n\\qquad(2.12)\\] A function of the form \\(Q \\cos (\\freq t - \\phs)\\) is therefore equivalent to \\[\nQ \\cos (\\freq t - \\phs) = (Q \\cos \\phs) \\cos \\freq t + (Q \\sin \\phs) \\sin \\freq t = C_1 \\cos \\freq t + C_2 \\sin \\freq t\n\\] so that with \\[\nC_1 = Q \\cos \\phs , \\qquad C_2 = Q \\sin \\phs\n\\qquad(2.13)\\] the general solution may be expressed as \\[\n\\gc (t) = Q \\cos (\\freq t - \\phs)\n\\qquad(2.14)\\]\nThis form is arguably the one that is most easily visualized. The response to initial conditions is in the form of a single cosine wave with amplitude \\(Q\\) and phase angle7 \\(\\phs\\). The amplitude and phase are given, through Equation 2.13 and Equation 2.11, by \\[\nQ = \\sqrt{C_1^2 + C_2^2} = \\sqrt{\\gcic^2 + \\left(\\frac{\\dgcic}{\\freq}\\right)^2}\n\\qquad(2.15)\\] \\[\n\\phs = \\arctan \\frac{\\sin \\phs}{\\cos \\phs} = \\arctan \\frac{C_2/Q}{C_1 / Q} = \\arctan \\frac{\\dgcic / (\\freq Q)}{\\gcic / Q}\n\\qquad(2.16)\\] The response of an undamped linear single degree of freedom system to some initial conditions \\(\\gcic &gt; 0\\) and \\(\\dgcic &gt; 0\\) is shown in Figure 2.6. This sinusoidal response starts from the initial displacement \\(\\gcic\\) with slope \\(\\dgcic\\). The first peak is reached at time \\(t=\\hat{t} = \\phs / \\freq\\). The peak amplitude \\(Q\\) is the same at all peaks, in other words the vibrations do not decay since there is no energy dissipation in the system and once it gets going with a certain total mechanical energy, given by \\[\n\\te_o = \\ke_o + \\pe_o = \\frac{1}{2} m \\dgcic^2 + \\frac{1}{2} k \\gcic^2\n\\] its mechanical energy remains at this constant level. The maximum displacement and velocity (in an absolute sense) that occur during the motion, inferred from Equation 2.14 and its time derivative, are given by \\[\n\\gc_{\\max} = Q, \\quad \\dgc_{\\max} = \\freq Q\n\\]\n\n\n\nFigure 2.6: Initial condition response of an undamped single degree of freedom system.\n\n\nThe maximum kinetic energy occurs whenever the displacement is zero and at a value of \\[\n\\ke_{\\max} = \\frac{1}{2} m (\\dgc_{\\max})^2 = \\frac{1}{2} m (\\freq Q)^2 = \\frac{1}{2} m \\left(\\freq^2 \\gcic^2 + \\dgcic^2\\right)\n\\] whereas the maximum potential energy occurs whenever the velocity is zero and at a value of \\[\n\\pe_{\\max} = \\frac{1}{2} k (\\gc_{\\max})^2 = \\frac{1}{2} k Q^2 = \\frac{1}{2} k \\left(\\gcic^2 + \\frac{\\dgcic^2}{\\freq^2}\\right)\n\\] The maximum force that occurs in the spring, possibly important for design considerations, is given by \\[\n\\text{maximum spring force} = k \\gc_{\\max} = k Q = k \\sqrt{\\gcic^2 + \\left(\\frac{\\dgcic}{\\freq}\\right)^2}\n\\]\nThe response is said to be periodic with period \\(\\period\\) so that the motion of the mass repeats itself in patterns of duration \\(\\period\\); periodicity is expressed mathematically by the condition \\[\n\\gc(t) = \\gc(t+\\period) \\quad \\forall t\n\\] where \\(\\period\\) is said to be the period of the system, given by \\[\n\\period = \\frac{2\\pi}{\\freq}\n\\] as may be easily inferred from Equation 2.14. The period, which may be defined as the time it takes for motion to complete one full cycle, is a fundamental quantity in structural dynamics and it is more often referred to than the frequency due to its more direct physical implication. It is often stated in units of seconds [\\(\\punit{sec}\\) or \\(\\punit{s}\\)] since the periods of most systems encountered in structural dynamics are of the order of seconds. What is called the cyclic frequency is defined as the number of cycles completed in a unit of time, i.e. \\[\n\\text{cyclic frequency} = \\frac{1}{\\period} = \\frac{\\freq}{2 \\pi}\n\\] If time is measured in seconds, than the unit of cyclic frequency is named \\(\\textrm{Hertz}\\), denoted by \\(\\punit{Hz}\\), so that \\(1 \\unit{Hz} = \\punit{no. of cycles} / 1 \\unit{sec}\\). To distinguish between the two frequencies, \\(\\freq\\) (with units of \\(\\punit{rad/sec}\\)) is often referred to as angular frequency since it corresponds to the angle the cosine function in the response goes through in a unit of time. Here we will simply refer to \\(\\freq\\) as frequency to economize on adjectives, and use the term cyclic frequency whenever we need to explicitly refer to it."
  },
  {
    "objectID": "singledof.html#sec-Damping",
    "href": "singledof.html#sec-Damping",
    "title": "2  Free Vibrations of Single Degree of Freedom Systems",
    "section": "2.4 Damping",
    "text": "2.4 Damping\nAlthough indispensable for introducing basic concepts, one of the major drawbacks of the undamped model is that it does not reflect energy dissipation, which is a phenomenon observed in all real life systems. Energy dissipation may occur do to various mechanisms. Friction between the system and its surroundings, radiation, internal friction and heat generation, cracking and plastic deformations, to list some prominent causes, may all contribute at varying degrees to dissipation. The simple fact is that explicit identification and modeling of all such causes is not feasible if at all possible, unless some of them are dominating and the aim is to specifically address and study them.\n\n2.4.1 Viscous Damping Model\nA simple model for dissipation has proved both mathematically convenient and practically applicable, so as to provide acceptable representations of experimentally observed responses. The model is based phenomenologically on the response of a linear viscous dashpot in which the applied force is proportional to the velocity of deformation. Amalgamation of energy dissipation mechanisms to a single equivalent linear viscous dashpot provides a model that is capable of producing a certain type of amplitude decay often observed in free vibrations of real structures. This model is therefore generally accepted as a reasonable prototype to model energy dissipation in small amplitude vibrations, so much so that it is explicitly referred to in many structural codes and guidelines. With due caution we will simply refer to this model as viscous damping and represent it graphically with a dashpot as shown in Figure 2.7(a).\n\n\n\nFigure 2.7: (a) Viscously damped single degree of freedom system and (b) its free body diagram including the d’Alembert force.\n\n\nThe force across the damper is given by \\(c \\dgc\\) where \\(\\dgc\\) is the rate of deformation and \\(c\\) is called the (linear) viscous dashpot coefficient: it is this coefficient, or some other one derived form it, that must be adjusted properly if the model is to represent accurately the amplitude decrement of the real system. The force acted upon the mass by the damper is therefore equal in magnitude to \\(c \\dgc\\) and opposite in direction to the direction of the velocity. The free body diagram of the mass, including the damping force and the d’Alembert force, is shown in Figure 2.7(b). The sum of the horizontal forces leads to \\[\nm \\ddgc (t) + c \\dgc (t) + k \\gc (t) = \\extforce (t)\n\\qquad(2.17)\\] which is the equation of motion that represents the dynamics of all viscously damped single degree of freedom systems. The unforced vibrations will hence be governed by \\[\nm \\ddgc (t) + c \\dgc (t) + k \\gc (t) = 0 \\, ; \\quad \\left\\{\\gc(0) = \\gcic, \\; \\dgc(0) = \\dgcic\\right\\}\n\\qquad(2.18)\\] which is once again a second order linear differential equation with constant coefficients.\nSince Equation 2.18 is of the same form as Equation 2.5, we may expect Equation 2.6 to work in this case as well. Using the candidate solution in Equation 2.18 leads to \\[\n  (ms^2 + cs + k)A\\expon{st} = 0\n\\] and the non-trivial solution requires \\[\nms^2 + cs + k = 0\n\\] There are two solutions for \\(s\\) that satisfy this quadratic equation, given by \\[\ns_1 = -\\frac{c}{2m} + \\frac{1}{2m}\\sqrt{c^2 - 4mk}, \\quad s_2 = -\\frac{c}{2m} - \\frac{1}{2m}\\sqrt{c^2 - 4mk}\n\\] It is possible to rewrite these expressions in somewhat simpler, familiar terms. Remembering that \\(\\freq^2 = k/m\\), and defining \\[\n2 \\damp \\freq \\equiv \\frac{c}{m}\n\\qquad(2.19)\\] where \\(\\damp\\) is a new but dependent variable derived from the damping properties, the roots may also be expressed as \\[\ns_1 = -\\damp \\freq + \\freq \\sqrt{\\damp^2 - 1}, \\quad s_2 = -\\damp \\freq - \\freq \\sqrt{\\damp^2 - 1}\n\\qquad(2.20)\\] It is somewhat easier to observe that the nature of the solution depends very much on the value of the coefficient \\(\\damp\\). Although only one of the cases is mostly relevant, for completeness we note the following three possibilities:\n\nOverdamped systems: Consider that \\(\\damp &gt; 1\\). In this case both roots are real valued and the exponentials lead to hyperbolic sines and cosines such that no oscillation is possible. In fact, one has \\[\\begin{align*}\n\\gc (t) & = A_1\\expon{\\left(-\\damp \\freq + \\freq \\sqrt{\\damp^2 - 1}\\right)t} + A_2\\expon{\\left(-\\damp \\freq - \\freq \\sqrt{\\damp^2 - 1}\\right)t} \\\\\n& = \\expon{-\\damp \\freq t}\\left[A_1\\expon{\\freq t \\sqrt{\\damp^2 - 1}} + A_2\\expon{- \\freq t \\sqrt{\\damp^2 - 1}}\\right] \\\\\n& = \\expon{-\\damp \\freq t}\\left[(A_1+A_2)\\cosh \\left(\\freq t \\sqrt{\\damp^2 - 1}\\right) + (A_1 - A_2)\\sinh \\left(\\freq t \\sqrt{\\damp^2 - 1}\\right) \\right] \\\\\n\\gc (t) & = \\expon{-\\damp \\freq t}\\left[C_1 \\cosh \\left(\\freq t \\sqrt{\\damp^2 - 1}\\right) + C_2 \\sinh \\left(\\freq t \\sqrt{\\damp^2 - 1}\\right) \\right]\n\\end{align*}\\] To simplify the presentation, let us define \\[\n\\vartheta \\equiv \\freq \\sqrt{\\damp^2 -1}\n\\] so that \\[\n\\gc (t) = \\expon{-\\damp \\freq t}\\left(C_1 \\cosh \\vartheta t  + C_2 \\sinh \\vartheta t \\right)  %= \\expon{-\\damp \\freq t} Q \\cosh \\left(\\mu t - \\phs \\right)\n\\qquad(2.21)\\] To satisfy initial conditions one must have \\[\\begin{align*}\n\\gc(0) & = \\gcic = C_1 \\quad \\rightarrow \\quad C_1 = \\gcic \\\\\n\\dgc(0) & = \\dgcic = - \\damp \\freq C_1 + \\vartheta C_2 \\quad \\rightarrow \\quad C_2 = \\frac{\\dgcic + \\damp \\freq \\gcic}{\\vartheta}\n\\end{align*}\\] and hence the general solution for initial condition response of overdamped SDOF systems may be expressed as \\[\n\\gc (t) = \\expon{-\\damp \\freq t}\\left[\\gcic \\cosh \\vartheta t  + \\frac{\\dgcic + \\damp \\freq \\gcic}{\\vartheta} \\sinh \\vartheta t \\right]\n\\]\n\n\n\n\nFigure 2.8: Response of overdamped systems subjected to initial conditions \\(\\{\\gcic \\neq 0, \\dgcic=0\\}\\).\n\n\nHow the response varies for some values of \\(\\damp\\) may be seen in Figure 2.8. Each curve in this figure shows the response of an overdamped SDOF system with a specific value of \\(\\damp\\) due to nonzero initial displacement \\(\\gcic \\neq 0\\) and zero initial velocity \\(\\dgcic = 0\\). The plots are non-dimensionalized, with the horizontal axis corresponding to time scaled with \\(\\period\\) (i.e. the period the system would have if it were undamped). Evidently all responses simply decay towards the static equilibrium position. What is slightly counter intuitive is that the higher the damping coefficient in an overdamped system, the longer it takes for the system to go back to the original configuration. Higher damping limits the velocities to smaller values so that recovery takes longer.\n\nCritically damped systems: The nature of the solution will eventually change as damping gets smaller and the transition occurs when \\(c^2 - 4mk = 0\\) or, equivalently, when \\(\\damp = 1\\). In this case the roots in Equation 2.20 yield \\[\ns_1 = s_2 = - \\freq\n\\] and with repeated roots the solution takes the form \\[\n\\gc (t) = A_1 \\expon{- \\freq t} + A_2 t \\expon{- \\freq t}\n\\] For initial displacement \\(\\gcic\\) and initial velocity \\(\\dgcic\\), the coefficients are evaluated as \\[\\begin{align*}\n\\gc(0) & = \\gcic = A_1 \\quad \\rightarrow \\quad A_1 = \\gcic \\\\\n\\dgc(0) & = \\dgcic = - \\freq A_1 +  A_2 \\quad \\rightarrow \\quad A_2 = \\dgcic + \\freq \\gcic\n\\end{align*}\\] so that the general solution for critically damped single degree of freedom systems may be expressed as \\[\n\\gc (t) = \\gcic \\expon{- \\freq t} + (\\dgcic + \\freq \\gcic) t \\expon{- \\freq t}\n\\] The response is once again a simple decay with no oscillation around the static equilibrium configuration but the recovery will be faster than the curves shown in Figure 2.6. This particular case allows us to define a critical damping for SDOF systems, given by \\[\nc_{cr} = 2\\sqrt{km}\n\\] since for \\(c &gt; c_{cr}\\) the system will be overdamped, and the for \\(c &lt; c_{cr}\\) it will be underdamped. This critical value depends on the mass and stiffness properties of the system and thus it may be estimated for design purposes. Employing the critical damping concept, the coefficient \\(\\damp\\) initially defined via Equation 2.19 may also be defined as the ratio of the available damping to the critical damping, i.e. \\[\n\\damp = \\frac{c}{c_{cr}}\n\\] and so \\(\\damp\\) is referred to as the critical damping ratio or simply as the damping ratio, which is the name we will use to address it.\nUnderdamped systems: When \\(\\damp &lt; 1\\), the square roots in Equation 2.20 lead to complex numbers, and harmonic motion becomes possible. Let us express the two roots as \\[\\begin{align*}\ns_1 & = -\\damp \\freq + \\freq \\sqrt{-(1-\\damp^2)} = -\\damp \\freq + \\imag \\dfreq , \\\\\ns_2 & = -\\damp \\freq - \\freq \\sqrt{-(1-\\damp^2)} = -\\damp \\freq - \\imag \\dfreq = s_1^*\n\\end{align*}\\] where \\[\n\\dfreq \\equiv \\freq\\sqrt{1-\\damp^2}\n\\qquad(2.22)\\] is called the damped frequency of the system. Remembering the discussion about complex coefficients in undamped vibrations, the general solution may be written as \\[\n\\gc (t) = \\expon{-\\damp \\freq t}\\left(A \\expon{\\imag \\dfreq t}  + A^* \\expon{-\\imag \\dfreq t} \\right)\n\\] which, with the help of Equation 2.9, may be recast in the following form: \\[\n\\gc (t) = \\expon{-\\damp \\freq t}\\left(C_1 \\cos \\dfreq t  + C_2 \\sin \\dfreq t \\right)\n\\] Applying the initial conditions leads to \\[\\begin{align*}\n\\gc(0) & = \\gcic = C_1 \\quad \\rightarrow \\quad C_1 = \\gcic \\\\\n\\dgc(0) & = \\dgcic = - \\damp \\freq C_1 +  \\dfreq C_2 \\quad \\rightarrow \\quad C_2 = \\frac{\\dgcic + \\damp \\freq \\gcic}{\\dfreq}\n\\end{align*}\\] so that \\[\n\\gc (t) = \\expon{-\\damp \\freq t}\\left(\\gcic \\cos \\dfreq t  + \\frac{\\dgcic + \\damp \\freq \\gcic}{\\dfreq} \\sin \\dfreq t \\right)\n\\qquad(2.23)\\] Alternatively, via Equation 2.12 and defining \\[\nQ \\cos \\phs = C_1, \\quad Q \\sin \\phs = C_2\n\\] the solution may be expressed as \\[\n\\gc (t) = Q \\expon{-\\damp \\freq t} \\cos (\\dfreq t  - \\phs)\n\\qquad(2.24)\\] where \\[\nQ = \\sqrt{C_1^2 + C_2^2} = \\frac{\\sqrt{\\gcic^2 + 2 \\damp \\gcic \\left(\\ratio{\\dgcic}{\\freq}\\right)  + \\left(\\ratio{\\dgcic}{\\freq}\\right)^2}}{\\sqrt{1-\\damp^2}}\n\\qquad(2.25)\\] \\[\n\\phs = \\arctan \\frac{\\sin \\phs}{\\cos \\phs} = \\arctan \\frac{C_2/Q}{C_1 / Q} = \\arctan \\frac{(\\dgcic+\\damp\\freq\\gcic) / (\\dfreq Q)}{\\gcic / Q}\n\\qquad(2.26)\\] Evidently the oscillations in underdamped systems will take place with an exponentially decaying amplitude defined by \\(Q\\expon{-\\damp \\freq t}\\). The response is not strictly harmonic but we still talk of a period and frequency of the system: the oscillatory part, \\(\\cos (\\dfreq t - \\phs)\\), is a harmonic wave with frequency equal to the damped frequency of the system, and the damped period of the system is defined as \\[\n\\dperiod = \\frac{2\\pi}{\\dfreq}\n\\] Since the damping ratio \\(\\damp &lt; 1\\), \\[\n\\dperiod = \\frac{2\\pi}{\\freq \\sqrt{1-\\damp^2}}= \\frac{\\period}{\\sqrt{1-\\damp^2}} &gt; \\period\n\\] so that the damped period is slightly longer than the undamped period. The difference, however, is generally small for common structures, in which damping ratios are generally on the order of \\(1\\%\\) to \\(15\\%\\). Even for a relatively high damping ratio of \\(10\\%\\), the difference between the two periods is about \\(0.5 \\%\\); in most applications, this difference may be neglected and the undamped period may be referred to.\n\n\n\n\nFigure 2.9: Response of underdamped systems subjected to initial conditions: (a) Typical response of an underdamped system to initial conditions \\(\\{\\gcic &gt; 0, \\dgcic&gt;0\\}\\), (b) effects of damping ratio on the response to initial conditions \\(\\{\\gcic \\neq 0, \\dgcic=0\\}\\).\n\n\nThe responses of underdamped systems are visualized in Figure 2.9. The typical response of an underdamped system, subject to initial conditions \\(\\gcic &gt; 0\\) and \\(\\dgcic &gt; 0\\) is shown in Figure 2.9(a). The response at any instance is the product of the harmonic wave \\(\\cos (\\dfreq t - \\phs)\\) with the envelope \\(Q\\expon{-\\damp\\freq t}\\), resulting in an oscillation about the natural equilibrium configuration with an exponentially decaying amplitude. The damped period is easily identified as the duration between any two consecutive down-crossings (or up-crossings), or any two consecutive peaks (or troughs). How fast the response decays in a single cycle depends on the value of \\(\\zeta\\); this dependence is clearly seen in Figure 2.9(b), which shows the responses of underdamped systems with three different values of \\(\\zeta\\), all plotted in non-dimensionalized form to allow a direct comparison.\n\n\n2.4.2 Estimating Viscous Damping from Free Vibration Data\nIncreasing damping ratio in underdamped systems leads obviously to faster decay in the response, which may be quantified by the decrease in amplitudes of peaks. This relation is used directly in a well known method used to estimate the damping ratio of SDOF systems. Consider a local peak, say the ith local peak, that occurs at some time \\(t=t_i\\). The amplitude \\(Q_i\\) of this peak will be given by \\[\nQ_i = \\gc (t_i) = Q \\expon{-\\damp \\freq t_i} \\cos (\\dfreq t_i - \\phs)\n\\] as shown in Figure 2.10.\n\n\n\nFigure 2.10: Peaks in free vibrations of a viscously underdamped system.\n\n\nThis local peak does not occur exactly when the cosine term is equal to one. In fact, by taking the first time derivative of the displacement given by Equation 2.24 and after combining the harmonic terms, the velocity may be expressed as \\[\n\\dgc (t) = - \\freq Q \\expon{- \\damp \\freq} \\sin (\\dfreq t - \\phs + \\alpha)\n\\qquad(2.27)\\] where \\(\\alpha\\) is a phase shift that depends on the damping ratio as \\(\\tan \\alpha = \\damp/\\sqrt{1-\\damp^2}\\), which yields \\(\\alpha \\approx \\damp\\) for \\(\\damp \\ll 1\\). If there is no damping then \\(\\alpha=0\\), and for small values of damping it is very close to zero. In any case, an extremum in the displacement occurs whenever \\(\\sin (\\dfreq t - \\phs + \\alpha) = 0\\). If a local peak occurs at time \\(t=t_i\\), then the next local peak occurs at \\(t=t_i + \\dperiod\\) since \\(\\sin (\\dfreq (t_i+\\dperiod) - \\phs + \\alpha) = \\sin (2\\pi + \\dfreq t_i - \\phs + \\alpha) = \\sin (t_i - \\phs + \\alpha)\\); it is obvious from this discussion that all consecutive local peaks are separated by duration \\(\\dperiod\\). The amplitude \\(Q_{i+1}= \\gc (t_i+\\dperiod)\\) of the \\((i+1)\\)th local peak therefore is given by \\[\nQ_{i+1} = Q \\expon{-\\damp \\freq (t_i+\\dperiod)} \\cos (\\dfreq (t_i+\\dperiod) - \\phs) = Q \\expon{-\\damp \\freq t_i} \\expon{-2 \\pi \\damp / \\sqrt{1-\\damp^2}} \\cos (\\dfreq t_i - \\phs)\n\\] since the angles in \\(\\cos (\\dfreq (t_i+\\dperiod) - \\phs)\\) and \\(\\cos (\\dfreq t_i - \\phs)\\) differ by \\(2 \\pi\\). The ratio of the amplitudes of two consecutive local peaks is therefore given by \\[\n\\frac{Q_i}{Q_{i+1}} = \\expon{2 \\pi \\damp / \\sqrt{1-\\damp^2}}\n\\qquad(2.28)\\]\n\\(\\rem{Logarithmic decrement}\\) is the name given to the natural logarithm of the ratios of two successive local peaks. It may be measured and calculated directly from recorded free vibration data and it is a widely used indicator of energy dissipation; as the velocity is zero at the peaks, the energy of the system when the mass is at a peak displacement comprises only the potential energy, which is a direct function of the displacement. Based on Equation 2.28, the logarithmic decrement in a viscously damped system is therefore given by \\[\n\\ln \\frac{Q_i}{Q_{i+1}} = 2 \\pi \\frac{\\damp}{\\sqrt{1-\\damp^2}}\n\\qquad(2.29)\\] so that, having measured the amplitudes, the damping ratio of the system may be calculated from \\[\n  \\frac{\\damp}{\\sqrt{1-\\damp^2}} = \\frac{1}{2\\pi} \\ln \\frac{Q_i}{Q_{i+1}}\n\\qquad(2.30)\\] When the damping ratio is small, this expression may be approximated by \\[\n  \\damp \\approx \\frac{1}{2\\pi} \\ln \\frac{Q_i}{Q_{i+1}}\n\\qquad(2.31)\\] which is the form more commonly encountered. Applications have shown that the damping estimates improve if one uses the ratio of more widely separated peaks instead of two consecutive ones. If one uses two local peaks, \\(Q_{i}\\) and \\(Q_{i+n}\\), separated by a duration of \\(n\\dperiod\\), the damping may be estimated as \\[\n  \\frac{\\damp}{\\sqrt{1-\\damp^2}} = \\frac{1}{2\\pi n} \\ln \\frac{Q_i}{Q_{i+n}} \\approx \\damp\n\\qquad(2.32)\\] where the last approximation is acceptable only for small values of damping ratio; it might be mentioned that the error due to this approximation alone would be less than \\(1\\%\\) for damping ratios less than \\(10\\%\\).\n\n\n2.4.3 Energy Dissipated by Viscous Damping\nThe amount of energy dissipated due to viscous damping may be calculated based on the principle of work and energy which states that the total mechanical energy of a system varies as it moves from state 1 at time \\(t=t_1\\) to state 2 at time \\(t=t_2\\) according to \\[\n\\te_1 + \\wnc_{1 \\rightarrow 2} = \\te_2\n\\] where \\(\\te_i=\\ke_i + \\pe_i\\) is the total energy of the system at state \\(i\\), and \\(\\ke_i\\) and \\(\\pe_i\\) are the system’s kinetic and potential energies, respectively, at state \\(i\\). When a single degree of freedom system is governed by Equation 2.17, its kinetic and potential energies at state \\(i\\) at time \\(t=t_i\\), may be expressed as \\[\n\\ke_i = \\frac{1}{2} m [\\dgc(t_i)]^2, \\qquad \\pe_i = \\frac{1}{2} k [\\gc(t_i)]^2\n\\] with the set \\(\\left\\{ \\gc (t_i), \\dgc (t_i) \\right\\}\\) denoting the state of the system at time \\(t_i\\). The displacement (deformation) and the velocity are sufficient to define the state since the acceleration at time \\(t=t_i\\) is dependent on these through the equation of motion. The third component \\(\\wnc_{1 \\rightarrow 2}\\) is the work done by non-conservative forces as the system moves from state 1 to state 2. The only non-conservative force in the system of Figure 2.7 is the damping force \\(c\\dgc\\). Consider the free body diagram of the SDOF system at some time \\(t\\) shown in Figure 2.11. When the system moves by an amount \\(\\diff \\gc\\), the change in the system’s energy will equal to the work done by this force so that \\[\n\\diff{\\te} = - c \\dgc \\diff \\gc\n\\qquad(2.33)\\] where the minus sign is due to the algebraicaly consistent directions employed. Note that the work done by the spring force is the change in potential energy and the work done by the d’Alembert force is the change in kinetic energy, and so they are accounted for as \\(\\diff{\\te}\\). The time rate of change of energy will be given by \\[\n\\divt{\\te} = - c \\dgc \\divt{\\gc} = - c \\dgc^2\n\\qquad(2.34)\\]\n\n\n\nFigure 2.11: Free body diagram of the freely vibrating damped SDOF system.\n\n\nIn principle, this expression may be integrated, either over a path via Equation 2.33 or over a duration via Equation 2.34, to calculate the energy dissipated over the path or time interval investigated, which is simply the negative of the work done by the non-conservative forces. A simple result, however, does not emerge in the case of free vibrations because the dissipated energy depends on the state or, equivalently, where in its cycles the system is. To give an idea as to possible results, the energy dissipated in \\(t=[0,\\dperiod)\\) may be shown to be equal to \\[\\begin{align*}\n\\int_{0}^{\\dperiod} c \\dgc^2 \\diff t & = c \\int_{0}^{\\dperiod} \\left[-Q\\expon{-\\damp \\freq t} \\left(\\damp \\freq \\cos (\\dfreq t - \\phs) + \\dfreq \\sin(\\dfreq t - \\phs) \\right) \\right]^2\\diff t \\\\\n& = \\frac{cQ^2}{4}\\left[ 1 - \\expon{-4 \\pi \\damp / \\sqrt{1-\\damp^2}} \\right] \\left[\\frac{\\dfreq^2}{\\damp\\freq} + 2 \\damp \\freq \\cos^2 \\phs - \\dfreq \\sin 2\\phs\\right]\n\\end{align*}\\]\nOne graphical tool frequently used to visualize the effects of energy dissipation is to plot the force-displacement relationship. The force in the context of free vibrations refers to the total resisting force that acts on the mass of the prototype model. When the system is undamped, this force is simply \\(\\extforce_{R}=k \\gc\\), and when the system is linearly viscously damped, it is \\(\\extforce_{R} = k \\gc + c \\dgc\\). The force-displacement graphs of these two cases are presented in Figure 2.12. These plots have been developed for durations of one period starting with time \\(t=0\\) for systems subjected to the same initial velocity but no initial displacement, the only difference between the systems of the two plots being the addition of damping in the second one.\nThe main difference between the behavior observed in Figure 2.12 is the area enclosed by each curve. When undamped, the system loads and unloads (with directions indicated by the arrowheads on the curves) along the same line as shown in Figure 2.12 (a). Force and displacement are in phase, and as a result the total work done by the force as the system moves through one full period is zero. In the viscously damped system, the path is curvilinear as shown in Figure 2.12 (b) because of the phase difference between the force and displacement; moreover, the total work done is not zero in this case but the system dissipates energy of amount equal to the shaded area “enclosed” within the curve. When the force-displacement curve encloses an area the system is said to exhibit \\(\\rem{hysteretic behavior}\\), after such behavior observed in magnetic hysteresis.\n\n\n\nFigure 2.12: Force-displacement plots for (a) undamped and (b) linearly viscously damped SDOF systems.\n\n\n\n\n2.4.4 Non-viscous Damping Models\nThe widespread acceptance of the viscous damping model has reinforced itself with its appearance in structural codes and more recent identification and health monitoring studies which have focused almost exclusively on fitting viscous damping models to vibration data obtained from large scale systems. The complexity of energy dissipation mechanisms in large scale systems somewhat justifies the use of this model due to its relative simplicity and success. When studying individual components, composite materials and high amplitude vibrations, however, other damping mechanisms have proved useful and sometimes provided better results. Although we will revisit some of these models when studying forced vibrations, here we will briefly mention them and comment on their major differences compared with the viscous damping model.\nThe two governing characteristics of the viscous damping model are that: i. it predicts an exponentially decaying response; ii. the amount of energy dissipated in one cycle of steady state vibrations under a harmonic external excitation depends on the frequency. A physical shortcoming of the model is that the oscillations theoretically continue indefinitely albeit at completely negligible amplitudes; observationally the vibrations in real structures eventually cease so that the real dissipative mechanism should be at the very least a combination of viscous and friction mechanisms. Since this phenomenon becomes significant in very low amplitudes that possibly have no bearing at all on design constraints it is not generally dwelt upon, and the focus of investigations lie with the general characteristics that are pronounced in design sensitive amplitudes.\nOne often cited alternative damping model is called Coulomb damping, with energy dissipated through sliding friction (in other words, external friction). In this case the dissipative force is not velocity dependent as in the case of viscous damping but rather it has a constant value, whereas the direction of this force varies as the direction of motion, i.e. direction of velocity, changes. The solution of this problem is not particularly difficult but now the problem is that of forced vibrations. Analysis of this problem shows that the decay predicted by Coulomb damping is linear, as opposed to the exponential decay of viscous damping; the mass does come to a stop in finite time, however, since the energy of the system eventually fails to overtake friction. The fact that exponential decay seems to match better with experimental evidence is one reason that Coulomb damping has not gained much precedence in structural dynamics.\nAnother damping model which goes by different names including structural damping or hysteretic damping aims to model dissipation through internal friction. The motivation for this type of damping comes from observations regarding energy dissipation of systems oscillating harmonically, as a single degree of freedom system would when it reaches steady state under a harmonic forcing. A thorough understanding of this statement requires forced vibration analysis, but to provide a qualitative perspective we note that viscous damping leads to a closed, elliptic hysteresis loop whose size depends on the frequency of loading (which in steady state becomes the frequency with which the system moves). Hence, viscous damping or the energy it dissipates is sometimes referred to as frequency dependent. Experimental observations have shown however that hysteresis loops tend to be independent of frequency in a wide range of systems and frequencies. The structural damping model has been proposed to reflect this frequency independent property, which may be mathematically achieved by treating the stiffness as having a complex valued part. The analysis of this model is however more involved and particularly not so simple for free vibrations."
  },
  {
    "objectID": "singledof.html#sec-GeneralizedSDOF",
    "href": "singledof.html#sec-GeneralizedSDOF",
    "title": "2  Free Vibrations of Single Degree of Freedom Systems",
    "section": "2.5 Generalized SDOF Systems",
    "text": "2.5 Generalized SDOF Systems\n\n2.5.1 Continuous Systems\nWhen the mass and flexibility of a system are distributed, it becomes necessary for a precise formulation to treat the system as continuous, and the state of the system is defined as functions of both space (comprising all the points included in the system’s domain) and time. Due to this continuity, such systems have infinite number of degrees of freedoms governed by partial differential equations, and their response shows considerable complexity compared with the simple SDOF model. In certain cases, however, single degree of freedom models may yield reasonable estimates of prominent dynamic characteristics of complex systems provided that the deformation patterns are estimated relatively accurately.\nConsider for example a cantilever beam as shown in Figure 2.13; this could be a chimney with possibly variable cross section of bending rigidity8 \\(EI = EI(s)\\), length \\(\\ell\\), mass per unit length \\(\\mlen=\\mlen(s) = \\rho A(s)\\). Analysis of the vibration problem for this system requires that the equations of motion be formulated in terms of the displacement field \\(\\gc=\\gc(s,t)\\) and one will obtain a partial differential equation, which in the case of variable section will be nonlinear, that must be solved. We will eventually deal with vibrations of simple continuous systems but at this stage such an approach is simply not feasible. The experience gained through analyses of such systems have however shown us that they have many frequencies with which they may oscillate, and that they maintain some particular shapes when they oscillate harmonically with any of those frequencies. This behavior could be exploited and a great simplification would be achieved if the shape of vibration could somehow be foreseen. This of course is not practically possible, but it turns out that a reasonable estimate of how the structure would behave may lead to acceptable results.\n\n\n\nFigure 2.13: A tall chimney.\n\n\nWe feel it is best to proceed by demonstration, so let us continue the simplified analysis of the chimney. We will assume that during free vibrations the chimney oscillates harmonically with a certain frequency and that during these oscillations it maintains a constant shape albeit with varying amplitude so that the at any instant \\(t\\), the lateral displacement of the section at location \\(s\\) is given by \\[\n\\gc (s,t)=\\shpf (s) \\gengct\n\\qquad(2.35)\\] where \\(\\shpf=\\shpf(s)\\) is called the shape function and \\(\\gengc = \\gengc (t)\\) is a time dependent amplitude, generally corresponding to the actual displacement of a particular point. Equation 2.35 is a variation of the method of separation of variables since instead of solving for possible candidates via the governing equation of motion, the shape function in this case is specified by the analyst. There are some guidelines as to how this choice may be improved. First the restraints: the shape function should satisfy the geometric boundary conditions because only by doing so it can be ensured that the solution will satisfy those conditions. Since in our example the chimney is fixed at \\(s=0\\), at any instant during motion we should have no translation or rotation at \\(s=0\\): \\[\n\\gc (s,t)|_{s=0} = 0, \\qquad \\pardiv{\\gc (s,t)}{s}\\biggr|_{s=0} = 0\n\\] If we are to use the approximation of Equation 2.35, these conditions are satisfied at all times only if \\[\n\\shpf (0) = 0, \\qquad \\divp{\\shpf}{s}\\biggr|_{s=0} = 0\n\\] To simplify the presentation, let us introduce the following notation to denote derivatives with respect to a spatial variable, such as \\(s\\) in this example: \\[\n\\shpf' = \\shpf' (s) = \\divp{\\shpf (s)}{s}, \\quad \\shpf'' = \\shpf''(s) = \\frac{\\diff^2 \\shpf (s)}{\\diff s^2}\n\\] With this notation, the geometric conditions may be written more simply as \\[\n\\shpf (0) = 0, \\quad \\shpf'(0) = 0\n\\qquad(2.36)\\] and we note that, whatever shape function \\(\\shpf\\) we choose for the chimney, we should at a minimum ensure that the conditions in Equation 2.36 are satisfied. Satisfaction of these condition, however, is not sufficient to ensure acceptably accurate results since the approximation will improve only if the shape function truly resembles the actual shape taken on by the system. Various proposals have been discussed to ensure acceptable results, including choosing the shape function as the deflected shape of the structure under some static loading. As the possibilities are numerous, here we will focus on the procedure and we will try to provide some worked examples to investigate the performances of differing shape functions.\nFor our chimney, we will choose the unknown amplitude \\(\\gengc\\) to be the displacement at the tip, i.e. we choose \\(\\gengc (t) \\equiv \\gc(\\ell, t)\\). The shape function now will have to be a function which will satisfy the geometric boundary conditions at the fixed end, i.e. \\(\\shpf (0) = 0, \\shpf'(0) = 0\\), but it will also have to satisfy \\(\\shpf (\\ell) = 1\\) at the tip since by choice \\(\\gc (\\ell, t) = \\shpf (\\ell) \\gengc (t) = \\gengc (t)\\). Two simple candidates could for example be: \\[\n\\shpf (s) = \\frac{s^2}{2\\ell} \\quad \\text{or} \\quad \\shpf(s) = \\frac{1}{2}\\left(1-\\cos \\frac{\\pi s}{\\ell}\\right)\n\\]\nHaving specified a shape function, we are now ready to proceed with the analysis. The method of choice is virtual work, which requires that d’Alembert forces be included. At any point along the chimney the acceleration is given by the second time derivative of \\(\\gc (s,t)\\), and our approximation leads to \\[\n\\gc (t) = \\shpf \\gengc (t) \\quad \\rightarrow \\quad \\frac{\\partial^2 \\gc}{\\partial t^2} = \\shpf \\ddgengc (t)\n\\] since the shape function is constant in time. For the segment of width \\(\\diff s\\) and located at position \\(s\\), the d’Alembert force to be acted on it at time \\(t\\) is given by \\[\n\\bigl[\\mlen \\diff s\\bigr] \\shpf \\ddgengc (t)\n\\] acting in the direction opposite to that of the acceleration9 so that per unit length, the d’Alembert force is given by \\(\\mlen\\shpf \\ddgengc (t)\\). These forces are included in the free body diagram shown in Figure 2.13 (c), which also includes the reaction forces at the base (i.e. the fixed end). Since with the inclusion of the d’Alembert forces the system is instantaneously in a state of static equilibrium, the principle of virtual work dictates that in a virtual variation of displacements, the virtual internal work has to be equal to the virtual external work: \\[\n\\vwork_{int} = \\vwork_{ext}\n\\] The virtual displacements are generated by a variation in the single free parameter \\(\\gengc\\) because \\(\\shpf\\) is prescribed, and so the virtual displacement pattern is given by \\[\n  \\vgc (s) = \\shpf (s) \\vgengc\n\\qquad(2.37)\\] where it should be noted that while \\(\\gc = \\gc (s,t)\\) and \\(\\gengc = \\gengc (t)\\), \\(\\vgc\\) is a function only of the spatial coordinate and neither \\(\\vgc\\) nor \\(\\vgengc\\) are functions of time.10\nSince the shape function satisfies the geometric boundary conditions, there will be no translation of rotation induced at the fixed end during the virtual displacement, and the work done by the reaction forces at the base will be zero. The only external work done is that due to the d’Alembert forces, which may be calculated via \\[\\begin{align*}\n\\vwork_{ext} & = \\int_{0}^{\\ell} - \\bigl[\\mlen \\shpf \\ddgengc \\diff s\\bigr] \\bigl[\\vgc \\bigr] \\\\\n& = - \\left[\\int_{0}^{\\ell} \\mlen \\shpf^2  \\diff s \\right] \\ddgengc \\vgengc = -  \\genm \\ddgengc \\vgengc\n\\end{align*}\\] where \\[\n\\genm = \\int_{0}^{\\ell} \\mlen \\shpf^2 \\diff s\n\\] is called the generalized mass.\nThe internal work is slightly more involved with various components that may be taken into consideration. To keep the derivation relatively simple, let us assume that bending deformations dominate and that bending is uniaxial during motion. Under the assumption of cross sections remaining plane and perpendicular to the neutral axis, which is the pillar of the well known Euler-Bernoulli beam theory, the geometry of deformation is completely described by the displacement \\(\\gc = \\gc(s,t)\\) and its spatial derivatives. Let the rotation of the cross section at \\(s\\) be denoted by \\(\\eta = \\eta (s,t)\\). This rotation is related in general to the displacements through \\[\n\\eta = \\frac{\\partial u}{\\partial s}\n\\] so that for the approximation considered, we have \\[\n\\gc = \\shpf \\gengc \\quad \\rightarrow \\quad \\eta = \\shpf' \\gengc\n\\] and the virtual rotation imposed due to the variation \\(\\vgengc\\) is given by \\[\n\\virt \\eta = \\shpf' \\vgengc\n\\] Another key geometric quantity is the curvature, expressing the variation of the slope along the elastic curve11. For small displacement gradients, it is shown in all introductory strength of materials texts that the relationship between rotation and curvature \\(\\curv = \\curv (s,t)\\) is given by \\[\n\\diff \\eta = \\curv \\diff s\n\\] so that curvature is related to the displacements through \\[\n\\curv = \\frac{\\partial \\eta}{\\partial s} = \\frac{\\partial^2 \\gc}{\\partial s^2}\n\\] For the generalized SDOF approximation we therefore have \\[\n\\eta = \\shpf \\gengc \\quad \\rightarrow \\quad \\curv = \\shpf'' \\gengc\n\\] and the relative virtual rotation \\(\\diff\\, (\\virt \\eta)\\) of two infinitesimally close cross sections may be expressed in terms of the virtual curvature as \\[\n\\diff\\, (\\virt \\eta) = \\left(\\virt \\curv\\right) \\diff s = (\\shpf'' \\vgengc) \\diff s\n\\]\n\n\n\nFigure 2.14: Bending moments and rotations in a beam. (a) Undeformed configuration, (b) real rotations of two infinitesimally close cross sections and the bending moments acting on them, (c) virtual rotations imposed.\n\n\nThe work done by the internal bending moment \\(\\smoment(s,t)\\) acting on the cross sections at \\(s\\) and \\(s + \\diff s\\) depends on the relative rotation of these two cross sections. As the rotations vary due to the virtual displacements as schematically shown in Figure 2.14, the net virtual work done by the bending moments is given by \\(\\smoment \\diff\\, (\\virt \\eta) = \\smoment \\shpf'' \\vgengc \\diff s\\) if we neglect the work done by \\(\\diff M\\) since the product of \\(\\diff M\\) with any other infinitesimal quantity is expected to be of second order. In uniaxial bending of a linear elastic bar, the bending moment \\(\\smoment = \\smoment (s,t)\\) is related to the curvature through the well known expression \\[\n\\smoment = E I \\curv =  E I \\frac{\\partial^2 \\gc}{\\partial s^2} = E I \\shpf'' \\gengc\n\\] so that the virtual work done by \\(\\smoment\\) as it goes through the incremental difference of virtual rotation may be expressed as \\[\n\\smoment \\diff\\, (\\virt \\eta) = \\left(E I \\shpf'' \\gengc\\right) \\left(\\shpf'' \\vgengc \\diff s\\right) = EI (\\shpf'')^2 \\gengc \\vgengc \\diff s\n\\] and the total internal work done may be calculated by integrating over the whole length so that \\[\n\\vwork_{int} = \\int_{0}^{\\ell} EI (\\shpf'')^2 \\gengc \\vgengc \\diff s = \\left[ \\int_{0}^{\\ell} EI (\\shpf'')^2  \\diff s \\right] \\gengc \\vgengc = \\genk \\gengc \\vgengc\n\\] where \\[\n\\genk = \\int_{0}^{\\ell} EI (\\shpf'')^2  \\diff s\n\\] is called the generalized stiffness.12\nThe principle of virtual work demands that the external virtual work must be equal to the internal virtual work so that we have \\[\n\\vwork_{ext} =  -  \\genm \\ddgengc \\vgengc = \\genk \\gengc \\vgengc = \\vwork_{int} \\quad \\rightarrow \\quad \\left[\\genm \\ddgengc + \\genk \\gengc \\right] \\vgengc = 0\n\\] and since this condition must be satisfied for all admissible virtual displacements, i.e. for any admissible \\(\\vgengc\\), it must be that \\[\n\\genm \\ddgengct + \\genk \\gengct = 0\n\\qquad(2.38)\\] The similarity of this final equation with the standard equation of motion for the prototypical SDOF model is obvious, but we feel that the notational difference involving the superscript asterisk is worthwhile to emphasize that the generalized SDOF approach involves significant further approximations compared with the more conventional SDOF models.\nAn estimate for the natural frequency of the system is now given by \\[\n  \\genfreq = \\sqrt{\\frac{\\genk}{\\genm}}\n\\qquad(2.39)\\] which may be shown to provide an upperbound for the lowest frequency of the real system.13 The approximation would get better as the assumed shape \\(\\shpf\\) resembles more and more the actual shape the structure oscillates with. While it may not be possible to perfectly estimate the true shape, it is possible to improve the estimates; one could, for example, try a few alternative proposals for \\(\\shpf\\) and take the minimum of the estimated frequencies obtained via each shape.\nFor historical reasons it should be mentioned that this approach is sometimes referred to as Rayleigh’s method, wherein an approximating function defined over the whole domain is used to estimate the frequency of a complex system. One could use a set of approximating functions, defined again over the whole domain, which may be used to estimate multiple frequencies, and this approach is generally called the Rayleigh-Ritz method. One could also divide the domain and use approximating functions in each of the sub-domains, leading to what is commonly referred to as the finite element method of analysis, which is very suitable for computer based analysis of structures.\n\n\n\n\nRecall from basic strength of materials that the bending rigidity of a homogeneous linear elastic bar is the product of the material’s modulus of elasticity \\(E\\) and the cross sectional area’s second moment \\(I\\) about the bending axis.↩︎\nTo clarify this statement: when free body diagrams are sketched, we consider an instant at which \\(\\gc\\) and its time derivatives are (considered to be) positive valued, and sketch all the forces in accordance with this setup. This ensures compatibility with assumed sign convention: when the sign of \\(\\gc\\) or its derivatives change, so do automatically the directions of the associated forces, and there is no need for explicit corrections.↩︎\nReminder: virtual displacements are some non-zero patterns that are imposed on the structure in a fashion that is independent of time, as if time was frozen at that particular instant at which the system attained a state of static equilibrium. A virtual displacement hypothetical, a thought experiment if you wish, and not an actually imposed displacement.↩︎\nElastic curve is a name given to the deformed shape of a beam’s longitudinal axis.↩︎\nHere we have considered only bending deformations to keep the discussion relatively simple. It is possible to include the contributions of other deformations, including for example shear and axial deformations, in the calculation of virtual work as well.↩︎\nAlthough the details are to be provided in latter chapters, it should be mentioned here that while a single DOF system has only a single frequency with which it freely vibrates, multi DOF systems have multiple frequencies with which they may freely vibrate. The lowest of those frequencies is often the one that is most significant in the vibrations of such structures and so a good estimate of that lowest frequency is quite helpful.↩︎\n\n\n\n2.5.2 Discrete Systems\nDiscrete systems refers in dynamics to those systems which may have distributed flexibility but their mass is assumed to be concentrated at a finite number of points on the system. This concentration leads to a finite number of degrees of freedom, as opposed to the uncountable number in continuous systems, so that these systems are generally referred to as multi degree of freedom (MDOF) systems. An MDOF system is governed by a set of coupled ordinary differential equations, as many as the number of degrees of freedom, and many frequencies with which it may oscillate. The analysis of motion is therefore much more involved compared to the analysis of an SDOF system. On the other hand, it may be possible also for MDOF systems to obtain acceptable estimates for the fundamental (lowest) frequency of the system using the generalized SDOF approach.\n\n\n\nFigure 2.15: A three story shear building.\n\n\nTo again proceed with an example, let us consider a simple three story structure with rigid floors, represented as three single bay frames vertically stacked as shown in Figure 2.15(a), with masses concentrated at the floor levels. It is assumed that the structure is symmetric so that translation along one horizontal direction is uncoupled from rotation of the floor plates in their own plane and translation along the orthogonal horizontal direction; axial deformations are altogether ignored. This is called the shear building model, and it is frequently used for buildings of different heights.14 The deformation pattern is prescribed by the lateral translations of the floors, denoted here by \\(\\gc_1=\\gc_1(t)\\), \\(\\gc_2=\\gc_2(t)\\) and \\(\\gc_3=\\gc_3(t)\\). Generalization of the approach is much easier is matrix notation is used, so let us define a displacement matrix \\(\\gcvec=\\gcvec(t)\\) as \\[\n\\gcvec \\equiv \\left\\{ \\begin{array}{c} \\gc_1 \\\\ \\gc_2 \\\\ \\gc_3 \\end{array} \\right\\}\n\\] where it should be obvious that if there were \\(N\\)-many floors, the dimension of \\(\\gcvec\\) would be \\(N \\times 1\\). Lateral translation of the floors are resisted by deformations in the structural load bearing members, most importantly the columns, in such a way that the cumulative lateral story stiffness (including all contributions) is assumed to be equal to \\(k_i\\) for the \\(i\\)th story, and the force-displacement relationship is assumed to be linear. The internal forces that develop as a result of the motion of the floor masses is in general much more complicated, including axial forces and bending moments at the ends of the columns in addition to lateral shear forces, and the structural behavior will most probably nonlinear under significant displacements. When axial deformations are neglected and the floors are assumed to be rigid, however, the axial forces and moments in the columns are not associated with any inertial action and hence they are not explicitly treated in the dynamic analysis. When they need to be determined, they may be calculated using standard structural analyses methods once the dynamic response is evaluated.\nThe generalized SDOF approximation for discrete systems is based on assuming a time independent displacement pattern with an unknown amplitude, as was done for continuous systems, with the displacement pattern defined not by a shape function \\(\\shpf (s)\\) defined over the whole domain but rather by a shape matrix \\(\\vshpf\\) such that \\[\n\\gcvec (t) = \\vshpf \\gengct\n\\qquad(2.40)\\] which, when written out explicitly for an \\(N\\)-DOF model, may be expressed as \\[\n  \\left\\{ \\begin{array}{c} \\gc_1 (t) \\\\ \\gc_2 (t) \\\\ \\vdots \\\\ \\gc_N (t) \\end{array} \\right\\}  = \\left\\{ \\begin{array}{c} \\pvshpf{1} \\\\ \\pvshpf{2} \\\\ \\vdots \\\\ \\pvshpf{N} \\end{array} \\right\\} \\gengc (t)\n\\qquad(2.41)\\] The time dependent variable \\(\\gengc\\) is generally defined to be the amplitude of response that would be observed at one of the degrees of freedom. For our three story frame, for example, we could choose \\(\\gengc \\equiv \\gc_3\\); in this case, the shape matrix may be chosen as \\[\n\\vshpf = \\left\\{ \\begin{array}{c} 1/3 \\\\ 2/3 \\\\ 1 \\end{array}\\right\\}\n\\] if we foresee a linear increase with height, or perhaps as \\[\n\\vshpf = \\left\\{ \\begin{array}{c} 5/10 \\\\ 8/10 \\\\ 1 \\end{array}\\right\\}\n\\] if relatively larger deformations are expected in the lower stories. Obviously the choices are endless, and the only guide is an estimate of how such a structure would possibly behave. In any case, once the shape matrix is fixed, the virtual displacements are obtained only through a variation in \\(\\gengc\\) so that \\[\n\\virt \\gcvec = \\vshpf \\vgengc\n\\]\nBy virtue of the shear building model’s inherent assumptions, the internal virtual work done through the virtual displacements will comprise the work done by the end shear of the columns alone. Consider two consecutive floors, floor \\(i\\) and \\(i-1\\), with the \\(i\\)th story columns between them, as shown in Figure 2.16. The cumulative shear force obtained by summing the shear forces at one end of the columns is called the story shear \\(V_{i}\\), which is the total force transmitted by the story. If the stiffness of the story is \\(k_{i}\\), then this shear force is given by \\(V_{i} = k_{i} (\\gc_{i} - \\gc_{i-1})\\) since the difference \\(\\gc_{i} - \\gc_{i-1}\\) is the deformation which the columns of that story suffer;15 this relative displacement is also called the interstory drift. The work done by \\(V_{i}\\) as the floors go through virtual displacements \\(\\vgc_i\\) and \\(\\vgc_{i-1}\\) is given by \\[\nV_{i} \\vgc_{i} - V_{i} \\vgc_{i-1} = V_{i} (\\vgc_{i} - \\vgc_{i-1}) = V_{i} (\\pvshpf{i} - \\pvshpf{i-1})\\vgengc\n\\] which, after substituting in the force-displacement relationship and the generalized SDOF approximation, leads to \\[\nk_{i} (\\pvshpf{i} - \\pvshpf{i-1})^2 \\gengc \\vgengc\n\\] and the total virtual internal work done will be a summation of all the contributions so that,16 \\[\n\\vwork_{int} = \\left[\\sum_{i=1}^{N} k_{i} (\\pvshpf{i} - \\pvshpf{i-1})^2 \\right]\\gengc \\vgengc\n\\qquad(2.42)\\]\n\n\n\nFigure 2.16: Lateral shear forces at column ends.\n\n\nThe term in the brackets in Equation 2.42 may be expanded and then rewritten as a matrix equation so that, for example, for our 3-story shear frame, \\[\n\\sum_{i=1}^{3} k_{i} (\\pvshpf{i} - \\pvshpf{i-1})^2 = \\begin{Bmatrix} \\pvshpf{1} & \\pvshpf{1} & \\pvshpf{3} \\end{Bmatrix} \\begin{bmatrix} k_1 + k_2 & -k_2 & 0 \\\\ -k_2 & k_2 + k_3 & -k_3 \\\\ 0 & -k_3 & k_3 \\end{bmatrix} \\begin{Bmatrix} \\pvshpf{1} \\\\ \\pvshpf{2} \\\\ \\pvshpf{3} \\end{Bmatrix} = \\vshpf^T \\kmat \\vshpf\n\\] where the superscript \\(\\mtrx{\\cdot}^T\\) denotes the transpose of the matrix \\(\\mtrx{\\cdot}\\) and \\(\\kmat\\) is the stiffness matrix of the system, a concept well known from static analysis but written here for dynamic degrees of freedom. The total virtual internal work may finally be expressed as \\[\n\\vwork_{int} = \\left( \\vshpf^T \\kmat \\vshpf \\right) \\gengc \\vgengc = \\genk \\gengc \\vgengc\n\\] where \\[\n\\genk = \\vshpf^T \\kmat \\vshpf\n\\] is the generalized stiffness of the system.17\nThe external virtual work for the shear frame is relatively easier to calculate. The acceleration of the \\(i\\)-th floor mass is given by \\(\\ddgc_i = \\pvshpf{i} \\ddgengc\\) and the associated d’Alembert forces are shown in Figure 2.15(c). The work done by the d’Alembert force on the \\(i\\)-th floor as that floor goes through the virtual displacement \\(\\vgc_{i} = \\pvshpf{i}\\vgengc\\) is \\[\n- \\left(m_i \\pvshpf{i} \\ddgengc \\right)\\pvshpf{i}\\vgengc = - m_i \\left(\\pvshpf{i} \\right)^2 \\ddgengc \\vgengc\n\\] and, going through steps similar to those undertaken in derivation of the internal work, the total external virtual work for our 3-story frame may now be evaluated via \\[\\begin{align*}\n  \\vwork_{ext} & = - \\left[ \\sum_{i=1}^3 m_i \\left(\\pvshpf{i} \\right)^2 \\right] \\ddgengc \\vgengc = \\begin{Bmatrix} \\pvshpf{1} & \\pvshpf{1} & \\pvshpf{3} \\end{Bmatrix} \\begin{bmatrix} m_1  & 0 & 0 \\\\ 0 & m_2 & 0 \\\\ 0 & 0 & m_3 \\end{bmatrix} \\begin{Bmatrix} \\pvshpf{1} \\\\ \\pvshpf{2} \\\\ \\pvshpf{3} \\end{Bmatrix}  \\ddgengc \\vgengc \\\\\n  & = - \\left(\\vshpf^T \\mmat \\vshpf \\right) \\ddgengc \\vgengc = - \\genm \\ddgengc \\vgengc\n\\end{align*}\\] where \\(\\mmat\\) is called the mass matrix of the system, and \\[\n\\genm = \\vshpf^T \\mmat \\vshpf\n\\] is its generalized mass.\nThe by-now-familiar steps follow: principle of virtual work demands we must have \\[\n\\vwork_{ext} =  -  \\genm \\ddgengc \\vgengc = \\genk \\gengc \\vgengc = \\vwork_{int} \\quad \\rightarrow \\quad \\left[\\genm \\ddgengc + \\genk \\gengc \\right] \\vgengc = 0\n\\] and since this condition must be satisfied for all admissible virtual displacements it must be true that \\[\n\\genm \\ddgengct + \\genk \\gengct = 0\n\\] which is identical to Equation 2.38. Once again, an estimate for the fundamental frequency of the system is provided by: \\[\n\\genfreq = \\sqrt{\\frac{\\genk}{\\genm}}\n\\]\n\n\n\n\nThis is essentially a model comprising masses in series, each executing one dimensional motion, connected to each other by springs that deform under relative motion of the neighboring masses.↩︎\nFor ease of discussion we define \\(\\gc_{0} \\equiv 0\\) which corresponds to the base of the first story columns.↩︎\nAgain we are defining \\(\\pvshpf{0} \\equiv 0\\) for ease of presentation, which is of course consistent with the previous definition \\(\\gc_{0} = 0 = \\pvshpf{0} \\gengc\\) since the shape approximation should satisfy the geometric boundary conditions as in the case of continuous systems.↩︎\nBefore concluding, we should note that one could consider the free body diagram of each floor mass separately wherein the shear forces would have to be considered as external forces acting on the mass and the whole virtual work would be written as that due to external forces alone. This has no bearing on the final outcome since then the forces would change direction and the end result would not alter by one bit.↩︎\n\n\n\n2.5.3 Damping and External Forces\nHaving established the basic approach, we may begin to include additional complexities in our model. To this end let us consider again the chimney and the shear frame, but with some dampers and external forces acting on them as shown in Figure 2.17.\n\n\n\nFigure 2.17: (a) Chimney with external loads and dampers, (b) free body diagram of the chimney, (c) shear frame with dampers, (d) story shears due to dampers.\n\n\nLet us start with the chimney shown in Figure 2.17(a). The displacement field is once again \\(\\gc=\\gc (s,t)\\), and the generalized SDOF approximation is given by \\(\\gc (s,t) = \\shpf (s) \\gengc (t)\\). In addition to our previous investigation, this chimney is acted upon by a distributed external force \\(\\extforce = \\extforce(s,t)\\) defined per unit length, and two external damping devices connected to a rigid frame, with damping coefficients \\(c_1\\) and \\(c_2\\). These externally connected dampers are possibly not common applications but here they simply serve the discussion; more on this will be said later on. We have already shown that the internal work done by the bending moments during a virtual displacement is given by \\[\n\\genk \\gengc \\vgengc = \\left[\\int_{0}^{\\ell} EI (\\shpf'')^2 \\diff s \\right] \\gengc \\vgengc\n\\] and the external work done by the d’Alembert forces is given by \\[\n-\\genm \\ddgengc \\vgengc = \\left[\\int_{0}^{\\ell} \\mlen \\shpf^2 \\diff s\\right] \\ddgengc \\vgengc\n\\] so that we need only derive the contributions of the new components.\nThe external force acting on the section at \\(s\\) is \\(f \\diff s\\). When the chimney goes through virtual displacement \\(\\vgc = \\shpf \\vgengc\\), this force does work of amount \\[\n\\left[\\extforce \\diff s \\right]\\left[\\shpf \\vgengc \\right]\n\\] so that the total work done by the distributed force may be evaluated by integrating the contributions along the height as \\[\n\\left[\\int_{0}^{\\ell} \\extforce \\shpf \\diff s\\right] \\vgengc = \\genf \\vgengc\n\\] where \\(\\genf = \\genf (t)\\) is called the generalized force.18\nThe forces acted on the chimney by the dampers are proportional to their velocities of deformation. The velocity of deformation for the damper located at position \\(s=s_i\\) is \\[\n\\pardiv{\\gc}{t}\\biggr|_{s=s_i} = \\shpf(s_i) \\dgengc\n\\] and therefore the force acted upon the chimney by the damper is given by \\[\nc_i \\shpf (s_i) \\dgengc\n\\] with the direction shown in the free body diagram of Figure 2.17(b). The force acts at \\(s=s_i\\) so that during virtual displacements, the point of application of the force moves by an amount \\(\\shpf (s_i) \\vgengc\\) so that the virtual work done by this force is equal to \\[\n- [c_i \\shpf (s_i) \\dgengc][\\shpf (s_i) \\vgengc] = - c_i \\shpf^2 (s_i) \\dgengc \\vgengc\n\\] The cumulative contribution of such dampers to the external virtual work is then calculated by a summation over all the dampers to obtain \\[\n- \\left[\\sum_{i} c_i \\shpf^2 (s_i)\\right] \\dgengc \\vgengc = - \\genc \\dgengc \\vgengc\n\\] where \\(\\genc\\) is referred to as the generalized damping.19\nThe principle of virtual work is the same as always but now with additional terms contributing to the work expressions so that we have, \\[\n\\vwork_{int} = \\genk \\gengc \\vgengc = - \\genm \\ddgengc \\vgengc - \\genc \\dgengc \\vgengc + \\genf \\vgengc = \\vwork_{ext}\n\\] which may be expressed as \\(\\left[\\genm \\ddgengc + \\genc \\dgengc + \\genk \\gengc - \\genf \\right] \\vgengc = 0\\). Since this condition must be valid for arbitrary \\(\\vgengc\\), it must be true that: \\[\n\\genm \\ddgengc + \\genc \\dgengc + \\genk \\gengc = \\genf\n\\qquad(2.43)\\] This is the general equation of motion that governs the dynamics of generalized SDOF systems, and its similarity with the previously discussed equation for the prototype SDOF model is obvious. We may at this point say a few words about the damping term \\(\\genc\\). It has already been mentioned that viscous damping is a phenomenological model that has been found to represent observed behavior acceptably well in most cases; as such, it is almost impossible to define a viscous damping coefficient if there are no actual physical viscous dampers as in this example. What will most probably happen is that there will not be such dampers but the damping coefficient will have to be somehow estimated. As before, it is relatively easier to approach the problem via the damping ratio coefficient so that, by defining \\[\n2 \\gendamp \\genfreq = \\frac{\\genc}{\\genm}\n\\] Equation 2.43 may be expressed as \\[\n\\ddgengc + 2 \\gendamp \\genfreq \\dgengc+ (\\genfreq)^2 \\gengc = \\frac{1}{\\genm} \\genf\n\\qquad(2.44)\\] As previously discussed for the prototype SDOF model, estimating \\(\\gendamp\\) based on previous experience with similar systems will almost always be much easier than trying to estimate \\(\\genc\\) and the equation of motion for the generalized SDOF is most often formulated in the form of Equation 2.44.\nAnalogous expressions will be observed while working with discrete systems. Consider for example the three story shear frame of Figure 2.17(c), acted upon by three forces and stories supplemented with dampers. The floor displacements are once again given by \\(\\gcvec^T = \\left\\{ \\gc_1 \\; \\gc_2 \\; \\gc_3\\right\\}^T\\) and the generalized SDOF approximation is defined through \\(\\gcvec^T = \\left\\{ \\pvshpf{1} \\; \\pvshpf{2} \\; \\pvshpf{3} \\right\\}^T \\gengc\\). We have already shown that the virtual external work done by the d’Alembert forces is given by \\[\n- \\genm \\ddgengc \\vgengc = - \\vshpf^T \\mmat \\vshpf \\ddgengc \\vgengc\n\\] and now we have to additionally consider the virtual work done by the externally applied forces \\(\\ldvec^T = \\left\\{ \\extforce_1 \\; \\extforce_2 \\; \\extforce_3 \\right\\}^T\\). As the \\(i\\)-th floor moves through the virtual displacement \\(\\vgc_i = \\pvshpf{i} \\vgengc\\), the virtual work done by the force \\(\\extforce_i\\) acting on that floor is simple \\(\\extforce_i \\vgc_i = \\extforce_i \\pvshpf{i} \\vgengc\\). The total virtual work done by the applied forces is then given by \\[\n\\sum_{i} f_i \\pvshpf{i} \\vgengc = \\left[ \\sum_{i} \\extforce_i \\pvshpf{i} \\right] \\vgengc = \\left[\\vshpf^T \\ldvec \\right] \\vgengc = \\genf \\vgengc\n\\] where \\(\\genf\\) is called the generalized (external) force. This work will have to be added to that done by the d’Alembert forces.\nAs for internal virtual work, it was previously shown that the virtual work done by the lateral load bearing system was equal to: \\[\n\\genk \\gengc \\vgengc = \\left(\\vshpf^T \\kmat \\vshpf\\right) \\gengc \\vgengc\n\\] The addition of dampers between floors will lead to additional shear forces transmitted via stories. The forces at the two ends of a damper are given by the product of the damping coefficient with the relative velocity across the two ends causing the deformation of the damper, so that the additional interstory shear across the \\(i\\)-th story is given by \\(c_i (\\pdivt{\\gc}_i - \\pdivt{\\gc}_{i-1}) = c_i (\\pvshpf{i} - \\pvshpf{i-1}) \\dgengc\\). The internal virtual work done by these end shears is to be calculated as \\[\nc_i (\\pdivt{\\gc}_i - \\pdivt{\\gc}_{i-1}) \\vgc_i - c_i (\\pdivt{\\gc}_i - \\pdivt{\\gc}_{i-1}) \\vgc_{i-1} = c_i (\\pvshpf{i} - \\pvshpf{i-1})^2 \\dgengc \\vgengc\n\\] and the contribution of the dampers to the internal virtual work is obtained by summing the contributions of all stories: \\[\n\\left[\\sum_i c_i (\\pvshpf{i} - \\pvshpf{i-1})^2 \\right] \\dgengc \\vgengc\n\\] Similar to the case regarding stiffness terms, the summation in the brackets may be written as a matrix product; e.g. for our three story shear frame, \\[\\begin{align*}\n\\sum_{i=1}^{3} c_{i} (\\pvshpf{i} - \\pvshpf{i-1})^2 = \\begin{Bmatrix} \\pvshpf{1} & \\pvshpf{1} & \\pvshpf{3} \\end{Bmatrix} \\begin{bmatrix} c_1 + c_2 & -c_2 & 0 \\\\ -c_2 & c_2 + c_3 & -c_3 \\\\ 0 & -c_3 & c_3 \\end{bmatrix} \\begin{Bmatrix} \\pvshpf{1} \\\\ \\pvshpf{2} \\\\ \\pvshpf{3} \\end{Bmatrix} = \\vshpf^T \\cmat \\vshpf\n\\end{align*}\\] so that \\[\n\\left[\\sum_i c_i (\\pvshpf{i} - \\pvshpf{i-1})^2 \\right] \\dgengc \\vgengc = \\left(\\vshpf^T \\cmat \\vshpf\\right) \\dgengc \\vgengc = \\genc \\dgengc \\vgengc\n\\] where \\(\\genc=\\vshpf^T \\cmat \\vshpf\\) is called the generalized damping, and \\(\\cmat\\), given in this specific example by \\[\n\\cmat = \\begin{bmatrix} c_1 + c_2 & -c_2 & 0 \\\\ -c_2 & c_2 + c_3 & -c_3 \\\\ 0 & -c_3 & c_3 \\end{bmatrix}\n\\] is called the (viscous) damping matrix of the system.\nWith these additions, principle of virtual work yields \\[\n\\vwork_{int} = \\genk \\gengc \\vgengc + \\genc \\dgengc \\vgengc = - \\genm \\ddgengc \\vgengc + \\genf \\vgengc = \\vwork_{ext}\n\\] which may be expressed as \\(\\left[ \\genm \\ddgengc + \\genc \\dgengc + \\genk \\gengc - \\genf \\right] \\vgengc = 0\\). Since this condition must be valid for arbitrary \\(\\vgengc\\), it must be true that \\[\n\\genm \\ddgengc + \\genc \\dgengc + \\genk \\gengc = \\genf\n\\qquad(2.45)\\] which, as expected, is identical in form to Equation 2.43. Damping again deserves a special mention: It is rare to find buildings equipped with such dampers as investigated in the discussion above, and the concept of generalized damping will most often refer to a conceptual mechanism, as referred to previously in the analysis of the chimney.\n\n\n\n\nThere may be many components of the external force and the generalized force will then be the superposition of all the contributions; it is essentially the coefficient that multiplies \\(\\vgengc\\) in the calculation of the work done by all external forces.↩︎\nAgain, there may be other contributions to the damping, and at the end of the day generalized (viscous) damping is the name given to the coefficient of the velocity in the virtual work expression.↩︎\n\n\n\n2.5.4 Epilogue\nThe introduction of the generalized SDOF approximation has been via examples, and we agree that there are advantages and disadvantages associated with this choice of presentation. The discussion may be considered to lack a generality that could be reached through a more rigorous theoretical introduction, a shortcoming we have tried to alleviate by referring along the way to what the formulations would look like if we were to consider more general cases. We believe, however, that the generalized SDOF approximation is essentially very much dependent on intuition regarding structural behavior, and that its introduction through examples helps to establish a better understanding of the step-by-step procedure while presenting the fundamental issues. For quick reference, we present in Table 2.1 the fundamental equations that will most probably be encountered while developing and analyzing generalized SDOF models for relatively simpler systems.\n\n\nTable 2.1: A summary of expressions commonly used in generalized SDOF approximations.\n\n\n\n\n\n\n\n\nBeam (1-D, bending)\nDiscrete (N-DOF)\n\n\n\n\nApproximation\n\\(\\gc (s,t) = \\shpf (s) \\gengc (t)\\)\n\\(\\gcvec (t) = \\vshpf \\gengc (t)\\)\n\n\nGeneralized mass \\(\\genm\\)\n\\(\\int \\mlen \\shpf^2 \\diff s\\)\n\\(\\vshpf^T \\mmat \\vshpf\\)\n\n\nGeneralized stiffness \\(\\genk\\)\n\\(\\int EI (\\shpf'')^2 \\diff s\\)\n\\(\\vshpf^T \\kmat \\vshpf\\)\n\n\nGeneralized force \\(\\genf\\)\n\\(\\int \\extforce \\shpf \\diff s\\)\n\\(\\vshpf^T \\ldvec\\)\n\n\nFrequency \\(\\genfreq\\)\n\\(\\genfreq = \\sqrt{{\\genk}/{\\genm}}\\)\nsame\n\n\nGeneralized damping \\(\\genc\\)\n\\(2 \\gendamp \\genfreq \\genm\\)\n\\(2 \\gendamp \\genfreq \\genm\\) or \\(\\vshpf^T \\cmat \\vshpf\\)\n\n\nEquation of motion\n\\(\\genm \\ddgengct + \\genc \\dgengct + \\genk \\gengct = \\genf(t)\\)\nsame\n\n\n\n\n\n\nThere are of course still many cases that one could concoct which we have not explicitly addressed here. That being said, we hope the discussions have been detailed enough so that should such new challenges arise, the fundamental tools and techniques discussed above will suffice to help the reader deal with those challenges. An immediate question is whether or not this method could be extended to two or three dimensions in continuous systems, as for example the case would be for analysis of plate vibrations. It should be somewhat straightforward to assume that the extension would be possible by defining shape functions in two or three dimensions, but the expressions we derived for the relatively simple beam (chimney) would have to be modified since force-deformation mechanisms will in general have additional complexities . It is not feasible within the confines of this books to analyze deformation patterns of all possible structural elements, but relevant information may be accessed in texts dealing with advanced strength of materials and structural analysis. The main flow of the generalized SDOF approximation, however, would still be that presented herein.\nThe generalized SDOF approximation is a powerful tool although its usefulness these days may be questioned since, with the increase in computational power and the strict performance criteria established in more recent decades, analyses of structural dynamics problems are almost exclusively executed with specialized software tailored to handle large numbers of degrees of freedom. Still, we feel that the generalized SDOF model is a very good teaching tool, forcing the applier to think about dynamic behavior and various concepts at a relatively early stage. Many of the more advanced analytical and numerical methods used for analyses of complex structures may be better appreciated with an understanding of the generalized SDOF approximation. It is also important for experienced engineers in that it provides an easy to apply tool for sanity checks when evaluating numerical results obtained via other tools."
  },
  {
    "objectID": "singledofforced.html#general-methodology",
    "href": "singledofforced.html#general-methodology",
    "title": "3  Forced Vibrations of Single Degree of Freedom Systems",
    "section": "3.1 General Methodology",
    "text": "3.1 General Methodology\nTo develop the general method for developing analytical solutions to forced vibrations, let us once again consider the prototypical SDOF model, shown for ease of reference again in Figure 3.2. The equation of motion for the system, obtained by summing the forces shown in the free body diagram and considering initial conditions, is given by \\[\nm \\ddgct + c \\dgct + k \\gct = \\extforce(t) \\, ; \\quad \\left\\{\\gc(0) = \\gcic, \\dgc(0) = \\dgcic\\right\\}\n\\qquad(3.1)\\]\n\n\n\nFigure 3.2: (a) Viscously damped single degree of freedom system and (b) its free body diagram including the d’Alembert force.\n\n\nStudies in differential equations tell us that the solution to Equation 3.1 may be constructed via two components as \\[\n\\gct = \\gc_{c} (t) + \\gc_{p}(t)\n\\] where \\(\\gc_{c}(t)\\) is referred to as the complementary solution, given by the solution to the homogeneous equation so that \\[\nm \\ddgc_{c}(t) + c \\dgc_{c}(t) + k \\gc_{c}(t) = 0\n\\] and \\(\\gc_{p}(t)\\) is referred to as the particular solution satisfying \\[\nm \\ddgc_{p}(t) + c \\dgc_{p}(t) + k \\gc_{p}(t) = \\extforce (t)\n\\] The particular solution will depend on the forcing function and so it must be determined anew for each different type of force, whereas the complementary solution for an underdamped system will always be given by some form of \\[\n\\gct = \\expon{-\\damp \\freq t}\\left(C_1 \\cos \\dfreq t  + C_2 \\sin \\dfreq t \\right)\n\\qquad(3.2)\\] where \\(C_1\\) and \\(C_2\\) are two coefficients to be determined. The existence of these two coefficients is what allows us to solve the problem since that freedom is needed to incorporate the contribution of initial conditions, something that the particular solution alone cannot do. That the superposition of the complementary and the particular solutions still satisfy the force equilibrium equation is trivial due to the linearity of the differential equation since \\[\\begin{align*}\nm \\left[\\ddgc_{c} + \\ddgc_{p}\\right] & + c \\left[\\dgc_{c} + \\dgc_{p} \\right] + k \\left[\\gc_{c} + \\gc_{p} \\right]  \\\\\n& = \\left[m \\ddgc_{c} + c \\dgc_{c} + k \\gc_{c} \\right] + \\left[m \\ddgc_{p} + c \\dgc_{p} + k \\gc_{p} \\right] \\\\\n& = [0] + \\left[m \\ddgc_{p} + c \\dgc_{p} + k \\gc_{p} \\right] = \\extforce(t)\n\\end{align*}\\]\nThe linearity of the governing equation has even more significant consequences which has proven extremely useful in analysis: since superposition holds, the simultaneous action of a number of disturbances may be analyzed by evaluating the response of the system to each individual disturbance separately, and then superpose all the solutions thus obtained to evaluate the cumulative response; the principle is schematically explained in Figure 3.3. To express this statement symbolically, if \\(\\gc^{(1)}\\) is the response of the system to some input \\(\\text{inp}^{(1)}\\) and if \\(\\gc^{(2)}\\) is its response to some input \\(\\text{inp}^{(2)}\\), then the response of the system will be given by \\(\\gc^{(1)} + \\gc^{(1)}\\) when the system is acted upon by both inputs simultaneously, i.e. by \\(\\text{inp}^{(1)} + \\text{inp}^{(2)}\\). If the inputs are amplified so that the system is acted upon by \\(a_1 \\text{inp}^{(1)} + a_2 \\text{inp}^{(2)}\\), then the responses to individual inputs will likewise be amplified so that the system response will be given by \\(a_1 \\gc^{(1)} + a_2 \\gc^{(1)}\\). Note that we have used the more generic term input to denote the effect that sets the system in motion for it can refer to a set of initial conditions and/or external forces and/or base motion; all of these may be investigated separately and the results thus obtained may then be combined to calculate the response that would occur under the combined action of all. We may therefore finally state the following: Let \\(\\gc^{(1)}\\) be the solution to the initial condition problem \\[\nm \\ddgc^{(1)} (t) + c \\dgc^{(1)} (t) + k \\gc^{(1)} (t) = 0 \\, ; \\quad \\left\\{\\gc^{(1)}(0) = \\gcic, \\dgc^{(1)} (0) = \\dgcic \\right\\}\n\\qquad(3.3)\\] so that it is given for a viscously underdamped system by \\[\n\\gc^{(1)}(t) = \\expon{-\\damp \\freq t}\\left(\\gcic \\cos \\dfreq t  + \\frac{\\dgcic + \\damp \\freq \\gcic}{\\dfreq} \\sin \\dfreq t \\right)\n\\]\n\n\n\nFigure 3.3: Superposition in linear systems.\n\n\nas we had shown while discussing free vibrations. If the same system were subjected only to some external force with zero initial conditions, the response \\(\\gc^{(2)}(t)\\) would have to satisfy1 \\[\nm \\ddgc^{(2)} (t) + c \\dgc^{(2)} (t) + k \\gc^{(2)} (t) = \\extforce (t) \\, ; \\quad \\left\\{\\gc^{(2)} (0) = 0, \\dgc^{(2)} (0) = 0 \\right\\}\n\\qquad(3.4)\\] When the system is subjected to both the external excitation \\(\\extforce(t)\\) and the nonzero initial conditions \\(\\gc(0) = \\gcic, \\dgc(0) = \\dgcic\\), the response \\(\\gct\\) would have to satisfy \\[\nm \\ddgct + c \\dgct + k \\gct = \\extforce(t) \\, ; \\quad \\left\\{\\gc(0) = \\gcic, \\dgc(0) = \\dgcic\\right\\}\n\\qquad(3.5)\\] and the linearity of the system allows superposition so that \\(\\gct\\) is simply given by \\[\n\\gc (t) = \\gc^{(2)} (t) + \\gc^{(2)} (t)  = \\expon{-\\damp \\freq t}\\left(\\gcic \\cos \\dfreq t  + \\frac{\\dgcic + \\damp \\freq \\gcic}{\\dfreq} \\sin \\dfreq t \\right)  + \\gc^{(2)} (t)\n\\qquad(3.6)\\] This result will allow us to investigate all forced vibration problems with zero initial conditions as the additional contribution of any nonzero initial condition may simply be superposed afterwards.\n\n\n3.1.1 Constant Force: Step Input\nLet us start with the case of a constant force shown in Figure 3.4, defined mathematically as \\[\n\\extforce (t) = \\begin{cases} \\sforce & t \\geq 0 \\\\ 0 & t &lt; 0 \\end{cases}\n\\]\n\n\n\n\nFigure 3.4: Constant force (step function)\n\n\nFor \\(t \\geq 0\\), the underdamped system is governed by \\[\nm \\ddgct + c \\dgct + k \\gct = \\sforce \\, ; \\quad \\left\\{\\gc(0) = 0, \\dgc(0) = 0\\right\\}\n\\qquad(3.7)\\] and the complementary solution is given by \\[\n\\gc_{c} (t) = \\expon{-\\damp \\freq t}\\left(C_1 \\cos \\dfreq t  + C_2 \\sin \\freq t \\right)\n\\qquad(3.8)\\] We have to find the particular solution before evaluating the unknown coefficients since the initial conditions are to be imposed on the actual response, not just the complementary part. As the forcing function is a constant, we may initially try a constant particular solution of the form \\[\n\\gc_{p} (t) = C\n\\qquad(3.9)\\] Substituting the trial solution of Equation 3.9 into the equation of motion in Equation 3.7 leads to2 \\[\n0 + 0 + k C = \\sforce\n\\] so that we conclude the particular solution to be of the trial form with \\[\nC = \\frac{\\sforce}{k}\n\\] which, it should be noted, is equal the static displacement \\[\n\\Delta_{st}=\\frac{\\sforce}{k}\n\\] if this were a static problem. Now the solution becomes \\[\n\\gct = \\expon{-\\damp \\freq t}\\left(C_1 \\cos \\dfreq t  + C_2 \\sin \\dfreq t \\right) + \\frac{\\sforce}{k}\n\\qquad(3.10)\\] and applying the initial conditions lead to \\[\\begin{align*}\n\\gc (0)  = C_1 + \\frac{\\sforce}{k} = & 0 \\quad \\rightarrow \\quad C_1  = - \\frac{\\sforce}{k} \\\\\n\\dgc (0)  = - \\damp \\freq  C_1 + \\dfreq C_2 = & 0 \\quad \\rightarrow \\quad C_2  = - \\frac{\\sforce}{k} \\frac{\\damp}{\\sqrt{1-\\damp^2}}\n\\end{align*}\\] so that the solution is finally obtained as \\[\n\\gct = \\frac{\\sforce}{k} \\left[ 1 -  \\expon{-\\damp \\freq t}\\left(\\cos \\dfreq t  + \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq t \\right)  \\right] \\quad \\text{for } t \\geq 0\n\\qquad(3.11)\\]\nHow the system responds to the force and the effects of damping on the response may be most easily visualized via the plots sketched in Figure 3.5. There are a few important things to be noted. First of all, in the presence of damping, the response eventually converges to the static displacement; how fast this convergence occurs depends on the amount of damping with faster rates occurring for larger damping values. Results obtained via static analyses are therefore the asymptotic values the dynamic responses eventually settle to whenever the duration of the load application is long enough. Another point worth making is that the maximum response that occurs may exceed the static response and the peak value depends again on the amount of damping. In fact, the velocity as a function of the normalized time \\(\\tau = t/\\dperiod\\) may be shown to be given by \\[\n\\dgc (t) = \\frac{\\sforce}{k}  \\expon{- \\damp \\freq t}\\frac{\\freq}{\\sqrt{1-\\damp^2}} \\sin \\dfreq t\n\\qquad(3.12)\\]\n\n\n\nFigure 3.5: Response to a constant force (step function) for various values of damping ratio (noted in percentage) as a function of normalized time \\(\\tau = t / \\dperiod\\).\n\n\nwhich will take on a value of zero for \\(t &gt; 0\\) whenever \\(\\dfreq t\\) is a positive integer multiple of \\(\\pi\\), or in other words, whenever \\[\nt = \\ratio{i \\pi}{\\dfreq} = i \\ratio{\\dperiod}{2} \\quad \\text{for } i=1,2,\\ldots\n\\] which corresponds to \\[\n\\tau = \\ratio{t}{\\dperiod} = \\ratio{1}{2} i \\quad \\text{for } i=1,2,\\ldots\n\\] i.e. whenever \\(\\tau\\) is a positive integer multiple of \\(1/2\\). Therefore, the first peak is reached, if at all, when \\(\\tau = 1/2\\), i.e. halfway through the first cycle when \\(t = \\dperiod / 2\\), and the value of the peak displacement is given by \\[\n\\gc_{max} = \\Delta_{st}\\left[1+\\expon{-\\pi \\damp / \\sqrt{1-\\damp^2}}\\right]\n\\] so that for an undamped system we have \\[\n\\frac{\\gc_{max}}{\\Delta_{st}}= 2\n\\] and for damping values of \\(\\zeta=5\\%\\), \\(\\zeta=20\\%\\) and \\(\\zeta=50\\%\\) the amplification above will be calculated as \\(1.85\\), \\(1.53\\) and \\(1.16\\), respectively.\n\n\n\n\n That the initial conditions are zero DOES NOT mean the complementary solution has to be zero; \\(\\gc^{(2)}\\) will still need a particular and a complementary component.↩︎\nThis approach is commonly referred to as the method of undetermined coefficients.↩︎"
  },
  {
    "objectID": "singledofforced.html#footnotes",
    "href": "singledofforced.html#footnotes",
    "title": "3  Forced Vibrations of Single Degree of Freedom Systems",
    "section": "",
    "text": "Earthquakes are not the sole cause of support motion but they are the most catastrophic. All ground borne vibrations, including those due to traffic, nearby machinery, pile driving or drilling will lead to support motions albeit negligible ones in most cases.↩︎\nRecall the discussions on modeling assumptions at the beginning of Chapter 2.↩︎\nTo contrast: under an external force, the frequency and the damping ratio are still fundamental determinants, but the stiffness (or, equivalently, the mass) of the system also plays a role in the amplitude of the response.↩︎\nsee, e.g., N. Makris and Y. Roussos, “Rocking response of rigid blocks under near-source ground motions,” Géotechnique, Vol.50, No.3, pp. 243-262, 2000.↩︎"
  },
  {
    "objectID": "singledofforced.html#linearly-increasing-force-ramp-input",
    "href": "singledofforced.html#linearly-increasing-force-ramp-input",
    "title": "3  Forced Vibrations of Single Degree of Freedom Systems",
    "section": "3.2 Linearly Increasing Force: Ramp Input",
    "text": "3.2 Linearly Increasing Force: Ramp Input\nConsider a linearly increasing external force as shown in Figure 3.4. This force, having a rate of increase of \\(1\\) (unit of force/unit of time), is defined mathematically as \\[\n\\extforce (t) = \\begin{cases} t & t \\geq 0 \\\\ 0 & t &lt; 0 \\end{cases}\n\\] so that for \\(t \\geq 0\\), the underdamped system is governed by \\[\nm \\ddgct + c \\dgct + k \\gct = t \\, ; \\quad \\left\\{\\gc(0) = 0, \\dgc(0) = 0 \\right\\}\n\\qquad(3.13)\\]\n\n\n\nFigure 3.6: Linearly increasing force (ramp function).\n\n\nThe complementary solution is still given by Equation 3.8. Since the right hand side of the equation is a linear function of \\(t\\), for the particular solution, we may try \\[\n\\gc_p (t) = At + B\n\\qquad(3.14)\\] which leads, when substituted into the equation of motion of Equation 3.13, to \\[\n0 + cA + Akt + Bk = t\n\\] In this case, the coefficients of the left and right hand sides of the equation may be matched to conclude \\[\nA = \\frac{1}{k}, \\quad B = - \\frac{c}{k^2} = - \\frac{2 \\damp \\freq m}{k^2} = - \\frac{1}{k}\\frac{2 \\damp}{\\freq}\n\\] so that the solution \\(\\gc = \\gc_{c} + \\gc_{p}\\) is of the form \\[\n\\gct = \\expon{-\\damp \\freq t}\\left(C_1 \\cos \\dfreq t  + C_2 \\sin \\dfreq t \\right) + \\frac{1}{k} \\left[t - \\frac{2 \\damp}{\\freq} \\right]\n\\qquad(3.15)\\] Applying the initial conditions leads to \\[\\begin{align*}\n\\gc (0)  = C_1 - \\frac{2 \\damp}{k \\freq} = & 0 \\quad \\rightarrow \\quad C_1  =  \\frac{2 \\damp}{k \\freq} \\\\\n\\dgc (0)  = - \\damp \\freq  C_1 + \\dfreq C_2 + \\frac{1}{k}= & 0 \\quad \\rightarrow \\quad C_2  = \\frac{2 \\damp^2 - 1}{k\\dfreq}     \n\\end{align*}\\] with the final solution now given for \\(t \\geq 0\\) by \\[\n\\gct = \\frac{1}{k\\freq} \\left[\\expon{-\\damp \\freq t}\\left(2 \\damp \\cos \\dfreq t  + \\frac{2 \\damp^2 - 1}{\\sqrt{1-\\damp^2}} \\sin \\dfreq t \\right) + \\freq t - 2 \\damp \\right]\n\\qquad(3.16)\\]\nHaving determined the solution for a unit rate, we may easily extend this solution to the case when the rate of increase of the force is not unity but some \\(\\lambda\\) so that the force is defined as \\[\n\\extforce (t) = \\begin{cases} \\lambda t & t \\geq 0 \\\\ 0 & t &lt; 0 \\end{cases}\n\\] and the system is governed by \\[\nm \\ddgct + c \\dgct + k \\gct = \\lambda t \\, ; \\quad \\left\\{\\gc(0) = 0, \\dgc(0) = 0\\right\\}\n\\qquad(3.17)\\] Due to the linearity of the system, the principle of superposition summarized in Figure 3.3 allows us to conclude that when the input is scaled by some value \\(\\lambda\\), the output will also have to be scaled by the same value so that the response will simply be given for \\(t \\geq 0\\) by \\[\n\\gct = \\frac{\\lambda}{k \\freq} \\left[\\expon{-\\damp \\freq t}\\left(2 \\damp \\cos \\dfreq t  + \\frac{2 \\damp^2 - 1}{\\sqrt{1-\\damp^2}} \\sin \\dfreq t \\right) + \\freq t - 2 \\damp \\right]\n\\qquad(3.18)\\] which of course includes the initial problem as a special case with \\(\\lambda = 1\\). If the system is undamped, then using \\(\\damp = 0\\) in Equation 3.18 leads to \\[\n\\gct = \\frac{\\lambda}{k\\freq} \\left[ \\freq t -  \\sin \\freq t \\right] \\quad \\text{for } t\\geq 0\n\\qquad(3.19)\\]\n\n\n\nFigure 3.7: Response to a linearly increasing force (step function) for various values of damping ratio (noted in percentage) as a function of normalized time \\(\\tau = t / \\period\\).\n\n\nA graphical comparison of the variation of response with damping in this case is not as straightforward as it was in the response to a step function. To help discuss general trends, Figure 3.7 presents the responses that would be observed for a particular system for various values of the damping ratio. The normalized time used in these plots is \\(\\tau = t / \\period\\) which differs from that used for previous investigations in that here we use the undamped period as opposed to the damped one. To help facilitate a visual reference, the plots also include what may be referred to as instantaneous static response \\(\\extforce (\\tau) / k\\). The tendency of the response is to converge to some percentage of the instantaneous static response. Since \\(\\freq t = 2 \\pi \\tau\\), for an undamped system we have \\[\n\\frac{\\extforce(\\tau)}{k} - \\gc (\\tau) = \\frac{\\lambda}{\\freq k} 2 \\pi \\tau - \\frac{\\lambda}{\\freq k} \\left[ 2 \\pi \\tau - \\sin 2 \\pi \\tau \\right] = \\frac{\\lambda}{\\freq k}\\sin 2 \\pi \\tau\n\\] so that the response oscillates around the instantaneous static response. On the other hand, whenever there is damping in the system we have, from Equation 3.18, \\[\n\\underset{\\tau \\rightarrow \\infty}{\\lim}\\left[\\frac{\\extforce(\\tau)}{k} - \\gc (\\tau)\\right] = \\frac{\\lambda}{\\freq k} 2 \\pi \\tau - \\frac{\\lambda}{\\freq k} \\left[ 2 \\pi \\tau - 2 \\damp\\right] = 2 \\damp \\frac{\\lambda}{\\freq k}\n\\] so that eventually the transient vibrations die out and the steady state response tracks the force with a certain lag that depends on the damping ratio for a given system and force.\n\n3.2.1 Input Shifted in Time\nConsider what the response would be if the step and the ramp forces of the discussions above were applied not at time \\(t=0\\) but they started to act at some time \\(t=\\tshift\\) as shown in Figure 3.8.\nSince the coefficients in the differential equation are time invariant, or in other words since the mass, damping and stiffness properties of the system remain unaltered as time progresses, the solution to these problems is relatively straightforward. Let us take the step input to begin with. The problem statement for zero initial conditions is given by \\[\nm \\ddgct + c \\dgct + k \\gct = \\sforce \\, ; \\quad \\left\\{\\gc(\\tshift) = 0, \\dgc(\\tshift) = 0\\right\\} \\quad \\text{for } t \\geq \\tshift\n\\] If we define a new time variable \\(\\tau = t - \\tshift\\), then \\[\n\\frac{\\diff q}{\\diff \\tau} = \\frac{\\diff q}{\\diff t} \\frac{\\diff t}{\\diff \\tau} = \\frac{\\diff q}{\\diff t}, \\quad \\frac{\\diff^2 q}{\\diff \\tau^2} = \\frac{\\diff^2 q}{\\diff t^2}\n\\] so that the problem may be stated in terms of this new time variable as \\[\nm \\ddgc (\\tau) + c \\dgc (\\tau) + k \\gc (\\tau) = \\sforce \\, ; \\quad \\left\\{\\gc(0) = 0, \\dgc(0) = 0\\right\\} \\quad \\text{for } \\tau \\geq 0\n\\] Note that this is exactly the same problem as that in Equation 3.7, with \\(\\tau\\) replacing \\(t\\). The solution may therefore immediately be written following Equation 3.11 \\[%\\begin{xequation}\\label{eq:xsolstepshift}\n\\gc (\\tau) = \\frac{\\sforce}{k} \\left[ 1 -  \\expon{-\\damp \\freq \\tau}\\left(\\cos \\dfreq \\tau  + \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq \\tau \\right)  \\right] \\quad \\text{for } \\tau \\geq 0\n\\] and substituting \\(\\tau = t - \\tshift\\) leads to \\[%\\begin{xequation}\\label{eq:xsolstepshift2}\n\\gct = \\frac{\\sforce}{k} \\left[ 1 -  \\expon{-\\damp \\freq (t-\\tshift)}\\left(\\cos \\dfreq (t-\\tshift)  + \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq (t-\\tshift) \\right)  \\right] \\quad \\text{for } t \\geq \\tshift\n\\]\n\n\n\nFigure 3.8: Step and ramp inputs shifted in time.\n\n\nAs the methodology described above is general, the conclusion is obvious: since the coefficients of the linear equation of motion are time invariant, a time shift in input results simply results in a shift in the output. If, for example, the initial conditions for the system were nonzero at time \\(t=\\tshift\\) so that the system were to be governed by \\[\nm \\ddgct + c \\dgct + k \\gct = \\sforce \\, ; \\quad \\left\\{\\gc(\\tshift) = \\gc_{*}, \\dgc(\\tshift) = \\dgc_{*}\\right\\} \\quad \\text{for } t \\geq \\tshift\n\\] then, based on equations Equation 3.6 and Equation 3.11 wherein we replace \\(t\\) by \\(t-\\tshift\\), and \\(\\gcic\\) and \\(\\dgcic\\) by \\(\\gc_{*}\\) and \\(\\dgc_{*}\\), respectively, the response would be given by: \\[\\begin{align*}\n\\gc (t) & = \\expon{-\\damp \\freq (t-\\tshift)}\\left[\\gc_{*} \\cos \\dfreq (t-\\tshift)  + \\frac{\\dgc_{*} + \\damp \\freq \\gc_{*} }{\\dfreq} \\sin \\dfreq (t-\\tshift) \\right]  + \\\\\n& \\; \\frac{\\sforce}{k} \\left[ 1 -  \\expon{-\\damp \\freq (t-\\tshift)}\\left(\\cos \\dfreq (t-\\tshift)  + \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq (t-\\tshift) \\right)  \\right] \\quad \\text{for } t \\geq \\tshift\n\\end{align*}\\]\nSimilarly, if an underdamped SDOF system, initially at rest, is subjected to the ramp function shown in Figure 3.8 so that it is governed by \\[\nm \\ddgct + c \\dgct + k \\gct = \\lambda (t-\\tshift) \\, ; \\quad \\left\\{\\gc(\\tshift) = 0, \\dgc(\\tshift) = 0\\right\\} \\quad \\text{for } t \\geq \\tshift\n\\] then its response is obtained simply by shifting the solution in Equation 3.18 as: \\[\n\\gct = \\frac{\\lambda}{k \\freq} \\left[\\expon{-\\damp \\freq (t-\\tshift)}\\left(2 \\damp \\cos \\dfreq (t-\\tshift)  + \\frac{2 \\damp^2 - 1}{\\sqrt{1-\\damp^2}} \\sin \\dfreq (t-\\tshift) \\right) + \\freq (t-\\tshift) - 2 \\damp \\right]\n\\]\n\n\n3.2.2 Constant Load Applied in Finite Time\nTo model the fact that it is not physically possible to instantaneously apply a load, let us consider a forcing function which starts from 0 and increases linearly to some value \\(\\sforce\\) in duration \\(t_{r}\\), called rising time, after which it remains at the constant value of \\(\\sforce\\). Such a loading, shown in Figure 3.9, is described mathematically by \\[\n\\extforce (t) = \\begin{cases} \\sforce {\\ratio{t}{t_{r}}} & 0 \\leq t &lt; t_{r} \\\\ F & t \\geq t_{r} \\end{cases}\n\\]\n\n\n\nFigure 3.9: Force linearly increasing to a constant value.\n\n\nThere is more than one way to approach this problem, as will probably be the case in many of the problems that will be considered throughout this work. One approach is to make use of the results previously derived and construct a solution via superposition. Assume the system is underdamped and initially (at time \\(t=0\\)) at rest. The system is governed by two different equations, one corresponding to each force segment, as follows: \\[\\begin{align*}\n  m \\ddgct + c \\dgct + k \\gct & = \\sforce {\\ratio{t}{t_{r}}} \\, ; \\quad \\left\\{\\gc(0) = 0, \\dgc(0) = 0\\right\\} \\quad \\text{for } 0 \\leq t &lt; t_{r} \\\\\n   m \\ddgct + c \\dgct + k \\gct & = \\sforce \\, ; \\quad \\left\\{\\gc(t_{r}) = \\gc_{*}, \\dgc(t_{r}) = \\dgc_{*} \\right\\} \\quad \\text{for } t \\geq t_{r}\n\\end{align*}\\] The solution to the first part for \\(0 \\leq t &lt; t_{r}\\) is simple in that it is given by Equation 3.18 with \\(\\lambda = \\sforce / t_{r}\\): \\[\n\\gct = \\frac{\\sforce}{k \\freq t_{r}} \\left[\\expon{-\\damp \\freq t}\\left(2 \\damp \\cos \\dfreq t  + \\frac{2 \\damp^2 - 1}{\\sqrt{1-\\damp^2}} \\sin \\dfreq t \\right) + \\freq t - 2 \\damp \\right]\n\\qquad(3.20)\\] The second part is essentially a problem we have investigated in Section 3.2.1, with a shifted step input and non-zero initial conditions with \\(t_{r}=\\tshift\\). The solution was shown to be given for \\(t \\geq t_{r}\\) by \\[\\begin{align*}\n\\gc (t) & = \\expon{-\\damp \\freq (t-t_{r})}\\left[\\gc_{*} \\cos \\dfreq (t-t_{r})  + \\frac{\\dgc_{*} + \\damp \\freq \\gc_{*} }{\\dfreq} \\sin \\dfreq (t-t_{r}) \\right]  + \\\\\n& \\; \\frac{\\sforce}{k} \\left[ 1 -  \\expon{-\\damp \\freq (t-t_{r})}\\left(\\cos \\dfreq (t-t_{r})  + \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq (t-t_{r}) \\right)  \\right]\n\\end{align*}\\] wherein the initial conditions \\(\\gc_{*}\\) and \\(\\dgc_{*}\\) will have to be determined as the values from the last instant governed by the solution to the first part. Substituting \\(t=t_{r}\\) in Equation 3.20 yields \\[%\\begin{xequation}\\label{eq:solforcerampstep1}\n\\gc_{*} \\equiv \\gc ({t_{r}}) = \\frac{\\sforce}{k \\freq t_{r}} \\left[\\expon{-\\damp \\freq t_{r}}\\left(2 \\damp \\cos \\dfreq t_{r}  + \\frac{2 \\damp^2 - 1}{\\sqrt{1-\\damp^2}} \\sin \\dfreq t_{r} \\right) + \\freq t_{r} - 2 \\damp \\right]\n\\] The time derivative of \\(\\gc\\) may be obtained from Equation 3.20 as \\[\n\\dgct = \\frac{\\sforce}{k t_{r}} \\left[1 - \\expon{-\\damp \\freq t}\\left(\\cos \\dfreq t  + \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq t \\right) \\right]\n\\qquad(3.21)\\] so that \\[\n\\dgc_{*}\\equiv \\dgc ({t_{r}})=\\frac{\\sforce}{k t_{r}} \\left[1 - \\expon{-\\damp \\freq t_{r}}\\left(\\cos \\dfreq t_{r}  + \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq t_{r} \\right)\\right]\n\\] Although we have obtained the full solution, the presence of damping somewhat makes the algebra complicated and the presentation symbolically overloaded; let us therefore first simplify the results by considering the undamped case with \\(\\damp = 0\\). When there is no damping, the solution reduces to \\[\n\\gct = \\begin{cases}\\ratio{F}{k}\\frac{1}{\\freq t_{r}}\\left[\\freq t - \\sin \\freq t \\right] \\;  \\text{for }   0 \\leq t &lt; t_{r} \\\\\n% \\vspace{-1em} \\\\\n\\gc_{*} \\cos \\freq (t-t_{r}) + \\ratio{\\dgc_{*}}{\\freq} \\sin \\freq (t-t_{r}) + \\frac{F}{k}\\left[ 1 - \\cos \\freq (t-t_{r}) \\right] \\;  \\text{for } t \\geq t_{r}\n\\end{cases}\n\\] The initial conditions for the second part will be given by \\[\n\\gc_{*}= \\ratio{\\sforce}{k \\freq t_{r}} \\left[\\freq t_{r} - \\sin \\freq t_{r}\\right], \\quad \\dgc_{*}=\\ratio{\\sforce}{k t_{r}} \\left[1 - \\cos \\freq t_{r} \\right]\n\\qquad(3.22)\\] and substituting these into the solution leads, after some algebra and trigonometric combinations, to \\[\n\\gct = \\begin{cases} {\\ratio{\\sforce/k}{\\freq t_{r}}}\\left[\\freq t - \\sin \\freq t \\right]  &  \\text{for } 0 \\leq t &lt; t_{r} \\\\\n% \\vspace{-1em}\\\\\n{\\ratio{\\sforce/k}{\\freq t_{r}}} \\left[ \\freq t_{r} - \\sin \\freq t + \\sin \\freq (t-t_{r}) \\right] &  \\text{for } t \\geq t_{r}\n\\end{cases}\n\\qquad(3.23)\\] The response is very sensitive to the value of the rise time \\(t_{r}\\) in relation to the system’s period \\(\\period\\) as signified by the ratio \\(t_{r}/T\\). Some trends may be observed better by writing the solution in terms of a normalized time \\(\\tau = t / \\period\\) and replacing \\(\\freq\\) with \\(2 \\pi / \\period\\) so that \\[\n\\ratio{\\gc (\\tau)}{\\sforce/k} = \\begin{cases} {\\ratio{\\tau}{ (t_{r}/\\period)}}- {\\ratio{\\sin 2 \\pi \\tau}{2 \\pi (t_{r}/\\period)}} &  \\text{for }   0 \\leq \\tau &lt; (t_{r}/\\period) \\\\\n% \\vspace{-1em} \\\\\n1 - {\\ratio{\\sin 2 \\pi \\tau - \\sin 2 \\pi (\\tau-(t_{r}/\\period))}{2\\pi(t_{r}/\\period)}} &  \\text{for }  \\tau \\geq (t_{r}/\\period)\n\\end{cases}\n\\qquad(3.24)\\] A somewhat interesting result is observed when it is noted that whenever \\((t_{r}/\\period)\\) is some integer, \\(\\sin 2 \\pi \\tau - \\sin 2 \\pi (\\tau-(t_{r}/\\period)) = 0\\) since the sine of an angle is the same as the sine of the same angle plus any integer multiple of \\(2\\pi\\). In such cases, the response after the rise time becomes equal to \\(\\sforce/k\\) and no oscillations occur. Incidentally this corresponds to those cases in which the velocity of the system at the end of the ramp loading is zero. For non-integer values of \\((t_{r}/\\period)\\), the behavior is determined by the magnitude of the ratio: if \\((t_{r}/\\period) \\gg 1\\) (load is applied very slowly relative to the period of the system), the maximum response is close to \\(\\sforce/k\\), which again could be considered as the static response of the system. At the other end, if \\((t_{r}/\\period) \\ll 1\\) (load is applied very quickly compared to the period of the system), the maximum response is close to \\(2 (\\sforce/k)\\); recall that in the limiting case of an instantaneously applied step load we had previously shown the maximum response to be \\(2 (\\sforce/k)\\)3. The variation of the ratio \\(q(\\tau)/(\\sforce/k)\\) with the relative rise time \\((t_{r}/\\period)\\) is examplified for various cases in Figure 3.10.\n\n\n\nFigure 3.10: Normalized response of an undamped system to step input with a finite rise time for various values of \\((t_{r}/\\period)\\). The dashed lines corresponding to \\((\\extforce (\\tau)/k)/(\\sforce/k)\\) are presented to indicate the behavior of the force.\n\n\n\n\n\n\nAs \\((t_{r}/\\period) \\rightarrow 0\\), Equation 3.24 may be shown to converge to \\(1 - \\cos 2 \\pi \\tau\\), which is the same result as that obtained for the step input applied instantaneously.↩︎"
  },
  {
    "objectID": "singledofforced.html#sec-harmonicforce",
    "href": "singledofforced.html#sec-harmonicforce",
    "title": "3  Forced Vibrations of Single Degree of Freedom Systems",
    "section": "3.3 Harmonic Force Excitations",
    "text": "3.3 Harmonic Force Excitations\nWe have already seen that the nature of vibrations occurring in an SDOF system depend significantly on the time variation of the input relative to the period of the system. This dependence may lead to catastrophic outcomes in the case of repeated loads under which the amplifications in the response may become excessively large so as to induce failure. The most significant parameter in the response to repeated loads turns out to be the ratio of the frequency of excitation to the frequency of the system. Therefore we start the discussions of this phenomenon with the analysis of response to a single frequency input in order identify critical issues. The results developed for this case may then be used to investigate the responses to a broader set of repeated loads with the help of a well-known expansion that has been used in many branches of engineering sciences.\nA harmonic excitation is essentially a single frequency sinusoidal wave. A harmonic force may be expressed as \\[\n   \\extforce (t) = \\sforce \\sinp{\\extfreq t - \\extphs}\n\\qquad(3.25)\\] where \\(\\sforce\\) is the amplitude, \\(\\extfreq\\) is the excitation frequency, and \\(\\extphs\\) is the phase angle of the force. When analyzing long term behavior the phase generally does not have a significant bearing on design critical issues so that most often it is neglected (i.e. \\(\\extphs\\) is assumed to be \\(0\\)); we will however consider the possibility of a nonzero phase to promote a general discussion.\nWe will assume that such a force acts on our system for a long duration4, long enough so that the transient vibrations have died out completely and the system is in what is called to be steady state. Recall that the forced vibration response of a viscously underdamped system is given by \\[\n\\gct = \\gc_{c} (t) + \\gc_{p}(t) = \\expon{-\\damp \\freq t}\\left(C_1 \\cos \\dfreq t  + C_2 \\sin \\dfreq t \\right) + \\gc_{p}(t)\n\\] so that as \\(t\\) progresses, the exponential term tends to die out; hence the name transient vibrations. As the transient vibrations die out, the response is defined more and more solely by the particular solution, and this state of things is referred to as steady state vibrations. Since a harmonic excitation by assumption acts for a long duration, we shall initially neglect the transients and focus solely on the steady state. This does not mean that the critical response is observed always during steady state vibrations; it may be that for some cases the maximum deformation in the system occurs before the transients die out. It turns out, however, that the worst of the worst occurs for particular ranges of the excitation frequency and in those cases the transients play an insignificant role.\n\n3.3.1 Dynamic Amplification\nThe steady state vibrations under the action of a harmonic force are governed by \\[\n    m \\ddgct + c \\dgct + k \\gct = \\sforce \\sinp{\\extfreq t - \\extphs}\n\\qquad(3.26)\\] or equivalently, after dividing through by \\(m\\), \\[\n    \\ddgct + 2 \\damp \\freq \\dgct + \\freq^2 \\gct = \\frac{\\sforce}{m} \\sinp{\\extfreq t - \\extphs}\n\\qquad(3.27)\\] where it should be mentioned that no initial condition information is provided simply because the effects of initial conditions are irrelevant for steady state vibrations. When the forcing function is harmonic the response may be expected to be harmonic as well since, at the end of the day, the left hand side of equation ought to match the right hand side at all times, and therefore appearance of sines and cosines on the left hand side should not come as a surprise. A trial solution for steady state vibrations may therefore be formulated as \\[\n    \\gct = A_1 \\cosp{\\extfreq t - \\extphs} + A_2 \\sinp{\\extfreq t - \\extphs}\n\\qquad(3.28)\\] which, when substituted into Equation 3.27, leads to \\[\\begin{align*}\n    & \\left[- \\extfreq^2 A_1 + 2 \\damp \\freq \\extfreq A_2  + \\freq^2 A_1 \\right ] \\cosp{\\extfreq t- \\extphs} + \\\\\n    & \\phantom{XXXXXXX} \\left[- \\extfreq^2 A_2  - 2 \\damp \\freq \\extfreq A_1 + \\freq^2 A_2 \\right ] \\sinp{\\extfreq t- \\extphs} =  \\frac{\\sforce}{m} \\sinp{\\extfreq t - \\extphs}\n\\end{align*}\\] and equating the coefficients of the sines and cosines on both sides leads to \\[\n    \\left(\\freq^2 - \\extfreq^2 \\right) A_1 + 2 \\damp \\freq \\extfreq A_2 =  0\n\\qquad(3.29)\\] \\[\n    -  2 \\damp \\freq \\extfreq A_1 + \\left(\\freq^2 - \\extfreq^2 \\right) A_2 = \\frac{\\sforce}{m}\n\\qquad(3.30)\\] Solving for the coefficients \\(A_i\\), one obtains, \\[\nA_1 = \\ratio{\\sforce}{m} \\ratio{\\left(- 2 \\damp \\freq \\extfreq \\right)}{\\left( \\freq^2 - \\extfreq^2 \\right)^2 + \\left(2 \\damp \\freq \\extfreq \\right)^2}, \\quad A_2 = \\ratio{\\sforce}{m} \\ratio{\\left( \\freq^2 - \\extfreq^2 \\right)}{\\left(\\freq^2 - \\extfreq^2 \\right)^2 + \\left(2 \\damp \\freq \\extfreq \\right)^2}\n\\] and after dividing the nominators and denominators by \\(\\freq^4\\) we get \\[\nA_1 = \\ratio{\\sforce}{k} \\ratio{ - 2 \\damp \\ratfreq }{\\left( 1 - \\ratfreq^2 \\right)^2 + \\left(2 \\damp  \\ratfreq \\right)^2}, \\quad A_2 = \\ratio{\\sforce}{k} \\ratio{ 1 - \\ratfreq^2}{\\left(1 - \\ratfreq^2 \\right)^2 + \\left(2 \\damp \\ratfreq \\right)^2}\n\\] where \\(\\ratfreq\\) is the ratio of the excitation frequency to the frequency of the system, i.e.  \\[\n\\ratfreq = \\ratio{\\extfreq}{\\freq}\n\\] Since the response is given by \\[\n\\gct = A_1 \\cosp{\\extfreq t - \\extphs} + A_2 \\sinp{\\extfreq t - \\extphs}\n\\] these two harmonics may, via the expansion \\(\\sinp{a-b} = \\sin a \\cos b - \\cos a \\sin b\\), be combined into a single wave, as was done on numerous previous instances, to obtain \\[\n\\begin{array}{rcl}\n\\gct  & \\!\\!\\! =  & \\!\\!\\! Q \\sinp{\\extfreq t - \\extphs - \\phs} = Q\\left[\\sinp{\\extfreq t - \\extphs}\\cos{\\phs} - \\cosp{\\extfreq t - \\extphs}\\sin{\\phs}\\right] \\\\\n& \\!\\!\\! = & \\!\\!\\! (-Q \\sin \\phs) \\cosp{\\extfreq t - \\extphs} + (Q \\cos \\phs ) \\sinp{\\extfreq t - \\extphs}\n\\end{array}\n\\qquad(3.31)\\] so that we have \\(A_1 = - Q \\sin \\phs\\) and \\(A_2 = Q \\cos \\phs\\), leading to: \\[\nQ = \\sqrt{A_1^2 + A_2^2}, \\quad \\tan \\phs = \\ratio{-A_1/Q}{A_2/Q}\n\\] The amplitude \\(Q\\) of the response is therefore given by \\[\n    Q = \\sqrt{A_1^2 + A_2^2} = \\ratio{\\sforce}{k}\\ratio{1}{\\sqrt{\\left(1 - \\ratfreq^2 \\right)^2 + \\left(2 \\damp \\ratfreq \\right)^2}} = \\ratio{\\sforce}{k} \\dynampr\n\\qquad(3.32)\\] where \\(F/k\\) would be the response that would be observed if the force of amplitude \\(\\sforce\\) were to be applied statically, and \\[\n    \\dynamp = \\dynampr = \\ratio{1}{\\sqrt{\\left(1 - \\ratfreq^2 \\right)^2 + \\left(2 \\damp \\ratfreq \\right)^2}} = \\ratio{Q}{F/k}\n\\qquad(3.33)\\] is called the dynamic amplification factor.5 With this definition, the phase angle \\(\\phs\\) may now be shown to be defined through \\[\n   \\tan \\phs = \\ratio{ ({2 \\damp \\ratfreq})/{\\dynamp}}{({1-\\ratfreq^2})/{\\dynamp}}\n\\qquad(3.34)\\] and it is implied by definition that \\(0 \\leq \\phs \\leq \\pi\\).\nThe dynamic amplification factor is a measure of increase in maximum response due to the harmonic application of the force, depending on ratio of the frequencies and available damping. How this amplification factor varies as a function of the ratio of frequencies is naturally of greatest importance, and this variation is shown graphically in Figure 3.11, along with variations of the phase angle, for various levels of viscous damping. A few characteristics of these curves deserve special mention:\n\n\n\nFigure 3.11: Variation of the dynamic amplification factor \\(\\dynamp\\) and the phase angle \\(\\phs\\) with ratio of frequencies, plotted for various levels of viscous damping.\n\n\n\nFor all levels of damping, \\(\\dynamp \\rightarrow 1\\) as \\(\\ratfreq \\rightarrow 0\\). This is mathematically obvious as the limit of the expression in Equation 3.33, and it may physically be interpreted in a few different ways:\n\nFor a given excitation with some finite, non-zero excitation frequency \\(\\extfreq\\), \\(\\ratfreq \\rightarrow 0\\) implies \\(\\freq \\rightarrow \\infty\\), which in turn requires \\(m \\rightarrow 0\\) for a system with finite stiffness. If so, then the inertial forces would be very small compared to the deformational forces so that \\(m \\ddgct\\) could be neglected in comparison with \\(k \\gct\\) and the governing differential equation would effectively simplify to \\(k \\gct = \\sforce \\sinp{\\extfreq t - \\extphs}\\) with the response given by \\[\n\\gct = \\ratio{\\sforce}{k} \\sinp{\\extfreq t - \\extphs}\n\\] and the system would deform in phase with the force (\\(\\phs \\rightarrow 0\\)). A massless spring represents a limiting case as the spring simply deforms in phase with the force (\\(\\phs = 0\\)), with the maximum deformation be given by \\(Q = \\sforce / k\\).\nFor a given excitation with some finite, non-zero excitation frequency \\(\\extfreq\\), \\(\\ratfreq \\rightarrow 0\\) implies \\(\\freq \\rightarrow \\infty\\), which in turn requires \\(k \\rightarrow \\infty\\) for a system with finite mass. Also in this case inertial forces could be neglected beside deformational forces so that \\(m \\ddgct\\) could be neglected compared to \\(k \\gct\\) and the governing differential equation would again effectively simplify to \\(k \\gct = \\sforce \\sinp{\\extfreq t - \\extphs}\\). The ratio of maximum deformation to \\(\\sforce / k\\) is again given by \\(Q / (\\sforce / k) = 1\\), no matter how small \\(Q\\) and \\(F / k\\) are due to the very high value of \\(k\\).\nFor a given system with some finite, non-zero frequency \\(\\extfreq\\), \\(\\ratfreq \\rightarrow 0\\) implies \\(\\extfreq \\rightarrow 0\\), which would mean that the force is applied ever so slowly and no significant accelerations develop, again allowing us to neglect \\(m \\ddgct\\) compared to \\(k \\gct\\), with the governing differential equation simplifying once again to \\(k \\gct = \\sforce \\sinp{\\extfreq t - \\extphs}\\), and the previous conclusion follow.\n\nFor all levels of damping, \\(\\dynamp \\rightarrow 0\\) as \\(\\ratfreq \\rightarrow \\infty\\). This result is also obvious mathematically as the limit of the expression in Equation 3.33, and the physical system may correspond to one of the following:\n\nFor a given excitation with some finite, non-zero excitation frequency \\(\\extfreq\\), \\(\\ratfreq \\rightarrow \\infty\\) implies \\(\\freq \\rightarrow 0\\), which in turn requires \\(m \\rightarrow \\infty\\) for a system with finite stiffness. If so, then the inertial forces would be very large compared to the deformational forces so that \\(k \\gct\\) could be neglected in comparison with \\(m \\ddgct\\) and the governing differential equation would effectively simplify to \\(m \\ddgct = \\sforce \\sinp{\\extfreq t - \\extphs}\\), the integration of which leads to: \\[\n\\gct = - \\ratio{\\sforce}{m\\extfreq^2} \\sinp{\\extfreq t - \\extphs}\n\\] The minus sign implies that the response is out of phase with the force (\\(\\phs \\rightarrow \\pi\\)) so that whenever the force reaches a maximum, the displacement reaches a minimum and vice versa. Clearly the maximum deformation tends to zero as \\(m\\) gets larger; in the limit, the inertia of the system is so great that no force can get it to start moving.\nFor a given excitation with some finite, non-zero excitation frequency \\(\\extfreq\\), \\(\\ratfreq \\rightarrow \\infty\\) implies \\(\\freq \\rightarrow 0\\), which in turn requires \\(k \\rightarrow 0\\) for a system with finite mass. Also in this case deformational forces could be neglected beside inertial forces so that \\(k \\gct\\) could be neglected compared to \\(m \\ddgct\\) and the governing differential equation would again effectively simplify to \\(m \\ddgct = \\sforce \\sinp{\\extfreq t - \\extphs}\\), leading to the same conclusions as in (ii.a).\nFor a given system with some finite, non-zero frequency \\(\\freq\\), \\(\\ratfreq \\rightarrow \\infty\\) implies \\(\\extfreq \\rightarrow \\infty\\), which would mean that the time variation of the force is extremely fast and significant accelerations develop as the mass tries to respond, again allowing us neglect \\(k \\gct\\) compared to \\(m \\ddgct\\). The governing differential equation would again effectively simplify to \\(m \\ddgct = \\sforce \\sinp{\\extfreq t - \\extphs}\\) and the response would be given by \\[\n\\gct = - \\ratio{\\sforce}{m\\extfreq^2} \\sinp{\\extfreq t - \\extphs}\n\\] which would tend to zero as \\(\\extfreq\\) gets larger and larger.\n\nThe dynamic amplification factor reaches a peak value somewhere in the vicinity of \\(\\ratfreq = 1\\) when damping levels are low. We can investigate the derivative of the dynamic amplification factor with respect to \\(\\ratfreq\\) to locate the extremum points: \\(\\diff \\dynamp / \\diff \\ratfreq\\) becomes zero at \\(\\ratfreq = 0\\) and \\(\\ratfreq = \\sqrt{1-2 \\damp^2}\\) for \\(\\damp \\leq 1/\\sqrt{2}\\), while for \\(\\damp &gt; 1 / \\sqrt{2}\\) the derivative is zero only for \\(\\ratfreq = 0\\). Therefore whenever \\(\\damp \\leq 1/\\sqrt{2} \\approx 71\\%\\), the maximum value of the dynamic amplification factor is given by \\[\n    \\dynamp_{\\max} = \\dynamp \\bigr|_{\\ratfreq = \\sqrt{1-2\\damp^2}} = \\ratio{1}{2 \\damp} \\ratio{1}{\\sqrt{1-\\damp^2}} \\approx \\ratio{1}{2 \\damp}\n\\qquad(3.35)\\] where the last approximation is valid for small values of the damping ratio. To provide some numerical justification, for a damping ratio of \\(\\damp = 10 \\%\\), which is not so small in terms of damping ratios frequently encountered in structural dynamics, the exact value for the amplification factor is \\(5.05\\) whereas the approximate value is \\(5.00\\), with the error of approximation about \\(1\\%\\) or, in other words, practically completely negligible.\n\nIf the damping is zero, the amplitude of the dynamic response tends to infinity as \\(\\ratfreq = (\\extfreq / \\freq) \\rightarrow 1\\), and this phenomenon is called \\(\\mem{resonance}\\). This infinite response is of course purely theoretical as the system would either yield or break if the deformations were to exceed critical levels but nevertheless the possibility of such large increases, no matter how small the amplitude of the forces is and purely due to the time variation of the force, is most significant. The large peaks observed in the vicinity of \\(\\ratfreq = (\\extfreq / \\freq) = 1\\) when viscous damping is present are also very significant as they may lead to excessive deformations not accounted for in design, and these will also be referred to as resonance to allude to the nature of phenomenon. Resonance leads to such significant increases in demands that it should definitely be avoided if possible, most probably by changing the design to modify the frequency of the system and making sure that it does not coincide with the possibly dominant frequencies of expected excitations.\n\n\n\n\nAs will be observed in numerous investigations, all time related adjectives such as ‘long’ and ‘short’ are relative to the period of the system.↩︎\nNote that by definition the dynamic amplification factor is a positive quantity.↩︎\n\n\n\n3.3.2 Response of Undamped Systems\nThe curves in Figure 3.11 are very significant for design purposes as they indicate the most critical deformations that SDOF systems are likely to suffer under harmonic forces, but they do not represent the whole picture regarding the time variation of the response. Let us first investigate an undamped system’s response over time for various values of \\(\\ratfreq = \\extfreq / \\freq\\), sketched in Figure 3.12. The system is initially at rest and the force is given by \\(\\extforce (t) = \\sforce \\sinp{\\extfreq t - \\extphs}\\). Since the system is undamped, for all \\(\\ratfreq \\neq 1\\), Equation 3.32 and Equation 3.34 lead to6 \\[\nQ = \\ratio{\\sforce}{k} \\dynamp = \\ratio{\\sforce}{k}\\ratio{1}{\\sqrt{(1-\\ratfreq^2)^2}}, \\qquad \\phs = \\begin{cases} \\arctan{\\frac{0}{1}} = 0 & \\ratfreq &lt; 1 \\\\ \\arctan{\\frac{0}{-1}} = \\pi & \\ratfreq &gt; 1\\end{cases}\n\\]\n\n\n\nFigure 3.12: Response of an undamped SDOF system, initially at rest, to the harmonic force \\(\\extforce (t) = \\sforce \\sinp{\\extfreq t+(\\pi/2)} =\\sforce \\cos{\\extfreq t}\\), for various values of \\(\\ratfreq = \\extfreq / \\freq\\). The plots are for time normalized by the period of the force, i.e. \\(\\tau = t / (2\\pi/\\extfreq)\\). Thin (blue) lines correspond to normalized force \\(\\extforce(\\tau) / \\sforce\\) and are presented for visual comparison of time shifts between the input and the response.\n\n\nSince the phase angle is either zero (for \\(\\ratfreq &lt; 1\\)) or \\(\\pi\\) (for \\(\\ratfreq &gt; 1\\)), the particular solution may be written with the help of the expansion \\(\\sinp{a-b} = \\sin a \\cos b - \\cos a \\sin b\\) as \\[\n\\gc_{p} (t) = Q \\cos \\phs \\sinp{\\extfreq t - \\extphs}\n\\] so that \\(\\gct = \\gc_{c} (t) + \\gc_{p} (t)\\) is given by \\[\n\\gct = C_1 \\cosp{\\freq t} + C_2 \\sinp{\\freq t} + Q \\cos \\phs \\sinp{\\extfreq t - \\extphs}\n\\] When the system is initially at rest, evaluating \\(C_i\\) leads to \\[\n\\ratio{\\gct}{\\sforce / k} = \\dynamp \\bigl[\\sin \\extphs \\cos \\phs \\cos \\freq t - \\ratfreq \\cos \\extphs \\cos \\phs \\sin \\freq t + \\cos \\phs \\sinp{\\extfreq t -\\extphs}\\bigr]\n\\qquad(3.36)\\] so that if, for example, \\(\\extforce (t) = \\sforce \\sinp{\\extfreq t}\\) with \\(\\extphs = 0\\), the response is given by \\[\n\\ratio{\\gct}{\\sforce / k} = \\dynamp \\bigl[- \\ratfreq \\cos \\phs \\sin \\freq t + \\cos \\phs \\sin{\\extfreq t}\\bigr]\n\\] whereas if \\(\\extforce (t) = \\sforce \\cosp{\\extfreq t}\\) with \\(\\extphs = -\\pi/2\\), the response is given by \\[\n\\ratio{\\gct}{\\sforce / k} = \\dynamp \\bigl[- \\cos \\phs \\cos \\freq t + \\cos \\phs \\cos{\\extfreq t}\\bigr]\n\\] where, in all cases concerning undamped systems, \\(\\cos \\phs = 1\\) if \\(\\ratfreq &lt; 1\\), and \\(\\cos \\phs = -1\\) if \\(\\ratfreq &gt; 1\\). Expressing the result in Equation 3.36 in terms of normalized time \\(\\tau = t / (2 \\pi / \\extfreq)\\), i.e. normalizing time with the period of the excitation frequency, we obtain \\[\n\\ratio{\\gc (\\tau) }{\\sforce / k} = \\dynamp \\bigl[\\sin \\extphs \\cos \\phs \\cosp{\\frac{2 \\pi}{\\ratfreq} \\tau}\n- \\ratfreq \\cos \\extphs \\cos \\phs \\sinp{\\frac{2 \\pi}{\\ratfreq} \\tau} + \\cos \\phs \\sinp{2 \\pi \\tau -\\extphs}\\bigr]\n\\qquad(3.37)\\] and we use Equation 3.37 to develop the response time histories shown in Figure 3.12 for \\(\\ratfreq = 0.1\\) and \\(\\ratfreq = 3.0\\), with \\(\\extphs = -\\pi/2\\). Note that since the system is undamped, the so-called transient solution never dies out, and in fact the maximum response may easily exceed what the particular solution, i.e. the dynamic amplification factor, alone predicts. The phase difference \\(\\phs\\) between the input and the output is not easily identified from these plots since the response comprises not only the particular solution but also the transients.\nWhen \\(\\ratfreq = 1\\), i.e. when \\(\\extfreq = \\freq\\), the particular solution \\(\\gc_p = Q \\sinp{\\extfreq t - \\extphs}\\) may no longer be employed since when \\(\\extfreq = \\freq\\), \\(\\gc_P = Q \\sinp{\\freq t - \\extphs}\\) satisfies the homogeneous equation. The particular solution for this specific case is given by \\[\n\\gc_{p} =  t [B_1 \\cosp{\\extfreq t - \\extphs} + B_2 \\sinp{\\extfreq t - \\extphs}] = t [B_1 \\cosp{\\freq t  - \\extphs} + B_2 \\sinp{\\freq t  - \\extphs}]\n\\] where \\(B_i\\) are constants yet to be determined. Substituting this proposal in the equation of motion given by \\[\nm \\ddgc_{p} (t) + k \\gc_{p} (t) = \\sforce \\sinp{\\extfreq t - \\extphs} = \\sforce \\sinp{\\freq t - \\extphs}\n\\] and solving for \\(B_i\\) yields: \\[\nB_1 = - \\ratio{\\sforce}{k}\\ratio{\\freq}{2}, \\qquad B_2 = 0\n\\] The total solution is given by \\[\n\\gct = C_1 \\cosp{\\freq t} + C_2 \\sinp{\\freq t} - \\ratio{\\sforce}{k}\\ratio{\\freq}{2} t \\cosp{\\freq t - \\extphs}\n\\] so that with the system initially at rest, one gets \\(C_1 = 0\\) and \\(C_2 = \\sforce \\cos \\extphs / (2k)\\), and the response is given by \\[\n\\ratio{\\gct}{{\\sforce}/{k}} = \\ratio{\\cos{\\extphs}}{2} \\sin{\\freq t} - \\ratio{\\freq}{2} t \\cosp{\\freq t - \\extphs}\n\\qquad(3.38)\\] For the specific case of \\(\\extphs = -\\pi/2\\) and using normalized time \\(\\tau = t / (2 \\pi / \\extfreq)\\), the response is given by \\[\n\\ratio{\\gc (\\tau)}{{\\sforce}/{k}} = \\pi \\tau \\sinp{2 \\pi \\tau}\n\\] and this final form is the one plotted in Figure 3.12. Two characteristics of the response are immediately obvious from this plot: i. The sinusoidal component is multiplied by a linearly increasing envelope so that the response amplitude continuously increases, leading to an infinitely large response as \\(\\tau \\rightarrow \\infty\\), ii. the response reaches its local peaks and troughs when the force is zero, so that the phase difference between the input and output is given by \\(\\phs = \\pi / 2\\), a result that is not obvious at a first glance from Equation 3.34.\n\n\n\n\nWhen \\(\\ratfreq = 1\\), the particular solution used for \\(\\ratfreq \\neq 1\\) is also the complementary solution and so the particular solution needs to be modified as we will soon see.↩︎\n\n\n\n3.3.3 Response of Damped Systems\nThe behavior is qualitatively different in the presence of damping as it should be expected. The particular solution is still given by Equation 3.31 but the complementary solution is given, for a viscously underdamped system, by Equation 3.2, i.e.  \\[\n\\gct=\\expon{-\\damp \\freq t}\\left(C_1 \\cos \\dfreq t  + C_2 \\sin \\dfreq t \\right)\n\\] Evaluating the coefficients for a system initially at rest leads to \\[\n\\begin{array}{rcl}\n\\frac{\\gct}{\\sforce / k}  & \\!\\!\\! = & \\!\\!\\! \\dynamp \\expon{-\\damp \\freq t} \\biggl[\\sinp{\\extphs + \\phs} \\cos \\dfreq t + \\biggl(\\frac{\\damp \\sinp{\\extphs + \\phs}-\\ratfreq \\cosp{\\extphs + \\phs}}{\\sqrt{1-\\damp^2}}\\biggr) \\sin \\dfreq t \\biggr] \\\\\n  & & \\; + \\dynamp\\sinp{\\extfreq t - \\extphs - \\phs}\n\\end{array}\n\\qquad(3.39)\\] which may be expressed, using normalized time \\(\\tau = t / (2 \\pi / \\extfreq)\\), as: \\[\n\\begin{array}{rcl}\n\\frac{\\gc (\\tau)}{\\sforce / k}  & \\!\\!\\! = & \\!\\!\\! \\dynamp \\expon{-2 \\pi \\damp \\tau / \\ratfreq} \\biggl[ \\sinp{\\extphs + \\phs} \\cos{\\frac{2 \\pi \\sqrt{1-\\damp^2}}{\\ratfreq}\\tau} + \\biggl(\\frac{\\damp \\sinp{\\extphs + \\phs}-\\ratfreq \\cosp{\\extphs + \\phs}}{\\sqrt{1-\\damp^2}}\\biggr) \\sin{\\frac{2 \\pi \\sqrt{1-\\damp^2}}{\\ratfreq}\\tau} \\biggr] \\\\\n& & \\;  + \\dynamp \\sinp{2 \\pi \\tau - \\extphs - \\phs}\n\\end{array}\n\\qquad(3.40)\\]\nLet us see how the response develops in the presence of relatively small amount of linear viscous damping, plotted in Figure 3.13. These plots show the response of an SDOF system, with \\(\\damp = 1 \\%\\), during the first ten cycles of the input. When \\(\\ratfreq = 0.1\\), the transients die out by the time about 6-7 cycles of input are completed, and the steady state response starts to completely govern, with response amplitude \\(\\approx F/k\\) and phase \\(\\phs \\approx 0\\). Since \\(\\ratfreq = 0.1\\), the system’s (undamped) frequency is ten times bigger than the forcing frequency, and so the system’s period is about ten times smaller than the period of the input; therefore, by the time the input completes one full cycle, the transient response completes about 10 cycles, and hence we can see the transient response decaying almost completely by the end of 6-7 cycles of input. The situation is reversed when \\(\\ratfreq = 3.0\\), since now the system’s period is 3 times longer that the period of the input; therefore, by the time the input completes ten full cycles, the transient response completes only a bit more than 3 cycles, and hence it is still very much alive. The dominance of the steady response is therefore not obvious and the presence of two distinct frequencies is still felt at \\(\\tau = 10\\); nevertheless, the amplitude of the response clearly indicates the decrease in the dynamic amplification factor as \\(\\ratfreq\\) exceeds \\(1\\).\n\n\n\nFigure 3.13: Response of a lightly damped (\\(\\damp = 1\\%\\)) SDOF system, initially at rest, to the harmonic force \\(\\extforce (t) = \\sforce \\sinp{\\extfreq t+(\\pi/2)} = \\sforce \\cosp{\\extfreq t}\\), for various values of \\(\\ratfreq = \\extfreq / \\freq\\). Time is normalized by the period of the force, i.e. \\(\\tau = t / (2\\pi/\\extfreq)\\). Thin (blue) lines correspond to normalized force \\(\\extforce(\\tau) / \\sforce\\) and are presented for visual comparison of time shifts between the input and the response.\n\n\nObviously the most interesting case is again that of near resonance, and we see that contrary to the unbounded increase observed in the undamped case, damping leads to a response converging to some finite value when \\(\\ratfreq = 1\\). As the transients complete about 10 cycles, the convergence is not finalized in the segment shown; in fact, for this amount of damping, the undisputed dominance of the steady state response requires about 50-60 cycles to be completed. This relatively delayed convergence is observed clearly in Figure 3.14 where the exponential decay of the response amplitude is tractable, and the response eventually converges to a steady state amplitude given by \\(50 \\approx 1 / (2 \\damp) = 1 / 0.02\\) as previously discussed while the dynamic amplification factor was investigated.\n\n\n\nFigure 3.14: Response of a lightly damped (\\(\\damp = 1\\%\\)) SDOF system, initially at rest, to the harmonic force \\(\\extforce (t) = \\sforce \\sinp{\\extfreq t+(\\pi/2)}=\\sforce \\cosp{\\extfreq t}\\), for \\(\\ratfreq = \\extfreq / \\freq = 1\\). Time is normalized by the period of the force, i.e. \\(\\tau = t / (2\\pi/\\extfreq)\\).\n\n\n\n\n3.3.4 Beat Phenomenon\nA curious phenomenon becomes predominantly evident in the response when the excitation frequency and the frequency of the system are close in an undamped system. The response of an undamped system, initially at rest, to the external force \\(\\extforcet = \\sforce \\sinp{\\extfreq t + (\\pi/2)} = \\sforce \\cosp{\\extfreq t}\\) was shown to be given by \\[\n\\ratio{\\gct}{\\sforce / k} = \\dynamp \\bigl[- \\cos \\phs \\cos \\freq t + \\cos \\phs \\cos{\\extfreq t}\\bigr]\n\\] When the response comprises two harmonics, it may be written, using trigonometric identities7, as the product of two harmonic waves: one of frequency equal to the average, and the second equal to half the difference of the original two frequencies. For this particular case, it may be shown that: \\[\n\\ratio{\\gct}{\\sforce / k} = \\dynamp \\cos \\phs \\bigl[- \\cos \\freq t + \\cos{\\extfreq t}\\bigr] = - 2 \\dynamp \\cos \\phs \\sinp{\\frac{\\extfreq - \\freq}{2}t}\\sinp{\\frac{\\extfreq + \\freq}{2}t}\n\\]\nThis product of two sine waves is generally interpreted as one modulating wave with frequency of modulation, called the beat frequency, equal to \\((\\extfreq - \\freq)\\),8 and a second wave, of frequency equal to the average given by \\((\\extfreq + \\freq)/2\\), whose amplitude is modified in a time dependent manner by the modulating wave. The resulting pattern is shown in Figure 3.15 which shows the response for the case \\(\\ratfreq = \\extfreq / \\freq = 0.94\\). If this were a sound wave, one would hear a note with a perpetually changing strength so that it would get loud and then quiet and then loud again and so on. Such a phenomenon is not very common but certainly possible in structural dynamics, with the more important considerations appearing in multi degree of freedom systems in which this beat phenomenon generally corresponds to a back-and-forth transfer of energy between different types of motion.\n\n\n\nFigure 3.15: Beat phenomenon in an undamped SDOF system subjected to a harmonic force \\(\\extforce (t) = \\sforce \\cosp{\\extfreq t}\\) with \\(\\ratfreq = \\extfreq / \\freq = 0.94\\). Time is normalized by the period of the force, i.e. \\(\\tau = t / (2\\pi/\\extfreq)\\).\n\n\n\n\n\n\n\\(\\sin(a\\pm b) = \\sin a \\cos b \\pm \\cos a \\sin b\\), \\(\\cos 2a = 1 - 2 \\sin^2 a = 2\\cos^2 a - 1\\)↩︎\nThe beat frequency is defined as the difference and not the half of the difference of the two frequencies, a choice based on the fact that the time between the peaks (or zeros) of modulation is given by \\(2\\pi/(\\extfreq - \\freq)\\)↩︎"
  },
  {
    "objectID": "singledofforced.html#sec-pulseimpulse",
    "href": "singledofforced.html#sec-pulseimpulse",
    "title": "3  Forced Vibrations of Single Degree of Freedom Systems",
    "section": "3.4 Pulse Response and Impulse Response Function",
    "text": "3.4 Pulse Response and Impulse Response Function\nA subclass of inputs called pulse type inputs (or simply pulses) are useful to model excitations that are relatively of short duration. The response of an SDOF system to such inputs will be qualitatively different than those we have so far considered in that due to the short excitation duration the system will not reach steady state conditions, and most of the oscillations will be free vibrations instigated by the energy the input imparts to the system.\n\n\n\nFigure 3.16: Pulse type forces: (a) arbitrary shaped, (b) rectangular pulse, (c) half-sine pulse, (d) triangular pulse.\n\n\nA pulse type loading often does not have a well-defined shape, such as the one shown in Figure 3.16(a). For analytical treatment pulses are often modeled in simpler shapes, such as the rectangular pulse of Figure 3.16(b), the half sine wave of Figure 3.16(c), and the symmetrical triangular shape of Figure 3.16(d). Analyses of these simpler shapes could be expected to give some indication of how SDOF systems respond to pulses and the effects of the pulse shape on the observed behavior.\n\n3.4.1 Rectangular Pulse\nLet us start with the rectangular pulse of Figure 3.16(b) since we have previously developed solutions to step inputs. We’ll analyze this problem twice, once by direct solution and once via superposition, to provide some exercise in possible approaches. The force is defined by \\[\n\\extforce (t) = \\begin{cases} F & 0 \\leq t &lt; t_d \\\\ 0 & t \\geq t_d \\end{cases}\n\\qquad(3.41)\\] where \\(t_d\\) is generally referred to as the pulse duration. Assuming the system is viscously underdamped and initially at rest, the system will be governed by \\[\nm \\ddgct + c \\dgct + k \\gct = \\sforce\\, ; \\quad \\left\\{\\gc(0) = 0, \\dgc(0) = 0\\right\\} \\, \\text{for } 0 \\leq t &lt; t_{d}\n\\qquad(3.42)\\] \\[\nm \\ddgct + c \\dgct + k \\gct = 0 \\, ; \\quad \\left\\{\\gc(t_{d}) = \\gc_{*}, \\dgc(t_{d}) = \\dgc_{*} \\right\\} \\, \\text{for } t \\geq t_{d}\n\\qquad(3.43)\\] We have already solved both cases: The solution to the step input of Equation 3.42 is given by Equation 3.11 and restated here for convenience, including the region of validity: \\[\n\\gct = \\frac{\\sforce}{k} \\left[ 1 -  \\expon{-\\damp \\freq t}\\left(\\cos \\dfreq t  + \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq t \\right)  \\right] \\quad \\text{for } 0 \\leq t &lt; t_d\n\\qquad(3.44)\\] The displacement and velocity of the of the system at \\(t=t_d\\) may be evaluated via Equation 3.11 and Equation 3.12 and they are given by \\[\n\\gc_{*}  \\equiv \\gc (t_d) = \\frac{\\sforce}{k} \\left[ 1 -  \\expon{-\\damp \\freq t_d}\\left(\\cos \\dfreq t_d  + \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq t_d \\right)  \\right]\n\\qquad(3.45)\\] \\[\n\\dgc_{*}  \\equiv \\dgc (t_d) = \\frac{\\sforce}{k} \\frac{\\freq}{\\sqrt{1-\\damp^2}} \\expon{-\\damp \\freq t_d} \\sin \\dfreq t_d\n\\qquad(3.46)\\] so that, based on the discussions of Section 3.2.1, the free vibration of the system for \\(t\\geq t_d\\) in response to Equation 3.43 is given by \\[\n\\gct = \\expon{-\\damp \\freq (t-t_{d})}\\left[\\gc_{*} \\cos \\dfreq (t-t_{d})  + \\frac{\\dgc_{*} + \\damp \\freq \\gc_{*} }{\\dfreq} \\sin \\dfreq (t-t_{d}) \\right]\n\\qquad(3.47)\\]\nTo gain some physical insight into how response characteristics change depending on the relative duration of the pulse, we may start by evaluating the response of an undamped SDOF system subjected to different pulses of same amplitude but varying relative duration. When the system is undamped, the expressions above may be used with \\(\\damp = 0\\) to obtain the response, and doing so we get \\[\n\\gct = \\begin{cases}\n\\ratio{\\sforce}{k} \\left[1 - \\cos \\freq t\\right] & \\text{for } 0 \\leq t &lt; t_{d}\\\\\n% \\label{eq:resprectpulseud1} \\tag{a} \\\\\n\\gc_{*} \\cosp{\\freq (t-t_d)} + \\ratio{\\dgc_{*}}{\\freq} \\sinp{\\freq (t - t_{d})}  & \\text{for } t \\geq t_{d}\n% \\label{eq:resprectpulseud2} \\tag{b}\n\\end{cases}\n\\qquad(3.48)\\] with \\[\n% \\begin{equation*}\\label{eq:resprectpulseud3}\n\\gc_{*}  = \\frac{\\sforce}{k} \\left[ 1 - \\cosp{\\freq t_d} \\right],  \\quad\n\\dgc_{*}  = \\frac{\\sforce}{k} {\\freq} \\sinp{\\freq t_d}\n% \\end{equation*}\n\\qquad(3.49)\\] To generalize the discussion, normalized time \\(\\tau = t/\\period\\) may be used and the relative pulse duration explicitly identified as \\(t_{d} / \\period\\) so that the response normalized by \\(\\sforce/k\\) is given by9 \\[\n\\frac{\\gct}{\\sforce/k} = \\begin{cases} \\left[1 - \\cosp{2 \\pi \\tau} \\right] & \\text{for } 0 \\leq \\tau &lt; \\ratio{t_{d}}{\\period} \\\\\n% \\vspace{-1em}\\\\\n\\ratio{\\gc_{*}}{\\sforce/k} \\cosp{2 \\pi \\left(\\tau - \\ratio{t_{d}}{\\period}\\right)} + \\ratio{\\dgc_{*}}{\\freq (\\sforce/k) } \\sinp{2\\pi \\left(\\tau - \\ratio{t_{d}}{\\period}\\right)} & \\text{for } \\tau \\geq \\ratio{t_{d}}{\\period} \\end{cases}\n\\qquad(3.50)\\] where \\[\n\\gc_{*}  = \\ratio{\\sforce}{k}\\left[ 1 - \\cos\\left( 2 \\pi  \\ratio{t_{d}}{\\period}\\right) \\right],  \\quad\n\\dgc_{*}  = \\ratio{\\sforce}{k} {\\freq} \\sin \\left(2 \\pi \\ratio{t_{d}}{\\period}\\right)\n\\qquad(3.51)\\] One immediate observation is that whenever \\(t_{d}/\\period\\) is a positive integer, \\(\\gc_{*}=0\\) and \\(\\dgc_{*}=0\\) so that no oscillations occur after the pulse ends.\n\n\n\nFigure 3.17: Response of an undamped SDOF system to a rectangular pulse for various ratios of pulse duration to system’s period. The plots are for normalized time \\(\\tau = t / \\period\\). Dashed lines correspond to normalized force \\(\\extforce (\\tau) / \\sforce\\) and are included to indicate the duration of the excitation.\n\n\nHow the response varies as a function of the relative pulse duration may be observed from the cases shown in Figure 3.17. In all cases, the maximum relative amplitude is capped by \\(2\\), which is the same as that observed when the system is excited by a constant force. The response may not reach this maximum though, as clearly seen in the plots corresponding to \\(t_{d}/\\period=0.05\\) and \\(t_{d}/\\period=0.20\\). The response in these cases looks very much like free vibrations with some positive initial velocity. This observation may be justified by the following argument: the well-known impulse - momentum equation, derived from Newton’s equation of motion for a particle, is given by \\[\n\\int_{t_1}^{t_2} [\\extforce (t) - k\\gct] \\dt = m \\dgc (t_2) - m \\dgc (t_1)\n\\] where \\(\\extforce(t) - k\\gct\\) is the resultant force acting on the mass of the undamped SDOF system at time \\(t\\). The integral on the left hand side is called the (linear or angular) impulse10 acting on the system, and the product \\(m\\dgc\\) appearing on the right hand side is the (linear or angular) momentum of the mass.11 Integrating from \\(t_1=0\\) to \\(t_2 = t_d\\) and remembering that the system we are investigating is initially at rest, we have: \\[\n\\int_{0}^{t_d} [\\sforce - k\\gct] \\dt = m \\dgc (t_d)\n\\] If the pulse duration is very small so that \\(t_{d}/\\period \\ll 1\\), then \\(\\gct\\), which is initially \\(0\\), may be expected to remain in the near vicinity of \\(0\\) since it physically takes time for the displacement response to build up during oscillations. In such cases, therefore, the integral of \\(k \\gc\\) may be neglected, and the problem may be approximated by \\[\n\\lsint{0}{t_d} \\sforce  \\dt = \\sforce t_{d} \\approx m \\dgc (t_d)\n\\] which implies that when \\(t_{d}/\\period \\ll 1\\) the response is that of free vibrations with zero initial displacement and initial velocity equal to \\(\\sforce t_{d}/m\\). Obviously for a finite amplitude pulse, the impulse imparted on the system will get smaller as \\(t_{d}/\\period\\) gets closer to zero so that when \\(t_{d}/\\period \\ll 1\\) it may be argued that the maximum response generated will remain much lower than the maximum response generated by pulses with same magnitudes but longer durations.\nAn important discussion directly relevant for design is the investigation of the maximum deformation that occurs during the motion of the mass. The parameter we will be concerned with is the absolute maximum deformation \\(\\maxdfrm\\) defined as \\[\n\\maxdfrm = \\max_{t} \\abs{\\gct}\n\\] where the notation \\(\\abs{x}\\) denotes the absolute value of \\(x\\). From the plots in Figure 3.17 it may be observed that whenever \\(t_{d}/\\period&lt;1/2\\), \\(\\maxdfrm\\) occurs for the first time12 during the free vibration phase (at some \\(t \\geq t_{d}\\) or, equivalently, some \\(\\tau \\geq t_{d}/\\period\\)) while whenever \\(t_{d}/\\period \\geq 1/2\\), \\(\\maxdfrm\\) occurs for the first time during the forced vibration phase (at some \\(t &lt; t_{d}\\) or, equivalently, some \\(\\tau &lt; t_{d}/\\period\\)). To discuss this phenomenon analytically, consider the following observations:\n\nIf \\(t_{d}/\\period \\geq 1/2\\), then from Equation 3.48 for \\(0 \\leq t &lt; t_{d}\\), we see that the response reaches the maximum possible value of \\(2F/k\\) at least once during the pulse. This value is reached only once if \\(t_{d}/\\period = 1/2\\) and at time \\(t = t_{d} = \\period/2\\); it thereafter may be reached at every integer multiple of \\(\\period/2\\) if the pulse duration permits.\nIf \\(t_{d}/\\period &lt; 1/2\\), then from Equation 3.48 for \\(0 \\leq t &lt; t_{d}\\) we see that the maximum response reached during the forced vibration stage is \\[\n\\ratio{\\sforce}{k} \\left[1 - \\cos \\freq t_{d}\\right] &lt; 2\n\\] since when \\(t_{d}/\\period &lt; 1/2\\), \\(\\freq t_{d} &lt; \\pi\\).\nThe maximum vibration amplitude during the free vibrations, described by Equation 3.48 for \\(t \\geq t_{d}\\), is given by13 \\[\n\\sqrt{(\\gc_{*})^2 + \\left(\\frac{\\dgc_{*}}{\\freq} \\right)^2 }\n\\] which, after substituting the initial conditions from Equation 3.49, yields \\[\n\\ratio{F}{k}\\sqrt{2}\\sqrt{1-\\cos\\left(\\freq t_{d}\\right)}    \n\\] This expression may be recast, by using the identity \\[\n\\cos 2\\beta = 1 - 2 \\sin^2 \\beta\n\\] to the following form: \\[\n2 \\ratio{F}{k}\\abs{\\sin\\left(\\pi\\ratio{t_{d}}{\\period}\\right)}\n\\] where the absolute value is included as per definition of the absolute maximum response.\n\nBased on these observations, the following may be deduced:\n\nIf \\(t_{d}/\\period \\geq 1/2\\), then \\[\n\\maxdfrm = \\max \\left\\{2\\ratio{F}{k},  2 \\ratio{F}{k}\\abs{\\sin\\left(\\pi\\ratio{t_{d}}{\\period}\\right)} \\right\\} = 2\\ratio{F}{k}\n\\] since \\[\n\\abs{\\sin\\left(\\pi\\ratio{t_{d}}{\\period}\\right)} \\leq 1 \\quad \\forall \\;  \\ratio{t_{d}}{\\period} \\geq 1/2\n\\]\nIf \\(t_{d}/\\period &lt; 1/2\\), then \\[\n\\maxdfrm = \\max \\left\\{\\ratio{\\sforce}{k} \\left[1 - \\cos \\freq t_{d}\\right],  2 \\ratio{F}{k}\\abs{\\sin\\left(\\pi\\ratio{t_{d}}{\\period}\\right)} \\right\\} = 2 \\ratio{F}{k}\\abs{\\sin\\left(\\pi\\ratio{t_{d}}{\\period}\\right)}\n\\] since \\[\n\\left[1 - \\cos \\freq t_{d}\\right] = 2 \\sin^2 \\left(\\pi\\ratio{t_{d}}{\\period}\\right) &lt; 2 \\abs{\\sin \\left(\\pi\\ratio{t_{d}}{\\period}\\right)} \\quad \\forall \\; \\ratio{t_{d}}{\\period} &lt; 1/2\n\\]\n\nThese results therefore confirm the validity of the conclusions, deduced from a limited number of cases, for all possible values of the ratio \\(t_{d}/\\period\\).\n\n\n\nFigure 3.18: Response of a damped SDOF system to a rectangular pulse for various ratios of pulse duration to system’s damped period and damping ratio. The plots are for normalized time \\(\\tau = t / \\dperiod\\). Dashed lines correspond to \\(\\extforce (\\tau)/ \\sforce\\) and are included to indicate the duration of the excitation.\n\n\nThe effects of damping may be observed in the response plots of Figure 3.18, where two ratios of \\(t_{d}/\\dperiod\\) (duration normalized by the damped period) are investigated for various values of \\(\\damp\\). The values of damping range from lightly damped systems (\\(\\damp = 5\\%\\)) to heavily damped systems (\\(\\damp = 80\\%\\)), and the maximum response decreases with increasing damping for all ratios of \\(t_{d}/\\dperiod\\) as expected. This observation helps to justify the choice of investigating undamped systems as some upper bound on the response; for some instances though this upper bound may be too conservative and it may be necessary to acknowledge the presence of damping.\nThe absolute maximum deformation that would occur in the damped system is smaller than that which would be observed in the corresponding undamped system (identical system and loading but with \\(\\damp=0\\)). The patterns discussed for the undamped system persist for the damped systems: If \\(t_{d}/\\dperiod \\geq 1/2\\), \\(\\maxdfrm\\) occurs at time \\(t = \\dperiod/2\\) with magnitude14 given by \\[\n\\maxdfrm = \\ratio{\\sforce}{k}\\left[1 + \\expon{-\\pi \\damp / \\sqrt{1-\\damp^2}} \\right]\n\\] whereas if \\(t_{d}/\\dperiod \\geq 1/2\\), \\(\\maxdfrm\\) occurs at the first local maximum or minimum (peak or trough) that occurs after the pulse ends.\n\n\n\nFigure 3.19: Rectangular pulse as combination of two step functions.\n\n\nBefore concluding the discussion on the rectangular pulse, we may also investigate how the principle of superposition may be employed to solve for the response. The rectangular pulse may be thought of as the combination of two step functions, one with a positive and the other with a negative amplitude with the second one also shifted in time, as schematically shown in Figure 3.19. The response for the first part, during which only the first step function acts, is again given by Equation 3.44. In the second part for which \\(t \\geq t_{d}\\), both step functions act and so the response will be the superposition of the responses to each input: \\[\\begin{align*}\n\\gct  & = \\frac{\\sforce}{k} \\left[ 1 -  \\expon{-\\damp \\freq t}\\left(\\cos \\dfreq t  + \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq t \\right)  \\right] - \\\\\n& \\qquad \\frac{\\sforce}{k} \\left[ 1 -  \\expon{-\\damp \\freq (t-t_{d})}\\left(\\cos \\dfreq (t-t_{d})  + \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq (t-t_{d}) \\right)  \\right] \\quad \\text{for } t \\geq {t_d}\n\\end{align*}\\] That this expression is equivalent to the expression that would be obtained via Equation 3.45, Equation 3.46, and Equation 3.47 is not obvious but it may be shown after some tedious algebra. Life is simpler if we consider the undamped case with \\(\\damp = 0\\) so that the solution obtained via superposition simplifies to \\[\n\\gct = \\frac{\\sforce}{k} \\left[ 1 -  \\cos \\freq t \\right]\n- \\frac{\\sforce}{k} \\left[ 1 - \\cos \\freq (t-t_{d}) \\right]\n= \\frac{\\sforce}{k}\\left[ \\cos \\freq (t-t_{d}) - \\cos \\freq t \\right]\n\\] The previous solution we obtained in Equation 3.48.b and Equation 3.49 lead to \\[\n\\gct = \\frac{\\sforce}{k} \\left[(1- \\cos \\freq t_d) \\cos \\freq (t-t_{d}) + \\sin \\freq t_{d} \\sin \\freq (t-t_{d}) \\right]\n\\] which, after using the often-employed trigonometric relations for cosines and sines of angle sums, simplifies to \\[\n\\gct = \\frac{\\sforce}{k}\\left[ \\cos \\freq (t-t_{d}) - \\cos \\freq t \\right]\n\\] as claimed.\n\n\n\n\nIt is really not appropriate to talk of a static response in the case of a pulse loading but normalizing the response by \\(\\sforce/k\\) allows generalization of results to arbitrary \\(\\sforce\\) and \\(k\\).↩︎\n If the generalized coordinate is a unidirectional translation then we are talking about linear impulse - momentum, whereas if it is a rotation about some axis then we are talking about angular impulse - momentum, in which case \\(m\\) would be some moment of inertia and \\(\\sforce\\) would in fact be some moment.↩︎\n In general this is a vector equation but here the scalar form suffices since the motion is one dimensional.↩︎\nDue to the periodicity of the response, \\(\\maxdfrm\\) is observed at many instances in these cases.↩︎\nRecall the discussions on free vibrations for how a sine and a cosine wave of the same frequency is combined into a single sine or cosine wave.↩︎\nWe had previously derived this result while discussing response to a step function. Note that the pulse duration is normalized with the damped period \\(\\dperiod\\) in the damped cases.↩︎\n\n\n\n3.4.2 Half-Sine Pulse\nLet us now consider the response of an SDOF system to a pulse with a different shape, in particular a pulse in the form of half a sine wave as shown in Figure 3.16(c). Such a force would be defined mathematically as \\[\n    \\extforcet = \\begin{cases}\n        \\sforce \\sinp{\\ratio{\\pi}{t_{d}}t} & 0 \\leq t &lt; t_{d} \\\\\n        0 & t \\geq t_{d}\n    \\end{cases}\n\\qquad(3.52)\\] We have already seen that the undamped cases provide an upper bound to the response quantities so let us concentrate on the analysis of undamped systems to identify possible effects of the pulse shape. An undamped SDOF system, initially at rest, would be governed by \\[\nm \\ddgct + k \\gct = \\sforce \\sinp{\\ratio{\\pi}{t_{d}}t}\\, ; \\, \\left\\{\\gc(0) = 0, \\dgc(0) = 0\\right\\} \\, \\text{for } 0 \\leq t &lt; t_{d}\n\\qquad(3.53)\\] \\[\nm \\ddgct + k \\gct = 0 \\, ; \\, \\left\\{\\gc(t_{d}) = \\gc_{*}, \\dgc(t_{d}) = \\dgc_{*} \\right\\} \\, \\text{for } t \\geq t_{d}\n\\qquad(3.54)\\] The first stage of the response, i.e. the stage defined by Equation 3.53, is the response to a sinusoidal force excitation with frequency and phase given by \\[\n\\extfreq = \\ratio{\\pi}{t_d}, \\quad \\extphs = 0\n\\] We already solved this problem in Section 3.3.2. For \\(0 \\leq t  &lt; t_{d}\\) the solutions given by Equation 3.36 and Equation 3.38 lead to \\[\n    \\ratio{\\gct}{\\sforce / k} = \\begin{cases}\n         \\dynamp \\bigl[- \\ratfreq \\cos \\phs \\sin \\freq t + \\cos \\phs \\sinp{\\extfreq t}\\bigr]  & \\ratfreq = \\frac{\\extfreq}{\\freq} \\neq 1 \\\\\n         \\ratio{1}{2} \\sin{\\freq t} - \\ratio{\\freq}{2} t \\cosp{\\freq t} & \\ratfreq = \\frac{\\extfreq}{\\freq} = 1\n    \\end{cases}\n\\qquad(3.55)\\] For an undamped system we have \\[\n    \\dynamp = \\ratio{1}{\\sqrt{(1-\\ratfreq^2)^2}}, \\quad \\phs = \\begin{cases}\n        0 & \\ratfreq &lt; 1\\\\\n        \\pi & \\ratfreq &gt; 1\n    \\end{cases}\n\\qquad(3.56)\\] so that both cases may be collected in a single expression as \\[\n    \\dynamp \\cos \\phs = \\ratio{1}{{(1-\\ratfreq^2)}}\n\\qquad(3.57)\\] and Equation 3.55 may be rewritten as \\[\n    \\ratio{\\gct}{\\sforce / k} = \\begin{cases}\n         \\ratio{1}{{(1-\\ratfreq^2)}} \\bigl[\\sinp{\\extfreq t}- \\ratfreq \\sin \\freq t \\bigr]  & \\ratfreq = \\frac{\\extfreq}{\\freq} \\neq 1 \\\\\n         \\ratio{1}{2} \\sin{\\freq t} - \\ratio{\\freq}{2} t \\cosp{\\freq t} & \\ratfreq = \\frac{\\extfreq}{\\freq} = 1\n    \\end{cases}\n\\qquad(3.58)\\] Based on our experience with the rectangular pulse, we may foresee that the ratio of pulse duration to the period of the system will be an important parameter. To track the dependence on this parameter directly, we define \\[\n\\ratdur = \\ratio{t_{d}}{\\period} = \\ratio{\\pi / \\extfreq}{2 \\pi / \\freq} = \\ratio{1}{2 \\ratfreq}\n\\] so that Equation 3.58 may be expressed as \\[\n\\ratio{\\gct}{\\sforce / k} = \\begin{cases}\n         \\ratio{4 \\ratdur^2}{{(4 \\ratdur^2-1)}} \\Bigl[\\sinp{\\extfreq t} - \\ratio{1}{2 \\ratdur} \\sinp{\\freq t}\\Bigr]  & \\ratdur \\neq \\frac{1}{2} \\\\\n         \\ratio{1}{2} \\sinp{\\freq t} - \\ratio{\\freq}{2} t \\cosp{\\freq t} & \\ratdur = \\frac{1}{2}\n    \\end{cases}\n\\qquad(3.59)\\] and the velocity is given by \\[\n\\ratio{\\dgct}{\\sforce / k} = \\begin{cases}\n         \\ratio{2 \\ratdur \\freq}{{(4 \\ratdur^2-1)}} \\bigl[\\cosp{\\extfreq t} - \\cos \\freq t\\bigr]  & \\ratdur \\neq \\frac{1}{2} \\\\\n         \\ratio{\\freq^2}{2} t \\sinp{\\freq t} & \\ratdur = \\frac{1}{2}\n    \\end{cases}\n\\qquad(3.60)\\] The response in the stage \\(t \\geq t_{d}\\) during which no force acts, governed by Equation 3.54, are free vibrations defined by \\[\n\\gct = \\gc_{*} \\cosp{\\freq(t-t_{d})} + \\ratio{\\dgc_{*}}{\\freq} \\sinp{\\freq(t-t_{d})}\n\\qquad(3.61)\\] where \\(\\gc_{*} = \\gc (t_{d})\\) and \\(\\dgc_{*}=\\dgc (t_{d})\\) are to be calculated using the results at the end of the forced vibration phase, i.e. from Equation 3.59 and Equation 3.60. Note that when \\(\\ratdur = t_{d}/T = 1/2\\), we have \\(\\freq t_{d} = \\pi\\), so that \\(\\gc (t_{d}) = \\pi / 2\\) and \\(\\dgc (t_{d}) = 0\\). Evaluating \\(\\{\\gc_{*}, \\dgc_{*}\\}\\) and substituting them into Equation 3.61 leads, after some algebraic manipulations using certain trigonometric relations,15 to \\[\n\\ratio{\\gct}{\\sforce / k} = \\begin{cases}\n         \\ratio{- 4 \\ratdur}{{(4 \\ratdur^2-1)}} \\cos \\pi \\ratdur \\sinp{\\freq \\left(t - \\frac{t_{d}}{2}\\right)}  & \\ratdur \\neq \\frac{1}{2} \\\\\n         \\ratio{\\pi}{2} \\cosp{\\freq (t-t_{d})} & \\ratdur = \\frac{1}{2}\n    \\end{cases}\n\\qquad(3.62)\\]\n\n\n\nFigure 3.20: Response of an undamped SDOF system to a half-sine pulse for various ratios of \\(\\ratdur = t_{d}/\\period\\). The plots are for normalized time \\(\\tau = t / \\period\\). Thin dashed (blue) lines correspond to \\(\\extforce (\\tau)/ \\sforce\\) and are included to indicate the duration of the excitation.\n\n\nUsing normalized time \\[\n\\tau = \\ratio{t}{T}\n\\] the response to the half-sine pulse may now be expressed in condensed fashion as follows: \\[\n    \\ratio{\\gct}{\\sforce / k} = \\begin{cases}\n          \\ratio{4 \\ratdur^2}{{(4 \\ratdur^2-1)}} \\Bigl[\\sinp{\\pi \\frac{\\tau}{\\ratdur} } - \\frac{1}{2 \\ratdur} \\sinp{2 \\pi \\tau}\\Bigr]   & 0 \\leq \\tau &lt; \\ratdur, , \\; \\ratdur \\neq \\frac{1}{2} \\\\\n           \\ratio{1}{2} \\sinp{2 \\pi \\tau} - \\pi \\tau \\cosp{2 \\pi \\tau}   & 0 \\leq \\tau &lt; \\ratdur, \\ratdur = \\frac{1}{2} \\\\\n         - \\ratio{4 \\ratdur}{{(4 \\ratdur^2-1)}} \\cosp{\\pi \\ratdur} \\sinp{\\pi(2 \\tau - \\ratdur)}  & \\tau \\geq \\ratdur, \\; \\ratdur \\neq \\frac{1}{2} \\\\\n         - \\ratio{\\pi}{2} \\cosp{2 \\pi\\tau} & \\tau \\geq \\ratdur, \\ratdur = \\frac{1}{2}\n    \\end{cases}\n\\qquad(3.63)\\] These equations are used to plot the various cases shown in Figure 3.20. When \\(\\ratdur = t_{d} / \\period\\) is relatively small, the behavior observed for the case of a half-sine pulse is very similar to that observed for a rectangular pulse, since then the response resembles very much that of a system subjected to some initial velocity. The initial velocity depends on the impulse \\(\\int_0^{t_{d}} \\! \\extforce \\dt\\) imparted, and it is the amount of impulse rather than the shape of the pulse that governs the response. At the other extreme, for \\(\\ratdur\\) relatively large, the effects of the pulse shape become much pronounced. Even for the case of \\(\\ratdur = 3\\) in Figure 3.20, we can see that the mean response follows the half sine wave with amplitude fluctuations smaller than those observed for smaller \\(\\ratdur\\) values. This trend continues with increasing values of \\(\\ratdur\\) so that eventually for truly large values of \\(\\ratdur\\) the response simply tracks \\(\\extforcet / k\\) as if the system responds pseudo-statically with negligible dynamical variations. The main difference between the long duration rectangular and half-sine pulses is the sudden jump in the rectangular pulse in contrast to the comparatively slowly rising excitation in the half-sine wave, leading to dominant transients in the case of the rectangular pulse that do not die out in undamped systems.\n\n\n\n\n\\(\\cos(a \\pm b) = \\cos a \\cos b \\mp \\sin a \\sin b\\)\\(\\sin(a \\pm b) = \\sin a \\cos b \\pm \\cos a \\sin b\\) \\(\\cos 2a = 2 \\cos^2 a -1 = 1 - 2 \\sin^2 a\\)↩︎\n\n\n\n3.4.3 Response and Shock Spectra\nRecall the prolonged analysis we presented while investigating how the maximum deformation varies depending on the duration of the rectangular pulse? The same question is also pressing in the case of the half-sine pulse. More generally, it could be the variation of maximum velocity, acceleration, or any other response related quantity that we may want to track as some function of a defining parameter. A record of the variation of some response quantity with a specific parameter when the system is subjected to a particular excitation is referred to as a response spectrum. The idea of a response spectrum is prominent in design because it is tailored to reflect the most critical case to be considered under a specific action. In the context of pulse-like inputs the maximum deformation is often the most relevant design parameter,16 and the variation of the maximum deformation with the duration and amplitude of the pulse excitation is referred to as a shock spectrum. We will see later that the concept of response spectra plays a pivotal role in aseismic design.\nThere are quite a few pulse forms that have been investigated besides the rectangular and the half-sine pulses we have analyzed in detail, with results published in many specialized publications and handbooks.17 Here we just intend to introduce some samples for the concept and therefore limit our discussions to the shock spectra for the two pulse types we have analyzed in the previous sections. Consider first the case of a rectangular pulse type force which was investigated in some detail in Section 3.4.1. In particular, it was shown that when an undamped SDOF system is acted upon by a rectangular pulse of amplitude \\(\\sforce\\) and duration \\(t_d\\), the maximum deformation \\(\\maxdfrm\\) that occurs in the system depends on the ratio of the pulse duration to the system’s period, i.e. \\(t_d / \\period\\), so that\n\nwhen \\(t_d / \\period \\geq 1/2\\), \\(\\maxdfrm = 2 \\ratio{\\sforce}{k}\\),\nwhen \\(t_d / \\period &lt; 1/2\\), \\(\\maxdfrm = 2 \\ratio{\\sforce}{k} \\abs{\\sin \\left( \\pi \\ratio{t_d}{\\period}\\right)}\\).\n\nNormalizing \\(\\maxdfrm\\) with \\(\\sforce/k\\) would provide a measure of the amplification observed in the dynamic response compared with the static response one would observe if the same amplitude of excitation were to be applied statically. Sometimes referred to as response factors, such normalized response quantities may therefore be employed as indicators for certain practices in which the maximum response amplitude is the sole critical parameter. A summary of results may be most readily shown on a simple graph depicting the variation of \\(\\maxdfrm / (\\sforce/k)\\) with \\(t_d / \\period\\), such as the one shown in Figure 3.21.\n\n\n\nFigure 3.21: Shock spectrum for a rectangular pulse, showing the variation of the maximum deformation that occurs in an undamped SDOF system subjected to a rectangular pulse.\n\n\nA similar discussion could be held for the case of the half-sine pulse although now the algebra becomes more involved. The response of an undamped SDOF system to a half sine pulse of amplitude \\(\\sforce\\) and duration \\(t_d\\) was shown in Section 3.4.2 (Equation 3.63) to be given by \\[\n\\ratio{\\gct}{\\sforce / k} = \\begin{cases}\n          \\ratio{1}{{1-(\\period/(2t_d))^2}} \\Bigl[\\sinp{\\pi \\frac{t}{t_d} } - \\frac{\\period}{2 t_d} \\sinp{\\freq t}\\Bigr]   & 0 \\leq t &lt; t_d, , \\; t_d \\neq \\frac{\\period}{2} \\\\\n           \\ratio{1}{2} \\bigl[\\sinp{\\freq t} - \\freq t \\cosp{\\freq t}\\bigr]   & 0 \\leq t &lt; t_d, t_d = \\frac{\\period}{2} \\\\\n         - \\ratio{\\period/t_d}{{1-(\\period/(2t_d))^2}} \\cosp{\\pi \\frac{t_d}{\\period}} \\sinp{\\freq \\bigl(t - \\frac{t_d}{2}\\bigr)}  & t \\geq t_d, \\; t_d \\neq \\frac{\\period}{2} \\\\\n         - \\ratio{\\pi}{2} \\cosp{\\freq t} & t \\geq t_d, t_d = \\frac{\\period}{2}\n    \\end{cases}\n\\qquad(3.64)\\] Let us start with the case of \\(t_d = T/2\\) as it is easier to deal with. The forced vibration phase, i.e. the time interval during which the force is acting, is described by \\[\n\\ratio{\\gct}{\\sforce / k} = \\frac{1}{2} \\bigl[\\sinp{\\freq t} - \\freq t \\cosp{\\freq t}\\bigr] = \\frac{1}{2} \\Bigl[\\sinp{\\pi\\ratio{t}{t_d}} - \\pi \\ratio{t}{t_d} \\cosp{ \\pi \\ratio{t}{t_d}}\\Bigr]\n\\] where we have incorporated the information that for the case at hand, \\(t_d = T/2\\). Extreme values occur at instances \\(t^*\\) at which the time derivative of this expression is zero so that \\[\n\\divt{({\\gct}/{(\\sforce / k))}}\\biggr|_{t=t^*} = \\frac{1}{2} \\pi^2 \\ratio{t^*}{t_d^2} \\sinp{\\pi \\ratio{t^*}{t_d}} =0\n\\] which yields either \\(t^*=0\\) or \\(t^*=t_d\\). It may be shown by substitution that the latter is the value that leads to the maximum response whereas the first corresponds to the instant of the minimum response. The maximum response that occurs during the forced phase is therefore given by \\[\n\\frac{1}{2} \\Bigl[\\sinp{\\pi\\ratio{t}{t_d}} - \\pi \\ratio{t}{t_d} \\cosp{ \\pi \\ratio{t}{t_d}}\\Bigr]\\Biggr|_{t=t_d} = \\ratio{\\pi}{2}\n\\] We can not yet conclude that this is the maximum of all response (still for the particular case of \\(t_d = T/2\\)) since the maximum that would be observed during the free vibration phase, i.e. the time interval after the force stops acting, may exceed this value. The response in the free vibration phase is described by \\[\n\\ratio{\\gct}{\\sforce / k} = - \\frac{\\pi}{2} \\cosp{\\freq t} = - \\frac{\\pi}{2} \\cosp{ \\pi \\ratio{t}{t_d}}\n\\] which is a simple sinusoidal wave with amplitude \\(\\pi / 2\\). We therefore may conclude that the maximum response that occurs in the system when \\(t_d /T = 1/2\\) is given by \\(\\pi / 2\\).\nThe investigation of what happens when \\(t_d /T \\neq 1/2\\) is more involved. The response in the forced vibration phase is described by \\[\\begin{align*}\n\\ratio{\\gct}{\\sforce / k} & =\n          \\frac{1}{{1-(\\period/(2t_d))^2}} \\Bigl[\\sinp{\\pi \\frac{t}{t_d} } - \\frac{\\period}{2 t_d} \\sinp{\\freq t}\\Bigr] \\\\\n          & = \\frac{1}{{1-(\\period/(2t_d))^2}} \\Bigl[\\sinp{\\pi \\frac{t}{t_d} } - \\frac{\\period}{2 t_d} \\sinp{2 \\pi \\ratio{t_d}{\\period} \\ratio{t}{t_d}} \\Bigr]\n\\end{align*}\\] To find the time instances \\(t^*\\) at which the extreme values of this response occur, we take the derivative of the expression above and set it equal to zero at \\(t=t^*\\) to obtain: \\[\n\\cosp{\\pi \\ratio{t^*}{t_d}}=\\cosp{2 \\pi \\ratio{t^*}{\\period}}\n\\] Since cosine is an even, periodic function with a period of \\(2\\pi\\), this condition is satisfied whenever \\[\n\\pi \\ratio{t^*}{t_d}= \\pm 2 \\pi \\ratio{t^*}{\\period} \\pm 2 \\pi n \\rightarrow \\ratio{t^*}{t_d} = \\pm \\ratio{2 n}{1 \\mp (2 t_d/\\period)}\n\\] where \\(n\\) is a non-zero integer. To account for all possibilities is important since at this point it is almost impossible to conclude anything specific about what these values lead to in the response. It may be shown by substitution that the response attains local maximum values for the positive signs so that the values we are interested in are given by \\[\n\\ratio{t^*}{t_d} = \\ratio{2 n}{1 + (2 t_d/\\period)} \\qquad \\text{for } n=1,2,3,...\n\\] It should also be noted that not all values of \\(n\\) may be used for an arbitrary value of \\(t_d/\\period\\) since the viable possibilities are those for which \\(t^* &lt; t_d\\) because we are investigating the forced vibration phase. For example, when \\(t_d/\\period = 1\\), we have \\[\n\\ratio{t^*}{t_d} = \\ratio{2}{3} n &lt; 1\n\\] which leads to a viable solution only for \\(n = 1\\). For any \\(n \\geq 2\\), the values obtained would not be valid since those values would lead to \\(t^* &gt; t_d\\), and the response expression we are investigating is not valid in that range (that would be the free vibration phase). The fact that only \\(n=1\\) is admissible means that there is only one local maximum (peak) in the response, a conclusion that may be verified by the corresponding plot in Figure 3.20. This single peak occurrence persists until \\(t_d/\\period = 1.5\\) since for any \\(t_d/\\period &lt; 1.5\\), \\[\n\\ratio{t^*}{t_d} &gt; \\ratio{2 n}{4} \\quad \\rightarrow \\quad \\ratio{t^*}{t_d} &gt; 1 \\qquad \\text{for } n=2,3,...\n\\] With \\(t_d/\\period = 1.5\\), the second peak starts to develop albeit with zero amplitude to begin with. When \\(t_d/\\period = 2\\), for example, \\[\n\\ratio{t^*}{t_d} = \\ratio{2 n}{5} &lt; 1\n\\] yields \\(n=1\\) and \\(n=2\\) as viable solutions, and hence indicates the existence of two local maxima during the forced vibration phase. Similarly, the third local peak starts to kick in after \\(t_d/\\period = 2.5\\), and for \\(t_d/\\period = 3\\), we have \\[\n\\ratio{t^*}{t_d} = \\ratio{2 n}{7} &lt; 1\n\\] leading to \\(n=1,2\\) and \\(3\\), thereby indicating three local maxima. All of the cases above may be observed in the plots in Figure 3.20.\nThe next issue to consider is to figure out which of these local maxima is the biggest of all. This question may be dealt with analytically but a graphical approach is somewhat easier and more informative. The local maxima in the forced vibration phase are given by the response values at times \\(t=t^*\\), i.e. \\[\n\\biggl(\\ratio{\\gc}{\\sforce / k}\\biggr)_{max} = \\frac{1}{{1-(\\period/(2t_d))^2}} \\Bigl[\\sinp{\\pi \\frac{t}{t_d} } - \\frac{\\period}{2 t_d} \\sinp{2 \\pi \\ratio{t_d}{\\period} \\ratio{t}{t_d}} \\Bigr] \\biggr|_{t=t^*}\n\\] The first local peak is defined by \\[\n\\ratio{t^*}{t_d} = \\ratio{2}{1 + (2 t_d/\\period)}\n\\] so that if we want to plot how the amplitude of this local peak varies with the ratio \\(t_d/\\period\\), we have to plot the variation of \\[\n\\frac{1}{{1-(\\period/(2t_d))^2}} \\Bigl[\\sinp{\\pi \\ratio{2}{1 + (2 t_d/\\period)} } - \\frac{\\period}{2 t_d} \\sinp{2 \\pi \\ratio{t_d}{\\period} \\ratio{2}{1 + (2 t_d/\\period)}} \\Bigr]\n\\] for \\(t_d/\\period \\geq 0\\). Similarly, for the second local peak, we have \\[\n\\ratio{t^*}{t_d} = \\ratio{4}{1 + (2 t_d/\\period)}\n\\] and we plot \\[\n\\frac{1}{{1-(\\period/(2t_d))^2}} \\Bigl[\\sinp{\\pi \\ratio{4}{1 + (2 t_d/\\period)} } - \\frac{\\period}{2 t_d} \\sinp{2 \\pi \\ratio{t_d}{\\period} \\ratio{4}{1 + (2 t_d/\\period)}} \\Bigr]\n\\] for \\(t_d/\\period \\geq 1.5\\) (since the second peak does not exist for \\(t_d/\\period &lt; 1.5\\)). Such plots are provided in Figure 3.22 for the first three local peaks (i.e. \\(n=1,2,3\\)).\n\n\n\nFigure 3.22: Amplitudes of local response (\\(\\gct/(F/k)\\)) peaks (top) and the maximum of those amplitudes (bottom) as they vary with the ratio of pulse duration to the period of the system when an undamped SDOF system is subjected to a half-sine pulse. The results pertain to the forced vibration phase alone.\n\n\nThe three curves in the top plot of Figure 3.22 show how the amplitude of each individual peak, i.e. the first, the second and the third peak, that occur in the forced vibration phase varies with \\(t_d/\\period\\). Clearly the first peak’s amplitude is the largest initially but after a while the amplitude of the second peak exceeds that of the first, and after a while the peak of the third exceeds both and so on. The value corresponding to the case of \\(t_d/\\period = 1/2\\) is also embedded to the first local peak plot. As we are interested in the global maximum response that will be observed during the forced vibration phase, what we need is the envelope of these curves, which is the curve shown in the bottom plot.\nWhat remains to be seen is whether the maximum response that will be observed in the free vibration phase exceeds the one that is observed in the forced vibration phase. The response in the free vibration phase is given by \\[\n    \\ratio{\\gct}{\\sforce / k} = - \\frac{\\period/t_d}{{1-(\\period/(2t_d))^2}} \\cosp{\\pi \\frac{t_d}{\\period}} \\sinp{\\freq \\bigl(t - \\frac{t_d}{2}\\bigr)}\n\\] and so this is a simple sinusoidal wave with amplitude \\[\n\\left| \\frac{\\period/t_d}{{1-(\\period/(2t_d))^2}} \\cosp{\\pi \\frac{t_d}{\\period}} \\right|\n\\] How this free vibration amplitude varies with \\(t_d/\\period\\) is shown in the top part of Figure 3.23. The lighter line accompanying the free vibration amplitudes corresponds to the previously calculated maxima for the forced vibration phase.\nFinally, the shock spectrum is constructed by the envelope of the two curves, i.e. the value of the shock spectrum at any value of \\(t_d/\\period\\) is the greater of the free vibration amplitude and the maximum forced vibration response at that particular \\(t_d/\\period\\). The free vibration amplitude exceeds the maximum force vibration response for \\(t_d/\\period &lt; 1/2\\) whereas the reverse is true for \\(t_d/\\period &gt; 1/2\\). The resulting shock spectrum in terms of \\({\\maxdfrm}/({\\sforce / k})\\) is shown in the lower part of Figure 3.23.\n\n\n\nFigure 3.23: Variation of the free vibration amplitude (\\(\\gct/(F/k)\\), top) and the shock spectrum (bottom) for the undamped SDOF system subjected to a half-sine pulse.\n\n\nThe effort that goes into developing such spectra is obviously not insignificant, even for the relatively simpler case of undamped systems. What damping will do will be to decrease the amplitudes in all cases so that the undamped system may be used as a conservative estimate of what to expect. Further complexities will be introduced as the pulse shape varies. Still we find the exercise above worthwhile to introduce the concept of spectrum and illustrate the procedures engineers employ to produce such information. On the other hand, it is probably more efficient to develop such spectra using numerical methods to calculate the response to any input. Moreover, the numerical approach is the only option when analytical solutions are elusive as, for example, in the case of earthquake induced ground motions. More will be said on this issue while discussing earthquake response spectra in latter sections.\n\n\n\n\nAn impact, for example, may be modelled as a short duration pulse-type loading and protection against impacts is often a matter of limiting deformations with proper design. Blast type loadings are also an important subclass.↩︎\nSee, e.g., Harris’s Shock and Vibration Handbook, edited by C.M. Harris and A.G. Piersol, Fifth Edition, McGraw-Hill, 2002; in particular Chapter 8: Transient Response to Step and Pulse Functions by R.S. Ayre.↩︎\n\n\n\n3.4.4 Impulse\nWe have already seen that as the pulse duration tends to be very short compared to the period of the structure, the response tends to free vibrations with some initial velocity. The mathematical limit of such a pulse would be an instantaneous effect. The impulse imparted by finite amplitude pulses, however, tend to zero with decreasing duration, so in the limiting case such a pulse would have no effect whatsoever on the system. To be able to impart a finite impulse instantaneously, a generalized function called Dirac-delta is employed to model this limiting case.\nThe Dirac-delta function may be defined as the limit of a number of different functional forms but, for the purposes of this discussion, assume we have a rectangular pulse starting at \\(t=0\\), of duration \\(\\Delta t\\) and amplitude \\(1 / \\Delta t\\) as shown in Figure 3.24(a). The impulse imparted by this pulse is of unit magnitude, hence the limit is also referred to as the unit impulse. As \\(\\Delta t \\rightarrow 0\\), the amplitude increases without bound, but the integral of the function is assumed to remain at the constant value of unity, i.e. we assume that \\[\n\\lsint{-\\infty}{t}\\delta(\\tau) \\diff\\tau = \\begin{cases} 0 & \\text{for } t &lt; 0 \\\\ 1 & \\text{for } t \\geq 0 \\end{cases}\n\\qquad(3.65)\\] where the instantaneous transfer of momentum is assumed to be completed by the time \\(t=0\\).18 This limiting case is graphically represented by a line with an arrowhead, placed on the instant at which the unit impulse acts, as shown in Figure 3.24(b) and (c). If the unit impulse acts at \\(t=0\\), then it is simply written as \\(\\delta (t)\\), whereas if it is acting at some other instant \\(t=\\tshift\\), then the instance of application is explicitly indicated and the function is expressed as \\(\\delta (t-\\tshift)\\).19\n\n\n\nFigure 3.24: (a) A unit pulse, (b) its limit as \\(\\Delta t \\rightarrow 0\\) known as the unit impulse (the Dirac-delta function), (c) a shifted unit impulse.\n\n\nHow would a damped SDOF system respond to such an input? Let us assume that the system is initially at rest and it is subjected to the unit impulse \\(\\delta (t)\\). The impulse-momentum equation, with the limits of the integral corresponding to \\(0^{-}\\) and \\(0\\) where \\(0^{-}\\) is some instant very close to \\(0\\), is given by \\[\n\\lsint{0^{-}}{0} \\underbrace{\\left[\\delta(t) - c \\dgct - k \\gct \\right]}_{\\text{resultant force acting on the mass}} \\dt = \\sint \\diff \\underbrace{(m \\dgct)}_{\\text{momentum}} = \\lsint{0^{-}}{0} m \\ddgct \\dt\n\\] Let us investigate these integrals one by one. By definition, \\[\n\\lsint{0^{-}}{0} \\delta(t) = 1\n\\] and since the system is at rest, \\[\n\\sint \\diff {(m \\dgct)} = m \\dgc (0) -  m \\dgc (0^{-}) = m \\dgc (0)\n\\] The remaining two integrals need more deliberation. We have already seen while discussing response to pulse inputs that it takes some time for displacements to build up. The duration we are considering is extremely small so that the positions of the mass at \\(t=0^{-}\\) and \\(t=0\\) are practically the same, in which case the integral of \\(\\gc (t)\\) within those limits is zero. These considerations lead to \\[\n\\lsint{0^{-}}{0} c \\dgct \\dt = c \\gc (0) - c \\gc (0^{-}) = 0, \\quad \\lsint{0^{-}}{0} k \\gct \\dt = 0\n\\] so that by the time the impulse has ended, the mass, while still at the same position, has gained a velocity equal to \\[\n\\dgc (0) = \\frac{1}{m}\n\\] A viscously damped linear SDOF system subject to a unit pulse at \\(t=0\\) is therefore governed for \\(t \\geq 0\\) by \\[\n    m \\ddgct + c \\dgct + k \\gct = 0 \\, ; \\quad \\left\\{\\gc(0) = 0, \\dgc(0) = \\frac{1}{m} \\right\\}\n\\qquad(3.66)\\] The response to a unit impulse, i.e. the solution to Equation 3.66, is very important in structural dynamics. It is often referred to as the impulse response function and it is designated by a special symbol for distinction. Here we will use \\(\\impresp (t)\\) to denote the impulse response function which, for an underdamped system is given by \\[\n    \\impresp (t) = \\frac{1}{m \\dfreq} \\expon{- \\damp \\freq t} \\sin \\dfreq t\n\\qquad(3.67)\\] and if the system were undamped, the impulse response function could be derived from Equation 3.67 by substituting \\(\\damp = 0\\) to obtain \\[\n    \\impresp (t) = \\frac{1}{m \\freq} \\sin \\freq t\n\\qquad(3.68)\\] The impulse response function is schematically shown in Figure 3.25.\n\n\n\nFigure 3.25: Impulse response functions \\(\\impresp (t)\\) [on the left] and \\(\\impresp (t-\\tshift)\\) [on the right] for a viscously underdamped SDOF system.\n\n\nThe same conclusion would be reached if we were to consider the limiting case of a finite duration rectangular pulse. The solution for a rectangular pulse, of amplitude \\(\\sforce\\) and duration \\(t_{d}\\), is given by Equation 3.44, Equation 3.45, Equation 3.46, and Equation 3.47. Let us employ these solutions with \\[\nt_{d} = \\Delta t, \\quad \\sforce = \\frac{1}{\\Delta t}\n\\] and consider the limit \\(\\Delta t\\rightarrow 0\\). Using the series expansions20 for the exponential as well as the sine and cosine terms in the solutions, the limits for the initial conditions of Equation 3.45 and Equation 3.46 are obtained as \\[\n\\lim_{\\Delta t \\rightarrow 0} \\gc (\\Delta t) = 0, \\quad \\lim_{\\Delta t \\rightarrow 0} \\dgc (\\Delta t) = \\frac{1}{m}\n\\] so that the limit of Equation 3.47 yields \\[\n\\lim_{\\Delta t \\rightarrow 0} \\gc (t) = \\frac{1}{m \\dfreq} \\expon{- \\damp \\freq t} \\sin \\dfreq t = \\impresp (t)\n\\qquad(3.69)\\]\nThe linearity of the system allows for applying the principle of superposition so that if the system was subject to an impulse of amplitude \\(\\lambda\\), then the response would be simply \\[\n\\gct = \\lambda \\impresp (t)\n\\] and if this impulse were applied at time \\(t = \\tshift\\), then the response would be given for \\(t \\geq \\tshift\\) by \\[\n\\gc (t) = \\lambda \\impresp (t - \\tshift)\n\\] where it is implied by definition that \\(\\impresp (t - \\tshift) = 0\\) for \\(t &lt; \\tshift\\).\n\n\n\nFigure 3.26: A general input as a sequence of impulses.\n\n\nIf the system is subject to multiple impulses, say \\(n\\) impulses, each of which is applied at \\(t = \\tau_i\\) with amplitude \\(\\lambda_i\\), then the response of the system at time \\(t\\) may be evaluated via superposition as \\[\n\\gct = \\sum_{i=1}^{n} \\lambda_i \\impresp (t - \\tau_i)\n\\] This reasoning may be extended to finding the response of an SDOF system to a general input by modeling the input as a sequence of infinitesimal impulses. Consider the input sketched in Figure 3.26. This input may be approximated by a sequence of impulsive actions, each of which is applied at \\(t = \\tau_i\\) with impulse \\(\\extforce (\\tau_i) \\Delta \\tau\\). The response of the system at some time \\(t\\) would be given, according to the principle of superposition, by the sum of the responses to each individual impulsive action so that \\[\n\\gct \\approx \\sum_{i} \\left[\\extforce (\\tau_i) \\Delta \\tau \\right] \\impresp (t - \\tau_i)\n\\] where the approximate sign is used since (i) the input is idealized by a sequence of pulses as opposed to the continuous curve it actually is, and (ii) the response to a finite duration pulse is not exactly equal to the impulse response \\(\\impresp (t-\\tau_i)\\) but we assume \\(\\Delta t\\) is small enough so that this approximation is acceptable and that the impulse response may be used in the construction.21 It is implied that the summation is over only those impulses for which \\(t \\geq \\tau_i\\). As we consider smaller and smaller increments \\(\\Delta \\tau\\), \\(\\tau\\) becomes a continuous variable (as opposed to the countable \\(\\tau_i\\)), \\(\\extforce (\\tau_i) \\Delta \\tau \\rightarrow \\extforce (\\tau) \\diff \\tau\\), and the summation is replaced by an integral to account for all the impulses from the time the force begins to act up to the final time \\(t\\) so that \\[\n    \\gct = \\lsint{0}{t} \\extforce (\\tau) \\impresp (t-\\tau) \\diff \\tau\n\\qquad(3.70)\\] This integral, commonly known as the convolution integral or the superposition integral, is referred to as Duhamel’s integral in the context of vibrations. It may be considered as the general solution to all forced vibration problems regarding SDOF systems since the integral may, in theory, be evaluated given a force and the system’s impulse response function, whether analytically or by numerical means. There are, however, more accurate and efficient numerical methods used in integrating the equations of motion and the direct numerical evaluation of Equation 3.70 is seldom used anymore.\nTwo further points should be made in passing. First, it should be apparent if we follow the development of the formulations that the solution in Equation 3.70 is constructed for a system initially at rest. If the system has non-zero initial conditions so that \\(\\gc (0) = \\gcic\\) and \\(\\dgc (0) = \\dgcic\\), their contribution may be included via superposition as \\[\n    \\gct =  \\expon{-\\damp \\freq t}\\left[\\gcic \\cos \\dfreq t  + \\frac{\\dgcic + \\damp \\freq \\gcic }{\\dfreq} \\sin \\dfreq t \\right] + \\lsint{0}{t} \\extforce (\\tau) \\impresp (t-\\tau) \\diff \\tau\n\\qquad(3.71)\\] The second point is related to how the convolution may be executed in terms of what is referred to as its commutativity. By defining a new (dummy) variable \\({\\tau}^{*} = t - \\tau\\) so that22 \\(\\diff {\\tau}^{*} = - \\diff \\tau\\), Equation 3.70 may be expressed as \\[\n\\begin{array}{rcl}\n    \\gct & \\!\\!\\! = & \\!\\!\\! \\lsint{0}{t} \\extforce (\\tau) \\impresp (t-\\tau) \\diff \\tau = \\lsint{t}{0} \\extforce (t - \\tau^{*}) \\impresp ({\\tau}^{*}) (-\\diff \\tau^{*}) \\\\\n    & \\!\\!\\! = & \\!\\!\\! \\lsint{0}{t} \\extforce (t - \\tau^{*}) \\impresp ({\\tau}^{*}) \\diff \\tau^{*} = \\lsint{0}{t} \\extforce (t - \\tau) \\impresp ({\\tau}) \\diff \\tau\n\\end{array}\n\\qquad(3.72)\\] where the last equality follows form the fact that both \\(\\tau\\) and \\(\\tau^{*}\\) are (dummy) variables that scan the interval between \\(0\\) and \\(t\\) so that either symbol may be used to express the integral. Whether the form in Equation 3.70 or the one in Equation 3.72 should be preferred is solely a matter of pragmatism in that one form may lead to integrals that are simpler to evaluate; otherwise, these two forms are equivalent and either may be employed in any problem.\n\n\n\n\nThe simple fact is that this function can not actually be determined at \\(t=0\\); the bounds of the two cases should more properly be \\(&lt; 0\\) and \\(&gt; 0\\), but here we include the equality sign as a mere convention.↩︎\nIt shouldn’t be a stretch to imagine that the Dirac-delta function may also be defined on a spatial domain, an approach sometimes used to model discrete forces acting at a point.↩︎\n\\(\\expon{x} = 1 + x + \\frac{x^2}{2!} + \\frac{x^3}{3!} + \\newline \\cdots\\), \\(\\sin \\theta = x - \\frac{x^3}{3!} + \\frac{x^5}{5!} + \\cdots\\), \\(\\cos \\theta = 1 - \\frac{x^2}{2!} + \\frac{x^4}{4!} + \\cdots\\)↩︎\nEventually we will take the limit as \\(\\Delta \\tau \\rightarrow 0\\) in which case the impulse response function will indeed appear in the solution as we observed in Equation 3.69. At this stage we simply note this rather than introducing a new function.↩︎\nSince \\(t\\) in this context denotes only the final time and time as variable is denoted by either \\(\\tau\\) or \\({\\tau}^{*}\\).↩︎"
  },
  {
    "objectID": "singledofforced.html#force-transmission-and-vibration-isolation",
    "href": "singledofforced.html#force-transmission-and-vibration-isolation",
    "title": "3  Forced Vibrations of Single Degree of Freedom Systems",
    "section": "3.5 Force Transmission and Vibration Isolation",
    "text": "3.5 Force Transmission and Vibration Isolation\nNext, we consider two interrelated problems dealing with systems subjected to harmonic excitations. The first question we will ask is, how does the magnitude of the force transmitted to the base of a SDOF system depend on the excitation frequency? In other words, are there particular strategies that can isolate the force transmitted to the base? This problem is of course relevant for designing a foundation or support structure may have to sustain the dynamic loads induced by a machine housed in the building. More commonly, there may be stringent limits to the magnitude of forces transmitted to the base in applications where they may be other sensitive equipment housed nearby. The second related problem pertains to base excitation described in the previous section. The central question here is are there strategies that can be implemented to limit, as much as possible, forces transmitted from the ground motion to the structure, given a certain ground excitation (either accelerations or displacements) with a sinusoidal time history and constant amplitude. An obvious application here is base isolation of structure to protect it from earthquake induced ground excitations, but there are other applications for this as well. For instance, in laboratories housing sensitive equipment such as microscopes, base isolation is necessary to ensure that pedestrian motion nearby does not impact instrument performance.\nWe start our inquiry by examining first the problem of force transmission to the base by a mass subject to simple harmonic motion. First, it will be necessary to rewrite our equation of motion and isolate the elements that transmit forces to the base. The total force \\(\\extforce_{tr} (t)\\) transmitted to the base comprises forces coming from springs and dampers, and it may be expressed as:\n\\[\\extforce_{tr} (t)= k \\gct + c \\dgct \\]\nFor an excitation \\(\\extforce (t) = \\sforce \\cosp{\\extfreq t}\\), the solution to the equation of motion gives us \\[\\gct = \\dynamp \\frac{\\sforce }{k} \\cosp{\\extfreq t - \\phs} \\] and \\[ \\dgct = - \\dynamp \\frac{\\sforce }{k} \\sinp{\\extfreq t - \\phs} \\] so that plugging \\(\\gct\\) and \\(\\dgct\\) into the expression for \\(\\extforce_{tr} (t)\\) yields: \\[ \\extforce_{tr} (t) = \\dynamp \\frac{\\sforce }{k} \\left[ k \\cosp{\\extfreq t - \\phs} + c \\extfreq  \\sinp{\\extfreq t - \\phs} \\right] = \\sforce_{tr} \\cosp{\\extfreq t - \\phs_{tr}}\\] where \\(\\phs_{tr}\\) is the phase difference between the applied external force and the force transmitted to the base, and \\(\\sforce_{tr}\\) is the amplitude of the transmitted force given by \\[ \\sforce_{tr}  = \\dynamp \\frac{\\sforce }{k} \\sqrt{k^2 + c^2 \\extfreq^2} \\]\nIf the problem were static, the force transmitted would be equal to \\(\\sforce\\). Amplification factor for transmissibility in the dynamic case can be given as: \\[ \\frac{\\sforce_{tr} }{\\sforce} = \\dynamp \\sqrt{1 + \\frac{c^2}{k^2} \\extfreq^2}\\]\nNoting that \\(c^2 = (2 m \\freq \\damp)^2\\) and \\(k^2 = (m \\freq^2)^2\\), the expression above may be written as \\[\\frac{\\sforce_{tr} }{\\sforce} = \\dynamp \\sqrt{1 + \\left(2\\damp \\frac{\\extfreq}{\\freq}\\right)^2}\\] and substituting in \\(\\ratfreq = \\frac{\\extfreq}{\\freq}\\) and the expression for \\(\\dynamp(\\ratfreq)\\) given by Equation 3.33, we get: \\[\n\\frac{\\sforce_{tr}}{\\sforce} = \\sqrt{\\ratio{1+(2\\damp \\ratfreq)^2}{\\left(1 - \\ratfreq^2 \\right)^2 + \\left(2 \\damp \\ratfreq \\right)^2}}\n\\qquad(3.73)\\]\n\n\n\nFigure 3.27: Force transmitted to the base for SDOF systems subject to harmonic excitation, shown here for varying damping ratios.\n\n\nThis ratio describing the amplification in force transmission due to dynamic effects is called transmissibility in the context of structural dynamics and it is an important consideration for numerous applications including vehicle, structure, and instrument design. Figure 3.27 shows how the transmissibility changes as a function of \\(\\ratfreq\\) and \\(\\damp\\). It is noteworthy that for very stiff systems, i.e. as \\(k \\rightarrow \\infty\\), \\({\\sforce_{tr}}/{\\sforce} \\approx 1\\). Additionally, if \\({\\sforce_{tr}}/{\\sforce} &lt; 1\\) is desired, then in lightly damped systems we would like to have \\(\\ratfreq &gt; \\sqrt{2}\\), which corresponds to systems with low stiffness values. Finally, near the resonant frequency for \\(\\ratfreq \\approx 1\\), damping plays an important positive role and can substantially reduce transmissibility."
  },
  {
    "objectID": "singledofforced.html#vibrations-induced-by-an-eccentric-rotating-mass",
    "href": "singledofforced.html#vibrations-induced-by-an-eccentric-rotating-mass",
    "title": "3  Forced Vibrations of Single Degree of Freedom Systems",
    "section": "3.6 Vibrations Induced by an Eccentric Rotating Mass",
    "text": "3.6 Vibrations Induced by an Eccentric Rotating Mass\nThere are many instances in which it may be desirable to induce vibrations to a structure or device with a prescribed frequency and amplitude. This is used in structural models for instance for health monitoring and dynamical testing. Other applications include eccentric mass vibration motors that are commonly used as haptic feedback devices (e.g. vibrations of a cell phone or game controller). Figure 3.28 illustrates an example structure on which such a device is mounted. In this scenario, we assume that the columns and beam are axially rigid, and only lateral forces induced by the rotation of the mass generate forces that translate into motion, with the lateral displacement \\(\\gc (t)\\) of the portal frame being the only degree of freedom.\n\n\n\nFigure 3.28: Eccentric rotating mass driven by a motor supported by a simple frame.\n\n\nIn this case, the eccentrically rotating mass \\(m_r\\) rotates around the anchor point with constant angular velocity \\(\\extfreq\\), and its eccentricity, i.e. its offset from the anchor point, is \\(e_m\\). This eccentrically rotating mass is referred to as the unbalanced mass in some applications. The total non-rotating mass, comprising the structural mass and, if relatively significant, the mass of the motor, is \\(m\\). The system has a total lateral stiffness \\(k\\) and it is viscously damped with damping coefficient \\(c\\). The rotation of the eccentric mass generates a tensile force on the bar as the bar tries to keep the rotating mass on its circular path. This force gets transmitted to the beam, and consequently a dynamic lateral force is exerted by the motor on the structure which can be expressed as: \\[ \\extforce(t) = m_r e_m \\extfreq^2 \\cosp{\\extfreq t}\\]\nIt is worth noting here that the amplitude of the force depends on the angular velocity of the rotating mass, which is also the frequency of the excitation. The equation of motion for the system is then given as: \\[  m \\ddgct + c \\dgct + k \\gct = m_r e_m  \\extfreq^2 \\cosp{\\extfreq t} \\] or equivalently, \\[  \\ddgct + 2 \\damp \\freq \\dgct + \\freq^2 \\gct = \\frac{m_r e_m \\extfreq^2}{m} \\cosp{\\extfreq t - \\phs} \\]\nConsidering only the steady state response, the displacement response of the system is given by \\[\\gct = Q \\cosp{\\extfreq t - \\phs}\\] where the dynamic amplitude \\(Q\\) and the phase angle \\(\\phs\\) are given by \\[\nQ = \\ratio {m_r e_m }{m} \\ratio{\\ratfreq^2}{\\sqrt{\\left(1 - \\ratfreq^2 \\right)^2 + \\left(2 \\damp \\ratfreq \\right)^2}} = \\ratio {m_r e_m}{m} \\ratfreq^2 \\dynamp\n\\qquad(3.74)\\] \\[\n\\tan {\\phs} =  \\ratio{2\\damp \\ratfreq}{1-\\ratfreq^2}\n\\qquad(3.75)\\]\nFigure 3.29 shows the variation of the response amplitude (normalized by \\(m_r e_m / m\\)) with the ratio of the excitation frequency to the frequency of the system. As should be expected, this graph is quite similar to the response graphs we have previously encountered for harmonic inputs. In the limit of vanishing angular velocity of the motor as \\(\\ratfreq \\rightarrow 0\\) or very high values of system frequency as \\(\\freq \\rightarrow \\infty\\), the displacement response diminishes to zero since the either the magnitude of the applied force becomes negligible or the structure is very rigid. As the angular speed of the motor increases so that \\(\\ratfreq \\rightarrow \\infty\\), the dynamic response converges to \\(Q = {m_r e_m}/{m}\\). Damping is inconsequential near these limits, but again plays a critical role in reducing the response amplitude near the resonant frequency \\(\\ratfreq \\approx 1\\), with the resonant condition occurring at \\(\\ratfreq&gt;1\\) (but still close to 1) for damped systems.\n\n\n\nFigure 3.29: Variation of normalized displacement amplitude \\(Q m / (m_r e_m)\\) with normalized frequency \\(\\ratfreq = \\extfreq/\\freq\\) in a SDOF system supporting a rotating eccentric mass."
  },
  {
    "objectID": "singledofforced.html#base-excitation",
    "href": "singledofforced.html#base-excitation",
    "title": "3  Forced Vibrations of Single Degree of Freedom Systems",
    "section": "3.7 Base Excitation",
    "text": "3.7 Base Excitation\nConsider what would happen if you were to stand on a cart, and someone started to shake the cart back and forth. You whole body would, if there was sufficient friction between your shoes and the surface of cart, eventually move with the cart, sometimes in and sometimes opposite to the direction in which the cart moves, and you would possibly topple over should the cart move too quickly. This is one way to feel what happens in earthquakes, of which more will be said further down the road. During an earthquake, the ground on which the structure stands moves due to waves travelling in and on the surface of the earth, forcing the supports, i.e. the points at which the structure is connected to the ground, to move with it.23 This motion is in turn transmitted to the whole structure, whereby so many unfortunate losses have occurred in past earthquakes. The full understanding of structural behavior and safety in large earthquakes is quite involved and requires collective knowledge across various areas of study. Here we will focus on modeling dynamical behavior of relatively simple systems; analyses of such systems go a long way in understanding earthquake responses of structures.\n\n\n\nFigure 3.30: SDOF system subjected to ground motion.\n\n\nTo better visualize some concepts and direct the focus of our investigations to how building-like structures behave during earthquakes, we will work with a modified (but completely analogous) SDOF prototype: the 2D, single bay single story frame shown in Figure 3.30(a), with mass concentrated at the floor level. The whole story has a certain lateral stiffness, denoted by \\(k\\), the value of which will depend on the material, dimensions and end conditions of load bearing elements such as columns and beams. The vertical elements in the load bearing system are graphically represented by the two columns. All elements are assumed to have sufficient axial rigidity so that their axial deformations may be neglected compared to bending deformations; therefore two ends of a line element are assumed to translate by the same amount along the longitudinal axis of that element. With this assumption, the only translation possible is the common lateral translation of the top joints. Rotations of the joints are assumed to have either negligibly small accelerations and/or negligibly small masses associated with these accelerations so that no significant inertia is developed in rotational degrees of freedom, and therefore these are not considered explicitly as dynamic degrees of freedom.24 Furthermore, although mass is present in vertical as well as horizontal members, it is generally the case that the concentration of inertial effects in the vicinity of the floor level is significantly larger than those contributed by the vertical members, so that the mass of the system may be assumed to be concentrated at the floor level. This mass, generally referred to as the floor mass, is graphically indicated by the block of mass \\(m\\) located at the top of the frame. With these assumptions, the model is an SDOF system, with lateral translation of the floor mass as its sole degree of freedom.\nWhen the ground moves horizontally as \\(\\gdist\\), the mass would move by the same amount if there were no deformations of the columns, but this is not possible because of the inertia effects. In general the mass moves relative to the ground by an amount of \\(\\gct\\) so that at some instant \\(t\\), the mass has moved from its original (stationary) equilibrium position by \\[\n\\adis (t) = \\gct + \\gdist\n\\] To address the two movements distinctly, \\(\\adis (t)\\) is referred to as the absolute displacement or total displacement, and \\(\\gct\\) is referred to as the relative displacement of the mass; the relative displacement is referred to more simply as the deformation since its value at any instant corresponds to the amount of deformation in the spring (the columns in this case) at that instant. The forces, including the d’Alembert force, that act on the mass at instant \\(t\\) are shown in Figure 3.30(b). The important thing to note is that the d’Alembert force depends on the absolute motion of the mass, i.e. \\(\\aacc (t)\\), since Newton’s law demands that acceleration be measured relative to a stationary reference (and the base the structure is attached to is not stationary in this case), but the forces that develop due to the deformation of the columns, i.e. \\(k \\gc\\), and those that develop in proportion to the rate of deformation across the damper, i.e. \\(c \\dgc\\), depend on the relative motion of the mass with respect to the ground (the base the structure is attached to). Summation of forces leads to \\[\nm \\aacc (t) + c \\dgct + k \\gct = 0\n\\qquad(3.76)\\] which is a correct equation of motion but not directly applicable since generally we aim to investigate the resulting motion of the mass under a specific ground motion. The ground motion may be treated as a known external excitation in two different ways. We may choose to track the absolute motion of the mass, in which case we may substitute \\(\\gct = \\adis (t) - \\gdist\\) and \\(\\dgct = \\avel (t) - \\gvelt\\) into Equation 3.76 ,and move the terms related to the ground motion to the right hand side of the equation to obtain: \\[\nm \\ddgct + c \\dgct + k \\gct = c \\gvelt + k \\gdist\n\\qquad(3.77)\\] If, on the other hand, we choose to track the relative motion of the mass, we substitute \\(\\aacc (t) = \\ddgct + \\gacct\\) into Equation 3.76, and move the ground acceleration term to the right hand side of the equation to obtain: \\[\nm \\ddgct + c \\dgct + k \\gct = - m \\gacct\n\\qquad(3.78)\\] Which of these equations is to be preferred generally depends on the particular details of a specific problem, but admittedly Equation 3.78 is by far the more commonly encountered one, especially for SDOF systems. The relative displacement is most readily related to the shear forces that must be transmitted by the columns and the maximum relative displacement therefore is an important design parameter which can be addressed more directly via Equation 3.78. Furthermore, this equation is quite similar in form to that of an SDOF system subject to an external force, and in earthquake response analysis the term on the right hand side, i.e. \\(-m \\gacct\\), is often referred to as the effective earthquake force. The form of the governing equation may be abridged if we divide both sides by the mass, after which we obtain \\[\n\\ddgct + 2 \\damp \\freq \\dgct + \\freq^2 \\gct = - \\gacct\n\\qquad(3.79)\\] This form of the equation of motion more emphatically demonstrates that the response of a system to a specific base motion depends solely on two parameters: the frequency and the damping ratio of the system.25 To highlight the significance of this observation, let us investigate the following scenario: consider two single degree of freedom systems, one extremely heavy and stiff, the other extremely light and flexible, such that they have the same frequency and damping ratio. Identical displacements (and hence velocities and accelerations) will develop in these two systems when they are both subjected to the same ground motion, no matter what the ground motion looks like, albeit the two systems seemingly being very different.\nOften the critical issue with base excitations in the context of structural dynamics is calculation of demands induced on structures by earthquake induced ground motions. Such motions are quite erratic with time histories defying analytical expressions, and we therefore feel that the details of earthquake response analysis are best left after a discussion of numerical methods to be used in solving the equation of motion. There is, however, significant insight to be gained from analyses of simpler loading patterns, and this is what we undertake for the rest of this section.\n\n3.7.1 Response to a Pulse-Like Base Motion\nLet us first investigate what the response of an SDOF system to a base excitation in the form of some pulse would be. To make this investigation more plausible, we have to consider the evolution of ground motion in real life which would require that the ground be at rest before and after the pulse, with possibly a permanent drift, and that the velocity starts from zero and again reaches zero at the end of the pulse. There could be numerous functions that fit this description but we use one previously proposed in the literature26, defined as \\[\n\\gdist = \\ratio{\\maxgvel}{2}t - \\ratio{\\maxgvel t_{d}}{4 \\pi} \\sinp{\\ratio{2\\pi}{t_{d}}t}\n\\qquad(3.80)\\] \\[\n\\gvelt = \\ratio{\\maxgvel}{2} - \\ratio{\\maxgvel}{2} \\cosp{\\ratio{2\\pi}{t_{d}}t}\n\\qquad(3.81)\\] \\[\n\\gacct = \\ratio{\\pi \\maxgvel}{t_{d}} \\sinp{\\ratio{2\\pi}{t_{d}}t}\n\\qquad(3.82)\\] where \\(t_{d}\\) is the duration of the pulse, \\(\\maxgvel\\) is the absolute maximum velocity defined as \\[\n\\maxgvel = \\max_{t} \\abs{\\gvelt}\n\\qquad(3.83)\\] and all the expressions are valid only for \\(0 \\leq t \\leq t_{d}\\), with the ground motion for \\(t &gt; t_{d}\\) defined by \\[\n\\gdist = \\ratio{\\maxgvel}{2}t_{d}, \\quad \\gvelt = 0, \\quad \\gacct = 0\n\\qquad(3.84)\\] The ground displacement, velocity and acceleration time histories defined by such a ground motion are shown in Figure 3.31.\n\n\n\nFigure 3.31: Pulse type ground motion defined by Equation 3.80, Equation 3.81, and Equation 3.82\n\n\nWhat would be the response of a viscously underdamped, linear, SDOF system, initially at rest, to such a base motion? Such a system’s relative motion would be governed for \\(0 \\leq t \\leq t_{d}\\) by \\[\n\\ddgct + 2 \\damp \\freq \\dgct + \\freq^2 \\gct = - \\gacct = - \\ratio{\\pi \\maxgvel}{t_{d}} \\sinp{\\ratio{2\\pi}{t_{d}}t}\n\\qquad(3.85)\\] and we have actually solved an analogous problem before, that of a system subjected to a harmonic force, for which the equation of motion was given by Equation 3.26 which is noted below for convenience: \\[\n    m \\ddgct + c \\dgct + k \\gct = \\sforce \\sinp{\\extfreq t - \\extphs}\n\\qquad(3.86)\\] Clearly Equation 3.85 is the same as Equation 3.86, with the coefficients and variables given by \\[\nm = 1, \\quad c=2\\damp \\freq, \\quad k = \\freq^2, \\quad \\extfreq = \\ratio{2 \\pi}{t_{d}}, \\quad \\sforce = - \\ratio{\\pi \\maxgvel}{t_{d}} = - \\ratio{\\maxgvel \\extfreq}{2} , \\quad \\extphs = 0\n\\qquad(3.87)\\] Therefore the solution will be given by Equation 3.39, repeated below for ease of reference: \\[\\begin{align*}\n\\frac{\\gct}{\\sforce / k} & = \\dynamp \\expon{-\\damp \\freq t} \\biggl[\\sinp{\\extphs + \\phs} \\cos \\dfreq t + \\biggl(\\frac{\\damp \\sinp{\\extphs + \\phs}-\\ratfreq \\cosp{\\extphs + \\phs}}{\\sqrt{1-\\damp^2}}\\biggr) \\sin \\dfreq t \\biggr] \\\\\n  & \\qquad + \\dynamp\\sinp{\\extfreq t - \\extphs - \\phs}\n\\end{align*}\\] When this solution is adopted to our current problem via Equation 3.87, one gets \\[\n\\begin{array}{rcl}\n\\gct  & \\!\\!\\! = & \\!\\!\\! - \\ratio{\\maxgvel \\extfreq}{2 \\freq^2} \\dynamp \\expon{-\\damp \\freq t} \\biggl[\\sin{\\phs} \\cos \\dfreq t + \\biggl(\\frac{\\damp \\sin{\\phs}-\\ratfreq \\cos{\\phs}}{\\sqrt{1-\\damp^2}}\\biggr) \\sin \\dfreq t \\biggr] \\\\\n  & & \\; - \\ratio{\\maxgvel \\extfreq'}{2 \\freq^2}  \\dynamp\\sinp{\\extfreq t -\\phs}\n\\end{array}\n\\qquad(3.88)\\] where \\[\n\\ratfreq = \\ratio{\\extfreq}{\\freq}, \\quad \\dynamp = \\ratio{1}{\\sqrt{\\left(1 - \\ratfreq^2 \\right)^2 + \\left(2 \\damp \\ratfreq \\right)^2}}, \\quad \\tan \\phs = \\ratio{ ({2 \\damp \\ratfreq})/{\\dynamp}}{({1-\\ratfreq^2})/{\\dynamp}}\n\\] as defined previously by Equation 3.33 and Equation 3.34. Contrary to the case of a harmonic force, the case we are currently investigating is that of a finite duration pule-type input, and the parameter we would like to focus on is not the ratio of the frequencies but rather the duration of the pulse relative to the period of the system. To reformulate the solution in terms of this parameter, we define \\[\n\\ratdur = \\ratio{t_{d}}{\\dperiod} = \\ratio{\\dfreq}{\\extfreq} = \\sqrt{1-\\damp^2}\\ratio{\\freq}{\\extfreq}\n\\] and note that \\[\n{\\maxgdis} = \\ratio{\\maxgvel t_{d}}{2} = \\ratio{\\maxgvel \\pi}{\\extfreq}\n\\] is the maximum ground displacement due to the motion given by Equation 3.80, Equation 3.81, and Equation 3.82. Substituting these variables into the solution leads, after some algebraic manipulation, to \\[\n\\begin{array}{rcl}\n\\gct & \\!\\!\\! = & \\!\\!\\! - \\maxgdis \\dynamp'\\expon{- \\zeta \\freq t} \\biggl[ \\sin \\phs' \\cos \\dfreq t + \\ratio{\\ratdur \\damp \\sin \\phs' - \\cos \\phs' \\sqrt{1-\\damp^2}}{\\ratdur \\sqrt{1-\\damp^2}} \\sin \\dfreq t \\biggr] \\\\\n& & \\; - \\maxgdis \\dynamp' \\sinp{\\extfreq' {t} - \\phs'}\n\\end{array}\n\\qquad(3.89)\\] for \\(0 \\leq t \\leq t_{d}\\), where \\[\n\\dynamp' = \\ratio{1}{2 \\pi} \\ratio{{1-\\damp^2}}{\\sqrt{\\left({\\ratdur^2} - 1 + \\damp^2 \\right)^2 + ({1-\\damp^2})(2 {\\damp} \\ratdur)^2}}\n\\]\nThe response of the system after the pulse stops to act, i.e. for \\(t &gt;t_{d}\\), will be one of free vibrations, with initial conditions given by the displacement and velocity \\(\\gc_{*}=\\gc (t_{d})\\) and \\(\\dgc_{*}= \\dgc (t_{d})\\) to be calculated from Equation 3.89 and its time derivative so that \\[\n\\gct = \\expon{- \\zeta \\freq (t-t_{d})} \\left[ \\gc_{*} \\cos\\dfreq (t - t_{d}) + \\frac{\\damp \\freq \\gc_{*} + \\dgc_{*}}{\\dfreq} \\sin \\dfreq (t - t_{d}) \\right]\n\\qquad(3.90)\\] To visualize possible different outcomes, we shall simplify the problem by considering an undamped case, the response of which may be derived using the foregoing equations by substituting \\(\\damp = 0\\). The displacement and velocity of such a system for \\(0 \\leq t \\leq t_{d}\\) and \\(\\ratdur \\neq 1\\) may be shown to be \\[\n    \\gct = - \\maxgdis\\ratio{1}{2\\pi} \\ratio{1}{\\ratdur^2 - 1} \\left[\\sin \\extfreq' t - \\ratio{1}{\\ratdur}\\sin \\freq t\\right]\n\\qquad(3.91)\\] \\[\n    \\dgct = - \\ratio{\\maxgvel}{2} \\ratio{1}{\\ratdur^2 - 1} \\left[\\cos \\extfreq' t - \\cos \\freq t\\right]\n\\qquad(3.92)\\] whereas when \\(\\ratdur = 1\\), the particular solution could be obtained by appropriate substitutions into the solution given previously for the case of a harmonic force in Equation 3.38 so that after going through the algebraic manipulations as was done above for the damped system, one obtains, for \\(0 \\leq t \\leq t_{d}\\), \\[\n    \\gct = - \\maxgdis\\ratio{1}{4\\pi}  \\left[\\sin \\freq t - \\freq t \\cos \\freq t\\right]\n\\qquad(3.93)\\] \\[\n    \\dgct = - \\ratio{\\maxgvel}{4} \\freq t \\sin \\freq t\n\\qquad(3.94)\\] For \\(t&gt;t_{d}\\), the undamped system’s motion is given by \\[\n    \\gct = \\gc_{*} \\cos \\freq (t-t_{d}) + \\ratio{\\dgc_{*}}{\\freq} \\sin \\freq (t-t_{d})\n\\qquad(3.95)\\] for all values of \\(\\ratdur\\), where \\(\\gc_{*} = \\gc (t_{d})\\) and \\(\\dgc_{*}= \\dgc(t_{d})\\) are to be evaluated from Equation 3.91 and Equation 3.92 (for \\(\\ratdur \\neq 1\\)), or Equation 3.93 and Equation 3.94 (for \\(\\ratdur = 1\\)).\n\n\n\nFigure 3.32: Response of an underdamped SDOF system, initially at rest, to a pulse-type base motion defined by Equation 3.80, for various values of \\(\\ratdur = t_{d} / \\period\\). The plots are for time normalized by the period of the system, i.e. \\(\\tau = t / \\period\\). Dashed (blue) lines correspond to normalized ground displacement \\(\\gdis(\\tau) / \\maxgdis\\) and are presented for visual comparison of the response amplitude.\n\n\nThe results that would be obtained for various cases of \\(\\ratdur = t_{d}/\\period\\) are shown in Figure 3.32. These responses are sketched for normalized time \\(\\tau = t/T\\) so that the plots reflect about five cycles of the system, and the expressions used in these plots are \\[\n\\ratio{\\gc (\\tau)}{\\maxgdis} = \\begin{cases} -  \\frac{1}{2 \\pi (\\ratdur^2 -1)} \\left[\\sinp{2 \\pi \\frac{\\tau}{\\ratdur}} - \\frac{1}{\\ratdur} \\sinp{2 \\pi \\tau} \\right] & \\ratdur \\neq 1 \\\\\n- \\frac{1}{4 \\pi} \\left[ \\sinp{2 \\pi \\tau} - 2 \\pi \\tau \\cosp{2 \\pi \\tau}  \\right] & \\ratdur = 1 \\end{cases}\n\\] for \\(0 \\leq \\tau \\leq \\ratdur\\) (equivalently, for \\(0 \\leq t \\leq t_{d}\\)), and for \\(\\tau &gt; \\ratdur\\) (equivalently, for \\(t &gt; t_{d}\\)) we have \\[\n\\ratio{\\gc (\\tau)}{\\maxgdis} = \\begin{cases} \\frac{\\sinp{2 \\pi \\ratdur}}{2 \\pi \\ratdur (\\ratdur^2 -1)} \\cosp {2 \\pi (\\tau - \\ratdur)} + \\frac{\\cosp{2 \\pi \\ratdur} - 1}{2 \\pi \\ratdur (\\ratdur^2 -1)} \\sinp {2 \\pi (\\tau - \\ratdur)}\n& \\ratdur \\neq 1 \\\\\n\\frac{1}{2} \\cosp {2 \\pi (\\tau - 1)} & \\ratdur = 1 \\end{cases}\n\\] These response graphs help us discern some differences between a pulse-type force and a pulse-type base excitation. We had previously seen in Section 3.4 that the effects of a pulse-type force tend to be more pronounced when the pulse duration exceeds half the period of the system. In the case of a base excitation, this phenomenon seems to be somewhat reversed: It seems that the amplitude of the maximum relative displacement approaches the amplitude of the ground displacement when the pulse duration tends be much shorter compared to the period of the system, and that when the duration exceeds the period by a significant amount, the amplitude of the relative displacement tends to zero. It may be argued that such an observation is consistent with how the excitation is transmitted to the mass via the stiffness elements. For a finite duration pulse, \\(\\ratdur \\rightarrow 0\\) implies \\(\\period \\rightarrow \\infty\\) and so, for a finite mass, \\(k \\rightarrow 0\\): in this case the ground moves but exceedingly small forces develop in the stiffness elements, therefore negligibly little force is transferred to the mass and so the mass remains almost still (with respect to the stationary frame of reference), thereby the maximum relative displacement of the mass with respect to the (moving) ground approaches the amplitude of the ground motion. At the other extreme, \\(\\ratdur \\rightarrow \\infty\\) implies \\(\\period \\rightarrow 0\\) and \\(k \\rightarrow \\infty\\), in which case the deformations in the stiffness elements remain negligibly small (even though now the forces may be very large), and so the mass moves in almost full accordance with the ground and the relative displacement approaches zero (although the mass moves with respect to the stationary frame of reference). These two extremes are common characteristics in all systems subjected to base motion.\n\n\n\nFigure 3.33: Response of a damped SDOF system to a pulse-type base motion defined by Equation 3.81, for various values of damping ratio \\(\\damp\\). The system is initially at rest. In all cases, \\(\\ratdur = t_{d} / \\period=0.5\\). The plots are for time normalized by the damped period of the system, i.e. \\(\\tau = t / \\dperiod\\). Dashed (blue) lines correspond to normalized ground displacement \\(\\gdis(\\tau) / \\maxgdis\\) and are presented for visual comparison of the response amplitude.\n\n\nWhat would happen if there was damping in the system? The various cases hitherto discussed have demonstrated that the undamped case provides an upper bound on the response amplitudes, and that when damping is present the response amplitudes decrease. The same is true in this case, with the maximum response decreasing as the damping ratio increases, and the response exponentially decaying in free vibrations. To provide some quantitative results, the responses of three SDOF systems with different values of viscous damping ratios are shown in Figure 3.33, where the rate of decay in time and decrease in maximum response are seen to be highly dependent on the available damping.\n\n\n\n\nEarthquakes are not the sole cause of support motion but they are the most catastrophic. All ground borne vibrations, including those due to traffic, nearby machinery, pile driving or drilling will lead to support motions albeit negligible ones in most cases.↩︎\nRecall the discussions on modeling assumptions at the beginning of Chapter 2.↩︎\nTo contrast: under an external force, the frequency and the damping ratio are still fundamental determinants, but the stiffness (or, equivalently, the mass) of the system also plays a role in the amplitude of the response.↩︎\nsee, e.g., N. Makris and Y. Roussos, “Rocking response of rigid blocks under near-source ground motions,” Géotechnique, Vol.50, No.3, pp. 243-262, 2000.↩︎\n\n\n\n3.7.2 Response to Harmonic Base Excitations\nResonance is possible also in the case of base excitations and its effects are highly devastating on structures. Although similar to the case of harmonic forces, there are some differences that should be highlighted when the input is that of ground motion. To analyze the issue, we suppose that the ground motion is harmonic, defined by \\[\n\\gdist = \\maxgdis \\sin \\extfreq t\n\\qquad(3.96)\\] so that the system is governed by \\[\n    \\ddgct + 2 \\damp \\freq \\dgct + \\freq^2 \\gct = \\extfreq^2 \\maxgdis \\sin \\extfreq t\n\\qquad(3.97)\\] As in the case of harmonic forces, also in this case we investigate the steady-state vibrations to quantify the effects of a harmonic base motion. The steady-state vibrations may be developed by analogy from the solution developed for the harmonic force case governed by Equation 3.26, given below for ease of reference: \\[\n    m \\ddgct + c \\dgct + k \\gct = \\sforce \\sinp{\\extfreq t - \\extphs}\n\\qquad(3.98)\\] Clearly Equation 3.97 is the same as Equation 3.98, with the coefficients defined as \\[\nm = 1, \\quad c=2\\damp \\freq, \\quad k = \\freq^2, \\quad \\sforce = \\extfreq^2 \\maxgdis, \\quad \\extphs = 0\n\\qquad(3.99)\\] Therefore the solution will be given by Equation 3.31, i.e.  \\[\n    \\gct = Q \\sinp{\\extfreq t - \\phs}\n\\qquad(3.100)\\] where, from Equation 3.32 and with \\(\\ratfreq = \\extfreq / \\freq\\), \\[\n    Q = \\maxgdis \\ratfreq^2 \\dynamp\n\\qquad(3.101)\\] and from Equation 3.34, \\[\n   \\tan \\phs = \\ratio{ ({2 \\damp \\ratfreq})/{\\dynamp}}{({1-\\ratfreq^2})/{\\dynamp}}\n\\qquad(3.102)\\] and it is implied by definition that \\(0 \\leq \\phs \\leq \\pi\\). \\(\\dynamp=\\dynampr\\) is the dynamic amplification factor defined by Equation 3.33.\n\n\n\nFigure 3.34: Variation of \\(Q/\\maxgdis = \\ratfreq^2 \\dynamp\\) and the phase angle \\(\\phs\\) with ratio of frequencies, plotted for various levels of viscous damping.\n\n\nA reasonable normalized response to investigate is the variation, with respect to \\(\\ratfreq\\), of the amplitude of steady state response to that of the maximum ground displacement, i.e. \\(Q / \\maxgdis\\), given by \\[\n\\ratio{Q}{\\maxgdis} = \\ratfreq^2 \\dynamp\n\\] The tendency of amplified response near \\(\\ratfreq = 1\\) is somewhat similar to that observed in the case of harmonic force excitations, with the peaks for different damping values all occurring now slightly to the right of \\(\\ratfreq = 1\\) and the shift increasing with increasing values of damping. The limiting values show important differences compared to the case of harmonic force excitations, and it is important to note the following issues:\n\nFor all levels of damping, \\(\\dynamp \\rightarrow 0\\) as \\(\\ratfreq \\rightarrow 0\\). This is mathematically obvious as the limit of the relationship in Equation 3.101 and may physically be interpreted as the case of a system with a finite mass and an extremely large lateral stiffness so that \\(\\freq \\rightarrow \\infty\\). In this case the lateral displacements that are caused by the deformations will be negligibly small so that the steady state response is given by \\(\\gct \\approx 0\\).\nFor all levels of damping, \\(\\dynamp \\rightarrow 0\\) as \\(\\ratfreq \\rightarrow \\infty\\). This result is also obvious mathematically as the limit of the relationship in Equation 3.101, and may physically be interpreted as the case of a system with a finite mass and almost no lateral stiffness so that \\(\\freq \\rightarrow 0\\). As the ground moves, the lateral force that develops in the lateral stiffness system remains negligibly small so that the accelerations that the mass develops remain negligible. The mass therefore practically stands still with respect to a stationary frame of reference while the ground moves, with the steady state relative displacement of the mass with respect to the ground therefore given by \\(\\gct \\approx - \\gdist\\).\nThe ratio \\(Q / \\maxgdis = \\ratfreq^2 \\dynamp\\) reaches a peak value somewhere in the vicinity of \\(\\ratfreq = 1\\) when damping levels are low. Taking the derivative of \\(\\ratfreq^2 \\dynamp\\) with respect to \\(\\ratfreq\\) to locate the extremum points yields the following possibilities: if \\(\\damp \\leq 1/\\sqrt{2}\\), \\(\\dif (\\ratfreq^2 \\dynamp )/ \\diff \\ratfreq\\) becomes zero at \\(\\ratfreq = 0\\) and \\(\\ratfreq = 1/\\sqrt{1-2 \\damp^2}\\), while for \\(\\damp &gt; 1 / \\sqrt{2}\\) the derivative is zero only for \\(\\ratfreq = 0\\). Therefore whenever \\(\\ratfreq \\leq 1/\\sqrt{2} \\approx 71\\%\\), the maximum amplification is given by \\[\n    \\left( \\ratio{Q}{\\maxgdis}\\right)_{\\max} = (\\ratfreq^2\\dynamp)\\biggr|_{\\ratfreq=\\frac{1}{\\sqrt{1-2\\damp^2}}} = \\ratio{1}{2 \\damp} \\ratio{1}{\\sqrt{1-\\damp^2}} \\approx \\ratio{1}{2 \\damp}\n\\qquad(3.103)\\] where the last approximation is valid for small values of the damping ratio. It was already shown in Section 3.3 that even for a relatively sizeable damping ratio of \\(\\damp = 10 \\%\\), the error of approximation remained about \\(1\\%\\). As in the case of harmonic force excitations, the amplitude of the dynamic response tends to infinity as \\(\\ratfreq \\rightarrow 1\\) for undamped systems, representing the theoretical upper bound although in practice it is impossible for deformations to reach even finitely large levels. Structures inevitably have energy dissipation through many mechanisms and inelastic deformations would alter system characteristics in any case after certain thresholds of deformation are exceeded.\n\n\n\n3.7.3 Brief Notes on the Basic Model\nThe model we have so far discussed while investigating vibrations due to ground motion is the most basic model and while it is extremely useful in understanding the fundamental concepts and patterns, it contains some simplifying assumptions that should be highlighted.\nOne point to make is that this model presumes a rigid ground such that the behavior of the soil and the structure may be assumed to be completely uncoupled. Soil is a deformable medium that has its own dynamic characteristics which are amplitude and frequency dependent. Any excitation transmitted via the soil is transmitted by waves that travel in the soil, and one part of the problem is the apparent wavelength of these soil waves in comparison with the dimensions of the structure. For relatively short spans all the supports of the structure may be assumed to move identically, whereas for long span structures it is possible to have significant differences in support motions. The second issue is the disturbance or modification that will take place in such wave motion due to the presence of the structure. If the structure is very flexible compared to the soil, the disturbance generated by its presence is generally expected to be relatively small so that the ground motion measured away from the structure, called the free-field motion, is roughly the same as that which would be measured at the base of the structure. On the other hand, the presence of a relatively rigid structure on flexible soil is expected to locally modify the ground motion significantly, leading to significant differences is free-field measurements and the actual motion at the structure’s base. This issue may be very significant when one wishes to analyze the effects of a specific earthquake on a structure based on measured free-field ground motions as actual base motions may not be available.\nA related point is that rotational motion (in this case, rotation in the plane of the 2D model) is neglected. Free field ground motions rarely contain significant surface rotations but in some cases, for example in the existence of a large rigid foundation plate, pronounced soil structure interaction may lead to rotational motion. Such rotations lead to additional lateral motion and inertia, leading to increased demands in the load bearing members, while also increasing contributions from gravity loads which may in turn reduce effective lateral stiffness. There are simple models that help in understanding and quantifying such effects and some will be introduced further on.\nPossibly the most important issue is the omission of inelastic response. Earthquakes, at least those that are deemed significant, exert large demands on structures such that elastic behavior limits are almost always exceeded. In such cases, the linear elastic model of Equation 3.79 is generally modified to \\[\n\\ddgct + 2 \\damp \\freq \\dgct + \\stifforce (\\gc) = - \\gacct\n\\qquad(3.104)\\] where \\(\\stifforce (\\gc)\\) is the lateral force provided by the stiffness members on the mass and it is now a non-linear function of the deformation \\(\\gc (t)\\). This issue will be revisited in greater detail while discussing earthquake induced vibrations in latter sections."
  },
  {
    "objectID": "numericalsdof.html#preliminary-ideas",
    "href": "numericalsdof.html#preliminary-ideas",
    "title": "4  Numerical Solutions of the SDOF Equation of Motion",
    "section": "4.1 Preliminary Ideas",
    "text": "4.1 Preliminary Ideas\nThe equation of motion for a viscously damped linear SDOF system under the action of an external force was shown in previous sections to be \\[\n   m \\ddgct + c \\dgct + k \\gct = \\extforcet\n\\qquad(4.1)\\] with the specialized equation for the case of a system excited by a ground motion given by \\[\n   m \\ddgct + c \\dgct + k \\gct = - m \\gacct\n\\qquad(4.2)\\] Although we have discussed the analytical solutions of these equations for an important subset of excitations, it has to be said that most often analytical solutions are beyond our reach and numerical techniques must be employed to obtain values for the response at various instances. While discussing numerical techniques, we will employ the force excitation form of the equation only to minimize repetitive expositions; clearly the formulations may be specialized for ground motion excitation by substituting \\(- m \\gacc (t)\\) for \\(\\extforce(t)\\).\nThe need for use of numerical techniques may arise from various reasons: it may be that the form of excitation is so complex that no known analytical solutions exist, it may be that the excitation is known only at discrete instances of time to begin with, or it may be that the nonlinearity of the system is prohibitive for any closed form solutions. In all cases, the method of attack for all numerical techniques is similar: a. time is discretized into a finite number of instances (using, if possible, small intervals in-between them); b. the behavior, in-between the time instances, of the force or the system or both is approximated via straight lines or simple curves; and c. the solution progresses from one step to the next through solution of algebraic equations.\nIn what follows, we will try to adhere to the following notation so as to provide some common language for all the methods to be discussed. We will assume that continuous time \\(t\\) is discretized into a total of \\(l+1\\) instances, each denoted by \\(t_j\\) for \\(j=0,1,2,\\ldots,l\\). The difference between any two consecutive instances is called a time step, to be denoted by \\(\\tstep = \\dsct{t}{j+1} - \\dsct{t}{j}\\). The time step does not in general have to be constant, but when working on linear systems with relatively smooth inputs, it often is. To emphasize the discrete nature of the calculations, we’ll use brackets: for some time dependent variable \\(\\gc(t)\\), \\(\\dsct{\\gc}{j}\\) will denote the value of that variable at time \\(t=\\dsct{t}{j}\\) where, for constant time step, \\(\\dsct{t}{j} = j \\tstep\\). The construction of the numerical solution up to and including the final time, corresponding to step \\(l+1\\) (counting time \\(t=0\\) as the first time step) will require knowledge of the input \\(\\dsct{\\extforce}{j}\\) for \\(j=0,1,2,...,l\\) and the initial conditions \\(\\dsct{\\gc}{0}\\), \\(\\dsct{\\dgc}{0}\\)."
  },
  {
    "objectID": "numericalsdof.html#linear-interpolation-of-the-excitation",
    "href": "numericalsdof.html#linear-interpolation-of-the-excitation",
    "title": "4  Numerical Solutions of the SDOF Equation of Motion",
    "section": "4.2 Linear Interpolation of the Excitation",
    "text": "4.2 Linear Interpolation of the Excitation\nFor linear SDOF systems, it is relatively straightforward to develop a numerical progression based on analytical solutions developed for simply varying forces. The fundamental idea is linear interpolation of the excitation in-between two consecutive time steps. Consider the sketch given in Figure 4.1. According to the this approach which we shall refer to as the piecewise linear excitation1 (PLE), the excitation \\(\\extforce(t)\\) is assumed to vary linearly between its values at \\(\\dsct{t}{j}\\) and \\(\\dsct{t}{j+1}\\) so that for \\(\\dsct{t}{j} \\leq t \\leq \\dsct{t}{j+1}\\) the excitation is approximated by \\[\n\\extforce(t) \\approx \\extforce(\\dsct{t}{j}) + \\frac{\\extforce(\\dsct{t}{j+1}) - \\extforce(\\dsct{t}{j})}{\\dsct{t}{j+1}-\\dsct{t}{j}} (t - \\dsct{t}{j}) = \\dsct{\\extforce}{j} + \\frac{\\dsct{\\extforce}{j+1} - \\dsct{\\extforce}{j}}{\\tstep} (t - \\dsct{t}{j})  \\quad\n\\] It is easier to express this equation using a shifted time variable \\(\\tau=t-\\dsct{t}{j}\\) such that (replacing the approximation with an equality) \\[\n\\extforce(\\tau+\\dsct{t}{j})=\\dsct{\\extforce}{j} + \\frac{\\dsct{\\extforce}{j+1} - \\dsct{\\extforce}{j}}{\\tstep} \\tau  \\quad \\text{for} \\quad 0 \\leq \\tau \\leq \\tstep\n\\] For a linear system, it is possible to employ superposition to develop the ‘exact’ response of the system under such an excitation: The response \\(\\gc (t)\\) for \\(\\dsct{t}{j} \\leq t \\leq \\dsct{t}{j+1}\\) may be considered to be the superposition of the following three responses, all of which were previously developed:\n\nThe response due to nonzero initial conditions \\(\\dsct{\\gc}{j}\\) and \\(\\dsct{\\dgc}{j}\\) at time \\(t=\\dsct{t}{j}\\). This response is given (see Chapter 2) by \\[\n\\gc (\\tau + \\dsct{t}{j}) = \\expon{- \\damp \\freq \\tau} \\left(\\dsct{\\gc}{j} \\cos \\dfreq \\tau + \\frac{\\dsct{\\dgc}{j} + \\damp \\freq \\dsct{\\gc}{j}}{\\dfreq} \\sin \\dfreq \\tau \\right)\n\\]\nThe response due to the constant force \\(\\dsct{\\extforce}{j}\\) acting on a system initially at rest. This response is given (see Chapter 3) by \\[\n\\gc (\\tau + \\dsct{t}{j}) = \\frac{\\dsct{\\extforce}{j}}{k} \\left[1-\\expon{- \\damp \\freq \\tau} \\left(\\cos \\dfreq \\tau + \\frac{\\damp}{\\sqrt{1 - \\damp^2}} \\sin \\dfreq \\tau \\right) \\right]\n\\]\nThe response due to the linearly varying (ramp) force \\((\\dsct{\\extforce}{j+1} - \\dsct{\\extforce}{j}) \\tau / \\tstep\\) acting on a system initially at rest. This response is given (see Chapter 3) by \\[\n\\gc (\\tau + \\dsct{t}{j}) =   \\frac{1}{k} \\frac{\\dsct{\\extforce}{j+1} - \\dsct{\\extforce}{j}}{\\tstep} \\expon{- \\damp \\freq \\tau} \\left(\\frac{2 \\damp}{\\freq} \\cos \\dfreq \\tau + \\left[\\frac{2 \\damp^2}{\\dfreq} - \\frac{1}{\\dfreq}\\right] \\sin \\dfreq \\tau \\right)\n+ \\frac{1}{k}\\frac{\\dsct{\\extforce}{j+1} - \\dsct{\\extforce}{j}}{\\tstep} \\left[\\tau  -\\frac{2 \\damp}{\\freq} \\right]\n\\] By taking the derivatives of these expressions we may obtain expressions for velocity, which will also be the superposition of the contributions from the three cases considered above.\n\n\n\n\nFigure 4.1: Approximating the force as a series of linear segments.\n\n\nThe displacement at \\(\\tau = \\tstep\\) (corresponding to \\(t=\\dsct{t}{j+1}\\)) is therefore given by \\[\\begin{align*}\n  \\gc(\\dsct{t}{j+1}) = \\dsct{\\gc}{j+1}  & = \\expon{- \\damp \\freq \\tstep} \\left(\\dsct{\\gc}{j} \\cos \\dfreq \\tstep + \\frac{\\dsct{\\dgc}{j} + \\damp \\freq \\dsct{\\gc}{j}}{\\dfreq} \\sin \\dfreq \\tstep \\right) \\\\\n   & \\quad + \\frac{\\dsct{\\extforce}{j}}{k} \\left[1-\\expon{- \\damp \\freq \\tstep} \\left(\\cos \\dfreq \\tstep + \\frac{\\damp}{\\sqrt{1 - \\damp^2}} \\sin \\dfreq \\tstep \\right) \\right]\\\\\n   & \\quad \\quad + \\frac{\\dsct{\\extforce}{j+1} - \\dsct{\\extforce}{j}}{k \\tstep} \\expon{- \\damp \\freq \\tstep} \\left(\\frac{2 \\damp}{\\freq} \\cos \\dfreq \\tstep + \\left[\\frac{2 \\damp^2}{\\dfreq} - \\frac{1}{ \\dfreq}\\right] \\sin \\dfreq \\tstep \\right) \\\\\n   & \\quad \\quad \\quad + \\frac{\\dsct{\\extforce}{j+1} - \\dsct{\\extforce}{j}}{k \\tstep} \\left[\\tstep  -\\frac{2 \\damp}{\\freq} \\right]\n\\end{align*}\\] Despite the somewhat complicated structure of this result, it is actually composed of a number of coefficients such as \\(\\cos \\dfreq \\tstep\\), \\(\\sin \\dfreq \\tstep\\), etc, multiplying the time-varying variables \\(\\gc\\), \\(\\dgc\\) and \\(\\extforce\\). Rearranging the terms, it is possible to express the result above as \\[\n\\dsct{\\gc}{j+1} = A_1 \\dsct{\\gc}{j+1} + A_2 \\dsct{\\dgc}{j} + A_3 \\dsct{\\extforce}{j} + A_4 \\dsct{\\extforce}{j+1}\n\\qquad(4.3)\\] where \\[\n\\begin{array}{l}\n  A_1 =  \\expon{- \\damp \\freq \\tstep} \\left(\\cos \\dfreq \\tstep + \\frac{\\damp}{\\sqrt{1 - \\damp^2}} \\sin \\dfreq \\tstep \\right) \\\\\n  A_2 =  \\expon{- \\damp \\freq \\tstep} \\left(\\frac{1}{\\dfreq} \\sin \\dfreq \\tstep \\right) \\\\\n  A_3 = \\frac{1}{k} \\left[\\frac{2 \\damp}{\\freq \\tstep} + \\expon{- \\damp \\freq \\tstep} \\left( - \\left[1 + \\frac{2 \\damp}{\\freq \\tstep} \\right]\\cos \\dfreq \\tstep + \\left[\\frac{1 - 2 \\damp^2}{\\dfreq \\tstep} - \\frac{\\damp}{\\sqrt{1-\\damp^2}} \\right] \\sin \\dfreq \\tstep \\right) \\right] \\\\\n  A_4 =\\frac{1}{k} \\left[1 - \\frac{2 \\damp}{\\freq \\tstep} + \\expon{- \\damp \\freq \\tstep} \\left( \\frac{2 \\damp}{\\freq \\tstep} \\cos \\dfreq \\tstep + \\frac{2 \\damp^2-1}{\\dfreq \\tstep} \\sin \\dfreq \\tstep \\right) \\right]\n\\end{array}\n\\qquad(4.4)\\] It is noteworthy that these coefficients are time invariant if a constant time step is used, in which case they would have to be calculated only once. Similarly, if we obtain the velocity by differentiating \\(\\gc (\\tau + t_{j})\\) and evaluate its value at \\(\\tau = \\tstep\\), we find that this value may also be expressed in the form \\[\n\\dsct{\\dgc}{j+1} = B_1 \\dsct{\\gc}{j} + B_2 \\dsct{\\dgc}{j} + B_3 \\dsct{\\extforce}{j} + B_4 \\dsct{\\extforce}{j}\n\\qquad(4.5)\\] where \\[\n\\begin{array}{l}\n  B_1 =  - \\expon{- \\damp \\freq \\tstep} \\left(\\frac{\\freq}{\\sqrt{1 - \\damp^2}} \\sin \\dfreq \\tstep \\right) \\\\\n  B_2 =  \\expon{- \\damp \\freq \\tstep} \\left(\\cos \\dfreq \\tstep - \\frac{\\damp}{\\sqrt{1 - \\damp^2}} \\sin \\dfreq \\tstep \\right) \\\\\n  B_3 = \\frac{1}{k \\tstep} \\left[-{1} + \\expon{- \\damp \\freq \\tstep} \\left( \\cos \\dfreq \\tstep + \\frac{\\freq \\tstep + \\damp}{\\sqrt{1-\\damp^2}} \\sin \\dfreq \\tstep \\right) \\right] \\\\\n  B_4 =\\frac{1}{k \\tstep} \\left[1 - \\expon{- \\damp \\freq \\tstep} \\left( \\cos \\dfreq \\tstep + \\frac{\\damp}{\\sqrt{1 - \\damp^2}} \\sin \\dfreq \\tstep \\right) \\right]\n\\end{array}\n\\qquad(4.6)\\] and once again all coefficients are independent of time if a constant time step is used. Once the displacement and the velocity at an instant are evaluated, the acceleration at that instant may be calculated via the the equation of motion as: \\[\n    \\dsct{\\ddgc}{j} = \\frac{1}{m}(\\dsct{\\extforce}{j} - c \\dsct{\\dgc}{j} - k \\dsct{\\gc}{j}) = \\frac{\\dsct{\\extforce}{j}}{m} - 2 \\damp \\freq \\dsct{\\dgc}{j} - \\freq^2 \\dsct{\\gc}{j}\n\\qquad(4.7)\\] Having developed the analytical results based on the initial assumptions, the flow of the PLE implemented with a constant time step may be summarized as in Figure 4.2.\n\n\n\n\n\n\nPseudocode for the Piecewise Linear Excitation method.\n\n\n\nviscously damped SDOF system, for constant time step\nInput: \\(m\\), \\(\\damp\\) (or \\(c\\)), \\(k\\), \\(\\tstep\\), \\(\\dsct{\\gc}{0}\\), \\(\\dsct{\\dgc}{0}\\), \\(\\left\\{\\dsct{\\extforce}{0}, \\ldots, \\dsct{\\extforce}{l} \\right\\}\\)\nInitialize: calculate \\(A_1,A_2,A_3,A_4,B_1,B_2,B_3,B_4\\) using Equation 4.4 and Equation 4.6\nfor \\(j=0,\\ldots,l-1\\):\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\gc}{j+1}=A_1 \\dsct{\\gc}{j} + A_2 \\dsct{\\dgc}{j} + A_3 \\dsct{\\extforce}{j} + A_4 \\dsct{\\extforce}{j+1}\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\dgc}{j+1}=B_1 \\dsct{\\gc}{j} + B_2 \\dsct{\\dgc}{j} + B_3 \\dsct{\\extforce}{j} + B_4 \\dsct{\\extforce}{j+1}\\)\nfor \\(j=0,\\ldots,l\\):\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\ddgc}{j} = \\frac{1}{m}(\\dsct{\\extforce}{j} - c \\dsct{\\dgc}{j} - k \\dsct{\\gc}{j})\\)\n\n\n\n\n\nFigure 4.2: Pseudocode for PLE.\n\n\n\nEXAMPLE 4 .1\nA single story structure, initially at rest, is idealized as an SDOF system for studying its lateral vibrations when subjected to unidirectional, pulse type lateral forces. The mass2 of the structure is assumed to be condensed at a certain level and estimated as \\(125 \\unit{tons}\\), its lateral stiffness is estimated as \\(2\\times 10^5 \\unit{kN/m}\\), and it is assumed to be viscously damped with a damping ratio of \\(2\\%\\). The equivalent model of the system and the forces it is subjected to are shown in Figure 4.3. Consider a constant time step of \\(\\tstep = 0.01 \\unit{seconds}\\), which corresponds to less than one-tenth of the system’s period, and let us say we want to evaluate the response of the system for a duration of \\(1 \\unit{second}\\), so that a total of \\(101\\) time instances are to be taken into consideration including the initial time \\(t=0\\).\n\n\n\nFigure 4.3: (a) SDOF model of a single story structure, (b) triangular pulse with duration \\(0.2 \\unit{seconds}\\), (c) half-sine pulse with duration \\(0.4 \\unit{seconds}\\).\n\n\nLet us start with the analysis of the triangular pulse with an amplitude of \\(100 \\unit{kN}\\) and duration \\(t_d = 0.2 \\unit{seconds}\\). The force increases linearly until it reaches its peak value of \\(100 \\unit{kN}\\) at \\(t = t_d / 2 = 0.1 \\unit{seconds}\\) corresponding to \\(j = 10\\), after which it declines linearly until it disappears at \\(t = t_d / 2 = 0.1 \\unit{seconds}\\) corresponding to \\(j = 20\\). The value of the force may therefore be defined at instances \\(j\\) as \\[\n\\dsct{\\extforce}{j} = \\begin{cases} 100 \\frac{\\dsct{t}{j}}{t_d/2} = 10 j \\unit{kN} & \\text{for } j = 0,1,\\ldots,10 \\\\\n200 - 200 \\frac{\\dsct{t}{j}}{t_d} = 200 - 10 j \\unit{kN} & \\text{for } j = 11,12,\\ldots,20 \\\\\n0 & \\text{for } j = 21, 22, \\ldots, 100\n\\end{cases}\n\\] The first order of business is to calculate the coefficients \\(A\\)’s and \\(B\\)’s that appear in the recursive formulas of Equation 4.3 and Equation 4.5. These coefficients are evaluated using the expressions given in Equation 4.4 and Equation 4.6 to obtain: \\[\n\\begin{array}{rr}\nA_{1} = 9.2148 \\times 10^{-1}, & A_{2} = 9.6580\\times 10^{-3} \\\\\nA_{3} = 2.6086\\times 10^{-7}, & A_{4} = 1.3174\\times 10^{-7} \\\\\nB_1 = -1.5453\\times 10^{1}, & B_2 = 9.0603 \\times 10^{-1} \\\\\nB_3 = 3.8004\\times 10^{-5}, & B_4 = 3.9260\\times 10^{-5}\n\\end{array}\n\\] Note that these coefficients are independent of the force insofar as the time step does not change. The next step is to calculate the displacement and the velocity through Equation 4.3 and Equation 4.5, and the acceleration at each time step through Equation 4.7. At the initial instance corresponding to \\(j=0\\) the system is at rest, and so \\(\\dsct{\\gc}{0} = 0\\), \\(\\dsct{\\dgc}{0} = 0\\). Since \\(\\dsct{\\extforce}{0} = 0\\), we find \\(\\dsct{\\ddgc}{0} = 0\\) as well. \\(\\dsct{\\gc}{1}\\) and \\(\\dsct{\\dgc}{1}\\) are to be evaluated from \\[\\begin{align*}\n\\dsct{\\gc}{1} & = 9.2148 \\times 10^{-1} \\dsct{\\gc}{0} + 9.6580\\times 10^{-3} \\dsct{\\dgc}{0} + 2.6086\\times 10^{-7} \\dsct{\\extforce}{0} \\\\\n    & \\phantom{9.2148} + 1.3174\\times 10^{-7} \\dsct{\\extforce}{1} = (1.3174\\times 10^{-7})(10) =  1.3174\\times 10^{-6} \\unit{m} \\\\\n\\dsct{\\dgc}{1} & = -1.5453\\times 10^{1} \\dsct{\\gc}{0} + 9.0603 \\times 10^{-1} \\dsct{\\dgc}{0} + 3.8004\\times 10^{-5} \\dsct{\\extforce}{0} \\\\\n    & \\phantom{-1.5} + 3.9260\\times 10^{-5}  \\dsct{\\extforce}{1} = (3.9260\\times 10^{-5} )(10) = 3.9260\\times 10^{-4}  \\unit{m/s} \\\\\n\\end{align*}\\] and the acceleration at \\(j=1\\) is consequently given by \\[\n    \\dsct{\\ddgc}{1} = \\frac{1}{m}(\\dsct{\\extforce}{1} - c \\dsct{\\dgc}{1} - k \\dsct{\\gc}{1}) = 7.7264 \\times 10^{-2} \\unit{m/s}\n\\] The calculations proceed in this manner, and the instances until \\(t=0.1 \\unit{seconds}\\) are obtained as: \\[\n\\small{\n\\begin{array}{rrr}\n\\dsct{\\gc}{0} = 0.0000 \\times 10^{-3} \\unit{m}, & \\dsct{\\dgc}{0} = 0.0000 \\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{0} = 0.0000  \\unit{m/s^2}\\\\\n\\dsct{\\gc}{1} = 0.0013\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{1} = 0.3926\\times 10^{-3}  \\unit{m/s}, & \\dsct{\\ddgc}{1} = 0.0773  \\unit{m/s^2}\\\\\n\\dsct{\\gc}{2} = 0.0102\\times 10^{-3} \\unit{m}, & \\dsct{\\dgc}{2} = 1.5006\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{2} = 0.1412 \\unit{m/s^2}\\\\\n\\dsct{\\gc}{3} = 0.0331\\times 10^{-3} \\unit{m}, & \\dsct{\\dgc}{3} = 3.1391\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{3} = 0.1820 \\unit{m/s^2}\\\\\n\\dsct{\\gc}{4} = 0.0739\\times 10^{-3} \\unit{m}, & \\dsct{\\dgc}{4} = 5.0430\\times 10^{-3} \\unit{m/s}, &  \\dsct{\\ddgc}{4} = 0.1937 \\unit{m/s^2}\\\\\n\\dsct{\\gc}{5} = 0.1338 \\times 10^{-3} \\unit{m}, & \\dsct{\\dgc}{5} = 6.9100 \\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{5} = 0.1748 \\unit{m/s^2}\\\\\n\\dsct{\\gc}{6} = 0.2110\\times 10^{-3} \\unit{m}, & \\dsct{\\dgc}{6} = 8.4482\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{6} = 0.1289 \\unit{m/s^2}\\\\\n\\dsct{\\gc}{7} = 0.3009\\times 10^{-3} \\unit{m}, & \\dsct{\\dgc}{7} = 9.4219\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{7} = 0.0635  \\unit{m/s^2}\\\\\n\\dsct{\\gc}{8} = 0.3971\\times 10^{-3} \\unit{m}, & \\dsct{\\dgc}{8} = 9.6876\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{8} = -0.0108  \\unit{m/s^2}\\\\\n\\dsct{\\gc}{9} = 0.4922\\times 10^{-3} \\unit{m}, & \\dsct{\\dgc}{9} = 9.2149\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{9} = -0.0823  \\unit{m/s^2}\\\\\n\\dsct{\\gc}{10} = 0.5792\\times 10^{-3} \\unit{m}, & \\dsct{\\dgc}{10} = 8.0896\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{10} = -0.1397  \\unit{m/s^2}\n\\end{array}\n}\n\\] These values are provided as reference for readers wishing to check the answers they obtain through their calculations and thereby verify their codes. The response obtained for the whole \\(1 \\unit{second}\\) duration is plotted in Figure 4.4.\n\n\n\nFigure 4.4: Displacement, velocity and acceleration response calculated for the system of Figure 4.3 subjected to the triangular pulse. The response quantities calculated by the PLE are marked with solid circles while the dashed lines are interpolations included for visualisation.\n\n\nLet us repeat the analysis for the case of the half-sine pulse, of amplitude \\(100 \\unit{kN}\\) and duration \\(0.4 \\unit{seconds}\\), shown in Figure 4.3.c. This time the force is defined by \\[\n\\dsct{\\extforce}{j} = \\begin{cases} 100 \\sinp{\\frac{\\pi}{0.4}\\dsct{t}{j}} = 100 \\sinp{\\frac{\\pi}{40}j}; & j = 0,1,\\ldots,40 \\\\\n0; & j = 41, 42, \\ldots, 100\n\\end{cases}\n\\]\n\n\n\nFigure 4.5: Displacement, velocity and acceleration response calculated for the system of Figure 4.3 subjected to the half-sine pulse. The response quantities calculated by the PLE are marked with solid circles while the dashed lines are interpolations included for visualisation.\n\n\nSince the coefficients \\(A\\)’s and \\(B\\)’s of the PLE do not depend on the input but only on the system parameters and the time step, the values calculated previously for the triangular pulse case are still valid. Proceeding with the recursive calculations, the response quantities until \\(t=0.1 \\unit{seconds}\\) are obtained as follows, presented for reference: \\[\n\\small{\n\\begin{array}{rrr}\n\\dsct{\\gc}{0} = 0.0000\\times 10^{-4}    \\unit{m}, & \\dsct{\\dgc}{0} = 0.0000 \\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{0}= 0.0000  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{1}= 0.0103\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{1}= 0.3080\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{1}= 0.0606  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{2}= 0.0804\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{2}= 1.1755\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{2}= 0.1104  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{3}= 0.2591\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{3}= 2.4518\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{3}= 0.1414  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{4}= 0.5772\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{4}= 3.9214\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{4}= 0.1486  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{5}= 1.0416\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{5}= 5.3378\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{5}= 0.1310  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{6}= 1.6350\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{6}= 6.4633\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{6}= 0.0913  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{7}= 2.3181\\times 10^{-4} \\unit{m}, & \\dsct{\\dgc}{7}= 7.1061\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{7}= 0.0357  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{8}= 3.0361\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{8}= 7.1495\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{8}= -0.0270  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{9}= 3.7271\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{9}= 6.5696\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{9}= -0.0873  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{10}= 4.3315\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{10}= 5.4370\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{10}= -0.1361  \\unit{m/s^2}\n\\end{array}\n}\n\\] The displacement, velocity and acceleration responses calculated for the first \\(1 \\unit{second}\\) are plotted in Figure 4.5.\n\n\n\n\nThis approach is referred in many references as the piecewise exact method which we think is somewhat misleading in that the ‘exactness’ alluded to with this name pertains only the analytical expressions used and not to the accurateness of the method itself.↩︎\nMany structures involve relatively large masses such that in practice metric ton (\\(\\punit{ton}\\) or \\(\\punit{t}\\)) is often used, with \\(1 \\unit{ton} = 1000 \\unit{kg}\\).↩︎\n\n\n\nEXAMPLE 4 .2\nTo illustrate how the calculations would proceed for an SDOF system subjected to ground motion, let us consider the system of Ex. 4 .1, subjected to a ground motion defined by \\[\n\\gdist = \\begin{cases} \\ratio{\\maxgvel}{2}t - \\ratio{\\maxgvel t_{d}}{2 \\pi} \\sinp{\\ratio{2\\pi}{t_{d}}t}; 0 \\leq t \\leq t_{d} \\\\\n\\ratio{\\maxgvel t_{d}}{2}; t &gt; t_{d}\\end{cases}\n\\] with \\(\\maxgvel = 1 \\unit{m/s}\\) and \\(t_{d} = 0.4 \\unit{s}\\). The ground acceleration is therefore given for \\(0 \\leq t \\leq t_{d}\\) by \\[\n\\gacct = \\ratio{\\pi \\maxgvel}{t_{d}} \\sinp{\\ratio{2\\pi}{t_{d}}t} = 2.5 \\pi \\sinp{{5 \\pi}t}\n\\] and it is zero at all other times. Recall that for this system, \\(\\damp = 2 \\%\\).\n\n\n\nFigure 4.6: (a) SDOF model of a single story structure subjected to ground motion, (b) A velocity-pulse type ground motion with duration \\(0.5 \\unit{s}\\).\n\n\nThe model and the ground acceleration are shown in Figure 4.6, and the governing equation of motion for \\(0 \\leq t \\leq 0.4 \\unit{s}\\) is given by \\[\nm \\ddgct + c \\dgct + k \\gct = - m \\gacct  \\rightarrow 125 \\ddgct + c \\gct + 2 \\times 10^5 \\gct = - 312.5 \\pi \\sinp{5 \\pi t}\n\\] subjected to initial conditions \\(\\gc (0) = 0, \\dgc (0) = 0\\); or equivalently by \\[\n\\ddgct + 2 \\zeta \\freq \\dgct + \\freq^2 \\gct = - \\gacct \\rightarrow \\ddgct +  1.6 \\gct + 1600 \\gct = - 2.5 \\pi \\sinp{5 \\pi t}\n\\] where we have taken into consideration that \\(\\damp = 0.02\\) and \\(\\freq = \\sqrt{k/m} = 40 \\unit{rad/s}\\) as per the properties stated for the system. Free vibrations ensue after \\(t = 0.4 \\unit{s}\\). Either form of the equation of motion may be used while calculating the response, but note that for the second equation the numerical values for the mass, damping and stiffness coefficients would have to be defined as \\(m = 1\\), \\(c = 1.6\\) and \\(k = 1600\\), respectively. Let us use this second form in our calculations with a constant time step of \\(\\tstep=0.01 \\unit{s}\\). The input is defined at each step by \\[\n\\dsct{\\extforce}{j} = - m\\dsct{\\gacc}{j} = \\begin{cases} - 7.854 \\sinp{0.1571 j} & \\text{for } j = 0,1,\\ldots,40 \\\\\n0 & \\text{for } j = 41, \\ldots, 100\n\\end{cases}\n\\]\n\n\n\nFigure 4.7: Relative displacement, relative velocity and relative acceleration response calculated for the system of Figure 4.6 subjected to the pulse-type ground motion. The response quantities calculated by the PLE are marked with solid circles while the dashed lines are interpolations included for visualisation.\n\n\nFor \\(m=1\\), \\(\\damp=0.02\\) and \\(k=1600\\), the coefficients for the PLE are calculated via Equation 4.4 and Equation 4.6 to obtain \\[\n\\begin{array}{rrrr}\nA_{1} = 9.2148\\times 10^{-1}, & A_{2} = 9.6580\\times 10^{-3} \\\\\nA_{3} = 3.2607\\times 10^{-5}, & A_{4} = 1.6468\\times 10^{-5} \\\\\nB_1 = -1.5453\\times 10^{1}, & B_2 = 9.0603 \\times 10^{-1} \\\\\nB_3 = 4.7504\\times 10^{-3}, & B_4 = 4.9076\\times 10^{-3}\n\\end{array}\n\\] The recursive calculations via Equation 4.3, Equation 4.5 and Equation 4.7 yield, for the first few steps, the following results:\n\\[\n\\small{\n\\begin{array}{rrr}\n\\dsct{\\gc}{ 0 } = 0.0000\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 0 } = 0.0000\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 0 } = -0.0000  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 1 } = -0.0202\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 1 } = -0.0603\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 1 } = -1.1866  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 2 } = -0.1569\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 2 } = -0.2290\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 2 } = -2.1393  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 3 } = -0.5036\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 3 } = -0.4735\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 3 } = -2.6841  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 4 } = -1.1136\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 4 } = -0.7471\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 4 } = -2.7151  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 5 } = -1.9897\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 5 } = -0.9967\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 5 } = -2.2106  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 6 } = -3.0818\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 6 } = -1.1712\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 6 } = -1.2357  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 7 } = -4.2934\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 7 } = -1.2302\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 7 } = 0.0683  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 8 } = -5.4955\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 8 } = -1.1501\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 8 } = 1.5073  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 9 } = -6.5461\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 9 } = -0.9284\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 9 } = 2.8651  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 10 } = -7.3110\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 10 } = -0.5835\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 10 } = 3.9370 \\unit{m/s^2}\n\\end{array}\n}\n\\] The relative displacement, relative velocity and relative acceleration responses calculated for the first \\(1 \\unit{second}\\) are plotted in Figure 4.7."
  },
  {
    "objectID": "numericalsdof.html#footnotes",
    "href": "numericalsdof.html#footnotes",
    "title": "4  Numerical Solutions of the SDOF Equation of Motion",
    "section": "",
    "text": "There is much to say about this with many recent earthquakes demonstrating that the social and economic losses that accumulate after significant earthquakes may reach devastating levels. ``Resilience’’ is likely to be a central concept in the coming years.↩︎"
  },
  {
    "objectID": "numericalsdof.html#central-difference-method",
    "href": "numericalsdof.html#central-difference-method",
    "title": "4  Numerical Solutions of the SDOF Equation of Motion",
    "section": "4.3 Central Difference Method",
    "text": "4.3 Central Difference Method\nA family of numerical methods commonly referred to as finite difference methods makes use of the Taylor series expansion of response and assumes that the series may be truncated after some terms with negligible error if the time step is relatively small. What is known as the Central Difference Method makes use of a one step forward and a one step backward expansion to reduce the order of error. Recall that for some sufficiently smooth continuous function \\(\\gc = \\gc (t)\\), Taylor series expansion expresses the value of the function at \\(t=t_2\\) as a function of the value of itself and its derivatives at \\(t=t_1\\) through \\[\\begin{align*}\n\\gc(t_2) & = \\gc(t_1) + (t_2 - t_1) \\frac{\\diff \\gc }{\\dt}\\biggr|_{t=t_1}  \\!\\!\\!\\!\\! + \\frac{(t_2 - t_1)^2}{2}\\frac{\\diff^2 \\gc}{\\dt^2}\\biggr|_{t=t_1}  \\!\\!\\!\\!\\! +  \\frac{(t_2 - t_1)^3}{6} \\frac{\\diff^3 \\gc}{\\dt^3}\\biggr|_{t=t_1}  \\!\\!\\!\\!\\! + \\cdots \\\\\n& = \\gc(t_1) + \\sum_{j=1}^{\\infty} \\frac{(t_2 - t_1)^j}{j!}\\frac{\\diff^j \\gc}{\\dt^j}\\biggr|_{t=t_1}\n\\end{align*}\\] Consider now the Taylor series expansions for displacement \\(\\gct\\) at \\(t+\\tstep\\) and \\(t - \\tstep\\), given by \\[\\begin{align*}\n  \\gc (t + \\tstep) & = \\gc (t) + \\dgc (t) \\tstep + \\frac{1}{2}\\ddgc (t) \\tstep^2 + o(\\tstep^3) \\\\\n  \\gc (t - \\tstep) & = \\gc (t) - \\dgc (t) \\tstep + \\frac{1}{2}\\ddgc (t) \\tstep^2 - o(\\tstep^3)\n\\end{align*}\\] where \\(o(\\tstep^p)\\) is the remainder of the expansion with leading term of order \\(\\tstep^p\\). The sum of the two equations above leads to \\[\n  \\gc (t + \\tstep) + \\gc (t - \\tstep) = 2 \\gc (t) + \\ddgc (t) \\tstep^2 + o(\\tstep^4)  \n\\] and if the fourth-order remainder were to be neglected, the acceleration at time \\(t\\) could be approximated by \\[\n    \\ddgc (t) \\approx \\frac{\\gc (t + \\tstep) - 2 \\gc (t) + \\gc (t - \\tstep)}{\\tstep^2}\n\\qquad(4.8)\\] The error so incurred is expected to decrease in an absolute sense as \\(\\tstep\\) decreases. On the other hand, the difference of the two expansions leads to \\[\n  \\gc (t + \\tstep) - \\gc (t - \\tstep) = 2 \\dgc  (t) \\tstep + + o(\\tstep^3)\n\\] so that neglecting the third order remainder yields the following approximation for the velocity: \\[\n    \\dgc  (t) \\approx \\frac{\\gc (t + \\tstep) - \\gc (t - \\tstep)}{2 \\tstep}\n\\qquad(4.9)\\] Equation 4.8 and Equation 4.9 are called the central difference approximations to the acceleration and the velocity, respectively. These approximations may be used in the equation of motion to express the equation solely in terms of the generalized displacement. Substituting the central difference approximations into the equation of motion and considering that time is discretized with constant time step \\(\\tstep\\) so that \\(t = j \\tstep\\) and \\(t \\pm \\tstep = (j \\pm 1) \\tstep\\), we get \\[\\begin{align*}\n  m \\ddgc (t) + c \\dgc  (t) + k \\gc (t) & =   m \\dsct{\\ddgc}{j} + c \\dsct{\\dgc}{j} + k \\dsct{\\gc}{j}  \\\\\n  & = m  \\frac{\\dsct{\\gc}{j+1} - 2 \\dsct{\\gc}{j} + \\dsct{\\gc}{j-1}}{\\tstep^2} + c  \\frac{\\dsct{\\gc}{j+1} - \\dsct{\\gc}{j-1}}{2 \\tstep} + k \\dsct{\\gc}{j} = \\extforce(t)= \\dsct{\\extforce}{j}\n\\end{align*}\\] It is straightforward to recast this expression into a regression type formula so that given the response up to and including time \\(t\\) (time step \\(p\\)), the response at \\(t+\\tstep\\) (time step \\(p+1\\)) may then be estimated using \\[\n  A_1 \\dsct{\\gc}{j+1} = \\left(\\dsct{\\extforce}{j} - A_2 \\dsct{\\gc}{j} - A_3 \\dsct{\\gc}{j-1} \\right)\n\\qquad(4.10)\\] where \\[\n\\begin{array}{l}\n  A_1 = {\\ratio{m}{\\tstep^2} + \\ratio{c}{2 \\tstep}} = m \\left[\\ratio{1}{\\tstep^2} + \\ratio{\\damp \\freq}{\\tstep} \\right] \\\\\n  A_2 =  k - \\ratio{2m}{\\tstep^2} = m \\left[\\freq^2 - \\ratio{2}{\\tstep^2} \\right] \\\\\n  A_3 = \\ratio{m}{\\tstep^2} - \\frac{c}{2 \\tstep} = m \\left[\\ratio{1}{\\tstep^2} - \\ratio{\\damp \\freq}{\\tstep} \\right] \\\\\n  A_4 = \\ratio{1}{2\\tstep}\\\\\n  A_5 = \\ratio{1}{\\tstep^2}\n\\end{array}\n\\qquad(4.11)\\] Once again, for a constant time step \\(\\tstep\\), the coefficients \\(A_i\\) are to be calculated only once. At each time step, the velocity is to be calculated from the central difference approximation in Equation 4.9, which may be written in discrete form as \\[\n  \\dsct{\\dgc}{j} = \\frac{1}{2\\tstep}(\\dsct{\\gc}{j+1} - \\dsct{\\gc}{j-1}) = A_4 (\\dsct{\\gc}{j+1} - \\dsct{\\gc}{j-1})\n\\qquad(4.12)\\] and in the case of SDOF systems the acceleration may be calculated using the equilibrium equation for that time step via the discretized form: \\[\n  m \\dsct{\\ddgc}{j} = \\left(\\dsct{\\extforce}{j} - c \\dsct{\\dgc}{j} - k \\dsct{\\gc}{j} \\right)\n\\qquad(4.13)\\] In the case of systems with numerous degrees of freedom the matrix computations involved above may be prohibitive and the accelerations may instead be calculated via the central difference approximations: \\[\n\\dsct{\\ddgc}{j} = \\frac{\\dsct{\\gc}{j+1}- 2 \\dsct{\\gc}{j} + \\dsct{\\gc}{j-1}}{\\tstep^2} = A_5 (\\dsct{\\gc}{j+1}- 2 \\dsct{\\gc}{j} + \\dsct{\\gc}{j-1})\n\\qquad(4.14)\\]\nFor initial conditions \\(\\dsct{\\gc}{0}\\) and \\(\\dsct{\\dgc}{0}\\), the first iteration would be given by \\[\n  A_1 \\dsct{\\gc}{1} = \\left(\\dsct{\\extforce}{0} - A_2 \\dsct{\\gc}{0} - A_3 \\dsct{\\gc}{-1} \\right)\n\\] where \\(\\dsct{\\gc}{-1}\\) is needed. One practice for a system at rest may be to assume \\(\\dsct{\\gc}{-1} = 0\\). An alternative is to use a value consistent with the central difference approximation which may be derived as follows: The central difference approximations for the acceleration and the velocity at time \\(t = 0\\) are \\[\n\\dsct{\\ddgc}{0} = \\frac{\\dsct{\\gc}{1} - 2 \\dsct{\\gc}{0} + \\dsct{\\gc}{-1}}{\\tstep^2}, \\quad \\dsct{\\dgc}{0} = \\frac{\\dsct{\\gc}{1} - \\dsct{\\gc}{-1}}{2 \\tstep}\n\\] so that using these two equations to eliminate the \\(\\dsct{\\gc}{1}\\) term, \\(\\dsct{\\gc}{-1}\\) is given by \\[\n\\dsct{\\gc}{-1} = \\dsct{\\gc}{0} - \\tstep \\dsct{\\dgc}{0} - \\frac{\\tstep^2}{2} \\dsct{\\ddgc}{0}\n\\] where the initial acceleration term \\(\\dsct{\\ddgc}{0}\\) is to be calculated from the equilibrium equation at time \\(t=0\\): \\[\n  \\dsct{\\ddgc}{0} = \\frac{1}{m} \\left(\\dsct{\\extforce}{0} - c \\dsct{\\dgc}{0} - k \\dsct{\\gc}{0} \\right)\n\\] The calculations involved are summarized in Figure 4.8.\n\n\n\n\n\n\nPseudocode for the Central Difference Method\n\n\n\nviscously damped SDOF system, for constant time step\nInput: \\(m\\), \\(\\damp\\) (or \\(c\\)), \\(k\\), \\(\\tstep\\), \\(\\dsct{\\gc}{0}\\), \\(\\dsct{\\dgc}{0}\\), \\(\\left\\{\\dsct{\\extforce}{0}, \\ldots, \\dsct{\\extforce}{l} \\right\\}\\)\nInitialize: calculate\n\\(\\phantom{xxxxxxxxxx}\\) \\(A_1,A_2,A_3\\), \\(A_4\\) and \\(A_5\\) using Equation 4.11, \\(A_1^{-1}\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\ddgc}{0} = \\frac{1}{m}(\\dsct{\\extforce}{0} - c \\dsct{\\dgc}{0} - k\\dsct{\\gc}{0})\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\gc}{-1} = \\dsct{\\gc}{0} - \\tstep \\dsct{\\dgc}{0} - \\frac{\\tstep^2}{2} \\dsct{\\ddgc}{0}\\)\nfor \\(j=0,\\ldots,l-1\\):\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\gc}{j+1} = A_1^{-1} \\left(\\dsct{\\extforce}{j} - A_2 \\dsct{\\gc}{j} - A_3 \\dsct{\\gc}{j-1} \\right)\\)\nfor \\(j=1,\\ldots,l\\):\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\dgc}{j} = A_4(\\dsct{\\gc}{j+1} - \\dsct{\\gc}{j-1})\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\ddgc}{j} = A_5 (\\dsct{\\gc}{j+1}- 2 \\dsct{\\gc}{j} + \\dsct{\\gc}{j-1})\\)\n\n\n\n\n\nFigure 4.8: Pseudocode for the central difference method.\n\n\nIt is extremely important to note that for the response to stay stable, meaning not to eventually get excessively and unphysically large so as to render all results useless, the time step used must be such that \\[\n  \\tstep \\leq \\frac{T}{\\pi}\n\\] where \\(T = 2 \\pi \\sqrt{m}/\\sqrt{k}\\) is the natural period of the system. Because of this constraint, the CDM is said to be a conditionally stable method, as opposed to those that are stable for any time step (which are called unconditionally stable). Note that this condition does not necessarily guarantee accuracy, but only stability. In general, the smaller the time step, the more accurate the results would be expected to be; a commonly suggested value is \\(\\tstep &lt; T/10\\).\nGeometrically, the central difference method is equivalent to fitting a second order curve passing through three data points \\(\\dsct{\\gc}{j-1}\\), \\(\\dsct{\\gc}{j}\\) and \\(\\dsct{\\gc}{j+1}\\), and evaluating the derivatives (velocity and acceleration in this case) at the midpoint. Assume a discretization with constant time step \\(\\tstep\\) and consider a time variable \\(\\tau = t - (j-1) \\tstep\\), such that \\[\n\\dgc (t=\\tau + (j-1) \\tstep) = \\frac{\\diff \\gc(\\tau)}{\\diff \\tau}, \\quad \\ddgc (t=\\tau + (j-1) \\tstep) = \\frac{\\diff^2 \\gc (\\tau)}{\\diff \\tau^2}\n\\] for \\(j\\tstep \\leq t \\leq (j+1)\\tstep\\) and \\(0 \\leq \\tau \\leq 2\\tstep\\). Given three data points \\(\\dsct{\\gc}{j-1}\\), \\(\\dsct{\\gc}{j}\\) and \\(\\dsct{\\gc}{j+1}\\), there is a unique second order curve \\(\\gc(\\tau)\\) that passes through all the three points as shown in Figure 4.9. Such a curve is defined by the equation \\[\n\\gc (\\tau) = C_1 \\tau^2 + C_2 \\tau + C_3\n\\] where \\(C_i\\) are constants that may be determined through the available information. In fact, we have, \\[\\begin{align*}\nq(\\tau = 0) & = C_3 = \\dsct{\\gc}{j-1} \\\\\nq(\\tau = \\tstep) & = \\tstep^2 C_1 + \\tstep C_2 + C_3 = \\dsct{\\gc}{j} \\\\\nq(\\tau = 2\\tstep) & = 4 \\tstep^2 C_1 + 2 \\tstep C_2 + C_3 = \\dsct{\\gc}{j+1}\n\\end{align*}\\]\n\n\n\n\nFigure 4.9: Second order curve passing through data three points.\n\n\nSolving for the coefficients leads to \\[\nC_1 = \\ratio{1}{2 \\tstep^2}(\\dsct{\\gc}{j+1} - 2 \\dsct{\\gc}{j} + \\dsct{\\gc}{j-1}), \\quad C_2 = \\ratio{1}{2 \\tstep}(-\\dsct{\\gc}{j+1} + 4 \\dsct{\\gc}{j} - 3 \\dsct{\\gc}{j-1}), \\quad C_3 = \\dsct{\\gc}{j-1}\n\\] so that the velocity and acceleration at the midpoint, i.e. at \\(t=i \\tstep\\) or \\(\\tau = \\tstep\\), are given by \\[\n\\dsct{\\dgc}{j}=\\dgc (t=j \\tstep) = \\frac{\\diff \\gc(\\tau)}{\\diff \\tau}\\biggr|_{\\tau = \\tstep} = (2 C_1 \\tau + C_2)\\bigr|_{\\tau=\\tstep} = \\ratio{\\dsct{\\gc}{j+1}-\\dsct{\\gc}{j-1}}{2\\tstep}\n\\] \\[\n\\dsct{\\ddgc}{j}=\\ddgc (t=j \\tstep) = \\frac{\\diff^2 \\gc(\\tau)}{\\diff \\tau^2}\\biggr|_{\\tau = \\tstep} = (2 C_1)\\bigr|_{\\tau=\\tstep} = \\ratio{\\dsct{\\gc}{j+1}-2\\dsct{\\gc}{j}+\\dsct{\\gc}{j-1}}{\\tstep^2}\n\\] which are in fact the finite difference approximations used for these two quantities in the central difference method.\n\nEXAMPLE 4 .3\nTo illustrate how the central difference calculations proceed, let us consider the system discussed previously in Ex. 4 .1, subjected to the half-sine pulse shown in Figure 4.3.c. The system is defined by parameters \\(m=125 \\unit{tons}\\), \\(k=200 \\, 000 \\unit{kN/m}\\) and \\(\\damp = 0.02\\) (or, equivalently, \\(c = 2 \\damp \\freq m = 200 \\unit{kN \\cdot s / m}\\)). With a time step of \\(\\tstep = 0.01 \\unit{seconds} \\approx 0.06 \\period\\), the force is again given by \\[\n\\dsct{\\extforce}{j} = \\begin{cases} 100 \\sinp{\\frac{\\pi}{40}j} & \\text{for } j = 0,1,\\ldots,40 \\\\\n0 & \\text{for } j = 41, 42, \\ldots, 100\n\\end{cases}\n\\] and the coefficients to be used in the central difference method are calculated via Equation 4.11 as: \\[\nA_{1} ^{-1}= 7.9365\\times 10^{-7}, \\; A_{2} = -2300 \\times 10^{3},  \\; A_{3} = 1240 \\times 10^{3}, \\; A_{4} = 50, \\; A_{5} = 10^{4}\n\\] With zero initial conditions so that \\(\\dsct{\\gc}{0} = 0\\) and \\(\\dsct{\\dgc}{0} = 0\\), \\(\\dsct{\\ddgc}{0}\\) and \\(\\dsct{\\gc}{-1}\\) are calculated to obtain \\[\n\\dsct{\\ddgc}{0} = \\frac{1}{m} (\\dsct{\\extforce}{0} - c \\dsct{\\dgc}{0} - k \\dsct{\\gc}{0}) = 0, \\quad  \\dsct{\\gc}{-1} = \\dsct{\\gc}{0} - \\tstep \\dsct{\\dgc}{0} - \\frac{\\tstep^2}{2} \\dsct{\\ddgc}{0} = 0\n\\] after which, through the recursive formulas given by Equation 4.29, Equation 4.12 and Equation 4.14, the following values are calculated for the first few time steps: \\[\n\\small{\n\\begin{array}{rrr}\n\\dsct{\\gc}{ 0 } = 0.0000\\times 10^{-4} \\unit{m}, & \\dsct{\\dgc}{ 0 } = 0.0000\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{ 0 } = 0.0000  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 1 } = 0.0000\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{ 1 } = 0.3114\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{ 1 } = 0.0623  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 2 } = 0.0623\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{ 2 } = 1.1891\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{ 2 } = 0.1133  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 3 } = 0.2378\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{ 3 } = 2.4792\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{ 3 } = 0.1447 \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 4 } = 0.5581\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{ 4 } = 3.9608\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{ 4 } = 0.1516  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 5 } = 1.0300\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{ 5 } = 5.3824\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{ 5 } = 0.1327  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 6 } = 1.6346\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{ 6 } = 6.5023\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{ 6 } = 0.0913  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 7 } = 2.3304\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{ 7 } = 7.1272\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{ 7 } = 0.0337  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 8 } = 3.0600\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{ 8 } = 7.1418\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{ 8 } = -0.0308  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 9 } = 3.7588\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{ 9 } = 6.5263\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{ 9 } = -0.0923  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 10 } = 4.3653\\times 10^{-4}  \\unit{m}, & \\dsct{\\dgc}{ 10 } = 5.3582\\times 10^{-3} \\unit{m/s}, & \\dsct{\\ddgc}{ 10 } = -0.1413 \\unit{m/s^2}\n\\end{array}\n}\n\\]\n\n\n\nFigure 4.10: Displacement, velocity and acceleration response calculated for the system of Figure 4.3 subjected to the half-sine pulse. The response quantities calculated with the central difference method are marked with solid circles while the dashed lines are interpolations included for visualisation.\n\n\nThe displacement, velocity and acceleration response calculated for the first \\(1 \\unit{second}\\) are plotted in Figure 4.10.\n\n\nEXAMPLE 4 .4\nFor a second application of the central difference method, let us consider the system and base motion of Figure 4.6. The equation of motion for \\(0 \\leq t \\leq 0.4 \\unit{seconds}\\) was shown (see Ex. 4 .2) to be given by \\[\n\\ddgct +  1.6 \\gct + 1600 \\gct = - 2.5 \\pi \\sinp{5 \\pi t}, \\quad \\{\\gc (0) = 0, \\dgc (0) = 0\\}\n\\] while for \\(t &gt; 0.4 \\unit{s}\\), free vibrations ensue. With a time step of \\(\\tstep=0.01 \\unit{s}\\), the input is defined by \\[\n\\dsct{\\extforce}{j} = \\begin{cases}- 7.854 \\sinp{0.1571 j} & \\text{for } j = 0,1,\\ldots,40 \\\\\n0 & \\text{for } j = 41, 42, \\ldots, 100\n\\end{cases}\n\\]\n\n\n\nFigure 4.11: Relative displacement, relative velocity and relative acceleration response calculated for the system of Figure 4.6 subjected to the pulse-type ground motion. The response quantities calculated by the central difference method are marked with solid circles while the dashed lines are interpolations included for visualisation.\n\n\nFor \\(m=1\\), \\(\\damp=0.02\\) and \\(k=1600\\), the coefficients for the central difference method are calculated via Equation 4.11 to obtain \\[\nA_{1}^{-1} = 9.9206\\times 10^{-5}, \\; A_{2} = 18 \\; 400,  \\; A_{3} = 9920, \\; A_{4} = 50, \\; A_{5} = 10^{4}\n\\] With zero initial conditions so that \\(\\dsct{\\gc}{0} = 0\\) and \\(\\dsct{\\dgc}{0} = 0\\), \\(\\dsct{\\ddgc}{0}\\) and \\(\\dsct{\\gc}{-1}\\) are calculated to obtain \\[\n\\dsct{\\ddgc}{0} = \\frac{1}{m} (\\dsct{\\extforce}{0} - c \\dsct{\\dgc}{0} - k \\dsct{\\gc}{0}) = 0, \\quad  \\dsct{\\gc}{-1} = \\dsct{\\gc}{0} - \\tstep \\dsct{\\dgc}{0} - \\frac{\\tstep^2}{2} \\dsct{\\ddgc}{0} = 0\n\\] after which, the recursive calculations via Equation 4.29, Equation 4.12 and Equation 4.14 yield, for the first few steps, the following results:\n\\[\n\\small{\n\\begin{array}{rrr}\n\\dsct{\\gc}{ 0 } = 0.0000\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 0 } = 0.0000\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 0 } = 0.0000  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 1 } = 0.0000\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 1 } = -0.0609\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 1 } = -1.2189  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 2 } = -0.1219\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 2 } = -0.2316\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 2 } = -2.1949  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 3 } = -0.4633\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 3 } = -0.4788\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 3 } = -2.7478  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 4 } = -1.0794\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 4 } = -0.7546\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 4 } = -2.7686  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 5 } = -1.9725\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 5 } = -1.0049\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 5 } = -2.2369  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 6 } = -3.0892\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 6 } = -1.1779\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 6 } = -1.2229  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 7 } = -4.3282\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 7 } = -1.2328\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 7 } = 0.1244  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 8 } = -5.5547\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 8 } = -1.1465\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 8 } = 1.6014  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 9 } = -6.6212\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 9 } = -0.9173\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 9 } = 2.9833  \\unit{m/s^2} \\\\\n\\dsct{\\gc}{ 10 } = -7.3892\\times 10^{-3}  \\unit{m}, & \\dsct{\\dgc}{ 10 } = -0.5651\\times 10^{-1} \\unit{m/s}, & \\dsct{\\ddgc}{ 10 } = 4.0592  \\unit{m/s^2} \\\\\n\\end{array}\n}\n\\] The relative displacement, relative velocity and relative acceleration responses calculated for the first \\(1 \\unit{second}\\) are plotted in Figure 4.11."
  },
  {
    "objectID": "numericalsdof.html#sec-numericalinterlude",
    "href": "numericalsdof.html#sec-numericalinterlude",
    "title": "4  Numerical Solutions of the SDOF Equation of Motion",
    "section": "4.4 Interlude",
    "text": "4.4 Interlude\nHaving discussed two numerical integration methods and gained a sense of how numerical integration schemes operate, it may be worthwhile to look into how the “success” of a numerical method should be judged. It is not our intention to provide a complete coverage of the analysis of numerical integration schemes. For interested readers, there are various studies and books in which thorough investigations may be found.3 Rather we aim to simply introduce some of the concepts and keywords that are encountered in such analyses so as to allude to certain pros and cons of the numerical methods that have been and will be introduced in this chapter.\nTo begin with, we may try to get a sense of how well a particular approach does by comparing its predictions in those problems for which analytical solutions are available. This is obviously not the best approach since there is no guarantee that if a method works well in a particular problem it should also work well in some other: certain qualities of the system and/or the excitation may lead to variations in how well a numerical integration scheme works for that particular problem. Having expressed this disclaimer, it is still worthwhile to get a sense of what happens through visuals. Let us consider the sinusoidal pulse type ground motion that was investigated in Ex. 4 .2 and Ex. 4 .4. The analytical solution to such an input was developed as given in Equation 3.88 and Equation 3.90, and so the true value of the response may be calculated at all times provided the following values are used in the analytical solution: \\[\n\\maxgvel = 1 \\unit{m/s}, t_{d} = 0.4 \\unit{s}, \\extfreq' = \\ratio{2 \\pi}{t_{d}} = 5 \\pi, \\freq = 40 \\unit{rad/s}, \\damp = 0.02, \\ratfreq = \\ratio{\\extfreq'}{\\freq}=\\ratio{\\pi}{8}\n\\] Consider, for example, the estimates that would be obtained by the central difference method for this problem. Figure 4.12 shows the estimates obtained with the central difference method employed with three different step sizes, i.e. \\(0.002\\), \\(0.01\\) and \\(0.02 \\unit{seconds}\\), along with the true values that are given by the analytical solution. Note that all the solutions are stable since they all remain bounded: this is to be expected since all time steps are smaller than the critical time step given by \\(\\period/\\pi = 0.05 \\unit{seconds}\\). That a solution is stable does not mean it is necessarily sufficiently accurate. The good news seems to be that as the time step gets smaller, the central difference estimates tend to match very well with the true values and in fact it is visually very difficult to distinguish in Figure 4.12 between the true values and the estimates obtained with \\(\\tstep = 0.002 \\unit{seconds}\\).\n\n\n\nFigure 4.12: Plots of results obtained for the sinusoidal pulse type ground motion (see Ex. 4 .2 and Ex. 4 .2) with the central different method for various values of time step. True response is the continuous red line, with solid (red) circles marking the results for \\(\\tstep = 0.002 \\unit{s}\\), hollow (blue) circles for \\(\\tstep = 0.01 \\unit{s}\\), and plus signs (green) for \\(\\tstep = 0.02 \\unit{s}\\).\n\n\nAs the time step gets larger, some systematic issues begin to appear. One obvious concern is whether or not the response amplitude at a given instance is estimated well. Some part of the response relates to the input: whether or not the time step used is small enough to capture the variations in the excitation will naturally directly affect the results. Assuming that the excitation is captured appropriately, there could still be an issue with what is generally called artificial damping or numerical damping. Some numerical techniques introduce, by virtue of their approximations, an artificial dissipation which causes errors in amplitude estimates. The central difference method is not known to suffer from this error. The second and perhaps more surprising problem is that some numerical methods introduce a change in the period of the system (sometimes referred to as period elongation) , and this seems to be a particular issue with the central difference method, as may be observed from the response curves. As the time step increases, the central difference method seems to lead to a decrease in the period, very evident especially in the free vibration phase. That this effect is inherent to the method and not specific to a particular example may be shown by direct analysis of the finite difference equations.\nWhether or not a numerical integration scheme is conditionally or unconditionally stable is a fundamental question that in most cases precede accuracy. The analysis of stability generally proceeds with either the analytical solution of the finite difference equations or a state space analysis. For illustration purposes let us focus on the state space analysis by again taking the central difference method as a case study, and further simplify the problem by assuming that the system is undamped. The central difference estimate of the response for such a system is given (Equation 4.29 and Equation 4.11 with \\(c = 0\\)) by \\[\n\\dsct{\\gc}{j+1} = (2-\\tstep^2 \\freq^2) \\dsct{\\gc}{j} - \\dsct{\\gc}{j-1} + \\ratio{\\tstep^2}{m} \\dsct{\\extforce}{j}\n\\] This equation may be complemented by the identity \\(\\dsct{\\gc}{j}=\\dsct{\\gc}{j}\\) so that, by defining a state vector \\[\n\\dscs{j} = \\colmat{\\dsct{\\gc}{j} \\\\ \\dsct{\\gc}{j-1}}\n\\] the central difference estimation may be cast into state space format as \\[\n\\dscs{j+1} = \\dscA \\dscs{j} + \\dscB \\dscf{j}\n\\] where the state transition matrix is given by \\[\n\\dscA = \\begin{bmatrix} (2-\\tstep^2 \\freq^2) & -1 \\\\ 1 & 0 \\end{bmatrix}\n\\] Through repeated substitutions, the state after \\(p\\) time steps may be shown to be given by \\[\n\\dscs{i+p} = \\dscA^p \\dscs{j} + \\sum_{j=0}^{p-1} \\dscA^{p-1-j}\\dscB \\dscf{i+j}\n\\] whence it should be apparent that whether or not the response estimates indefinitely grow with increasing \\(p\\) depends on how \\(\\dscA^{p}\\) behaves. From linear algebra we know that a real valued matrix \\(\\dscA\\) may be expressed using its eigenvalue matrix4 \\(\\eigvalmat\\) and eigenvector matrix \\(\\eigvecmat\\) as \\[\n\\dscA = \\eigvecmat^{-1} \\eigvalmat \\eigvecmat\n\\] where, for our \\(2 \\times 2\\) state transition matrix \\(\\dscA\\), the eigenvalues are the roots of the characteristic equation given by: \\[\n\\det\\left(\\begin{bmatrix} (2-\\tstep^2 \\freq^2) - \\eigval  & -1 \\\\ 1 & 0-\\eigval\\end{bmatrix}\\right) = \\eigval^2 + (\\tstep^2 \\freq^2 - 2) \\eigval + 1 = 0\n\\] Solving this quadratic equation and using the relationship \\(\\freq = 2 \\pi / \\period\\) yields \\[\n\\eigval_{1,2} = 1 - {2}\\left(\\ratio{\\tstep \\pi}{\\period} \\right)^2 \\mp 2 \\left(\\ratio{\\tstep \\pi}{\\period} \\right)\\sqrt{\\left(\\ratio{\\tstep \\pi}{\\period} \\right)^2-1}\n\\] Using the eigendecomposition, the \\(p\\)th power of \\(\\dscA\\) may be expressed as \\[\n\\dscA^p = \\underbrace{\\eigvecmat^{-1} \\eigvalmat \\eigvecmat\\eigvecmat^{-1} \\eigvalmat \\eigvecmat\\cdots\\eigvecmat^{-1} \\eigvalmat \\eigvecmat}_{p \\text{ times}} = \\eigvecmat^{-1} \\eigvalmat^{p} \\eigvecmat\n\\] so that the stability (or boundedness) depends directly on whether or not any of the eigenvalues have a magnitude bigger than unity, inwhich case \\(\\eigval^p\\) would increase without bound as \\(p\\) continues to increase. For our state space model of the central difference method, it is straightforward to see that when \\(\\tstep \\pi / T &gt; 1\\), the magnitude of at least one of the roots exceeds 1 and so the system becomes unstable. When \\(\\tstep \\pi / T &lt; 1\\), we have complex valued roots given by \\[\n\\eigval_{1,2} = 1 - {2}\\left(\\ratio{\\tstep \\pi}{\\period} \\right)^2 \\mp \\imag 2 \\left(\\ratio{\\tstep \\pi}{\\period} \\right)\\sqrt{1-\\left(\\ratio{\\tstep \\pi}{\\period} \\right)^2}\n\\] so that the magnitude of the eigenvalues, which are a pair of complex conjugate numbers in this case, is given by \\[\n\\vmag{\\eigval_1} = \\vmag{\\eigval_2} = \\left[1 - {2}\\left(\\ratio{\\tstep \\pi}{\\period} \\right)^2\\right]^2 + \\left[2\\left(\\ratio{\\tstep \\pi}{\\period} \\right)\\sqrt{1-\\left(\\ratio{\\tstep \\pi}{\\period} \\right)^2} \\right]^2 = 1\n\\] and therefore the \\(n\\)th power of the eigenvalues remain bounded, making the system stable. The magnitude of the maximum eigenvalue of a matrix is called the spectral radius of that matrix, and the stability criterion is sometimes expressed as the spectral radius being less than or equal to 1.5\nThe foregoing analysis is presented to introduce some key concepts in the evaluation of numerical techniques for solving the equation of motion. By now it should be obvious why the step size \\[\n\\tstep^{cr} = \\ratio{T}{\\pi}\n\\] is critical, and that the algorithm should be run with a time step less than this value. While discussing other numerical methods we will not dwell on detailed analyses, but we will use some terminology like artificial (or numerical) damping, period elongation and conditionally stable, all of which have been discussed or illustrated in the context of the central difference method.\nSince most of the problems go away if one were to choose a small enough time-step, why do we care, why not choose a very very small time step and be done with it? The computational cost for single degree of freedom systems is negligible and by all means the problems may be alleviated by using as small a time step as desired. The significant problem lies with systems having multiple degrees of freedom. We will eventually see that the response of such systems may be thought of as some linear combination of the responses of many contributing single degree of freedom systems with varying frequencies. Consider a system with thousands of degrees of freedom: the choice of a very small time step may drastically increase computational burden while using a larger time step may lead to stability problems in some of those contributing single degree of freedom systems. It is therefore crucial to understand possible problems that may be encountered while employing numerical integration schemes so that the analyst may correctly interpret the results obtained and perhaps optimize the choice of time step.\nAnother consideration that factors in predominantly when working on multi degree of freedom nonlinear systems is whether or not an integration scheme is explicit or implicit. If an integration scheme is such that all the information necessary to calculate the displacement response at time step \\(j+1\\) is limited to those already known at the end of time step \\(j\\), the method is said to be explicit. Mathematically this is analogous to a relationship of the sort \\(\\dsct{\\gc}{j+1} =\\mathfrak{F}(\\dsct{\\gc}{j} ,\\dsct{\\dgc}{j} ,\\dsct{\\ddgc}{j} )\\) where \\(\\mathfrak{F}(\\cdot)\\) is some function, and it stems from the practice of evaluating the equilibrium equation at time step \\(j\\) into which the response at step \\(j+1\\) enters as some component. The central difference method is an explicit method because to calculate \\(\\dsct{\\gc}{j+1}\\), we just need to know \\(\\dsct{\\gc}{j}\\) and \\(\\dsct{\\gc}{j-1}\\), both of which are known at the end of the \\(j\\)-th step.6 Explicit methods may be more cost effective, especially in the analysis of multi degree of freedom systems, but generally suffer from a need to work with relatively small time steps to minimize errors. Implicit methods, on the other hand, make use of some information pertaining to time step \\((j+1)\\) while solving for the response at that time step, and thereby may require iterative techniques. The equilibrium equation considered is that at time step \\(j+1\\). Mathematical expressions of implicit methods are analogous to the form \\(\\mathfrak{F'}(\\dsct{\\gc}{j},\\dsct{\\dgc}{j},\\dsct{\\dgc}{j}, \\dsct{\\gc}{j+1}, \\dsct{\\dgc}{j+1} ,\\dsct{\\ddgc}{j+1})=0\\) where \\(\\mathfrak{F'}(\\cdot)\\) is some function such that a simple forward time marching is not possible. Their solution is generally more costly due to the need to iterate in between and may also involve costly matrix factorizations."
  },
  {
    "objectID": "numericalsdof.html#houbolts-method",
    "href": "numericalsdof.html#houbolts-method",
    "title": "4  Numerical Solutions of the SDOF Equation of Motion",
    "section": "4.5 Houbolt’s Method",
    "text": "4.5 Houbolt’s Method\nThere are many variations to the theme of finite differences, and the one that we will now discuss as an alternative is generally referred to as Houbolt’s method. Originally in an effort to improve dynamic analyses of aircraft subjected to gusts,7 Houbolt’s method employs a four-point expansion whereby in the more commonly employed variation the response at steps \\(j\\), \\(j-1\\) and \\(j-2\\) are expressed in terms of the response quantities at time step \\(j+1\\): \\[\\begin{align*}\n\\dsct{\\gc}{j} & = \\dsct{\\gc}{j+1} -  \\tstep \\dsct{\\dgc}{j+1}  + \\ratio{\\tstep^2}{2} \\dsct{\\ddgc}{j+1} - \\ratio{\\tstep^3}{6} \\dsct{\\dddot{\\gc}}{j+1} + o(\\tstep^4) \\\\\n\\dsct{\\gc}{j-1} & = \\dsct{\\gc}{j+1} -  (2\\tstep) \\dsct{\\dgc}{j+1}  + \\ratio{(2\\tstep)^2}{2} \\dsct{\\ddgc}{j+1} - \\ratio{(2\\tstep)^3}{6} \\dsct{\\dddot{\\gc}}{j+1} + o(\\tstep^4) \\\\\n\\dsct{\\gc}{j-2} & = \\dsct{\\gc}{j+1} -  (3\\tstep) \\dsct{\\dgc}{j+1}  + \\ratio{(3\\tstep)^2}{2} \\dsct{\\ddgc}{j+1} - \\ratio{(3\\tstep)^3}{6} \\dsct{\\dddot{\\gc}}{j+1} + o(\\tstep^4)\n\\end{align*}\\]\nTaking into account the third order derivatives makes this a higher order approach than the central difference method and the error introduced by truncating the Taylor series in this case is \\(o(\\tstep^4)\\). Solving for \\(\\dsct{\\dgc}{j+1}\\), \\(\\dsct{\\ddgc}{j+1}\\), \\(\\dsct{\\dddot{\\gc}}{j+1}\\) in terms of \\(\\dsct{\\gc}{j+1}\\), \\(\\dsct{\\gc}{j}\\), \\(\\dsct{\\gc}{j-1}\\) and \\(\\dsct{\\gc}{j-1}\\) while ignoring higher order terms leads to \\[\\begin{align*}\n\\dsct{\\dgc}{j+1} & = \\ratio{1}{6\\tstep} (11 \\dsct{\\gc}{j+1} - 18 \\dsct{\\gc}{j} + 9 \\dsct{\\gc}{j-1} - 2 \\dsct{\\gc}{j-2} )\\\\\n\\dsct{\\ddgc}{j+1} & = \\ratio{1}{\\tstep^2} (2 \\dsct{\\gc}{j+1} - 5 \\dsct{\\gc}{j} + 4 \\dsct{\\gc}{j-1} - \\dsct{\\gc}{j-2} )\n\\end{align*}\\] Substituting these approximations into the equation of motion at time \\(t=(j+1)\\tstep\\), given by \\[\nm\\dsct{\\ddgc}{j+1} + c \\dsct{\\dgc}{j+1} + k \\dsct{\\gc}{j+1} = \\dsct{\\extforce}{j+1}\n\\] and after rearranging the terms, we get \\[\n    A_1 \\dsct{\\gc}{j+1} = \\dsct{\\extforce}{j+1} + A_2 \\dsct{\\gc}{j} + A_3 \\dsct{\\gc}{j-1} + A_4 \\dsct{\\gc}{j-2}\n\\qquad(4.15)\\] where \\[\n\\begin{array}{l}\nA_1 = k + \\ratio{2}{\\tstep^2}m + \\ratio{11}{6 \\tstep} c = k \\left[1 + \\ratio{2}{(\\freq \\tstep)^2} + \\ratio{11 \\damp }{3 (\\freq \\tstep)}\\right] \\\\\nA_2 = \\ratio{5}{\\tstep^2} m + \\ratio{3}{ \\tstep} c = k \\left[\\ratio{5}{(\\freq \\tstep)^2} + \\ratio{6 \\damp}{ (\\freq \\tstep)}  \\right] \\\\  \nA_3 = - \\ratio{4}{\\tstep^2} m - \\ratio{3}{2 \\tstep} c = -k \\left[\\ratio{4}{(\\freq \\tstep)^2} + \\ratio{3\\damp}{(\\freq \\tstep)} \\right] \\\\\nA_4 = \\ratio{1}{\\tstep^2} m + \\ratio{1}{3 \\tstep} c = k \\left[\\ratio{1}{(\\freq \\tstep)^2} + \\ratio{2 \\damp}{3 (\\freq \\tstep)}   \\right] \\\\\nA_5 =  \\ratio{1}{6\\tstep}\\\\\nA_6 = \\ratio{1}{\\tstep^2}\n\\end{array}\n\\qquad(4.16)\\]\n\n\n\n\n\n\nPseudocode for Houbolt’s Method\n\n\n\nviscously damped SDOF system, for constant time step\nInput: \\(m\\), \\(\\damp\\) (or \\(c\\)), \\(k\\), \\(\\tstep\\), \\(\\dsct{\\gc}{0}\\), \\(\\dsct{\\dgc}{0}\\), \\(\\left\\{\\dsct{\\extforce}{0}, \\ldots, \\dsct{\\extforce}{l} \\right\\}\\)\nInitialize: calculate\n\\(\\phantom{xxxxxxxxxx}\\) \\(A_1,A_2,A_3, A_4, A_5\\) and \\(A_6\\) using Equation 4.16, \\(A_1^{-1}\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\ddgc}{0} = \\frac{1}{m}(\\dsct{\\extforce}{0} - c \\dsct{\\dgc}{0} - k\\dsct{\\gc}{0})\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\gc}{1}, \\dsct{\\gc}{2}, \\dsct{\\dgc}{1}, \\dsct{\\dgc}{2}, \\dsct{\\ddgc}{1}, \\dsct{\\ddgc}{2}\\) by some method\nfor \\(j=2,\\ldots,l-1\\):\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\gc}{j+1} = A_1^{-1}(\\dsct{\\extforce}{j+1} + A_2 \\dsct{\\gc}{j} + A_3 \\dsct{\\gc}{j-1} + A_4 \\dsct{\\gc}{j-2})\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\dgc}{j+1} = A_5 (11 \\dsct{\\gc}{j+1} - 18 \\dsct{\\gc}{j} + 9 \\dsct{\\gc}{j-1} - 2 \\dsct{\\gc}{j-2} )\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\ddgc}{j+1} = A_6 (2 \\dsct{\\gc}{j+1} - 5 \\dsct{\\gc}{j} + 4 \\dsct{\\gc}{j-1} - \\dsct{\\gc}{j-2} )\\)\n\n\n\n\n\nFigure 4.13: Pseudocode for Houbolt’s method.\n\n\nHoubolt’s method is unconditionally stable so that relatively larger time steps may be used without stability concerns compared to the central difference method. On the other hand, it introduces artificial damping and period elongation which become pronounced with increasing step size. It is an implicit method since the equilibrium equation is evaluated at time step \\(p+1\\), and consequently the stiffness term that appears in coefficient \\(A_1\\) has to be inverted to obtain a solution. Although this is a trivial matter in the case of SDOF models, in the context of MDOF models it may mean the inversion (usually by some type of matrix factorization) of a large dimensional non-diagonal matrix, possibly at each time step if considering nonlinear systems with varying stiffness, which may be computationally very costly. Another issue is the initiation, in that to calculate \\(\\dsct{\\gc}{1}\\) and \\(\\dsct{\\gc}{2}\\) one needs to know \\(\\dsct{\\gc}{-1}\\) and \\(\\dsct{\\gc}{-2}\\) which, unfortunately, are not directly available. It turns out that the method may be quite sensitive to these initial conditions and that, for example, prescribing zero values for \\(\\dsct{\\gc}{-1}\\) and \\(\\dsct{\\gc}{-2}\\) may lead to unacceptable results. The common procedure is to estimate \\(\\dsct{\\gc}{1}\\) and \\(\\dsct{\\gc}{2}\\) via some other method and start the Houbolt progression with the third step.\nGeometrically, Houbolt’s method amounts to fitting a cubic curve to four data points and evaluating the derivatives at the end point. Consider the data points shown in Figure 4.14. A cubic curve may be fit to these four points, to be defined by the equation \\[\n\\gc (\\tau) = C_1 \\tau^3 + C_2 \\tau^2 + C_3 \\tau + C_4\n\\] where \\(C_i\\) are constants that may be determined through the available information. In fact, we have, \\[\\begin{align*}\nq(\\tau = 0) & = C_4 = \\dsct{\\gc}{j-2} \\\\\nq(\\tau = \\tstep) & = \\tstep^3 C_1 + \\tstep^2 C_2 + \\tstep C_3 + C_4= \\dsct{\\gc}{j-1} \\\\\nq(\\tau = 2\\tstep) & = 8 \\tstep^3 C_1 + 4 \\tstep^2 C_2 + 2 \\tstep C_3 + C_4 = \\dsct{\\gc}{j}\\\\\nq(\\tau = 2\\tstep) & = 27 \\tstep^3 C_1 + 9 \\tstep^2 C_2 + 3 \\tstep C_3 + C_4 = \\dsct{\\gc}{j+1}\n\\end{align*}\\]\n\n\n\nFigure 4.14: Second order curve passing through data three points.\n\n\nSolving for the coefficients one gets \\[\n\\begin{array}{c}\nC_1 = \\ratio{1}{6 \\tstep^3}(\\dsct{\\gc}{j+1} - 3 \\dsct{\\gc}{j} + 3 \\dsct{\\gc}{j-1}-\\dsct{\\gc}{j-2}) \\\\\nC_2 = \\ratio{1}{2 \\tstep^2}(-\\dsct{\\gc}{j+1} + 4 \\dsct{\\gc}{j} - 5 \\dsct{\\gc}{j-1}+2\\dsct{\\gc}{j-2})\\\\\nC_3 = \\ratio{1}{6 \\tstep}(2\\dsct{\\gc}{j+1} -9 \\dsct{\\gc}{j} +18 \\dsct{\\gc}{j-1}-11\\dsct{\\gc}{j-2}), \\qquad C_4 = \\dsct{\\gc}{j-2}\n\\end{array}\n\\] so that the velocity and acceleration at the end point, i.e. at \\(t=(j+1) \\tstep\\) or equivalently at \\(\\tau = 3\\tstep\\), are given by \\[\\begin{align*}\n\\dsct{\\dgc}{j+1} & =\\dgc (t=(j+1) \\tstep) = \\frac{\\diff \\gc(\\tau)}{\\diff \\tau}\\biggr|_{\\tau = 3\\tstep} = (3 \\tau^2 C_1  + 2 \\tau C_2 + C_3)\\bigr|_{\\tau=3\\tstep} \\\\\n& = \\ratio{11 \\dsct{\\gc}{j+1}-18 \\dsct{\\gc}{j}+9\\dsct{\\gc}{j-1}-2\\dsct{\\gc}{j-2}}{6\\tstep}\n\\end{align*}\\] \\[\\begin{align*}\n\\dsct{\\ddgc}{j+1} & =\\ddgc (t=(j+1) \\tstep) = \\frac{\\diff^2 \\gc(\\tau)}{\\diff \\tau^2}\\biggr|_{\\tau = 3\\tstep} = (18 \\tau C_1 + 2 C_2)\\bigr|_{\\tau=3\\tstep} \\\\\n& = \\ratio{2 \\dsct{\\gc}{j+1}-5 \\dsct{\\gc}{j}+4\\dsct{\\gc}{j-1}-\\dsct{\\gc}{j-2}}{\\tstep^2}\n\\end{align*}\\] which are in fact the finite difference approximations used for these two quantities in Houbolt’s method.\n\nEXAMPLE 4 .5\nTo illustrate how Houbolt’s method proceeds and to provide some comparison with the central difference method, let us consider the relatively simple problem of free vibrations.\nConsider an undamped system with frequency \\(\\freq\\), subjected to initial conditions \\(\\gc (0) = \\gc_o\\) and \\(\\dgc (0) = 0\\), so that it is governed by \\[\n\\ddgct + \\freq^2 \\gct = 0, \\quad \\left\\{\\gc (0) = \\gc_o, \\dgc (0) = 0\\right\\}\n\\] and its response is given by \\[\n\\gct = \\gc_o \\cos \\freq t\n\\] This response with a single known period and amplitude will allow a direct observation of any period elongation or artificial damping introduced by a numerical method. Since the right hand side of the equation is zero, the problem represents all undamped and unforced linear SDOF systems, and the results may be discussed in terms of the ratio of the time step to the period of the system. Here we will discuss the estimates for three different time steps. To provide a numerical check for the reader for Houbolt’s method, for a time step of \\(\\tstep = 0.1 \\unit{seconds}\\) and \\(\\tstep / \\period = 0.01\\), the system’s frequency is calculated as \\(\\freq = 2 \\pi / 10\\), and the coefficients in Houbolt’s method for this undamped system are given by: \\[\n\\ratio{A_1}{m} = 200.394784, \\quad \\ratio{A_2}{m} = 500, \\quad \\ratio{A_3}{m} = -400, \\quad \\ratio{A_4}{m} = 100\n\\] Given the initial condition \\(\\dsct{\\gc}{0}=\\gc_o\\), the estimates for \\(\\dsct{\\gc}{-1}\\) and \\(\\dsct{\\gc}{1}\\) are calculated using the central difference approximations to obtain \\[\n\\ratio{\\dsct{\\gc}{-1}}{\\gc_o} = 1.001974, \\quad \\ratio{\\dsct{\\gc}{1}}{\\gc_o} = 0.994078\n\\] Once these two values are calculated, the recursive equation of Houbolt’s method may be employed to obtain estimates for \\(\\dsct{\\gc}{2}, \\dsct{\\gc}{3}, \\ldots\\). Displacement estimates for the first few time steps are calculated as \\[\\begin{align*}\n\\ratio{\\dsct{\\gc}{2}}{\\gc_o} & = 0.984240, \\quad \\ratio{\\dsct{\\gc}{3}}{\\gc_o} = 0.970527 \\\\\n\\ratio{\\dsct{\\gc}{4}}{\\gc_o} & = 0.952996, \\quad \\ratio{\\dsct{\\gc}{5}}{\\gc_o} = 0.931717 \\\\\n\\ratio{\\dsct{\\gc}{6}}{\\gc_o} & = 0.906774, \\quad \\ratio{\\dsct{\\gc}{7}}{\\gc_o} = 0.878266 \\\\\n\\ratio{\\dsct{\\gc}{8}}{\\gc_o} & = 0.846304, \\quad \\ratio{\\dsct{\\gc}{9}}{\\gc_o} = 0.811014\n\\end{align*}\\]\nHow the two phenomena previously discussed become more or less pronounced with increasing time step size is quite easily observed in the plots of Figure 4.15. These three plots show the variation of the displacement response, normalized by the maximum displacement (which is equal to the initial displacement), for the first four cycles of oscillation. The solid line in these plots show the response calculated via the analytical solution. The hollow circles are the response values calculated with the central difference method, and the plus signs mark those calculated with Houbolt’s method.\n\n\n\nFigure 4.15: The free vibration of undamped SDOF systems subjected to initial displacement \\(\\dsct{\\gc}{o}\\) calculated using the analytical solution (solid line), the central difference method (circles) and Houbolt’s method (stars). (a) \\(\\tstep /\\period = 0.01\\), (a) \\(\\tstep / \\period = 0.05\\), (c) \\(\\tstep / \\period = 0.1\\). Plots presented for normalized displacements and normalized time.\n\n\nFor a relatively small time step such as \\(\\tstep / \\period = 0.01\\), both methods provide good estimates for the analytical solution, although some errors are present as would be observed if one were to zoom in. Period elongations or artificial damping are not perceptible in the four cycles although they are present albeit in negligible amounts. These effects become more pronounced with increasing time step size. For the time step of \\(\\tstep / \\period = 0.05\\), the two methods lead to perceptibly different results in that the central difference method leads to period shortening (its estimates slightly lagging the analytical solution) and Houbolt’s method leads to period elongation (its estimates slightly leading the analytical solution). With the time step of \\(\\tstep / \\period = 0.10\\), the trend becomes painfully obvious. The errors in the central difference estimates increase relative to those of smaller time steps, yet the algorithm does not have any artificial damping since the response amplitudes remain quite consistent. In comparison, the artificial damping in Houbolt’s approach looks quite detrimental and the amplitude estimate by the end of the fourth cycle is about half of the analytical response. Both algorithms reflect increasing errors in period estimates with the period shortening (central difference method) and elongation (Houbolt’s method) effects becoming even more pronounced with increasing time step size.\nThis of course is just one simple illustration of the critical issues in numerical integration and it is by no means conclusive. A thorough analysis requires analytical investigations of the numerical techniques but we refrain from further analysis as such an in depth critique is not the main focus here. The brief discussion in Section 4.4 and the references cited therein should give a flavour of what such an in depth analysis requires. It may however be pertinent to note that the complexity of a numerical integration scheme does not necessarily guarantee accuracy. Being a higher order finite difference technique, one may initially suppose that Houbolt’s method would outperform the central difference method in all cases but this presupposition is clearly not well founded as exemplified by the observations above.\n\n\n\n\nJ.C. Houbolt, A Recurrence Matrix Solution for the Dynamic Response of Aircraft in Gusts, NACA Technical Report 1010, 1951.↩︎"
  },
  {
    "objectID": "numericalsdof.html#sec-newmark",
    "href": "numericalsdof.html#sec-newmark",
    "title": "4  Numerical Solutions of the SDOF Equation of Motion",
    "section": "4.6 Newmark’s Method",
    "text": "4.6 Newmark’s Method\nA family of algorithms proposed by Newmark8 have proven to be quite popular with their intrinsic properties and their relation to various existing approaches. The approach is designed to employ information pertaining to acceleration at time step \\((j+1)\\) step while solving for the velocity and displacement at time step \\((j+1)\\). Since the information at step \\((j+1)\\) is not available at the end of the \\(j\\)-th step, such an approach in principle requires an initial prediction and then subsequent corrections of the future value. In this sense, Newmark’s method essentially belongs to a family known as predictor-corrector methods.\n\n4.6.1 General Formulation\nNewmark’s formulation is based on the following estimation equations: \\[\n\\begin{array}{lc}\n\\dsct{\\dgc}{j+1} = \\dsct{\\dgc}{j} + (1-\\gamma) \\tstep \\dsct{\\ddgc}{j} + \\gamma \\tstep \\dsct{\\ddgc}{j+1} & \\text{(a)}\\\\\n\\dsct{\\gc}{j+1} = \\dsct{\\gc}{j} + \\tstep \\dsct{\\dgc}{j} + \\left(\\frac{1}{2} - \\beta\\right)\\tstep^2 \\dsct{\\ddgc}{j} + \\beta \\tstep^2 \\dsct{\\ddgc}{j+1}  & \\text{(b)}\n\\end{array}\n\\qquad(4.17)\\]\nIn principle, \\(\\gamma\\) and \\(\\beta\\) are two free parameters that may be chosen by the analyst. Soon after the method was introduced, however, it became clear that unless \\(\\gamma = 1/2\\), artificial damping is introduced and that this damping is proportional to \\((\\gamma - 1/2)\\). Therefore it has become the mode of operation to take \\(\\gamma=1/2\\) and cast Newmark’s method as \\[\n\\begin{array}{lc}\n\\dsct{\\dgc}{j+1} = \\dsct{\\dgc}{j} + \\ratio{\\tstep}{2} \\dsct{\\ddgc}{j} + \\ratio{\\tstep}{2} \\dsct{\\ddgc}{j+1} & \\text{(a)}\\\\\n\\dsct{\\gc}{j+1} = \\dsct{\\gc}{j} + \\tstep \\dsct{\\dgc}{j} + \\left(\\frac{1}{2} - \\beta\\right) \\tstep^2 \\dsct{\\ddgc}{j} + \\beta \\tstep^2 \\dsct{\\ddgc}{j+1}  & \\text{(b)}\n\\end{array}\n\\qquad(4.18)\\] With dependence on only the single parameter \\(\\beta\\), this formulation is often referred as the Newmark-\\(\\beta\\) Method.\nUsing the estimations from Equation 4.18, the equilibrium equation is written at time step \\(j+1\\) so that \\[\nm \\dsct{\\ddgc}{j+1} + c \\dsct{\\dgc}{j+1} + k \\dsct{\\gc}{j} = \\dsct{\\extforce}{j+1}\n\\] and the acceleration term is solved for using \\[\n\\dsct{\\ddgc}{j+1}  = \\ratio{1}{m} \\dsct{\\extforce}{j+1} - \\ratio{c}{m} \\dsct{\\dgc}{j+1} - \\ratio{k}{m} \\dsct{\\gc}{j} = \\ratio{1}{m} \\dsct{\\extforce}{j+1} - 2 \\damp \\freq \\dsct{\\dgc}{j+1} - \\freq^2 \\dsct{\\gc}{j}\n\\qquad(4.19)\\] Herein lies the fundamental issue: to calculate \\(\\dsct{\\dgc}{j+1}\\) and \\(\\dsct{\\gc}{j+1}\\) via Equation 4.18 we need to know \\(\\dsct{\\ddgc}{j+1}\\), which in turn is to be calculated via Equation 4.19 using \\(\\dsct{\\dgc}{j+1}\\) and \\(\\dsct{\\gc}{j+1}\\)! Essentially Equation 4.18 is the predictor and Equation 4.19 is the corrector, and in one formulation of the method the acceleration is iteratively improved until convergence (within a desired tolerance) is achieved. To discuss how such iterations proceed, say that all response variables have been calculated for time step \\(j\\) so that \\(\\dsct{\\gc}{j}\\), \\(\\dsct{\\dgc}{j}\\) and \\(\\dsct{\\ddgc}{j}\\) are known. An initial estimate of \\(\\dsct{\\ddgc}{j+1}\\) is used to calculate initial estimates for \\(\\dsct{\\dgc}{j+1}\\) and \\(\\dsct{\\gc}{j+1}\\). Let these initial estimates be denoted by \\[\n\\edsct{\\ddgc}{j+1}{0}, \\quad \\edsct{\\dgc}{j+1}{0}, \\quad \\edsct{\\gc}{j+1}{0}\n\\] so that \\[\\begin{align*}\n\\edsct{\\dgc}{j+1}{0} & = \\dsct{\\dgc}{j} + \\ratio{\\tstep}{2} \\dsct{\\ddgc}{j} + \\ratio{\\tstep}{2} \\edsct{\\ddgc}{j+1}{0} \\\\\n\\edsct{\\gc}{j+1}{0} & = \\dsct{\\gc}{j} + \\tstep \\dsct{\\dgc}{j} + (\\frac{1}{2} - \\beta) \\tstep^2 \\dsct{\\ddgc}{j} + \\beta \\tstep^2 \\edsct{\\ddgc}{j+1}{0}\n\\end{align*}\\] These initial estimates are used to calculate the next estimate \\(\\edsct{\\ddgc}{j+1}{1}\\) using the equilibrium equation at time step \\((j+1)\\); for example, for a linear system, this equation would be \\[\n\\edsct{\\ddgc}{j+1}{1}  = \\ratio{1}{m} \\dsct{\\extforce}{j+1} - \\ratio{c}{m} \\edsct{\\dgc}{j+1}{0} - \\ratio{k}{m} \\edsct{\\gc}{j+1}{0}\n\\] and we check whether \\[\n\\edsct{\\dgc}{j+1}{1} - \\edsct{\\dgc}{j+1}{0} \\leq \\text{predetermined tolerance}\n\\] If this condition is satisfied, then desired accuracy is reached and we set \\[\n\\dsct{\\ddgc}{j+1} = \\edsct{\\ddgc}{j+1}{1}\n\\] and calculate \\[\\begin{align*}\n\\dsct{\\dgc}{j+1}  & = \\dsct{\\dgc}{j} + \\ratio{\\tstep}{2} \\dsct{\\ddgc}{j} + \\ratio{\\tstep}{2} \\dsct{\\ddgc}{j+1} \\\\\n\\dsct{\\gc}{j+1} & = \\dsct{\\gc}{j} + \\tstep \\dsct{\\dgc}{j} + (\\frac{1}{2} - \\beta) \\tstep^2 \\dsct{\\ddgc}{j} + \\beta \\tstep^2 \\dsct{\\ddgc}{j+1}\n\\end{align*}\\] but if the condition is not satisfied, then we calculate the next estimates \\(\\edsct{\\dgc}{j+1}{1}\\) and \\(\\edsct{\\gc}{j+1}{1}\\) using the most recent estimate \\(\\edsct{\\ddgc}{j+1}{1}\\) via \\[\\begin{align*}\n\\edsct{\\dgc}{j+1}{1} & = \\dsct{\\dgc}{j} + \\ratio{\\tstep}{2} \\dsct{\\ddgc}{j} + \\ratio{\\tstep}{2} \\edsct{\\ddgc}{j+1}{1} \\\\\n\\edsct{\\gc}{j+1}{1} & = \\dsct{\\gc}{j} + \\tstep \\dsct{\\dgc}{j} + (\\frac{1}{2} - \\beta) \\tstep^2 \\dsct{\\ddgc}{j} + \\beta \\tstep^2 \\edsct{\\ddgc}{j+1}{1}\n\\end{align*}\\] and repeat the iterations until convergence is achieved.\nIt is possible to formulate the Newmark-\\(\\beta\\) method without the need for iterations. For this we need to formulate the equilibrium equation in terms of the displacement, which requires the velocity and acceleration quantities to be expressed in terms of the unknown displacement and other known quantities. Note that using Equation 4.18, \\(\\dsct{\\ddgc}{j+1}\\) and \\(\\dsct{\\dgc}{j+1}\\) may be expressed in terms of \\(\\dsct{\\gc}{j+1}\\) and response quantities of time step \\(j\\) as \\[\n\\begin{array}{lc}\n\\dsct{\\ddgc}{j+1} = \\ratio{1}{\\beta \\tstep^2} \\dsct{\\gc}{j+1} - \\ratio{1}{\\beta \\tstep^2} \\dsct{\\gc}{j} - \\ratio{1}{\\beta \\tstep}  \\dsct{\\dgc}{j} + \\left(1 - \\ratio{1}{2 \\beta} \\right) \\dsct{\\ddgc}{j} & \\text{(a)}\\\\\n\\dsct{\\dgc}{j+1} = \\ratio{1}{2\\beta \\tstep} \\dsct{\\gc}{j+1} - \\ratio{1}{2\\beta \\tstep} \\dsct{\\gc}{j} + \\left(1 - \\ratio{1}{2 \\beta} \\right) \\dsct{\\dgc}{j} + \\left(1 - \\ratio{1}{4 \\beta} \\right) \\tstep \\dsct{\\ddgc}{j}  & \\text{(b)}\n\\end{array}\n\\qquad(4.20)\\] With these estimates, the equilibrium equation at time step \\((j+1)\\) for a viscously damped SDOF system yields \\[\\begin{align*}\nm \\dsct{\\ddgc}{j+1} & + c \\dsct{\\dgc}{j+1} + k \\dsct{\\gc}{j+1} = \\\\\n& m \\left[ \\ratio{1}{\\beta \\tstep^2} \\dsct{\\gc}{j+1} - \\ratio{1}{\\beta \\tstep^2} \\dsct{\\gc}{j} - \\ratio{1}{\\beta \\tstep}  \\dsct{\\dgc}{j} + \\left(1 - \\ratio{1}{2 \\beta} \\right) \\dsct{\\ddgc}{j} \\right] \\\\\n& \\phantom{XX} + c \\left[ \\ratio{1}{2\\beta \\tstep} \\dsct{\\gc}{j+1} - \\ratio{1}{2\\beta \\tstep} \\dsct{\\gc}{j} + \\left(1 - \\ratio{1}{2 \\beta} \\right) \\dsct{\\dgc}{j} + \\left(1 - \\ratio{1}{4 \\beta} \\right)\\tstep \\dsct{\\ddgc}{j} \\right] \\\\\n& \\phantom{XXXX} + k \\dsct{\\gc}{j+1} = \\dsct{\\extforce}{j+1}\n\\end{align*}\\] and rearranging the equation leads to \\[\n    A_1 \\dsct{\\gc}{j+1} =  \\dsct{\\extforce}{j+1} + A_2  \\dsct{\\gc}{j} + A_3  \\dsct{\\dgc}{j}+ A_4  \\dsct{\\ddgc}{j}\n\\qquad(4.21)\\] where \\[\n\\begin{array}{l}\n    A_1  = k + \\ratio{m}{\\beta \\tstep^2} + \\ratio{c}{2\\beta \\tstep} = k \\left[1 + \\ratio{1}{\\beta(\\freq \\tstep)^2} + \\ratio{\\damp }{\\beta (\\freq \\tstep)}\\right]\\\\\n    A_2  = \\ratio{m}{\\beta \\tstep^2} + \\ratio{c}{2 \\beta \\tstep} = k \\left[\\ratio{1}{\\beta(\\freq \\tstep)^2} + \\ratio{\\damp }{\\beta (\\freq \\tstep)}\\right]\\\\\n    A_3  = \\ratio{m}{\\beta \\tstep} + {c}\\left(\\ratio{1}{2 \\beta} - 1 \\right) = \\ratio{k}{\\freq} \\left[\\ratio{1}{\\beta(\\freq \\tstep)} +  \\left(\\ratio{\\damp }{\\beta} - 2 \\damp\\right)\\right]\\\\\n    A_4  = m \\left(\\frac{1}{2 \\beta} -1 \\right) + c \\tstep \\left(\\frac{1}{4 \\beta} - 1 \\right)= \\ratio{k}{\\freq^2} \\left[\\ratio{1}{2 \\beta} - 1 +  2 \\damp (\\freq \\tstep) \\left(\\ratio{1}{4  \\beta} - 1\\right)\\right]\n\\end{array}\n\\qquad(4.22)\\] The flow of the algorithm for Newmark’s method as it would be applied to viscously damped linear SDOF systems is shown below.\n\n\n\n\n\n\nPseudocode for Newmark’s Method (Newmark-\\(\\beta\\))\n\n\n\nviscously damped SDOF system, for constant time step\nInput: \\(m\\), \\(\\damp\\) (or \\(c\\)), \\(k\\), \\(\\beta\\), \\(\\tstep\\), \\(\\dsct{\\gc}{0}\\), \\(\\dsct{\\dgc}{0}\\), \\(\\left\\{\\dsct{\\extforce}{0}, \\ldots, \\dsct{\\extforce}{l} \\right\\}\\)\nInitialize: calculate\n\\(\\phantom{xxxxxxxxxx}\\) \\(A_1,A_2,A_3\\) and \\(A_4\\) using Equation 4.22, \\(A_1^{-1}\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(A_5=\\frac{1}{2\\beta \\tstep}\\), \\(A_6 = 1 - \\frac{1}{2\\beta}\\), \\(A_7 = \\tstep \\left(1 - \\frac{1}{4 \\beta}\\right)\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(A_8= \\frac{1}{\\beta \\tstep^2}\\), \\(A_9 = - \\frac{1}{\\beta \\tstep}\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\ddgc}{0} = \\frac{1}{m}(\\dsct{\\extforce}{0} - c \\dsct{\\dgc}{0} - k\\dsct{\\gc}{0})\\)\nfor \\(j=0,\\ldots,l-1\\):\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\gc}{j+1} = A_1^{-1}(\\dsct{\\extforce}{j+1} + A_2 \\dsct{\\gc}{j} + A_3 \\dsct{\\dgc}{j} + A_4 \\dsct{\\ddgc}{j})\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\dgc}{j+1} = A_5 (\\dsct{\\gc}{j+1} - \\dsct{\\gc}{j} ) + A_6 \\dsct{\\dgc}{j} + A_7 \\dsct{\\ddgc}{j}\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\ddgc}{j+1} = A_8 (\\dsct{\\gc}{j+1} - \\dsct{\\gc}{j}) + A_9 \\dsct{\\dgc}{j} + A_6 \\dsct{\\ddgc}{j}\\)\n\n\n\n\n\nFigure 4.16: Pseudocode for Newmark’s method.\n\n\nNewmark’s method is self starting in that initial conditions suffice to begin the iterations (along with \\(\\dsct{\\ddgc}{0}\\), which itself is calculated based on \\(\\dsct{\\dgc}{0}\\) and \\(\\dsct{\\gc}{0}\\) alone). Its stability, however, depends on the value of \\(\\beta\\). This issue is what we discuss next, along with the relations between this framework and some previously developed methods which may be considered to be special cases of Newmark’s approach.\n\n\n\n\nN. M. Newmark and S.P. Chan, A Comparison of Numerical Methods for Analyzing the Dynamic Response of Structures, Civil Engineering Studies SRS-036, University of Illinois at Urbana-Champaign, 1952.  N.M. Newmark, A Method of Computation for Structural Dynamics, ASCE Journal of the Engineering Mechanics Division, Vol. 85, No. EM 3, pp. 67-94, 1959.↩︎\n\n\n\n4.6.2 Various Interpretations of Newmark’s Method\nNewmark’s formulation provides a general framework from which various methods developed previously may be derived as special cases. The free parameters \\(\\gamma\\) and \\(\\beta\\) are what makes this possible, and its value determines the nature of the assumed variation of acceleration within a time step. If, for example, \\(\\gamma = 0\\) and \\(\\beta=0\\), Newmark’s velocity and displacement approximations in Equation 4.17 yield \\[\\begin{align*}\n\\dsct{\\dgc}{j+1} & = \\dsct{\\dgc}{j} + \\tstep \\dsct{\\ddgc}{j} \\\\\n\\dsct{\\gc}{j+1} & = \\dsct{\\gc}{j} + \\tstep \\dsct{\\dgc}{j} + \\frac{1}{2} \\tstep^2 \\dsct{\\ddgc}{j}\n\\end{align*}\\] so that this choice is essentially equivalent to keeping the acceleration constant \\(j\\tstep \\leq t &lt; (j+1)\\tstep\\) at its value at time step \\(j\\). This approach, which is not so popular due to want of accuracy and stability, is called the constant acceleration method.\nNext, consider the case with \\(\\gamma=1/2\\) and \\(\\beta = 1/4\\). The approximations now yield \\[\n\\begin{array} {lc}\n\\dsct{\\dgc}{j+1} = \\dsct{\\dgc}{j} +  \\tstep \\frac{\\dsct{\\ddgc}{j} + \\dsct{\\ddgc}{j+1}}{2} =  \\dsct{\\dgc}{j} +  \\tstep \\ddgc_{avg} & \\text{(a)} \\\\\n\\dsct{\\gc}{j+1} = \\dsct{\\gc}{j} + \\tstep \\dsct{\\dgc}{j} + \\frac{1}{2} \\tstep^2 \\frac{\\dsct{\\ddgc}{j} + \\dsct{\\ddgc}{j+1}}{2} = \\dsct{\\gc}{j} + \\tstep \\dsct{\\dgc}{j} + \\frac{1}{2} \\tstep^2 \\ddgc_{avg} & \\text{(b)}\n\\end{array}\n\\qquad(4.23)\\] which amounts to assuming that the acceleration is constant for \\(j \\tstep \\leq t &lt; (j+1) \\tstep\\) at an average value of \\[\n\\ddgc_{avg} = \\frac{\\dsct{\\ddgc}{j} + \\dsct{\\ddgc}{j+1}}{2}\n\\] This approach is called the constant average acceleration method or, according to Newmark and Chan,9 Timoshenko’s modified acceleration method.\nFinally, when \\(\\gamma=1/2\\) and \\(\\beta = 1/6\\), the approximations yield \\[\n\\begin{array}{lc}\n\\dsct{\\dgc}{j+1} = \\dsct{\\dgc}{j} + \\frac{1}{2} \\tstep \\dsct{\\ddgc}{j} + \\frac{1}{2} \\tstep \\dsct{\\ddgc}{j+1} & \\text{(a)}\\\\\n\\dsct{\\gc}{j+1} = \\dsct{\\gc}{j} + \\tstep \\dsct{\\dgc}{j} + \\frac{1}{3} \\tstep^2 \\dsct{\\ddgc}{j} + \\frac{1}{6} \\tstep^2 \\dsct{\\ddgc}{j+1} & \\text{(b)}\n\\end{array}\n\\qquad(4.24)\\] These approximations are identical to those one would obtain if one were to assume that the acceleration varied linearly for \\(j\\tstep \\leq t &lt; (j+1)\\tstep\\) from a value of \\(\\dsct{\\ddgc}{j}\\) to a value of \\(\\dsct{\\ddgc}{j+1}\\) since if, for \\(\\tau = t - j \\tstep\\), \\[\n\\ddgc (\\tau) = \\dsct{\\ddgc}{j} + \\ratio{\\dsct{\\ddgc}{j+1} - \\dsct{\\ddgc}{j}}{\\tstep} \\tau\n\\] then integration leads to \\[\\begin{align*}\n\\dgc (\\tau) & = \\dsct{\\dgc}{j} + \\dsct{\\ddgc}{j} \\tau  + \\ratio{\\dsct{\\ddgc}{j+1} - \\dsct{\\ddgc}{j}}{2 \\tstep} \\tau^2 \\\\\n\\gc (\\tau) & = \\dsct{\\gc}{j} + \\dsct{\\dgc}{j} \\tau + \\ratio{1}{2} \\dsct{\\ddgc}{j} \\tau^2  + \\ratio{\\dsct{\\ddgc}{j+1} - \\dsct{\\ddgc}{j}}{6 \\tstep} \\tau^3\n\\end{align*}\\] which yield exactly the same expressions as those in Equation 4.24 for \\(\\tau = \\tstep\\); hence, this approach is called the linear acceleration method.\nIt is not surprising that the stability of Newmark’s method depends on the values of \\(\\gamma\\) and \\(\\beta\\). Consider the commonly used case with \\(\\gamma = 1/2\\) and recall the discussion of Section 4.4. For an undamped system,10 it is possible to construct a state space model in the form \\[\n\\dscs{j} = \\colmat{\\dsct{\\gc}{j} \\\\ \\dsct{\\dgc}{j} \\\\\\dsct{\\ddgc}{j}}\n\\] so that Newmark’s estimates may be cast into state space format as \\[\n\\dscs{j+1} = \\dscA \\dscs{j} + \\dscB \\dscf{j+1}\n\\] where, for \\(\\eta=\\freq \\tstep\\), the state transition matrix is given by \\[\n\\dscA = \\begin{bmatrix}  \n1 - \\frac{\\beta \\eta^2}{1+\\beta \\eta^2} & \\tstep \\left( 1 - \\frac{\\beta \\eta^2}{1+\\beta \\eta^2} \\right) & \\tstep^2 (\\beta - \\frac{1}{2}) \\left( \\frac{\\beta \\eta^2 }{1+\\beta \\eta^2} -1 \\right) \\\\\n-\\frac{1}{\\tstep}\\frac{\\eta^2}{2(1+\\beta \\eta^2)} & 1- \\frac{\\eta^2}{2(1+\\beta \\eta^2)} & \\tstep \\left(\\frac{\\eta^2(\\beta-1/2)}{2(1+\\beta \\eta^2)} + \\frac{1}{2}\\right) \\\\\n- \\frac{1}{\\tstep^2} \\frac{\\eta^2}{1+\\beta \\eta^2} & - \\frac{1}{\\tstep} \\frac{\\eta^2}{1+\\beta \\eta^2} & \\frac{\\eta^2(\\beta-1/2)}{1+\\beta \\eta^2}\n\\end{bmatrix}\n\\] This matrix has three eigenvalues, one of which is \\(\\lambda_3 = 0\\). The other two are given by \\[\n\\lambda_{1,2} = 1 - \\frac{\\eta^2}{2(1+\\beta \\eta^2)} \\pm \\frac{\\eta}{2(1+\\beta \\eta^2)} \\sqrt{\\eta^2 - 4 \\beta \\eta^2 - 4}\n\\] Stability of the system is governed by the magnitude of the largest eigenvalue, called the spectral radius, as discussed in Section 4.4. For \\(\\beta = 1/4\\), we have \\[\n\\abs{\\lambda_{1}}= \\abs{\\lambda_{2}} = 1\n\\] so that the constant average acceleration method (Newmark’s method with \\(\\gamma = 1/2, \\beta = 1/4\\)) is unconditionally stable. For \\(\\beta = 1/6\\), the eigenvalues are given by \\[\n\\lambda_{1,2} = 1 - \\frac{3\\eta^2}{(6+\\eta^2)} \\pm \\frac{2\\eta}{(6+ \\eta^2)} \\sqrt{\\frac{\\eta^2}{3}- 4}\n\\]\n\n\n\nFigure 4.17: Spectral radii for two commonly employed Newmark-\\(\\beta\\) methods as a function of the ratio of the time step \\(h\\) to the period \\(T\\) of the undamped SDOF system.\n\n\nWhen \\(\\eta^2 = 12\\), we have \\(\\lambda_{1} = \\lambda_{2} = -1\\), and this in fact is the transition point from a stable to an unstable scheme since for \\(\\eta^2 &gt; 12\\) the spectral radius, i.e. the largest value of the magnitude of the eigenvalues, will exceed \\(1\\). The stability condition is therefore \\[\n\\eta^2 = (\\freq \\tstep)^2 = \\left(\\frac{2 \\pi }{\\period}\\tstep \\right)^2 \\leq 12 \\quad \\rightarrow \\quad \\frac{\\tstep}{\\period} \\leq \\frac{\\sqrt{3}}{\\pi} \\approx 0.551\n\\] and the linear acceleration method (Newmark’s method with \\(\\gamma = 1/2, \\beta = 1/6\\)) is conditionally stable. The variation of the spectral radii for the two methods is shown in Figure 4.17.\n\n\n\n\nN.M. Newmark and S.P. Chan, A Comparison of Numerical Methods for Analyzing the Dynamic Response of Structures, Civil Engineering Studies SRS-036, University of Illinois at Urbana-Champaign, 1952.↩︎\nFor a more detailed discussion with linear viscous damping included see, e.g., Chapter 9 in K.-J. Bathe, Finite Element Procedures, Prentice Hall, 1996.↩︎"
  },
  {
    "objectID": "numericalsdof.html#numerical-integration-for-nonlinear-sdof-systems",
    "href": "numericalsdof.html#numerical-integration-for-nonlinear-sdof-systems",
    "title": "4  Numerical Solutions of the SDOF Equation of Motion",
    "section": "4.7 Numerical Integration for Nonlinear SDOF Systems",
    "text": "4.7 Numerical Integration for Nonlinear SDOF Systems\nA predominant assumption in most structural engineering practice is that for small deformations and displacements, the structural members behave as linear elastic materials and geometric changes are small so as to not give rise to any sources of geometric nonlinearity. That said, in applications such as seismic design where extreme events like strong ground motions from rare earthquakes must be considered, linear elastic behavior is most probably not a valid assumption. The current design principles stipulate that overconservative approaches leading to structures that remain linear elastic even under extreme loadings may yield suboptimum/uneconomical designs.11\n\n\n\nFigure 4.18: a) Linear vs. nonlinear behavior of structural elements. b) Elastic-perfectly plastic assumption, where material stiffness vanishes past the yield point but elastic response is recovered as the displacement direction reverses.\n\n\nMost notably in the context of seismic design, it is reasonable to assume that structural members may undergo yielding and permanent deformations, and in doing so dissipate great amounts of energy through mechanisms such as cracking and spalling, yielding of joints and reinforcement bars, shearing of gusseted connections etc. The concept of nonlinear response and energy dissipation are schematically illustrated in Figure 4.18. The energy dissipated in a hysteretic cycle is the area enclosed by the hysteresis loop and dissipation through plastic deformations may reach levels much more prominent than the dissipation provided solely by the viscous damping model. It is therefore important to understand how yielding behavior and other nonlinearities in the load-bearing members would influence the response of the structure. In the context of SDOF systems, maximum relative or absolute displacement observed under an excitation may be important design considerations. Intuitively, we can imagine that yielding beyond a critical point may promote additional energy dissipation and thereby reduce maximum displacement, at the expense of resulting in some permanent deformation. A member that yields at a relatively low critical level of force however may result in excessive deformations, either transient and permanent, and these may reach unallowable levels for design purposes. Even for a simple SDOF system in which the nonlinear behavior of the material is idealized as elastic-perfectly plastic, often shortly referred to as elastoplastic, the response depends on the loading and deformation time-history, yield strength and other parameters, and thus generalized analytical solutions are elusive. Numerical methods presented in the previous sections, however, are broadly applicable to situations where structural members behave nonlinearly.\nThere has been much progress in our understanding of the behavior of nonlinear systems in recent decades, which has allowed identification of simple design rules that allow us to predict the expected total response of structures without any nonlinear analysis. These rules of thumb commonly employed in building codes have been based on documented behavior of nonlinear response of buildings from simulations and thereby projecting outcomes based on their elastic properties and approximated yield response. In doing so, engineers have simplified seismic design in building codes to the extent that nonlinear analysis is often not mandatory and dynamical response variables may be estimated from linear analysis on the basis of typical expectations of ground motions in a region, soil properties, and the degree to which the system may safely exhibit ductility without loss of all load bearing capacity. Nevertheless, simulation of nonlinear systems remains an important topic, at a minimum to reinforce the underpinnings of these design methods and in many instances to attain more accurate and economical structural solutions.\nIn this section, we will revisit a couple of the methods presented previously, the central difference method and the Newmark-\\(\\beta\\) approach to illustrate their application to nonlinear systems.\n\n4.7.1 Central Difference Method for Nonlinear SDOF Systems\nThe approximations presented in Equation 4.8 and Equation 4.9 for the central difference method are readily adopted to study nonlinear systems as well, since these are simply mathematical approximations of the basic variables describing the motion of the system in time. That said, it will be shown later that system characteristics such as the yield point will influence the accuracy of the method relative to other numerical methods. CDM is arguably the easiest method to apply to nonlinear systems given the simplicity of the algorithm and transferability to a generalized scenario where the spring term behaves nonlinearly. On the other hand, given its explicit nature, it is prone to error as it will generally have difficulty accurately reproducing member forces around the yielding point.\nThe generalized nonlinear equation of motion for SDOF systems subject to an external forced excitation may be expressed as \\[\nm \\ddgct + \\extforce' (\\gct, \\dgct) = \\extforcet\n\\qquad(4.25)\\] but often (unless structural elements such as suppplemental dampers make it necessary) it is assumed that the velocity dependent damping term may be modeled by the linear viscous damping model so that the governing equation is expressed as: \\[\nm \\ddgct + c \\dgct + \\stifforce (\\gct) = \\extforcet\n\\qquad(4.26)\\] If, for example, the excitation is ground motion, then the equation of motion will be given by \\[\nm \\ddgct + c \\dgct + \\stifforce (\\gct) = - m \\gacct\n\\qquad(4.27)\\] and in discretized form, equilibrium at time step \\(j\\) will require \\[\nm \\dsct{\\ddgc}{j} + c \\dsct{\\dgc}{j} + \\dsct{\\left\\{\\stifforce (\\gc)\\right\\}}{j} = \\dsct{\\extforce}{j}\n\\qquad(4.28)\\] In these equations, \\(\\stifforce\\) represents the nonlinear spring force and in general it is a function of the displacement time history \\(\\gct\\) up until the current time. If the central difference approximations of Equation 4.8 and Equation 4.9 are employed and the displacement at time step \\(j+1\\) is isolated as the unknown as was done in linear analysis, one gets \\[\nA_1 \\dsct{\\gc}{j+1} = \\dsct{\\extforce}{j}  - A_2 \\dsct{\\gc}{j} - A_3 \\dsct{\\gc}{j-1} -  \\dsct{\\left\\{\\stifforce (\\gc) \\right\\}}{j}\n\\qquad(4.29)\\] where \\[\n\\begin{array}{l}\n  A_1 = {\\ratio{m}{\\tstep^2} + \\ratio{c}{2 \\tstep}}  \\\\\n  A_2 = - \\ratio{2m}{\\tstep^2} \\\\\n  A_3 = \\ratio{m}{\\tstep^2} - \\frac{c}{2 \\tstep}  \\\\\n  (\\text{and for use further down the line: }A_4 = \\ratio{1}{2\\tstep}, \\; A_5 = \\ratio{1}{\\tstep^2})\n\\end{array}\n\\qquad(4.30)\\]\n\nNote that the definition of \\(A_2\\) is different than its previous version used in linear systems since the spring force now appears separately in \\(\\stifforce (\\gc)\\) Once again, for a constant time step \\(\\tstep\\), all of the coefficients \\(A_i\\) are to be calculated only once. At each time step, the velocity is to be calculated from the central difference approximation in Equation 4.9, which may be written in discrete form as \\[\n  \\dsct{\\dgc}{j} = \\frac{1}{2\\tstep}(\\dsct{\\gc}{j+1} - \\dsct{\\gc}{j-1}) = A_4 (\\dsct{\\gc}{j+1} - \\dsct{\\gc}{j-1})\n\\qquad(4.31)\\]  and the acceleration may be calculated using the equilibrium equation for that time step given by \\[\nm \\dsct{\\ddgc}{j} = \\dsct{\\extforce}{j} - c \\dsct{\\dgc}{j} - \\dsct{\\left\\{\\stifforce (\\gc) \\right\\}}{j}\n\\qquad(4.32)\\] or from the central difference approximation given by \\[\n\\dsct{\\ddgc}{j} = \\frac{\\dsct{\\gc}{j+1}- 2 \\dsct{\\gc}{j} + \\dsct{\\gc}{j-1}}{\\tstep^2} = A_5 (\\dsct{\\gc}{j+1}- 2 \\dsct{\\gc}{j} + \\dsct{\\gc}{j-1})\n\\qquad(4.33)\\] \nThe nonlinear spring force \\(\\stifforce\\) will generally depend on the model used for describing the nonlinearity of the element. For the idealized case of an elastic-perfectly-plastic spring subject to loading cycle as shown in Figure 4.18, member deforms elastically up to the yield point, in which case the force generated is \\(\\stifforce = k \\gc\\). In the post-yield regime, force generated by the member remains constant \\(\\stifforce = \\yieldforce\\). When the unloading begins, which may be determined based on the direction (sign) of velocity, the spring force follows a straight path parallel to the initial loading line. Once the unloading reaches a level such that yielding is initiated in the opposite direction, the spring force once again takes on a constant value, given now by \\(\\stifforce = - \\yieldforce\\). This loading - unloading sequence goes on as the direction of velocity is reversed. An example pseudo-code is provided below for the special case of perfect elastoplastic SDOF systems with viscous damping.\n\n\n\n\n\n\nPseudocode for the Central Difference Method for Nonlinear Systems\n\n\n\nviscously damped SDOF system with nonlinear spring, for constant time step\nInput: \\(m\\), \\(\\damp\\) (or \\(c\\)), \\(\\stifforce (\\gc)\\) (or for elastoplastic, \\(k\\), and \\(f_y\\) or \\(q_y\\)), \\(\\tstep\\), \\(\\dsct{\\gc}{0}\\), \\(\\dsct{\\dgc}{0}\\), \\(\\left\\{\\dsct{\\extforce}{0}, \\ldots, \\dsct{\\extforce}{l} \\right\\}\\)\nInitialize: calculate\n\\(\\phantom{xxxxxxxxxx}\\) \\(A_1,A_2,A_3\\), \\(A_4\\) and \\(A_5\\) using Equation 4.30, \\(A_1^{-1}\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\ddgc}{0} = \\frac{1}{m}(\\dsct{\\extforce}{0} - c \\dsct{\\dgc}{0} - \\dsct{\\left\\{\\stifforce (\\gc) \\right\\}}{0})\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\gc}{-1} = \\dsct{\\gc}{0} - \\tstep \\dsct{\\dgc}{0} - \\frac{\\tstep^2}{2} \\dsct{\\ddgc}{0}\\)\nfor \\(j=0,\\ldots,l-1\\):\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\gc}{j+1} = A_1^{-1} \\left(\\dsct{\\extforce}{j}- A_2 \\dsct{\\gc}{j} - A_3 \\dsct{\\gc}{j-1} - \\dsct{\\left\\{\\stifforce (\\gc) \\right\\}}{j}\\right)\\)\nfor \\(j=1,\\ldots,l-1\\):\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\dgc}{j} = A_4(\\dsct{\\gc}{j+1} - \\dsct{\\gc}{j-1})\\)\n\\(\\phantom{xxxxxxxxxx}\\) \\(\\dsct{\\ddgc}{j} = A_5 (\\dsct{\\gc}{j+1}- 2 \\dsct{\\gc}{j} + \\dsct{\\gc}{j-1})\\)\n\n\n\n\n\nFigure 4.19: Pseudocode for the Central Difference Method for Nonlinear Systems.\n\n\n\n\nEXAMPLE 4 .6\nTo identify some fundamental behavioral concepts, consider the analysis of an elastoplastic toy model with mass \\(m=1\\) kg, viscous damping ratio \\(\\damp = 0.05\\), and initial undamped period \\(\\period=1 \\unit{second}\\), subject to a cyclic base acceleration given as \\(\\gacc (t) = \\sin{\\freq t} \\unit{m/s^2}\\). If the yield limit is \\(\\yieldforce = 3 \\unit{N}\\) and similar behavior is observed in tension and compression, what will be the maximum displacement?\nThe response of this model is calculated via CDM with an example code and the maximum displacement is found to be \\(0.098 \\unit{m}\\). The code illustrates the simplicity of the central difference algorithm, owing to the explicit nature of the approach, which makes calculations of the spring force easy as they only depend on the previous time step. The implementation, however, has relatively low accuracy, especially in systems where there is an abrupt change in stiffness due to yielding. The elastoplastic case is an extreme example in this regard, since the post-yield stiffness is zero.\nSome important physical insights can be gained from this simple example. First, the yielding behavior of the elastoplastic system provides energy dissipation through hysteresis, with the size of the hysteresis loop giving us a sense of energy dissipated in each cycle. In this particular case, the dissipation energy in viscous and spring forces are comparable, and this helps further reduce the peak displacement of the system relative to the purely elastic case (\\(0.098 \\unit{m}\\) vs. \\(0.253 \\unit{m}\\) for elastic). Figure 4.1 illustrates these findings. These observations support the notion that yielding of elements may provide an economical way of reducing peak displacements under strong dynamic excitations, i.e. ground motion. The caveat, however, is that there is permanent deformation, which can be calculated from the mean of the steady state response, which in the case of harmonic deformation is small. As \\(\\yieldforce\\) is reduced, more energy can be dissipated, up to a practical limit beyond which either the hysteresis loop becomes too small and peak displacements increase, or plastic deformations become excessively large. The degree of plastic deformation will be proportional to the ratio of the peak displacement recorded in the linear elastic case vs. \\(\\yieldforce/k\\), that is the displacement limit for yield. We will consider this ratio further in seismic design, to be visited in later chapters. These concepts can be further explored in the case of harmonic excitation by modifying the example code provided, for instance to explore how yield limit, excitation characteristics, and viscous damping parameters influence the relative role of yielding on reducing peak displacements.\n\n\n\nFigure 4.20: a) Example displacement time history for an elastoplastic system subject to harmonic ground excitation; b) spring force vs. displacement showing the hysteresis loop; c) damping force vs. displacement, showing viscous dissipation. The Python scripts used to calculate the response can be found here.\n\n\n\n\n\n\nThere is much to say about this with many recent earthquakes demonstrating that the social and economic losses that accumulate after significant earthquakes may reach devastating levels. ``Resilience’’ is likely to be a central concept in the coming years.↩︎\n\n\n\n\n4.7.2 Newmark’s Method for Non-linear Systems\nWhile explicit methods such as central difference are easy to implement for nonlinear systems, implicit approaches are often preferred due to their higher accuracy and stability. In this context, the Newmark family of algorithms are quite popular, and they will be briefly discussed in this section to exemplify how their implementation in nonlinear cases differs from linear cases and explicit methods. As in the case of linear systems, the implicit nature of the method requires that force at each time step be calculated taking into account information from that same time step. In a system where the spring or damping forces are non-linear, this requires iterative calculations within each time step to precisely capture possible variations in system properties. The fundamental approximation involved is the assumption that properties of the system are considered to be constant at very short time intervals (within a time step) but vary over time. Within each step, iterative solutions determine how the system variables change, and displacements, velocities and accelerations are calculated consistently to satisfy the equations of motion. A commonly used iteration method is illustrated herein first for a static problem, and then integrated into Newmark’s method to solve SDOF structural dynamics problems.\n\n4.7.2.1 Newton-Raphson Iteration\nConsider a scenario in which the spring force - deformation relationship is nonlinear as shown in Figure 4.18. Assume the system is subject (or rather will eventually be subject after deformation) to a static external force \\(\\sforce\\). The system resists the external force by some \\(\\resistforce\\) and if the nonlinear spring is the only element then the resisting force is simply the force in the spring. There may be other components, say for example dampers or other terms coming from numerical approximations, which may contribute to this resistance and so we use the term resisting force to denote their cumulative act. Assume for simplicity that the resisting force is a function of only the generalized displacements, i.e. \\(\\resistforce = \\resistforce (\\gc)\\). If the initial displacement is \\(\\gc^{(0)}\\), which may or may not be equal to zero, the resisting force is given by \\(\\resistforce^{(0)} = \\resistforce (\\gc^{(0)})\\). Unless by a very fortuitous surprise, the system is most likely not balanced in that \\(\\resistforce^{(0)} \\neq \\sforce\\), and we have not yet reached equilibrium. The system will have to deform further to reach equilibrium, and the question is, by how much?\nThe Newton-Raphson approach tries to answer this question by iteratively updating the displacement and the unbalanced force until a specific condition is set and the convergence is deemed acceptable. Mathematically it is a root finding method, adopted here to minimize the residual \\(\\residual = \\sforce - \\resistforce (\\gc)\\). The objective of the iteration is to reduce \\(\\residual\\) below an acceptable threshold, which represents the acceptable error in force calculations. The underlying approximation may be discussed via Taylor expansion of \\(\\resistforce\\): consider that an estimate of the state and the resisting force, which is essentially a known function of the estimate of state, is available for the \\(p\\)-th iteration, i.e. \\(\\gc^{(p)}\\) and \\(\\resistforce^{(p)}\\) are known. The linearized Taylor series expansion approximation for the resisting force in the next iteration (i.e. essentially the resisting force at some other state) can be expressed as \\[\n\\resistforce^{(p+1)} \\approx \\resistforce^{(p)} + \\left. \\pardiv {\\resistforce}{\\gc} \\right|_{\\gc^{(p)}} \\left (\\gc^{(p+1)} - \\gc ^{(p)} \\right) = \\resistforce^{(p)} + \\bar{k}_t^{(p)} \\Delta \\gc^{(p)}\n\\] where \\(\\bar{k}_t^{(p)} = \\left. ({\\partial \\resistforce}/{\\partial \\gc}) \\right|_{\\gc^{(p)}}\\) is the equivalent tangent stiffness at \\(\\gc^{(p)}\\), and \\(\\Delta \\gc^{(p)} = \\gc^{(p+1)} - \\gc ^{(p)}\\) is the state step (as opposed to the time step we have referred to previously). Recall that we have assumed the resisting force to be a function of the generalized displacement alone; for more complicated cases, for example involving generalized velocities, the tangent stiffness may have to be a matrix. The setback is that we do not know the next point in the expansion, i.e. we do not yet know \\(\\gc^{(p+1)}\\) or, equivalently, \\(\\Delta \\gc^{(p)}\\). We may try to estimate the state step using the current imbalance in the system, i.e.\n\\[\n\\Delta \\gc ^{(p)} = \\frac{(\\sforce- \\resistforce^{(p)})} {\\bar{k}_t^{(p)}} = \\frac{\\residual^{(p)}}{\\bar{k}_t^{(p)}}\n\\] where \\(\\residual^{(p)}\\) is called the residual or the imbalance at iteration \\(p\\). But now that we have a new estimate for the state, given by \\[\n\\gc^{(p+1)} = \\gc ^{(p)} + \\Delta \\gc^{(p)}\n\\] we may calculate a new estimate for the resisting force, i.e. \\(\\resistforce^{(p+1)}\\), and check whether the system is in equilibirum or not. An exact equality may be too much to ask but we may be satisfied with an approximate answer such that the error is less than some tolerance, so that we may check whether \\[\n\\residual^{(p+1)} = \\sforce - \\resistforce^{(p+1)} \\leq \\text{force tolerance}\n\\] or whether \\[\n\\gc^{(p+1)} - \\gc^{(p)} \\leq \\text{state tolerance}\n\\] If the convergence condition is satisfied we may stop the iterations and use the final values as our best estimates, otherwise we may proceed further with the iterations by simply repeating the steps involved for the next iteration. All this may be graphically easier to grasp via the schematic description in Figure 4.21 (a). A simplified version that is often referred to may be conducted by keeping the same tangent stiffness in all iterations, which is also graphically depicted in Figure 4.21 (b); the benefit being the savings obtained by minimizing the number of tangent stiffness calculations at the cost of possibly more iterations. The good news is that the Newton-Raphson approach is quite general and it may be used for other type of nonlinear interactions, such as for example a nonlinear damper.\n\n\n\nFigure 4.21: Newton-Raphson iteration method for calculating nonlinear spring forces.\n\n\nA very simple example may suffice to demonstrate the steps involved. Consider a spring for which the force-displacement relationship is given by \\[\n\\stifforce = k_{nl} \\sqrt{q}  \\quad \\text{for } \\gc \\text{ in mm} \\geq 0\n\\] with \\(k_{nl} = 10 \\unit{N / \\sqrt{mm}}\\), and assume that the spring is subjected to an external force of \\(50 \\unit{N}\\), as sketched in Figure 4.22.\n\n\n\nFigure 4.22: Simple nonlinear spring subjected to an external force.\n\n\nThe exact solution is obvious: the spring has to deform \\(25 \\unit{mm}\\) for the system to equilibriate. Let us try to see if we can apply the Newton-Rhapson iterations to obtain this result. Assume our initial guess for the displacement is \\(\\gc^{(0)} = 1 \\unit{mm}\\) (note that an initial guess of \\(0\\) would yield an infinite tangent stiffness so that it would not be useful to start from). Since the only resisting element is a spring, we have \\(\\resistforce = \\stifforce\\). The unbalanced force and the tangent stiffness at this step are \\[\n\\begin{array}{c}\n\\residual^{(0)} = \\sforce - \\resistforce^{(0)} = 50 - \\left.(10 \\sqrt{q})\\right|_{\\gc^{(0)}} = 40 \\unit{N},\\\\\n\\bar{k}_t^{(0)} = \\left. \\pardiv {\\resistforce}{\\gc} \\right|_{\\gc^{(0)}} = \\left.\\ratio{5}{\\sqrt{q}}\\right|_{\\gc^{(0)}} \\! \\! = 5 \\unit{N / mm}\n\\end{array}\n\\] The state step is therefore given by \\[\n\\Delta \\gc^{(0)} = \\ratio{\\residual^{(0)}}{\\bar{k}_t^{(0)}} = 8 \\unit{mm}\n\\] and the next estimate is calculated as \\[\n\\gc^{(1)} = \\Delta \\gc^{(0)} + \\gc^{(0)} = 9 \\unit{mm}\n\\] with the new resisting (spring) force \\[\n\\resistforce^{(1)} = \\left.(10 \\sqrt{q})\\right|_{\\gc^{(1)}} = 30 \\unit{N}\n\\] Repeating the steps above will lead to the following results: \\[\\begin{align*}\n\\gc^{(1)}  & = 9 \\unit{mm}, \\quad  \\resistforce^{(1)} = 30 \\unit{N}, \\quad \\residual^{(1)} = 20 \\unit{N}, \\quad \\bar{k}_t^{(1)} = \\ratio{5}{3} \\unit{N / mm}, \\quad \\Delta \\gc^{(1)} = 12 \\unit{mm} \\\\\n\\gc^{(2)}  & = 21 \\unit{mm}, \\quad  \\resistforce^{(2)} = 45.83 \\unit{N}, \\quad \\residual^{(2)} = 4.17 \\unit{N}, \\quad \\bar{k}_t^{(2)} = 2.45 \\unit{N / mm}, \\quad \\Delta \\gc^{(2)} = 1.70 \\unit{mm} \\\\\n\\gc^{(3)}  & = 22.70 \\unit{mm}, \\quad  \\resistforce^{(3)} = 47.64 \\unit{N}, \\quad \\residual^{(3)} = 2.36 \\unit{N}, \\quad \\bar{k}_t^{(3)} = 1.05 \\unit{N / mm}, \\quad \\Delta \\gc^{(3)} = 2.25 \\unit{mm} \\\\\n\\gc^{(4)}  & = 24.95 \\unit{mm}, \\quad  \\resistforce^{(4)} = 49.95 \\unit{N}, \\quad \\residual^{(4)} = 0.05 \\unit{N}, \\quad \\bar{k}_t^{(4)} = 1.00 \\unit{N / mm}, \\quad \\Delta \\gc^{(4)} = 0.05 \\unit{mm} \\\\\n\\gc^{(5)}  & = 25 \\unit{mm}, \\quad  \\resistforce^{(5)} = 50 \\unit{N}, \\quad \\residual^{(5)} = 0 \\unit{N}\n\\end{align*}\\] With the residual falling to zero, we may safely stop the iterations and identify the solution as \\(25 \\unit{mm}\\), which happens to coincide with the exact solution. In more realistic problems we would have to accept some small error to avoid excessive number of iterations in order to save on computations.\n\n\n4.7.2.2 Newmark with Newton-Rhapson\nNow that we have established the procedure for solving nonlinear equilibrium equations, we can proceed with formulating Newmark’s algorithm for nonlinear systems. For simplicity, we consider here an SDOF system with a nonlinear spring force, with equation of motion given by Equation 4.26. The discretized form of this equation for time step \\((j+1)\\) will be given by \\[\nm \\dsct{\\ddgc}{j+1} + c \\dsct{\\dgc}{j+1} + \\dsct{\\left\\{\\stifforce (\\gc) \\right\\}}{j+1} = \\dsct{\\extforce}{j+1}\n\\qquad(4.34)\\] No matter what the spring force looks like, Newmark’s approximations for the velocity and acceleration, given by Equation 4.20, remain the same. Therefore the velocity and acceleration estimates \\(\\dsct{\\gc}{j+1}\\) and \\(\\dsct{\\dgc}{j+1}\\) will be given by\n\\[\n\\begin{array}{rcl}\n\\dsct{\\dgc}{j+1} & \\!\\!\\! = & \\!\\!\\! \\ratio{1}{2\\beta \\tstep} \\dsct{\\gc}{j+1} - \\ratio{1}{2\\beta \\tstep} \\dsct{\\gc}{j} + \\left(1 - \\ratio{1}{2 \\beta} \\right) \\dsct{\\dgc}{j} + \\left(1 - \\ratio{1}{4 \\beta} \\right) \\tstep \\dsct{\\ddgc}{j} \\\\\n\\dsct{\\ddgc}{j+1} & \\!\\!\\! = & \\!\\!\\! \\ratio{1}{\\beta \\tstep^2} \\dsct{\\gc}{j+1} - \\ratio{1}{\\beta \\tstep^2} \\dsct{\\gc}{j} - \\ratio{1}{\\beta \\tstep}  \\dsct{\\dgc}{j} + \\left(1 - \\ratio{1}{2 \\beta} \\right) \\dsct{\\ddgc}{j}\n\\end{array}\n\\qquad(4.35)\\] With these estimates, the equilibrium equation in Equation 4.34 may be written as \\[\\begin{align*}\nm \\dsct{\\ddgc}{j+1} & +  c \\dsct{\\dgc}{j+1} + \\dsct{\\left\\{\\stifforce (\\gc)\\right\\}}{j+1} = \\\\\n& m \\left[ \\ratio{1}{\\beta \\tstep^2} \\dsct{\\gc}{j+1} - \\ratio{1}{\\beta \\tstep^2} \\dsct{\\gc}{j} - \\ratio{1}{\\beta \\tstep}  \\dsct{\\dgc}{j} + \\left(1 - \\ratio{1}{2 \\beta} \\right) \\dsct{\\ddgc}{j} \\right] \\\\\n& \\phantom{XX} + c \\left[ \\ratio{1}{2\\beta \\tstep} \\dsct{\\gc}{j+1} - \\ratio{1}{2\\beta \\tstep} \\dsct{\\gc}{j} + \\left(1 - \\ratio{1}{2 \\beta} \\right) \\dsct{\\dgc}{j} + \\left(1 - \\ratio{1}{4 \\beta} \\right)\\tstep \\dsct{\\ddgc}{j} \\right] \\\\\n& \\phantom{XXX} + \\dsct{\\left\\{\\stifforce (\\gc)\\right\\}}{j+1} = \\dsct{\\extforce}{j+1}\n\\end{align*}\\] The coefficients may be grouped together to obtain\n\\[\nA_1 \\dsct{\\gc}{j+1} =  \\dsct{\\extforce}{j+1} + A_1  \\dsct{\\gc}{j} + A_2  \\dsct{\\dgc}{j}+ A_3  \\dsct{\\ddgc}{j} - \\dsct{\\left\\{\\stifforce (\\gc) \\right\\}}{j+1}\n\\qquad(4.36)\\] where \\[\n\\begin{array}{c}\nA_1 = \\ratio{m}{\\beta \\tstep^2} + \\ratio{c}{2 \\beta \\tstep}, \\quad A_2 = \\ratio{m}{\\beta \\tstep} + {c}\\left(\\ratio{1}{2 \\beta} - 1 \\right), \\\\\n\\quad A_3 = m \\left(\\ratio{1}{2 \\beta} -1 \\right) + c \\tstep \\left(\\ratio{1}{4 \\beta} - 1 \\right)\n\\end{array}\n\\qquad(4.37)\\] This equation is very similar to the equation we tried to solve while discussing the static load application in that we have \\[\n\\underbrace{A_1 \\dsct{\\gc}{j+1} + \\dsct{\\left\\{\\stifforce (\\gc) \\right\\}}{j+1}}_{\\text{like $\\resistforce$ of the static case}} =  \\underbrace{\\dsct{\\extforce}{j+1} + A_1  \\dsct{\\gc}{j} + A_2  \\dsct{\\dgc}{j}+ A_3  \\dsct{\\ddgc}{j}}_{\\text{like $\\sforce$ of the static case}}\n\\] and the question is whether or not the equality holds. Most probably it will not, and we will have to iteratively solve for the value of \\(\\dsct{\\gc}{j+1}\\) which will balance the equation, and in a dynamic progession we will have to do this for each time step separately.\nFor implementation details, consider that we have solved the state for all time steps until \\(j\\), so that \\(\\dsct{\\gc}{j}\\), \\(\\dsct{\\dgc}{j}\\) and \\(\\dsct{\\ddgc}{j}\\) are all known, along with all values of the excitation. Within time step \\(j+1\\), we may be in iteration \\(p\\), for which we check whether the equation \\[\nA_1 \\dsct{\\gc^{(p)}}{j+1} + \\dsct{\\left\\{\\stifforce (\\gc) \\right\\}^{(p)}}{j+1} =  \\dsct{\\extforce}{j+1} + A_1  \\dsct{\\gc}{j} + A_2  \\dsct{\\dgc}{j}+ A_3  \\dsct{\\ddgc}{j}\n\\] is satisfied (within some eror tolerance). If it is, then we set \\[\n\\dsct{\\gc}{j+1} = \\dsct{\\gc^{(p)}}{j+1}\n\\] and calculate the velocity and the acceleration for time step \\(j+1\\) via Equation 4.35. If it is not satisfied, however, we need to update our estimate, for which we first calculate \\[\n\\begin{array}{c}\n\\resistforce^{(p)} = A_1 \\dsct{\\gc}{j+1}^{(p)} + \\dsct{\\left\\{\\stifforce (\\gc) \\right\\}^{(p)}}{j+1} \\\\\n\\residual^{(p)} = \\left(\\dsct{\\extforce}{j+1} + A_1  \\dsct{\\gc}{j} + A_2  \\dsct{\\dgc}{j}+ A_3  \\dsct{\\ddgc}{j}\\right) - \\resistforce^{(p)}\\\\\n\\bar{k}_t^{(p)} = \\left. \\pardiv {\\resistforce}{\\gc} \\right|_{\\dsct{\\gc^{(p)}}{j+1}} = A_1 + \\left. \\pardiv {\\stifforce}{\\gc} \\right|_{\\dsct{\\gc^{(p)}}{j+1}} = A_1 + k_t^{(p)}\n\\end{array}\n\\] where \\(k_t^{(p)} = \\left({\\partial \\stifforce}/{\\partial \\gc}) \\right|_{\\dsct{\\gc^{(p)}}{j+1}}\\) is the tangent stiffness, which is the contribution of the actual physical stiffness terms to the equivalent tangent stiffness. The state step is to be determined via \\[\n\\Delta \\dsct{\\gc^{(p)}}{j+1} = \\ratio{\\residual^{(p)}}{\\bar{k}_t^{(p)}}\n\\] and the new estimate for the generalized displacement is given by \\[\n\\dsct{\\gc^{(p+1)}}{j+1} = \\dsct{\\gc^{(p)}}{j+1} + \\Delta \\dsct{\\gc^{(p)}}{j+1}\n\\] and use this new estimate to calculate \\(\\dsct{\\left\\{\\stifforce (\\gc) \\right\\}^{(p)}}{j+1}\\) and the other quantities involved. We check if another update is necessary, by either checking \\[\n\\residual^{(p+1)}  \\leq \\text{force tolerance}\n\\] or \\[\n\\dsct{\\gc^{(p+1)}}{j+1} - \\dsct{\\gc^{(p+1)}}{j} \\leq \\text{state tolerance}\n\\] and decide whether to proceed with further updates. Say that iteration \\(p*\\) is the iteration at which we have satisfied the error condition, with the final value calculated given by \\(\\dsct{\\gc^{(p*)}}{j+1}\\). Then we set \\[\n\\dsct{\\gc}{j+1} = \\dsct{\\gc^{(p*)}}{j+1}\n\\] using which we calculate the velocity and acceleration for time step \\(j+1\\) via Equation 4.35, and move on to the next time step. The algorithm is summarized in Figure 4.23. \n\n\n\n\n\n\nPseudocode for Newmark’s Method - Non-linear Spring (Newmark-\\(\\beta\\))\n\n\n\nviscously damped SDOF system with non-linear spring, for constant time step\nInput: \\(m\\), \\(\\damp\\) (or \\(c\\)), \\(\\stifforce(q)\\), \\(\\beta\\), \\(\\tstep\\), \\(\\dsct{\\gc}{0}\\), \\(\\dsct{\\dgc}{0}\\), \\(\\left\\{\\dsct{\\extforce}{0}, \\ldots, \\dsct{\\extforce}{l} \\right\\}\\), tolerance(s)\nInitialize: calculate\n\\(\\phantom{xxxx}\\) \\(A_1 = \\frac{m}{\\beta \\tstep^2} + \\frac{c}{2 \\beta \\tstep}\\), \\(A_2 = \\frac{m}{\\beta \\tstep} + {c}\\left(\\frac{1}{2 \\beta} - 1 \\right)\\),\n\\(\\phantom{xxxx}\\) \\(A_3 = m \\left(\\frac{1}{2 \\beta} -1 \\right) + c \\tstep \\left(\\frac{1}{4 \\beta} - 1 \\right)\\),\n\\(\\phantom{xxxx}\\) \\(A_4=\\frac{1}{2\\beta \\tstep}\\), \\(A_5 = 1 - \\frac{1}{2\\beta}\\), \\(A_6 = \\tstep \\left(1 - \\frac{1}{4 \\beta}\\right)\\),\n\\(\\phantom{xxxx}\\) \\(A_7= \\frac{1}{\\beta \\tstep^2}\\), \\(A_8 = - \\frac{1}{\\beta \\tstep}\\),\n\\(\\phantom{xxxx}\\) \\(\\dsct{\\ddgc}{0} = \\frac{1}{m}(\\dsct{\\extforce}{0} - c \\dsct{\\dgc}{0} - \\stifforce(\\dsct{\\gc}{0}))\\)\nfor time steps \\(j=0,\\ldots,l-1\\):\n\\(\\phantom{xxxx}\\) Initialize: set \\(\\dsct{\\gc^{(0)}}{j+1} = \\dsct{\\gc}{j}\\)\n\\(\\phantom{xxxx}\\) \\(\\sforce_{j+1} = \\dsct{\\extforce}{j+1} + A_1 \\dsct{\\gc}{j} + A_2 \\dsct{\\dgc}{j}+ A_3 \\dsct{\\ddgc}{j}\\)\n\\(\\phantom{XXXXXXX}\\) for state step \\(p=0,\\ldots\\) convergence:\n\\(\\phantom{XXXXXXXXXX}\\) \\(\\stifforce^{(p)} = \\stifforce (\\gc)\\biggr|_{\\dsct{\\gc^{(p)}}{j+1}}\\)\n\\(\\phantom{XXXXXXXXXX}\\) \\(\\resistforce^{(p)} = \\stifforce^{(p)} + A_1 \\dsct{\\gc}{j+1}^{(p)}\\)\n\\(\\phantom{XXXXXXXXXX}\\) \\(\\residual^{(p)} = \\sforce_{j+1} - \\resistforce^{(p)}\\)\n\\(\\phantom{XXXXXXXXXX}\\) \\(\\bar{k}^{(p)}_t = A_1 + \\left. \\pardiv {\\stifforce}{\\gc} \\right|_{\\dsct{\\gc^{(p)}}{j+1}}\\)\n\\(\\phantom{XXXXXXXXXX}\\) \\(\\Delta \\gc ^{(p)} = \\frac{\\residual^{(p)}} {\\bar{k}_t^{(p)}}\\)\n\\(\\phantom{XXXXXXXXXX}\\) \\(\\dsct{\\gc}{j+1}^{(p+1)} = \\dsct{\\gc}{j+1}^{(p)} + \\Delta \\gc ^{(p)}\\)\n\\(\\phantom{XXXXXXXXXX}\\) if tolerance(s) satisfied, set \\(\\dsct{\\gc}{j+1} = \\dsct{\\gc}{j+1}^{(p+1)}\\)\n\\(\\phantom{xxxx}\\) Compute velocity and accelerations:\n\\(\\phantom{xxxx}\\) \\(\\dsct{\\dgc}{j+1} = A_4 (\\dsct{\\gc}{j+1} - \\dsct{\\gc}{j} ) + A_5 \\dsct{\\dgc}{j} + A_6 \\dsct{\\ddgc}{j}\\)\n\\(\\phantom{xxxx}\\) \\(\\dsct{\\ddgc}{j+1} = A_7 (\\dsct{\\gc}{j+1} - \\dsct{\\gc}{j}) + A_8 \\dsct{\\dgc}{j} + A_5 \\dsct{\\ddgc}{j}\\)\n\n\n\n\n\nFigure 4.23: Pseudocode for Newmark’s method with nonlinear spring force.\n\n\n\n\nEXAMPLE 4 .7\nConsider a SDF system with \\(m=10000 \\unit{kg}\\) and \\(\\damp = 0.02\\). The restoring force-deformation relation is elastoplastic with stiffness \\(k=200 \\unit{kN/m}\\) before yield and yield force \\(f_Y=18 \\unit{kN}\\). The system is subjected to a sinosoidal force excitation given as \\(f=10\\mathrm{sin}(\\pi t) \\unit{kN}\\). Determine the response of this system (starting from rest) within \\(0 \\leq t \\leq 5.0\\unit{sec}\\) using the Central Difference Method and Newmark-\\(\\beta\\) constant and linear acceleration methods, with \\(h=0.1\\unit{sec}\\). Compare the results.\nThe comparison of the response computed using Newmark-\\(\\beta\\) method (with \\(\\beta = 1/4\\) and \\(\\beta = 1/6\\) ) are shown in Figure 4.24. It can be seen that the various methods give rise to small but noticable differences in the response calculation, which can have an effect on the peak response quantities obtained from the time histories obtained using different integration methods. In general, these differences may become more prominent with greater nonlinearities and coarser time step choices.\n\n\n\n\nFigure 4.24: Comparison of central Difference Method (CDM) and Newmark - \\(\\beta\\) algorithms for Ex. 4 .7 displacement, velocity, and nonlinear spring force time histories. The Python scripts used to calculate the response can be found here."
  },
  {
    "objectID": "eqsdof.html#sec-Preliminary_Concepts",
    "href": "eqsdof.html#sec-Preliminary_Concepts",
    "title": "5  Seismic Analysis of Single Degree of Freedom Systems",
    "section": "5.1 Preliminary Concepts",
    "text": "5.1 Preliminary Concepts\nIn previous chapters we covered most of the required analysis approaches for calculating the response of SDOF systems to various types of excitations including ground motions. Determining a system’s response to base excitation is important for a variety of applications. We mentioned that base excitations in the form of ambient vibrations, human activity such as pedestrian or vehicle traffic, or nearby industrial activity such as construction and mining may induce small-amplitude vibrations that may nevertheless be noticeable and may even be important in housing of sensitive equipment. Yet, many of these activities typically cause insignificant displacements in well-designed structures even if they cause uncomfort to occupants. Conversely, so-called strong ground motion, arising from seismic activity and most significantly in large earthquakes, is so centrally important in structural analysis and design that it merits a dedicated discussion. For this purpose, here we will briefly discuss some fundamental concepts from seismology such as causes of earthquakes and measures of earthquake intensity, followed by a qualitative discussion of factors that may influence structural behavior and possible damage in response to an earthquake. In latter sections response and design spectra for linear systems will be introduced, followed by a discussion of inelastic behavior of structures and its implications for structural design ."
  },
  {
    "objectID": "eqsdof.html#what-is-an-earthquake",
    "href": "eqsdof.html#what-is-an-earthquake",
    "title": "5  Seismic Analysis of Single Degree of Freedom Systems",
    "section": "5.2 What Is An Earthquake?",
    "text": "5.2 What Is An Earthquake?\nThe outermost layer of Earth is called the lithosphere. Earth’s thin crust is part of the litosphere and this crust is subject to extreme stresses that arise from the tremendous mass and relative motion of its fragmented sections because the lithosphere is essentially floating on another layer, called the asthenosphere, which is viscous. Each section of the lithosphere that seemingly moves as a single slab is called a tectonic plate or simply a plate, and the scientific theories and studies regarding the motions of these plates constitute the field of plate tectonics. There are 15 tectonic plates identified currently, some of which are called continental plates as they contain the continents, and some called the oceanic plates which spread between continental plates due to driving forces such as the heat from the mantle and magma cooling in the ocean bed. In a simple analogy, the movement of these plates resembles those of frozen sheets of ice on a partially frozen water body, i.e. with the water body representing the asthenosphere, the liquid-like viscous layer of the mantle. The interfaces of plates are called faults; as plates are driven to move, stresses build up along these faults due to constraints that hinder free relative motion, such that deformations occur in the plates. More generally, faults are fracture planes in Earth’s crust; they may be large so as to form interfaces inbetween tectonic plates, or they may be small (its all relative as even small may mean many kilometers long) so as to result from more local rock mass movements. Eventually the stress may exceed the interface resistance causing the plates or rock masses to slide relative to each other, either vertically (dip-slip fault), laterally (strike-slip fault), or some combination of vertical and lateral (oblique-slip fault). With the slip, the deformation energy previously stored in the plate is released by the elastic rebound1 of the plate. Figure 5.1 schematically illustrates the cycle.\n\n\n\nFigure 5.1: Slip along a fault line, showing the (a) original state (b) development of strain due to impeding slip (c) elastic rebound post-slip.\n\n\nPost-slip elastic rebound causes seismic waves that travel across the lithosphere. These waves include body waves that travel within Earth, comprising longitudinal tension-compression motion (P waves) and shearing motion (S waves), and surface waves that are generated as the body waves emerge on the surface of the crust (Rayleigh and Love waves). These waves cause local lateral and vertical displacements as they pass through a point on the ground. Some of the commonly encountered terms are schematically noted in Figure 5.2.\n\n\n\nFigure 5.2: Basic earthquake terminology."
  },
  {
    "objectID": "eqsdof.html#footnotes",
    "href": "eqsdof.html#footnotes",
    "title": "5  Seismic Analysis of Single Degree of Freedom Systems",
    "section": "",
    "text": "A.S. Veletsos and N.M. Newmark, Effect of Inelastic Behavior on the Response of Simple Systems to Earthquake Motions, Proc. of 2nd WCEE, pp. 895-912, 1960.↩︎\nWe have to be careful about what we mean by “economical” as the validity of the adjective depends very much on the boundaries or horizon of analyses. Recent earthquakes have unfortunately shown that indirect losses, such as significant population migration away from heavily damaged quarters and the consequent socio-economic losses may better be avoided even at higher costs of initial construction. “Resilient Urban Environment” may become the dominant paradigm in recent future.↩︎"
  },
  {
    "objectID": "eqsdof.html#sec-Measuring_the_Magnitude_Of_An_Earthquake",
    "href": "eqsdof.html#sec-Measuring_the_Magnitude_Of_An_Earthquake",
    "title": "5  Seismic Analysis of Single Degree of Freedom Systems",
    "section": "5.3 Measuring the Magnitude Of An Earthquake",
    "text": "5.3 Measuring the Magnitude Of An Earthquake\nAnecdotal records of earthquakes date back centuries. Systematic quantification of the magnitude and time-history characteristics of earthquakes, however, has become possible only with the advent of seismographic tools. Specifically, accelerometers housed in special stations that are distributed across the world offer us recordings of ground accelerations. Such recordings allow scientists to identify the epicenter as well as the amount of energy released. Figure 5.3 shows actual ground acceleration time histories that were measured during three earthquakes that occurred in a relatively small time span at distinct geographic locations.\nComing up with a single, all-telling indicator to characterize the measure of an earthquake has been an elusive task. Characterizing the behavior of a structure that will be subjected to a future earthquake is all the more so since uncertainties regarding structural behavior compound with uncertainties surrounding what a future ground motion may look like. A general framework proposes that the risk posed to a system is determined jointly by the hazard to which the system will be exposed and the system’s fragility or vulnerability so that: \\[\n\\text{Risk} = \\text{Hazard} \\times \\text{Fragility}\n\\] Ground motion studies try to model and estimate the hazard component while structural engineering studies focus on modeling structural behavior and estimation of fragility. The measure of an earthquake may mean either a quantification of the hazard or a quantification of the risk. For hazard, the measure used may be some magnitude that will try to define how big the energy released during the earthquake is, or some characteristic parameter, like for example the peak ground acceleration, that will try to quantify the amplitude of motion at a specific location. Examining the earthquake records shown in Figure 5.3, we can see that earthquake excitations are generally of random nature without a clear observable pattern. As is characteristic of earthquake ground acceleration time histories, the peak ground acceleration, taken as the maximum value of ground acceleration measured, is different in each case since it depends on distance from the epicenter, magnitude of the earthquake, geological conditions at the site, the response of the structure housing the equipment, instrument characteristics, and other factors. This obviates the well accepted notion that correct interpretation of a seismogram requires us to put the data acquired from a number of seismograms into context through some form of normalization, such that the magnitude of the earthquake can be objectively determined. Additionally, scaling (e.g. to attain a target peak ground acceleration), orientation and other post-processing steps may be necessary prior to utilizing seismogram data for structural analysis purposes.\n\n\n\nFigure 5.3: Earthquake ground acceleration time histories from 3 different earthquakes, Kocaeli (Türkiye) 1999 Iznik Station (90 degrees), Northridge (USA) 1994 Camarillo Station (180 degrees), and Kobe (Japan) 1995 Takarazuka Station (90 degrees). Note that horiontal (time) and vertical (acceleration in \\(\\gravity\\)) axes are scaled differently across figures.\n\n\nThe wide-spread availability of seismographic data allows us to have not just qualitative but also quantitative description of ‘big’ an earthquake is. In general use are two different phrases to describe how big is ‘big’: intensity, and magnitude. Intensity commonly refers to a qualitative measure of the devastation caused in the built environment, and sometimes also in the natural environment, by the earthquake. Such a measure may be helpful for organizing disaster response and for emergency policy-making, among other purposes. The Modified Mercalli Intensity (MMI) Scale2, for example, is an intensity measure widely used around the world. MMI scale, summarized in Table 5.1, ranges from I to XI (roman numerals), with the severity of damage increasing with intensity. MMI estimates may be developed via observation reports and also seismographic measurements such as maximum (peak) ground velocity which have previously been correlated with the MMI scale.\n\n\nTable 5.1: Modified Mercalli Intensity Scale.\n\n\n\n\n\n\n\nIntensity\nShaking\nDescription / Damage\n\n\n\n\nI\nNot felt\nNot felt except by a very few under especially favorable conditions.\n\n\nII\nWeak\nFelt only by a few persons at rest, especially on upper floors of buildings.\n\n\nIII\nWeak\nFelt quite noticeably by persons indoors, especially on upper floors of buildings. Many people do not recognize it as an earthquake. Standing motor cars may rock slightly. Vibrations similar to the passing of a truck. Duration estimated.\n\n\nIV\nLight\nFelt indoors by many, outdoors by few during the day. At night, some awakened. Dishes, windows, doors disturbed; walls make cracking sound. Sensation like heavy truck striking building. Standing motor cars rocked noticeably.\n\n\nV\nModerate\nFelt by nearly everyone; many awakened. Some dishes, windows broken. Unstable objects overturned. Pendulum clocks may stop.\n\n\nVI\nStrong\nFelt by all, many frightened. Some heavy furniture moved; a few instances of fallen plaster. Damage slight.\n\n\nVII\nVery Strong\nDamage negligible in buildings of good design and construction; slight to moderate in well-built ordinary structures; considerable damage in poorly built or badly designed structures; some chimneys broken.\n\n\nVIlI\nSevere\nDamage slight in specially designed structures; considerable damage in ordinary substantial buildings with partial collapse. Damage great in poorly built structures. Fall of chimneys, factory stacks, columns, monuments, walls. Heavy furniture overturned.\n\n\nIX\nViolent\nDamage considerable in specially designed structures; well-designed frame structures thrown out of plumb. Damage great in substantial buildings, with partial collapse. Buildings shifted off foundations.\n\n\nX\nExtreme\nSome well-built wooden structures destroyed; most masonry and frame structures destroyed with foundations. Rails bent.\n\n\n\n\nMagnitude, on the other hand, is a measure of the amplitude of ground motion and energy released in an earthquake, independent of its effects on the environment. In that sense, a magnitude measure may seem more objective than an intensity measure, but in essence they serve different albeit similar purposes. Early efforts to build an objective and quantitative measure for earthquake intensity made use of seismographic data that was becoming widely available. In 1935, Charles F. Richter developed a scale that aimed to account for the size of an earthquake using the peak amplitude measured by a torsional seismometer called the Wood-Anderson seismograph, normalizing this amplitude empirically for the distance from the epicenter to arrive at a local measure of the magnitude. An important notion of the Richter magnitude was that it employed a logarithmic scale to describe the magnitude. The Richter scale, often referred to as the local magnitude (scale) and denoted by \\(M_L\\), is no longer commonly used today, and it has been replaced by other magnitude measures such as the Moment Magnitude Scale (MMS) \\(M_w\\) which improves upon the shortcomings of the Richter scale. \\(M_w\\) is an estimate of energy released during an earthquake based on the estimate of a seismic moment, defined conceptually as the product \\(\\text{[slip length]} \\times \\text{[fault area]} \\times \\text{[rigidity]}\\), where rigidity depends on the cohesive strength of the rocks along the faults on which the slip occurs. Just to provide a comparison, the amount of energy released by a \\(M_w = 6\\) earthquake is comparable to that of an atomic bomb. This measure is also logarithmic, so that an increase from \\(M_w = 6\\) to \\(M_w = 7\\) corresponds to a ten fold increase in energy released. Each year, multiple earthquakes of \\(M_w &gt; 7\\) occur in various locations around the world. Extremely large earthquakes can register \\(M_w &gt; 9\\), such as the 2011 Tohoku (Japan) earthquake, which triggered a tsunami that compounded the devastation caused by the earthquake. While many of the large earthquakes cause no fatalities as they occur in remote locations, there have been significant earthquakes from the past decade that have caused loss of life measured in tens of thousands and total damage or collapse of thousands of buildings. As such, the issue of seismic design remains as relevant as ever for structural engineering and urban planning, especially for settlements near active faults."
  },
  {
    "objectID": "eqsdof.html#sec-Architectural_Seismic_Design_Considerations",
    "href": "eqsdof.html#sec-Architectural_Seismic_Design_Considerations",
    "title": "5  Seismic Analysis of Single Degree of Freedom Systems",
    "section": "5.4 Architectural Considerations in Earthquake Resistant Design",
    "text": "5.4 Architectural Considerations in Earthquake Resistant Design\nMany socio-economic considerations, including availability of fresh water and access to fertile lands, have influenced development of civilizations and birth of mega cities that harbor most of the human population in the modern age. Indeed, some of the world’s most populated urban centers are near active faults, and as such, it is not economically viable to avoid seismic hazards altogether by choosing low-hazard regions for further development. A number of considerations in structural design can, however, reduce the risk of structural damage. Many of these design considerations can be explained by intuition without resorting to any structural design calculations. Among the factors governing the demands generated on a structure by an earthquake, site conditions are of paramount importance. Waves travel quicker through dense geomaterials such as hard, unfragmented rock surfaces, which reduces the amplitude of ground motions transferred onto structures. Conversely, softer ground conditions such as soft clay and filled lake or river beds can amplify the amplitude of ground motion by multiple times. Construction in such regions may require implementation of soil improvement techniques, such as drawing piles that extend the foundation to the bedrock. An additional consideration is soil liquefaction, in which the increase in pore water pressure of soils due to excitation may reduce the load bearing capacity, thereby causing buildings to topple over or sink, sometimes even with their foundations intact, into the ground. This may cause damage and collapse even without visible damage to structural elements above surface.\nAs one may expect from all that we have learned in previous chapters, the natural frequency of the structure as well as available damping will also influence the demands. The fundamental period of a building can roughly be estimated as the number of stories divided by 10. Random vibrations such as earthquakes can be thought as a superposition of many harmonic excitations, where in the particular case of earthquakes the notable contributions to the signals come from excitations in the fraction of one Hz to several Hz range. Stiffness of structural elements is of course critical in determining where the frequency lies relative to this range. Typically, low to mid-rise multi-story buildings are more susceptible to earthquakes, whereas for high-rises the flexible nature of the tall cantilever structure makes the response amplification much smaller, and in such cases lateral wind loads are often the dominant design consideration for determining member sections.\nConstruction and materials quality are additional factors that determine structural response outcomes, and we cannot overemphasize the importance of quality control and site inspections for ensuring good seismic performance of well-designed structures. In most structures, the cost of the structural elements is a much smaller fraction of the total cost of the building, and from an engineering standpoint it is sensible to invest in high structural performance over superfluities that are largely cosmetic.\nA number of design factors also contribute to the structural response. Symmetrical plans and continuous load transfer mechanisms, especially along vertical axes, are known to be beneficial or at least nondetrimental is seismic behavior. Typically, basic structural designs utilize moment resisting frames, diagonal braces, or shear walls to limit lateral drift due to earthquake loads. Codes typically limit drift to \\(1\\%\\) of building height to avoid excess damage. Seismic resisting elements placed at the perimeter help limit drift and also maximize torsional resistance of these structures. Uniformity of load bearing elements is important: designs should avoid short column effects that will concentrate stresses on particular load-bearing elements, or soft stories that often arise when fewer columns are used in entrance floors to generate commercial or parking spaces but are susceptible to formation of collapse mechanisms. Additionally, simple design considerations, such as low height to base ratios (to avoid overturn), equal floor heights or stiffness distributions, short spans, diaphragms without large openings, and avoiding cantilevers are preferable. Aseismic design guidelines are well-described in building codes and documents such as FEMA 4543 which offer guidance for seismic considerations in architectural design. Structures conforming with these design guidelines are considered to be regular structures, for which analysis procedures may be considerably simpler. That said, irregularities may need to be present for architectural or other purposes and are permissible within the guidelines of building codes (e.g. ASCE 74 in the US) that delineate conditions that must be satisfied for these structures to be code-compliant. While these aspects are worthy of mentioning to promote awareness, in depth discussion of such practical considerations is beyond our scope and can be found in building codes and references focusing on structural design."
  },
  {
    "objectID": "eqsdof.html#sec-Earthquake_Response_Spectra_for_Linear_SDOF_Systems",
    "href": "eqsdof.html#sec-Earthquake_Response_Spectra_for_Linear_SDOF_Systems",
    "title": "5  Seismic Analysis of Single Degree of Freedom Systems",
    "section": "5.5 Earthquake Response Spectra for Linear Systems",
    "text": "5.5 Earthquake Response Spectra for Linear Systems\nLet’s recall that the equation of motion for a viscously damped linear SDOF system subject to ground accelerations \\(\\gacc (t)\\) is given by \\[\nm \\ddgc (t) + c \\dgc (t) + k \\gc (t) = - m \\gacc (t)\n\\] which may also be expressed as \\[\n\\ddgc (t) + 2 \\damp \\freq \\dgc (t) + \\freq^2 \\gc (t) = -\\gacc (t)\n\\] whereby it is quite obvious that the mass of the SDOF system does not explicitly factor into the equation in the case of ground motion, although it influences system parameters such as its natural period. In the context of seismic design, our primary goal is to determine the peak value of a key response variable, for example the relative displacement of the mass with respect to the ground, given a particular ground acceleration time history \\(\\gacct\\). These calculations will almost always have to be done via numerical methods.\nThe equation of motion implies that the response to a specific ground motion depends only on the natural frequency (or period) and the damping ratio of the system. How a response quantity varies with the period of the system is a very important design consideration, and the concept of a response spectrum was previously introduced in our discussion of forced vibrations of SDOF systems precisely for this reason. In the particular case of earthquake response spectra, we compute the peak response quantity (for example the absolute maximum value of \\(\\gc (t)\\)) attained due to a particular ground acceleration time history \\(\\gacc (t)\\), and plot it against the period of the structure. Given an earthquake ground acceleration record, the response spectrum tells us what peak values may be expected depending on the period \\(\\period\\) of the system. Often the same plot may include multiple graphs, each corresponding to a different value of the damping ratio. Of particular interest is the displacement (deformation) response spectrum, where we can define the absolute maximum of the displacement as:\n\\[\n\\dspec = \\dspec(\\period, \\damp) \\equiv \\max_t \\left( {q(t,\\period,\\damp)} \\right )\n\\] Figure 5.4 illustrates how the displacement response spectrum of SDOF systems vary with their undamped period \\(\\period\\) in response to the Kobe and Northridge records shown in Figure 5.3. The spectra are developed for a damping ratio of \\(\\damp = 5\\%\\) using the central difference algorithm.\n\n\n\nFigure 5.4: Displacement response spectra for systems with \\(\\damp = 5\\%\\) for Kobe and Northridge ground motion records shown in Figure 5.3.\n\n\nThe two ground motion records are quite different (see Figure 5.3) and so are their response spectra; there are, however, some common behavioral observations. When the period is very small (as \\(\\period \\rightarrow 0\\)), the deformation is negligible, as this limit represents an extremely rigid structure that moves as a rigid body with the ground. At the other extreme (as \\(\\period \\rightarrow \\infty\\)) , each spectra seems to converge to some constant value, as this limit represents an extremely flexible structure in which the mass basically stands still as the ground moves, with the maximum deformation given by the peak ground displacement (of that particular ground motion). The mid-period range is where obvious differentiation between the ground motions appear and this region is where most civil engineering structures are located.\nOne could similarly compute the absolute maximum values of the relative velocity and absolut (total) acceleration responses. Plotting these computed values against the natural period of the SDOF system can be used to construct the relative velocity response spectrum and the acceleration response spectrum. These two spectra are seldom computed. Instead, it is more practical to compute the so-called pseudo-velocity, defined as \\[\n\\vspec = \\freq \\dspec = \\frac{2 \\pi}{\\period} \\dspec\n\\qquad(5.1)\\] and the pseudo-acceleration, defined as \\[\n\\aspec = \\freq^2 \\dspec = \\left(\\frac{2 \\pi}{\\period}\\right)^2 \\dspec\n\\qquad(5.2)\\] whic are very close, but not exactly equal in the presence of damping, to the peak relative velocity and the peak absolute acceleration, respectively.\n\n\n\nFigure 5.5: Acceleration response spectra for systems with \\(\\damp = 5\\%\\) for the Kobe and Northridge ground motions shown in Figure 5.3.\n\n\nFigure 5.5 shows the pseudo-acceleration response spectra derived from the displacement response spectra shown in Figure 5.4. Again, the two spectra are significantly different, each reflecting the nature of its corresponding ground motion, albeit with some common behavioral patterns. Each spectra starts (as \\(\\period \\rightarrow 0\\)) from the peak ground acceleration of its ground motion, as this limit represents a completely rigid structure with the mass moving identically with the ground. At the other extreme (as \\(\\period \\rightarrow \\infty\\)), both spectra asymptotically converge to zero, as this limit represents an extremely flexible structure with the mass standing still as the ground moves. Once again the mid-period range reflects the particular energy contents of the individual ground motions, with high amplifications for some values of the period and not so significant amplifications in others. The response spectra essentially represent the demand on a structure: the bigger the response spectra, the more deformation the structure will have to resist.\nWe may naturally inquire how the pseudo-acceleration relates to the absolute (total) acceleration. In the case of undamped SDOF systems, the two quantities are identical. We can see this by writing the equation of motion as \\[  \nm \\aacc (t) + k \\gct = 0\n\\] and thus \\[\n\\aacc (t) =- \\freq^2 \\gct\n\\qquad(5.3)\\] where we note that \\(\\aacc (t)\\) is teh absolute (total) acceleration given by \\(\\aacc (t) = \\gacct + \\ddgct\\). From Equation 5.3 it is clear that the total acceleration scales proportionally with relative displacement \\(\\gc (t)\\), with the proportionality constant being \\(\\freq^2\\). This approximation is not strictly true for damped systems since with the inclusion of the damping term, acceleration is \\[\n\\aacc (t) =-(2\\damp \\freq \\dgct + \\freq^2 \\gct)\n\\] However, the maximum of the relative displacement (deformation) occurs when the relative velocity is zero, and the acceleration at that instance, while not exactly equal to its peak value, is given by \\(-\\freq^2 D\\). This value is a close approximation for lightly damped systems. The error of this approximation will grow with the damping ratio but for common structures with \\(\\damp &lt; 0.1\\) it is inconsequential, justifying the use of Equation 5.2.\n\n\n\nFigure 5.6: Base shear and overturning moment due to earthquake excitation.\n\n\nThe utility of calculating the pseudo-acceleration becomes apparent when we think about what will be the peak demand from our SDOF system due to the ground excitation. For SDOF systems, two of the significant measures of demand are the base shear and overturning moment: these quantities have direct implications on demands regarding shear forces, bending moments and axial forces that must be transmitted by the vertical members right above the ground. A popular conceptualization that bears some familiarity to the models the structural engineers are accustomed to is to think about a set of external forces that would, if they were to be applied to a stationary stucture, generate the same deformations as those that would be induced by the ground motion. These hypothetical forces are called equivalent static forces, to be denoted by \\(\\estat (t)\\) in SDOF systems. Obviously if the deformation (relative displacement) in an SDOF system at any instant is \\(\\gc\\), the external force that would have to be applied to that system to generate the same deformation without motion would have to be \\(\\estat = k \\gc\\). Since the internal forces developed in members depend on the deformations, the equivalent static forces may be used to calculate the internal forces that must be transmitted by the load bearing members using static equilibrium concepts. The equivalent static forces, although hypothetical, are of course related to the inertial effects through the equation of motion. Consider the SDOF force diagram shown in Figure 5.6. Using d’Alembert forces, we may consider static force and moment equilibrium of the whole system and calculate the base shear and overturning moment as: \\[\n\\baseshear (t) = - m \\ddgc (t), \\quad \\overturn (t) = - h m \\ddgc (t)\n\\qquad(5.4)\\] The equivalent static force concept says that we may use the lateral static force (applied in concordance with the sense of the generalized coordinate) \\(\\estat (t) = k \\gc (t)\\), in which case we would have \\[\n\\baseshear (t) = k \\gc (t), \\quad \\overturn (t) = h k \\gc (t)\n\\qquad(5.5)\\] That these are both viable approaches (the d’Alembert forces are in fact exact) for calculations may be deduced from the equation of motion of an undamped system since then we would have \\[\nm \\aacc (t) + k \\gc (t) = 0 \\quad \\rightarrow \\quad - m \\aacc (t) = k \\gc (t) = \\estat (t)\n\\] so that if damping were neglected, Equation 5.5 and Equation 5.5 would yield identical results. With damping there will be differences but such differences could very well be neglected for lightly damped systems. The peak values for base shear and overturning moment may therefore be calculated via \\[\n\\baseshear = k \\dspec = m \\aspec\n\\qquad(5.6)\\] and \\[\n\\overturn = h k \\dspec = h m \\aspec  \n\\qquad(5.7)\\]\nWhen expressed in units of gravitational constant \\(\\gravity\\), the pseudo-acceleration \\(\\aspec\\) directly specifies the magnitude of peak base shear as a ratio to the weight (\\(W = m\\gravity\\)) of the SDOF system; e.g. when \\(\\aspec = 0.7\\gravity\\), then the peak shear is \\(\\baseshear = 0.7 m \\gravity = 0.7 W\\) or, in other words, \\(70 \\%\\) of the structural weight."
  },
  {
    "objectID": "eqsdof.html#characteristics-of-response-spectra",
    "href": "eqsdof.html#characteristics-of-response-spectra",
    "title": "5  Seismic Analysis of Single Degree of Freedom Systems",
    "section": "5.6 Characteristics of Response Spectra",
    "text": "5.6 Characteristics of Response Spectra\nFrom Equation 5.1 and Equation 5.2 we note that the response quantities \\(\\dspec, \\vspec, \\aspec\\) are all interrelated through the equation \\[\n\\frac{\\aspec}{\\freq} = \\vspec = \\freq \\dspec\n\\] which, when expressed in terms of the period instead of the frequency, become \\[ \\frac{T }{2 \\pi} \\aspec = V = \\frac{2 \\pi}{T} D \\]\nLogarithms (say to base 10) of these relations lead to \\[\n\\log \\vspec = - \\log \\period + \\log \\dspec + \\log 2\\pi\n\\] \\[\n\\log \\vspec = + \\log \\period + \\log \\aspec - \\log 2\\pi\n\\] so that if \\(\\log \\vspec\\) were to be plotted against \\(\\log \\period\\), \\(\\log \\dspec = \\text{constant}\\) would be a line parallel to the \\(- 45^\\circ\\) line (in other words, parallel to the line \\(\\log \\vspec = - \\log \\period\\)), and \\(\\log \\aspec = \\text{constant}\\) would be a line parallel to the \\(+ 45^\\circ\\) line (i.e. parallel to the line \\(\\log \\vspec = + \\log \\period\\)). Therefore, if plotted on the same logarithmic figure with the vertical axis corresponding to \\(\\vspec\\), \\(\\dspec\\) axis would have a slope of \\(+1\\) and \\(\\aspec\\) axis would have a slope of \\(-1\\). Thus, the three spectral response parameters \\(\\dspec\\), \\(\\vspec\\), and \\(\\aspec\\) may be shown on a single tripartate logarithmic graph as plotted in Figure 5.7. Such tripartate plots have historically helped identify certain trends in earthquake response spectra which in turn have been employed in development of design spectra.\n\n\n\nFigure 5.7: Tripartite D-V-A spectra for various damping ratios for the Kobe 1995 ground motion record of Figure 5.3 scaled to a PGA of \\(1 \\gravity\\).\n\n\nThere are two extremes in such spectra which happen to yield identical behaviors across all earthquake ground motions: lines for different \\(\\damp\\) converge to the same limits asymptotically at the low and high ends of the spectra. These two extremes may be explained by mechanical considerations. When the period is very low (\\(\\period \\rightarrow 0\\)), the stiffness of the system should be extremely large (assuming a proportinately finite mass). In the limit, if the structure were to be infinitely stiff (\\(k \\rightarrow \\infty\\)), then we would have \\[\n\\frac{m}{k} \\aacc (t) + \\gc (t) = 0 \\approx \\gc(t)\n\\] so that with no relative displacements, the mass would move identically as the ground. Hence the maximum absolute acceleration of the mass would be identical to the peak ground acceleration so that \\[\n\\text{as } \\period \\rightarrow 0, \\quad \\dspec \\rightarrow 0 \\text{ and } \\aspec \\rightarrow \\text{peak ground acceleration}\n\\] At the other extreme when \\(\\period \\rightarrow \\infty\\), the system has negligibly small stiffness (\\(k \\rightarrow 0\\)) so that almost no force is transmitted to the mass. The mass therefore stands still as the ground moves, with \\[\nm \\aacc (t) + k \\gc (t) = 0 \\approx m \\aacc \\rightarrow \\ddgc (t) \\approx - \\gacc (t), \\quad \\gc (t) \\approx - \\gdis (t)\n\\] and we have \\[\n\\text{as } \\period \\rightarrow \\infty, \\quad \\dspec \\rightarrow \\text{peak ground displacement} \\text{ and } \\aspec \\rightarrow 0\n\\] Note that these trends are clearly independent of the ground motion as they are rather solely dominated by the physical properties of the system. The mid-range of the periods meanwhile illustrate the regime in which damping plays a pivotal role in the dynamic amplification observed. The behavior in this region is generally idealized as variations around a constant velocity value."
  },
  {
    "objectID": "eqsdof.html#elastic-design-spectra",
    "href": "eqsdof.html#elastic-design-spectra",
    "title": "5  Seismic Analysis of Single Degree of Freedom Systems",
    "section": "5.7 Elastic Design Spectra",
    "text": "5.7 Elastic Design Spectra\nIt will be of interest to plot variations in the pseudo-acceleration response spectrum for different values of \\(\\damp\\) for a given ground motion time-history. This is shown in Figure 5.8 for the Kobe ground motion record of Figure 5.3. It is clear yet again that damping plays an important role for SDOF systems in the mid-period range. While the excitation time history would cause notable differences in the spectra, some generic observations can be made.\n\n\n\nFigure 5.8: Acceleration response spectra for the Kobe ’95 earthquake with various damping ratios and PGA = 1 g.\n\n\nFor \\(\\period\\) values that are very small, \\(\\aspec\\) converges to the peak ground acceleration. As the period gets longer, \\(\\aspec\\) exhibits a sharp increase with increasing \\(\\period\\). This increase can be assumed to be more or less linear. At intermediate values of \\(\\period\\), \\(\\aspec\\) shows large fluctuations in lightly damped systems. A plateau-like behavior can be seen as damping increases. Highest sensitivity to the damping ratio is observed in this intermediate regime. For design purposes, we may consider \\(\\aspec\\) to be roughly constant over a narrow range of \\(\\period\\) values beyond the initial linear increase regime, before transitioning to a decay regime. The value of \\(\\aspec\\) strongly depends on \\(\\damp\\) in this intermediate range. Beyond this point, \\(\\aspec\\) exhibits a roughly inverse \\(1/\\period\\) relation with the \\(\\period\\) and possibly transitions to a \\(1/\\period^2\\) scaling at very long periods.\nIn summary, three distinct regions possibly arise in an idealized spectrum. The spectrum starts from the PGA value and linearly rises in the acceleration governed, small period regime. In the narrow velocity governed regime, \\(\\aspec\\) fluctuates around an average value, possibly with sharp peak and troughs. At longer periods, \\(\\aspec\\) decays inversely with the period and the response is governed by a large relative displacement. These basic features form the basis of linear elastic design spectra used in structural design codes such as ASCE/SEI 7: “Minimum Design Loads and Associated Criteria for Buildings and Other Structures”. The parameters describing the curve, most notably the two periods that mark the transition points in the so-called traditional 2-period response spectra (2PRS), are determined based on the local regulations that take into account the expected magnitude of the earthquake and ground conditions, considering an ideal maximum credible earthquake (MCE, e.g. an earthquake with ~2,500 yr return period). Various tools (such as the “ASCE Hazard Tool”) can be used to obtain design spectra for specific site conditions. It should be noted that with ASCE 7-22 and subsequent versions, the design guidelines have shifted from the traditional two-period response spectra (2PRS) to multi-period response spectra (MPRS) that better captures the frequency characteristics of earthquakes5. Notable differences between 2PRS and MPRS spectra are the sharper peak and transition in the velocity governed regime and a more gradual decay in the long-period regime. Figure 5.9 demonstrates the ASCE 7-22 prescribed response and design spectra (defined as the 2/3 of the intensity of the response spectrum to MCE) for a site on stiff soil and ordinary building (Risk Level II) in Evanston, IL, USA.\nThe discussion of practical considerations in constructing and using response and design spectra are purposefully kept brief here not to detract from the fundamental concepts pertaining to structural dynamics. Developing understanding of seismic hazards results in continuous changes in design codes and regulations, as such, these discussions are meant to familiarize the reader with general considerations rather than intending to convey the most up to date and accurate practices. For a more in depth discussion of response and design spectra, as well as their historical development, we refern the reader to comprehensive references on structural dynamics and seismic design6.\n\n\n\nFigure 5.9: Example response and design spectra (spectral acceleration vs period): Risk Level II, Class D buildings in Evanston, IL, USA based on ASCE 7 specifications.\n\n\n\nEXAMPLE 5 .1\nBased on the response spectra shown in Figure 5.8 scaled down to a PGA of \\(0.5 \\gravity\\), calculate the peak base shear and overturning moment for an SDOF idealization of a one-story building with floor mass \\(m = 250 \\, 000~\\unit{kg}\\), floor height \\(h = 3~\\unit{m}\\), total lateral stiffness \\(k= 10 \\, 000\\unit{kN}\\), and \\(\\zeta = 0.05\\). Express the base shear and overturning moment in terms of the weight of the structure.\nWe first compute natural frequency and period of system as \\(\\freq = \\sqrt \\frac {k}{m} =\\) 6.32 rad/s. This gives \\[\\period = \\frac{2 \\pi} { \\freq} = 0.993~\\unit{s} .\\]\nWe can estimate \\(\\aspec\\) from the graph as \\[\\aspec \\approx 1.2\\times0.5 = 0.6 \\gravity \\]\nnoting that the acceleration must be scaled down by 50%. Then, the base shear is calculated as a function of the weight \\(W=m\\gravity\\):\n\\[ \\baseshear = mA = 0.6 m\\gravity = 0.6 W\\]\nSimilarly,\n\\[\\overturn = mAh = 1.8 W\\]\n\n\n\n\nMPRS methodology was proposed partly to better estimate the response of long-period structures on soft soils where 2PRS estimates may not be conservative.↩︎\nAnil K. Chopra, Dynamics of Structures, 6th edition, 2024.\nRay W. Clough and Joseph Penzien, Dynamics of Structures, 2nd edition, 2015↩︎"
  },
  {
    "objectID": "eqsdof.html#sec-Earthquake_Response_Spectra_for_Non-linear_SDOF_Systems",
    "href": "eqsdof.html#sec-Earthquake_Response_Spectra_for_Non-linear_SDOF_Systems",
    "title": "5  Seismic Analysis of Single Degree of Freedom Systems",
    "section": "5.8 Earthquake Response Spectra for Non-linear Systems",
    "text": "5.8 Earthquake Response Spectra for Non-linear Systems\nThe elastic response and design spectra are helpful in understanding the response of a building to strong ground motion, particularly the effects of viscous damping and the natural period on response characteristics. The current paradigm in earthquake engineering, however, is based on the premise that it is not feasible economically to design buildings in a way to ensure that they respond elastically in rare large earthquakes. It is expected and deemed acceptable to some degree that a building shall respond inelastically to a significant ground motion; that cracking of concrete, yielding and plastic deformation of reinforcing bars or moment resisting steel frames shall occur. These material nonlinearities conribute to energy dissipation capacity of the structure. Additionally, when displacements become large, geometric nonlinearities may also become significant; for instance, brace members or suspension cables may exhibit large deviations from their undeformed orientations, which in turn may necessitate use of nonlinear trigonometric relations to model the stiffness term in the SDOF equation of motion.\n\n\n\nFigure 5.10: Excessive damage due to high inelastic demands in a large earthquakes. Spalling of concrete and buckling of longitudinal reinforcement indicate that the design capacity has been exceeded.\n\n\nInelastic behavior is difficult to quantify and predict exactly, but safety may be approximately accounted for by estimating how much ductility structural members can exhibit without losing load-bearing capacity, and how that capacity would fare against the total elastic and plastic deformations that a structure would have to sustain during an earthquake, i.e. demand. High inelastic demands may lead to excessive damage on load bearing members, a few examples of which are shown in Figure 5.10; significant demands may lead to collapse of structures during earthquakes or the structure may need to be demolished after the earthquake due to irreperable damage. In this section we will try to examine the effects of plastic deformations on the response time histories and consequently the peak response spectrum variables \\(\\dspec\\),\\(\\vspec\\) and \\(\\aspec\\).\n\n5.8.1 Strength Reduction and Ductility\nThe elastoplastic (elastic-perfectly plastic) spring model was previously introduced in the context of non-linear numerical integration methods, where it was also illustrated how energy is dissipated via plastic deformation in the form of hysteresis during cyclic excitation. We once again adopt the simple elastoplastic spring model to account for post-elastic deformations, this time in the context of earthquake induced ground motions. With no claims to exactness, the elastoplastic (elastic-perfectly plastic) model leads to some observations which help understanding of response behavior in more complicated nonlinear force-deformation relationships in which stiffness is continuously modified throughout the analysis to simulate plastic deformations that could occur due to large displacements.\n\n\n\nFigure 5.11: Force-displacement relationships: (a) ideal elastoplastic spring model, (b) the corresponding linear elastic model.\n\n\nRecall that in the first loading (\\(\\diff \\gc \\geq 0\\) throughout) of an initially unloaded and undeformed elastoplastic spring, the force-displacement (\\(\\stifforce\\)-\\(\\gc\\)) relationship is defined as: \\[\n\\stifforce = \\begin{cases}\n    k \\gc   & \\text{if $\\gc &lt; \\yielddisp$}.\\\\\n    \\yieldforce & \\text{if $\\gc \\ge \\yielddisp$}.\n  \\end{cases}\n\\qquad(5.8)\\] Yielding begins when \\(\\gc = \\yielddisp\\), i.e. the yield displacement, and the corresponding spring force \\(\\yieldforce\\) is called the yield force. When defining such a spring one also needs to prescribe unloading and reloading roles, for which it is assumed yielding in tension and compression occur at the same deformation level (\\(\\gc' \\pm \\yielddisp\\) where \\(\\gc'\\) is some value of \\(\\gc\\) for which \\(\\stifforce = 0\\)), and all unloading and reloading lines are parallel to the initial loading line. These rules are graphically summarized in Figure 5.11 (a).\nIt has become customary in earthquake engineering to define a hypothetical conjugate linear SDOF system (also referred to as the corresponding linear system) for comparison purposes. The conjugate linear SDOF system is a system with the same mass and the same initial tangent stiffness as the inelastic system, and it is assumed that the conjugate system remains linear elastic with this stiffness value. If the conjugate linear SDOF system has a stiffness of \\(k\\) and its maximum deformation under an excitation is \\(\\dspec = \\maxlindisp\\), then the peak force transmitted by the spring of the conjugate system is \\(\\maxstifforce = k \\maxlindisp\\). The comparative behavior of an elastoplastic system and its conjugate linear SDOF system are sketched in Figure 5.11 (b). By definition, the force in the elastoplastic spring can not exceed the yield force so that if \\(\\maxlindisp &gt; \\yielddisp\\), then \\(\\maxstifforce &gt; \\yieldforce\\). One measure of inelastic action is the strength reduction factor \\(\\redfac\\) (also reffered to as the yield strength reduction factor), defined as \\[\n\\redfac= \\frac{\\maxstifforce}{\\yieldforce} = \\frac{\\maxlindisp}{\\yielddisp} \\geq 1\n\\] The strength reduction factor is significant because in some sense it provides a bound for force-based design: if the system is allowed to deform inelastically, then the force it will have to be designed for is less than the force it would have to resist if it were to remain elastic. This sounds too good to be true and it is: plastic deformations may not be allowed to reach excessive levels and, even more importantly, the system must be designed sufficiently well so as to be able to undergo expected plastic deformations without any failure (however one may define failure). So the strength reduction factor by itself does not suffice to ensure successful aseismic design. Another commonly used measure in earthquake engineering is the ductility demand \\(\\duct\\) (also referred to as the ductility factor) defined as \\[\n\\duct = \\frac{\\maxtotdisp}{\\yielddisp}\n\\] where \\(\\maxtotdisp\\) is the maximum (in an absolute value sense) deformation that occurs in the system under a particular excitation. The ductility demand helps to quantify the amount of plastic deformation that will be asked of a system designed with some value of \\(\\redfac\\) in mind. For a certain value of \\(\\redfac\\), the response of the inelastic SDOF model may be computed numerically to estimate the maximum deformation \\(\\maxtotdisp\\) with which the ductility demand may be forecast.\nIn the context of damped SDOF systems with damping ratio \\(\\damp\\), several important questions arise. First, what is the relationship between \\(\\redfac\\), \\(\\mu\\), and \\(\\period\\), and to a lesser extent \\(\\damp\\)? Qualitatively, one can expect that higher values of \\(\\redfac\\) will result in greater ductility demands, but how does this depend on system variables? Another important question is: how should an inelastic response spectra be constructed to understand the impact of ductility demand on key response variables, and what are the appropriate variables to ensure a rational comparison with elastic systems? This will allow us to contrast strength-based designs (elastic design) and ductility-based designs (inelastic design) to see how they fare against each other from an economical or structural performance standpoint.\n\n\n5.8.2 Inelastic Response Spectra\nAnalyses by Veletsos and Newmark7 using the El Centro and Vernon earthquake records in the early 1960s helped clarify how elastic and inelastic behavior can be contrasted. To examine various issues, we’ll calculate the response of inelastic systems subjected to an actual ground motion (in our case the Kobe ’95 record) using the central difference algorithm. The first question that arises is, can inelastic deformations dissipate sufficient energy to reduce the maximum displacement attained to be below that of the conjugate linear system. Figure 5.12 illustrates that for lightly damped systems, this appears to be the case over a wide range of intermediate periods.\n\n\n\nFigure 5.12: Ratio of maximum displacement (elastic or inelastic) to maximum elastic displacement (observed in the conjugte SDOF system) for the Kobe ground motion record of Figure 5.3 considering four different values of \\(\\redfac\\) (with \\(\\redfac=1\\) corresponding to the elastic case) and two different values of damping ratio: (a) \\(\\damp = 2\\%\\), (b) \\(\\damp = 20\\%\\).\n\n\n\n\n\nFigure 5.13: Variation of ductility demand as a function of period for four different values of \\(\\redfac\\) (with \\(\\redfac=1\\) corresponding to the elastic case) for the Kobe ground motion record of Figure 5.3.\n\n\nFor fairly rigid systems with small periods, on the other hand, plastic deformations become quite excessive, often exhibiting a multi-fold increase relative to linear responses. In this regime, the large ductility demands shown in Figure 5.13 impose some practical limitations on the utility of inelastic behavior. Thus, for structural systems that are fairly rigid and with periods lower than \\(1 \\unit{second}\\), the design tends to rely predominantly on strength to ensure that the response remains largely elastic. Inelastic deformations seem to contribute to keeping the peak displacements relatively small in the intermediate period range even for increasing values of viscous damping. Whereas for long-period structures, benefits of hysteretic damping seem marginal, in a sense similar to the case of viscous damping. In this long-period regime, as previously discussed in the context of elastic spectra, a system with a finite mass is relatively so very flexible that the mass basicaly stands still as the ground moves; hence one essentially has \\(\\maxlindisp \\approx \\maxtotdisp \\approx \\text{peak ground displacement}\\). This convergence also implies that for long-period systems one has \\(\\redfac \\approx \\duct\\) since for \\(\\maxlindisp = \\maxtotdisp\\), \\[\n\\redfac = \\frac{\\maxstifforce}{\\yieldforce} = \\frac{k \\maxlindisp}{k \\yielddisp} = \\frac{\\maxtotdisp}{\\yielddisp} = \\duct\n\\] and not surprisingly we see that the ductility curves in Figure 5.13 tend to their respective strength reduction factors toward the higher values of the period. The observation that for longer periods \\(\\maxlindisp \\approx \\maxtotdisp\\) (and, equivalently, \\(\\redfac \\approx \\duct\\)) is called the equal displacement rule and it has been used as a basis for many code provisions.\nTo delve deeper in to these comparisons, it will be fruitful to think about how response spectra may be constructed to allow for direct comparison between inelastic and elastic systems. For this purpose, we consider that the maximum elastic strain energy that can be stored in the inelastic system is given by \\[\n\\frac{1}{2} k \\yielddisp ^2 = \\frac{1}{2} m (\\freq \\yielddisp)^2=\\frac{1}{2} m \\yvspec^2\n\\] where the pseudo-velocity spectral response variable is defined as \\(\\yvspec \\equiv \\freq \\yielddisp\\). This notation is consistent with elastic pseudo-velocity and pseudo-acceleration definitions presented earlier, since for \\(\\redfac=1\\) corresponding to the elastic case we have \\[\n\\dspec = \\maxtotdisp = \\yielddisp  \n\\] Similarly, the pseudo-acceleration spectral response and yield-deformation spectral response variables can be defined in accordance with linear systems, which results in the following relationships: \\[\n\\frac{\\yaspec}{\\freq} = \\yvspec = \\freq \\ydspec\n\\qquad(5.9)\\]\nAs in the case of linear systems, \\(\\yaspec\\) is significant from a design standpoint because it is related to the maximum base shear and overturning moment that can be attained, i.e. \\(\\baseshear = m \\yaspec\\) since the maximum member force is capped at the yield strength. It is of practical utility to construct a constant ductility response spectrum for the variables shown in Equation 5.9 to understand how ductility demand will impact these response measures. Such a development, however, requires iterative determination of the relationship between \\(\\yieldforce\\) and \\(\\mu\\). This can be done by numerically computing the ductility demand and then determining the largest value of the \\(\\yieldforce\\) that results in a target \\(\\mu\\), within an acceptable threshold. Interpolation of \\(\\yieldforce\\) and \\(\\mu\\) relationships computed with a small number of points may also be used to more efficiently converge to the ductility solutions. Figure 5.14 demonstrates the relationship between \\(\\redfac\\) and \\(\\mu\\). From Figure 5.14, it is apparent that as \\(\\period \\rightarrow 0\\), \\(\\redfac \\approx 1\\). In the limit as \\(\\period \\rightarrow \\infty\\) period limit, \\(\\redfac \\approx \\mu\\). It has also been empirically suggested that \\(\\redfac \\approx \\sqrt{2 \\mu - 1}\\) in the intermediate range, although various analytical formulas could be fitted to this regime. These basic rules of thumb, along with linear interpolation of \\(\\redfac\\) between these constant \\(\\redfac\\) regimes can be used to determine design values for yield-strength reduction factors empirically based on ensembles of ground motion data to construct inelastic design spectra.\n\n\n\nFigure 5.14: Relationship between \\(\\redfac\\) and \\(\\period\\) for different \\(\\mu\\) for a system with \\(\\damp\\) = 0.05 subjected to the Kobe ground motion record of Figure 5.3.\n\n\n\n\n\nFigure 5.15: \\(\\yaspec\\) vs \\(\\period\\) for varying \\(\\mu\\) values for a system with \\(\\damp\\) = 0.05 subjected to the Kobe ground motion record of Figure 5.3.\n\n\nFigure 5.15 illustrates the variation of \\(\\yaspec\\) with \\(\\period\\). Comparing Figure 5.8 with this spectra while being mindful of the scaling difference due to different PGAs, it is evident that the role of inelastic deformation is similar to damping, with a moderate amount of ductility strongly reducing the amount of strain energy that must be accommodated elastically in the system during deformations. As in the case of viscous damping, inelastic dissipation is most effective in the intermediate range of periods, which is the velocity sensitive regime. For the pseudo-acceleration spectra, it is clear that allowing a ductility factor of \\(\\mu = 2\\) is equivalent to having a linear system with fairly high levels of damping (~10%) in the velocity-sensitive regime. Considering that most structural engineering materials and member designs can accommodate reasonable amounts of ductility in the range of \\(\\mu \\approx 3\\), and that externally supplementing viscous damping is relatively costly, ductile designs offer economical alternatives to purely strength-based designs that enforce strictly linear behavior.\nBased on these considerations, we can summarize the seismic design process as follows. The designer may choose to pursue a strength-based design approach, ensuring that the response remains elastic at all times. This may be an economical solution in fairly rigid, short period structures in which high ductility demands may result in displacements that exceed safety limits even with a relatively small \\(\\redfac\\). For intermediate to longer period structures, accounting for some degree of inelastic deformation will often yield more economical solutions.8 This can be pursued by choosing a reasonable \\(\\redfac\\) and determining what is an acceptable ductility demand, for instance using the approximate \\(\\redfac - \\mu\\) relationships listed above for different period ranges. In building codes, the reduction factor is generalized to account for not only the yield behavior but also the overstrength that a structure should have, which is the difference between the design strength and the true yield strength that exceeds that value. All the relevant parameters such as the maximum deformation of an inelastic system can be determined directly from an elastic response spectrum. For instance, in the case of an allowable stress design approach, assume that the designer needs to determine \\(\\yieldforce\\). Based on the type of the structure and materials used, building codes typically prescribe an allowable ductility factor \\(\\mu\\). Based on a linear elastic design spectrum, \\(\\aspec\\) can be determined for a given \\(\\damp\\) and \\(\\period\\). Then, approximations for \\(\\redfac\\) based on \\(\\mu\\) can be determined for the given \\(\\period\\) using the established empirical relationships (recall trends in Figure 5.14). From there it follows that \\(\\baseshear = m \\aspec/\\redfac = \\yieldforce\\). Additionally, one may need to consider the maximum displacement attained to ensure that it is within allowable limits. Recall that \\[ \\mu = \\frac{\\maxtotdisp}{\\yielddisp} = \\frac{\\maxtotdisp \\redfac}{ \\dspec}  \\qquad(5.10)\\] where \\(\\dspec\\) is the maximum displacement attained in the conjugate linear system, and thus \\(\\yielddisp = \\dspec/R\\). Noting that for the conjugate linear system, \\[\\aspec = \\left(\\frac{2 \\pi}{\\period}\\right)^2 \\dspec  \\qquad(5.11)\\] we can use Equation 5.11 in Equation 5.10 to obtain: \\[ \\maxtotdisp = \\mu \\frac{1}{R} \\left(\\frac{T}{2 \\pi}\\right)^2 \\aspec  \\qquad(5.12)\\]\n\n\n\n\nA.S. Veletsos and N.M. Newmark, Effect of Inelastic Behavior on the Response of Simple Systems to Earthquake Motions, Proc. of 2nd WCEE, pp. 895-912, 1960.↩︎\nWe have to be careful about what we mean by “economical” as the validity of the adjective depends very much on the boundaries or horizon of analyses. Recent earthquakes have unfortunately shown that indirect losses, such as significant population migration away from heavily damaged quarters and the consequent socio-economic losses may better be avoided even at higher costs of initial construction. “Resilient Urban Environment” may become the dominant paradigm in recent future.↩︎"
  },
  {
    "objectID": "eqsdof.html#wrapping-up",
    "href": "eqsdof.html#wrapping-up",
    "title": "5  Seismic Analysis of Single Degree of Freedom Systems",
    "section": "5.9 Wrapping Up",
    "text": "5.9 Wrapping Up\nIn this chapter, we tried to introduce the basic concepts and analyses techniques developed for understanding how SDOF systems respond to base excitations, most notably in earthquakes. For linear systems designed for substantial strength, construction of elastic response spectra is relatively straightforward and can be done using existing ground acceleration time-histories. Appropriate care must be taken to ensure that time-histories, notably frequency range of the excitations, and peak amplitude of ground accelerations taken are representative of the site conditions and historical characteristics of earthquakes in the region. Principles underlying simplified design spectra commonly employed in building codes were briefly mentioned. We also introduced concepts of inelastic response spectra and design considerations, namely the importance of ductility in dissipating energy and economical designs that arise when ductility is favored over strength."
  },
  {
    "objectID": "multidof.html#sec-matrixform",
    "href": "multidof.html#sec-matrixform",
    "title": "6  Models for Linear Multi Degree of Freedom Systems",
    "section": "6.1 Equations of Motion in Matrix Form",
    "text": "6.1 Equations of Motion in Matrix Form\nTo begin thinking about the equations that govern the dynamics of linear MDOF systems let’s first consider the simple case of a three degree of freedom system. A tinker toy model of a 3-DOF system is shown in Figure 6.1 a in which three point masses connected by springs and dashpots are allowed to move in one direction. Since the individual masses may move in differing amounts, we need to track the position of each separately. The positions of the masses \\(m_1\\), \\(m_2\\) and \\(m_3\\) are denoted by \\(\\gc_1\\), \\(\\gc_2\\) and \\(\\gc_3\\), respectively, and these are the generalized coordinates of our model. External forces \\(\\extforce_1 (t)\\), \\(\\extforce_2 (t)\\) and \\(\\extforce_3 (t)\\) may in general be imposed on the masses.\n\n\n\nFigure 6.1: Three degree of freedom system: (a) the model, (b) free-body diagrams of the individual masses.\n\n\nSince we have three distinct point masses, Newton’s second law may be applied to each individual mass separately, which will in turn yield the governing equation for that mass in terms of the generalized coordinates and system parameters. Since the motion of each mass is one dimensional, we may develop the equations using scalar analysis. To this end we first have to sketch the free body diagram of each mass at an instant at which all kinematic variables (displacements, velocities and accelerations) are positive valued to obtain algebraically consistent signs and implied directions. Such free body diagrams are shown in Figure 6.1 b in which all the masses are assumed to be in those states for which \\(\\gc_i &gt; 0\\), \\(\\dgc_i &gt; 0\\) and \\(\\ddgc_i &gt; 0\\). The directions of the forces, indicated by the arrowheads, are consistent with the assumed states and relative motions.\nConsidering the sum of forces for each particle, we deduce the following equations from the individual free body diagrams: \\[\n\\extforce_1 + k_2(\\gc_2 - \\gc_1) + c_2 (\\dgc_2 - \\dgc_1) - c_1 \\dgc_1 - k_1 \\gc_1 = m_1 \\ddgc_1  \n\\] \\[\n\\extforce_2 + k_3(\\gc_3 - \\gc_2) + c_3(\\dgc_3 - \\dgc_2) - k_2(\\gc_2 - \\gc_1) - c_2(\\dgc_2 - \\dgc_1) = m_2 \\ddgc_2\n\\qquad(6.1)\\] \\[\n\\extforce_3 - k_3(\\gc_3 - \\gc_2) - c_3(\\dgc_3 - \\dgc_2)= m_3 \\ddgc_3\n\\] Now it is important to note that these equations are coupled, meaning that the variables \\(\\gc_i\\) and their time derivatives appear in multiple equations. If, for example, the first equation had only \\(\\gc_1\\) and its time derivatives, the second \\(\\gc_2\\) and its time derivatives, and the third \\(\\gc_3\\) and its time derivatives, then we would have three uncoupled equations that govern the dynamics of three separate single degree of freedom systems. These systems would be able to move independently of what the others are doing. For our system, however, the equations are coupled in that, for example, to solve for \\(\\gc_1\\) using the first equation we need to know \\(\\gc_2\\) which also appears in that equation. The motions of the masses affect each other and their responses must be determined simultaneously. This is the major difficulty with analyses of MDOF systems.\nA more general representation is possible if we choose to write these equations in matrix form. A simple rearrangement of terms leads to \\[\\begin{align*}\n\\underbrace{\\begin{bmatrix}\nm_1 & 0 & 0  \\\\\n0 & m_2 & 0 \\\\\n0 & 0 & m_3 \\\\\n\\end{bmatrix}}_{\\mmat}  \n\\underbrace{\\colmat{\\ddgc_1 \\\\ \\ddgc_2 \\\\ \\ddgc_3}}_{\\ddgcvec}  & + \\underbrace{\\begin{bmatrix}\nc_1 + c_2 & -c_2 & 0 \\\\ -c_2 & c_2+c_3 & -c_3  \\\\ 0 &-c_3 & c_3 \\end{bmatrix}}_{\\cmat} \\underbrace{\\colmat{\\dgc_1 \\\\ \\dgc_2 \\\\ \\dgc_3}}_{\\dgcvec} + \\\\\n& \\underbrace{\\begin{bmatrix}\nk_1 + k_2 & -k_2 & 0 \\\\ -k_2 & k_2+k_3 & -k_3  \\\\ 0 &-k_3 & k_3 \\end{bmatrix}}_{\\kmat} \\underbrace{\\colmat{\\gc_1 \\\\ \\gc_2 \\\\ \\gc_3}}_{\\gcvec}= \\underbrace{\\colmat{\n\\extforce_1 \\\\ \\extforce_2 \\\\ \\extforce_3}}_{\\ldvec}\n\\end{align*}\\] In this representation, the accelerations are collected in the column matrix \\(\\ddgcvec\\), the velocities in the column matrix \\(\\dgcvec\\), and the displacements in the column matrix \\(\\gcvec\\), all having dimensions of \\(n \\times 1\\) with \\(n\\) being the number of degrees of freedom (\\(n=3\\) for our current example). The matrix \\(\\mmat\\) that multiplies the accelerations \\(\\ddgcvec\\) is called the mass matrix, the matrix \\(\\cmat\\) that multiplies the velocities \\(\\dgcvec\\) is called the damping matrix, and the matrix \\(\\kmat\\) that multiplies the displacements/deformations \\(\\gcvec\\) is called the stiffness matrix of the system. These are square matrices with dimensions equal to the number of degrees of freedom of the system (i.e., \\(n \\times n\\), with \\(n=3\\) for our example). The column matrix \\(\\ldvec\\) appearing on the right hand side of the equation comprises the external forces. \\(\\ldvec\\) also has dimensions \\(n \\times 1\\) and, for ease of reference, it is often called the external force vector or the load vector. With these definitions, the equations of motion for our example may now be stated as \\[\n\\mmat \\ddgctvec + \\cmat \\dgctvec + \\kmat \\gctvec = \\ldtvec\n\\qquad(6.2)\\] and, more importantly, the equations of motion for any linear MDOF system will be given by this matrix expression. For different systems the sizes of matrices will differ, the coefficients in the matrices will differ, but once the equations are written in matrix form, they will be identical to the expression that we see in Equation 6.2. If the system is undamped, then its equations of motion will be given by \\[\n\\mmat \\ddgctvec +  \\kmat \\gctvec = \\ldtvec\n\\] and if this undamped system is undergoing free vibrations, then the equations of motion will be given by \\[\n\\mmat \\ddgctvec +  \\kmat \\gctvec = \\zerocol\n\\] where \\(\\zerocol\\) denotes a column matrix, of dimensions \\(n \\times 1\\), whose elements are all equal to zero. Clearly both of these equations may be derived from Equation 6.2 by enforcing \\(\\cmat = \\zeromat\\) and/or \\(\\ldvec = \\zerocol\\); \\(\\zeromat\\) is the zero matrix, of dimensions \\(n \\times n\\), with all of its elements equal to zero.\nIt is therefore of utmost importance to develop solution strategies that will directly deal with the matrix form of equations so that such strategies will be applicable to all linear MDOF systems. To solve the matrix equation of motion means to find \\[\n\\gctvec = \\colmat{\n\\gc_1(t)  \\\\\n\\gc_2(t) \\\\\n\\gc_3(t) \\\\\n}\n\\qquad(6.3)\\] for all relevant time instances \\(t\\). This solution must satisfy the equilibrium condition specified by Equation 6.2 at all times and furthermore it must also satisfy the initial conditions \\(\\gcvec (0)\\) and \\(\\dgcvec (0)\\)."
  },
  {
    "objectID": "multidof.html#symmetry-of-system-matrices",
    "href": "multidof.html#symmetry-of-system-matrices",
    "title": "6  Models for Linear Multi Degree of Freedom Systems",
    "section": "6.2 Symmetry of System Matrices",
    "text": "6.2 Symmetry of System Matrices\nTo introduce some additional concepts and details, let us consider as a second example the simple rigid bar shown in Figure 6.2. In order to simplify the problem, we will assume that horizontal motion of the bar is negligible. Any horizontal forces, including those that are associated with the rotation of the bar, will remain so small that they may be neglected. This assumption also implies that vertical motion, although not negligible, also remains relatively small such that circular arcs may be approximated by tangent lines and angles by their tangents. With these approximations the problem is drastically simplified but consequently, at least in principle, the analyses are limited to immediate vicinity of the initial equilibrium configuration. Gravity is assumed to play no role in this particular problem.\n\n\n\nFigure 6.2: A rigid bar constrained to move vertically.\n\n\nThe first order of business is to determine the generalized coordinates to be employed in the analysis. One way to think about the problem is to visualize the possible motion of the bar and identify possible candidates with which this motion may be described. As the bar is said to be rigid, this particular problem essentially boils down to choosing variables to describe a straight line. Furthermore, since the parts of the bar is assumed to move vertically, knowing the vertical positions of any two points on this straight line suffices to sketch the line. The system therefore has only two degrees of freedom in that once any two points on the bar are located at any instant, the positions of all its other parts may be determined in relation to those two points. One could also choose to identify the orientation of the bar through the angle it makes with the horizontal, so that knowing the vertical translation of any point on the bar and the rotation of the bar about that point also suffices to sketch the current spatial configuration of the whole bar. There is therefore an infinite number of choices that we may use as our generalized coordinates, three sets of which are shown in Figure 6.3. The sketches shown in the figure greatly exaggerate the displacements for visual purposes and they clearly do not conform to our stated assumptions of small amplitude motions, hence they should be regarded with care. So which choice shall we proceed with? Some choices may lead to simpler structures in the system matrices but it is somewhat early to introduce these investigations and therefore we postpone relevant discussions to after our initial analyses.\n\n\n\nFigure 6.3: Possible choices of generalized coordinates for modeling the dynamics of the rigid bar.\n\n\nFor no particular reason, let us choose as our generalized coordinates the vertical translations of the two ends of the bar as shown in Figure 6.4 wherein the top sketch shows the kinematic variables and the bottom figure shown the free body diagram of the bar. Here we have to note some issues which follow from our initial assumption of small displacements. The location of any point on the bar should in general be specified via the coordinate \\(s'\\), which denotes a positional variable in the deformed configuration. Since, however, the vertical displacements are assumed to be small and the horizontal displacements (and velocities and accelerations) are assumed to be comparatively negligible, we may instead use the horizontal position variable \\(s\\) since by assumption \\(s \\approx s'\\). The vertical position \\(\\gc (s,t)\\) of the piece of the bar located at \\(s\\) at time \\(t\\) is given by \\[\n\\gc (s,t) = \\gc_1 (t) + \\ratio{s}{\\ell} (\\gc_2 (t) - \\gc_1 (t))\n\\] and the vertical velocity of that same piece is \\[\n\\dgc (s,t) = \\dgc_1 (t) + \\ratio{s}{\\ell} (\\dgc_2 (t) - \\dgc_1 (t))\n\\qquad(6.4)\\] Let us first use the Newton-Euler approach to derive the governing equations of motion. To this end we have to calculate the linear and angular momenta (about the center of mass), take their time derivatives, and equate these time derivatives to the sums of external forces and moments, i.e. \\[\n\\dlinmom = \\fvec, \\quad \\dangmom{\\com} = \\moment{\\com}\n\\]\n\n\n\nFigure 6.4: Vertical motion of the rigid bar and the employed generalized coordinates.\n\n\nIf the bar is homogeneous, its center of mass is located at \\(s = \\ell/2\\), and the mass of an infinitesimal segment of width \\(\\diff s\\) is given by \\((m / \\ell) \\diff s\\). The vertical linear momentum of this infinitesimal piece given by the product of its mass and its vertical velocity so that when the piece is located at \\(s\\), its vertical linear momentum is \\[\n\\left[\\left(\\frac{m}{\\ell}\\right)\\diff s\\right]\\left[\\dgc_1 (t) + \\ratio{s}{\\ell} (\\dgc_2 (t) - \\dgc_1 (t))\\right]\n\\] and the vertical linear momentum of the whole bar is therefore given by \\[\n\\int_{0}^{\\ell} \\left(\\frac{m}{\\ell}\\right)\\left[\\dgc_1 (t) + \\ratio{s}{\\ell} (\\dgc_2 (t) - \\dgc_1 (t))\\right]\\diff s = m \\left(\\ratio{\\dgc_1 + \\dgc_2}{2} \\right)\n\\] which of course is equal to the total mass of the bar times the vertical velocity of its center of mass.1 Since the time derivative of the vertical linear momentum is equal to the resultant of the external forces we have, from the free body diagram in Figure 6.4, \\[\nm \\left(\\ratio{\\ddgc_1 + \\ddgc_2}{2} \\right) = - k \\gc_1 - 2k\\gc_2 - \\sforce_1 + \\sforce_2\n\\] which, after rearranging, may be written as \\[\n\\ratio{m}{2} \\ddgc_1 + \\ratio{m}{2} \\ddgc_2 + k \\gc_1 + 2k\\gc_2 = \\sforce_2 - \\sforce_1\n\\qquad(6.5)\\] To derive the expression for angular momentum about the center of mass, we note that the position of the infinitesimal segment with respect to the center of mass is given by \\(s-\\ell/2\\). Note that angular momentum is a vectorial quantity given by an expression of the sort \\(\\pvec \\times \\linmom\\) (i.e. position times linear momentum): for the infinitesimal segment to the right of the center of mass the position variable is positive, its velocity (and hence its linear momentum) is positive if it is upward, and their vectorial product yields a vector perpendicular to the plane of the bar with the sense given by the right hand rule (i.e. positive when out of the screen or page on which you are reading this text). The scalar component of the angular momentum for the infinitesimal piece is therefore given by \\[\n\\left[s-\\frac{\\ell}{2}\\right]\\left[\\left(\\frac{m}{\\ell}\\right)\\diff s\\right]\\left[\\dgc_1 (t) + \\ratio{s}{\\ell} (\\dgc_2 (t) - \\dgc_1 (t))\\right]\n\\] and the angular momentum of the whole bar about its center of mass is \\[\n\\int_{0}^{\\ell} \\left(\\frac{m}{\\ell}\\right)\\left[s-\\frac{\\ell}{2}\\right]\\left[\\dgc_1 (t) + \\ratio{s}{\\ell} (\\dgc_2 (t) - \\dgc_1 (t))\\right]\\diff s = \\ratio{m \\ell}{12} \\left(\\dgc_2 - \\dgc_1\\right)\n\\] which, of course, is equal to the product of the bar’s moment of inertia about its center of mass (i.e. \\(m \\ell^2 / 12\\)) and its angular velocity (i.e. \\((\\dgc_2 - \\dgc_1)/\\ell\\)). As the time derivative of this angular momentum should be equal to the resultant moment of the external forces and moments about the center of mass, we have, based on the free body diagram in Figure 6.4, \\[\n\\ratio{m \\ell}{12} \\left(\\ddgc_2 - \\ddgc_1\\right) = \\ratio{k \\ell}{2} \\gc_1 - \\ratio{2 k \\ell}{2} \\gc_2 - \\ratio{\\ell}{4} \\sforce_1 - \\smoment\n\\] which could be rewritten as \\[\n- \\ratio{m \\ell}{12} \\ddgc_1 + \\ratio{m \\ell}{12} \\ddgc_2 - \\ratio{k \\ell}{2} \\gc_1 + k \\ell \\gc_2 = - (\\ratio{\\ell}{4} \\sforce_1 + \\smoment)\n\\qquad(6.6)\\] When the two equations derived from linear and angular momenta are written in matrix form one gets \\[\n\\begin{bmatrix}\n\\ratio{m}{2} & \\ratio{m}{2}  \\\\\n-\\ratio{m \\ell}{12} & \\ratio{m \\ell}{12}\n\\end{bmatrix}\n\\colmat{\\ddgc_1 \\\\\\ddgc_2} + \\begin{bmatrix}\nk & 2k \\\\ - \\ratio{k \\ell}{2} & k \\ell \\end{bmatrix} \\colmat{\\gc_1 \\\\ \\gc_2} = \\colmat{\\sforce_2 - \\sforce_1 \\\\ - \\ratio{\\sforce_1 \\ell}{4} - \\smoment}\n\\qquad(6.7)\\] These equations are perfectly fine in terms of representing the dynamics, but the coefficient matrices are not symmetric as were those of the 3-DOF model discussed previously. Symmetry is a desirable property for computational purposes and it follows naturally if certain physical expectations (such as Betti’s law of reciprocity for example) are accounted for. One drawback about the Newton-Euler approach for MDOF systems is that the symmetry of the coefficient matrices is not guaranteed when an arbitrary set of generalized coordinates are employed. It should be mentioned that if, for example, we were to use the vertical translation of the center of mass of the bar and its rotation about that point as our generalized coordinates, we would end up with symmetric coefficient matrices with the Newton-Euler approach.\nThe Lagrangian approach, on the other hand, ensures symmetry naturally for all choices of generalized coordinates. To exemplify this statement, let us use the same two coordinates \\(\\gc_1\\) and \\(\\gc_2\\) shown in Figure 6.4, and this time use Lagrange’s equations. The velocity of an infinitesimal segment of the bar is given by the expression in Equation 6.4 so that the kinetic energy of the bar is: \\[\n\\ke = \\int \\frac{1}{2} \\dgc^2 \\dm = \\int_{0}{\\ell} \\frac{1}{2}  \\left[\\dgc_1 + \\frac{s}{\\ell} (\\dgc_2 - \\dgc_1)\\right]^2 \\frac{m}{\\ell}\\diff s = \\frac{m}{6} \\left[\\dgc_1^2 + \\dgc_2^2 + \\dgc_1 \\dgc_2\\right]\n\\] This form of the kinetic energy is representative of most systems and in the most general case one may expect to have a kinetic energy function of the form2 \\[\n\\ke = \\ke(\\{\\gc\\},\\{\\dgc\\},t) = \\ratio{1}{2} \\sum_{i}\\sum_{j} m_{ij}(\\{\\gc\\},t) \\dgc_i \\dgc_j + \\sum_{i} \\widehat{m}_{i}(\\{\\gc\\},\\,t) \\dgc_i + \\widehat{m}_o(\\{\\gc\\},t)\n\\] where \\(\\{\\gc\\}\\) denotes the set of generalized coordinates used for the system and \\(\\{\\dgc\\}\\) denotes the set of generalized velocities, with the summations over all generalized coordinates. The coefficients themselves may be functions of generalized coordinates and time so that \\(m_{ij}=m_{ij}(\\{\\gc\\},t)\\), \\(\\widehat{m}_{i} = \\widehat{m}_{i}(\\{\\gc\\},\\,t)\\), and \\(\\widehat{m}_o =\\widehat{m}_o(\\{\\gc\\},t)\\). Whenever time does not explicitly appear in the relations the last two terms disappear and the kinetic energy becomes a homogeneous quadratic form of the generalized velocities as \\[\n\\ke = \\ke(\\{\\gc\\},\\{\\dgc\\}) = \\ratio{1}{2} \\sum_{i}\\sum_{j} m_{ij}(\\{\\gc\\}) \\dgc_i \\dgc_j\n\\] and it may be shown that the coefficients are such that \\(m_{ij} = m_{ji}\\) for all \\(i,j\\). Furthermore, when we consider small oscillations around the equilibrium configuration, these coefficients cease to depend explicitly on generalized coordinates so that \\[\n\\ke(\\{\\dgc\\}) = \\ratio{1}{2} \\sum_{i}\\sum_{j} m_{ij} \\dgc_i \\dgc_j\n\\] with \\(m_{ij} = m_{ji}\\), given by: \\[\nm_{ij} = \\ratio{\\partial^2 \\ke}{\\partial \\dgc_i \\partial \\dgc_j}\n\\qquad(6.8)\\] In this case the kinetic energy of the system may be expressed using matrix notation as \\[\n\\ke = \\ratio{1}{2} \\dgcvec^T \\mmat \\dgcvec\n\\qquad(6.9)\\] where, for an n-DOF system, \\[\n\\mmat = \\begin{bmatrix} m_{11} & m_{12} & \\cdots & m_{1n} \\\\ m_{21} & m_{22} & \\cdots & m_{2n} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ m_{n1} & m_{n2} & \\cdots & m_{nn} \\end{bmatrix} \\quad \\text{and} \\quad \\dgcvec = \\colmat{\\dgc_1 \\\\ \\dgc_2 \\\\ \\vdots \\\\ \\dgc_n}\n\\] The potential energy of the system of Figure 6.2 comprises the energy stored in the two springs so that we have \\[\n\\pe = \\frac{1}{2} k \\gc_1^2 + \\frac{1}{2} 2k \\gc_2^2\n\\] The potential function may in general depend on generalized coordinates and time, i.e. we may have to deal with a function \\(\\pe = \\pe(\\{\\gc\\},t)\\). Most often this function does not explicitly depend on time. Moreover, when we consider small oscillations around the equilibrium configuration, it may be shown that the potential energy has the form \\[\n\\pe = \\pe(\\{\\gc\\}) = \\frac{1}{2} \\sum_{i} \\sum_{j} k_{ij} \\gc_i \\gc_j\n\\] where the coefficients do not explicitly deped on generalized coordinates, and that they are given by \\[\nk_{ij} = \\ratio{\\partial^2 \\pe}{\\partial \\gc_i \\partial \\gc_j}\n\\qquad(6.10)\\] such that \\(k_{ij}=k_{ji}\\) for all \\(i,j\\). In this case the potential energy of the system may be expressed using matrix notation \\[\n\\pe = \\ratio{1}{2} \\gcvec^T \\kmat \\gcvec\n\\qquad(6.11)\\] where, for an n-DOF system, \\[\n\\kmat = \\begin{bmatrix} k_{11} & k_{12} & \\cdots & k_{1n} \\\\ k_{21} & k_{22} & \\cdots & k_{2n} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ k_{n1} & k_{n2} & \\cdots & k_{nn} \\end{bmatrix} \\quad \\text{and} \\quad \\gcvec = \\colmat{\\gc_1 \\\\ \\gc_2 \\\\ \\vdots \\\\ \\gc_n}\n\\]\n\n\n\nFigure 6.5: Virtual displacements and resulting patterns.\n\n\nThe last step before we write Lagrange’s equations is identifying the generalized forces. Recall that the generalized forces are the coefficients in the virtual work expression when arbitrary virtual variations of the generalized coordinates are considered. Considering the external forces \\(\\sforce_1\\), \\(\\sforce_2\\) and \\(\\smoment\\) shown in the free body diagram in Figure 6.4 and imposing virtual displacements \\(\\virt \\gc_1\\) and \\(\\virt \\gc_2\\) shown in Figure 6.5, the virtual work done by the external forces3 as the system goes through these virtual displacements is given by \\[\n\\ratio{\\virt \\gc_1}{2} F_2 - \\ratio{\\virt \\gc_1}{4} F_1 + \\ratio{\\virt \\gc_1 - \\virt \\gc_2}{\\ell} \\smoment - \\ratio{3 \\virt \\gc_2}{4} F_1 + \\ratio{\\virt \\gc_2}{2} F_2 = \\vforce_1 \\virt \\gc_1 + \\vforce_2 \\virt \\gc_2  \n\\] so that the generalized forces are identified as the coefficients of the virtual displacements as \\[\n\\vforce_1 = \\ratio{1}{2} F_2 - \\ratio{1}{4} F_1 + \\ratio{1}{\\ell} \\smoment, \\qquad  \\vforce_2 = \\ratio{1}{2} F_2 - \\ratio{3}{4} F_1 - \\ratio{1}{\\ell} \\smoment\n\\] Now we are ready to derive the governing equations for our model. Lagrange’s equations specify that for our 2-DOF system, \\[\n\\frac{\\diff}{\\diff t} \\left(\\frac{\\partial \\ke}{\\partial \\dgc_{i}}\\right) - \\frac{\\partial \\ke}{\\partial \\gc_{i}} + \\frac{\\partial \\pe}{\\partial \\gc_{i}} = \\vforce_i \\qquad \\text{for} \\quad i=1,2\n\\qquad(6.12)\\] Substituting the energy expressions and evaluating the derivatives lead to \\[\n\\ratio{m}{3} \\ddgc_1 + \\ratio{m}{6} \\ddgc_2 + k \\gc_1  = \\ratio{1}{2} F_2 - \\ratio{1}{4} F_1 + \\ratio{1}{\\ell} \\smoment\n\\qquad(6.13)\\] and \\[\n\\ratio{m}{6} \\ddgc_1 + \\ratio{m}{3} \\ddgc_2 + 2k \\gc_2  = \\ratio{1}{2} F_2 - \\ratio{3}{4} F_1 - \\ratio{1}{\\ell} \\smoment\n\\qquad(6.14)\\] which may be combined into a single matrix equation as follows: \\[\n\\begin{bmatrix}\n\\ratio{m}{3} & \\ratio{m}{6}  \\\\\n\\ratio{m}{6} & \\ratio{m}{3}\n\\end{bmatrix}\n\\colmat{\\ddgc_1 \\\\\\ddgc_2} + \\begin{bmatrix}\nk & 0 \\\\ 0 & 2k  \\end{bmatrix} \\colmat{\\gc_1 \\\\ \\gc_2} = \\colmat{\\ratio{1}{2} F_2 - \\ratio{1}{4} F_1 + \\ratio{1}{\\ell} \\smoment \\\\ \\ratio{1}{2} F_2 - \\ratio{3}{4} F_1 - \\ratio{1}{\\ell}\\smoment}\n\\qquad(6.15)\\] So how is it that we come up with two different equations that govern the same set of generalized coordinates; in other words, can Equation 6.7 and Equation 6.15 both be valid? These two sets of equations are indeed interrelated as one set is a linear combination of the other (e.g. simple addition of Equation 6.12 and Equation 6.13 leads to Equation 6.5). As we have the possibility of obtaining symmetric coefficient matrices by a choice of method or coordinates in all cases, we will always assume that the mass and the stiffness (and eventually also the damping) matrices are symmetric, and develop solution strategies accordingly."
  },
  {
    "objectID": "multidof.html#footnotes",
    "href": "multidof.html#footnotes",
    "title": "6  Models for Linear Multi Degree of Freedom Systems",
    "section": "",
    "text": "Implicit assumption here being that the input influence matrix is time invariant, i.e. it remains unaltered as the system moves, so that taking time derivatives to obtain accelerations is trivial.↩︎"
  },
  {
    "objectID": "multidof.html#stiffness-and-inertia-influence-coefficients",
    "href": "multidof.html#stiffness-and-inertia-influence-coefficients",
    "title": "6  Models for Linear Multi Degree of Freedom Systems",
    "section": "6.3 Stiffness and Inertia Influence Coefficients",
    "text": "6.3 Stiffness and Inertia Influence Coefficients\n\n6.3.1 Force Equilibrium\nA more direct way to derive the coefficient matrices is often employed in structural dynamics due to its algorithmic nature. This approach addresses the matrix form of equations, given by \\[\n\\mmat \\ddgcvec + \\kmat \\gcvec = \\ldvec\n\\] as the force summation equation that it is, in the form \\[\n\\intf + \\stff = \\ldvec\n\\] where the components of \\[\n\\intf = \\mmat \\ddgcvec\n\\] are called the inertia forces and the components of \\[\n\\stff = \\kmat \\gcvec\n\\] are called the elastic forces. Note that both the inertia and the elastic forces are generated by motion. Since for small amplitude motion the coefficients in the mass and stiffness matrices do not explicitly depend on generalized coordinates, these terms may be thought of as independent quantities in that it may be possible to discuss them separately.\nLet us start with the elastic forces term. As the force equilibrium equation has to be valid whenever the accelerations are zero too, the stiffness related term may be determined by the well-known methods of structural analysis, e.g. the direct displacement method. In this case the force equilibrium equation would read \\[\n\\stff = \\kmat \\gcvec = \\begin{bmatrix} k_{11} & k_{12} & \\cdots & k_{1n} \\\\ k_{21} & k_{22} & \\cdots & k_{2n} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ k_{n1} & k_{n2} & \\cdots & k_{nn} \\end{bmatrix} \\colmat{\\gc_1 \\\\ \\gc_2 \\\\ \\vdots \\\\ \\gc_n}= \\ldvec = \\colmat{\\extforce_1 \\\\ \\extforce_2 \\\\ \\vdots \\\\ \\extforce_n}\n\\] where \\(k_{ij}\\) are called the stiffness influence coefficients. Now consider a particular case with a small displacement \\(\\gc_1 &gt; 0\\) while all other displacements are kept at zero (remember that accelerations were already assumed zero). In this particular case, the external forces and moments (depending on whether the DOF is translational of rotational) that have to be applied along the generalized coordinates for equilibrium of the system have to be equal to \\[\n\\colmat{k_{11} \\gc_1 \\\\ k_{21} \\gc_1 \\\\ \\vdots \\\\ k_{n1} \\gc_1} = \\colmat{\\extforce_1 \\\\ \\extforce_2 \\\\ \\vdots \\\\ \\extforce_n}\n\\] which means we must apply a force equal to \\(k_{11} \\gc_1\\) along generalized coordinate 1, \\(k_{21} \\gc_1\\) along generalized coordinate 2, etc. If the displacement imposed on generalized coordinate 1 is assumed to be equal to unity, then the forces are numerically given simply by the stiffness influence coefficients. This whole discussion may be extended to any coordinate in that we could assume \\(\\gc_j =1\\) while all other generalized coordinates take on a value of zero; the forces that must be applied are then given by \\(k_{1j} \\gc_j = k_{1j}\\), \\(k_{2j} \\gc_j = k_{2j}\\) etc. Based on this pattern, the following phrasing is often used in defining the stiffness influence coefficients: ``The stiffness coefficient \\(k_{ij}\\) is numerically equal to the force/moment that must be applied along generalized coordinate \\(i\\) while the system is in static equilibrium when the imposed displacements are such that \\(\\gc_j = 1\\) and all other displacements (and accelerations and velocities) are zero.’’ Note that this is somewhat reverse thinking: we are not trying to find the displacements that would be observed under a specific set of external effects and so the actual set of external forces acting on the system are irrelevant for this particular analysis; on the contrary, we are trying to figure out what external forces/moments should be applied to impose a certain displacement pattern. Even though this may seem somewhat peculiar, it actually provides a systematic way to evaluate the stiffness influence coefficients, one column at a time. Consider the rigid bar example of Figure 6.2, with the generalized coordinates shown in Figure 6.4 selected to model our problem. By imposing the displacement patterns \\[\n\\left\\{\\gc_1 &gt; 0, \\gc_2 = 0\\right\\} \\quad \\text{and} \\quad \\left\\{\\gc_1 = 0, \\gc_2 &gt; 0\\right\\}\n\\] one at a time in a successive fashion, we obtain the free body diagrams shown in Figure 6.6.\n\n\n\nFigure 6.6: Free body diagrams of the rigid bar for displacement patterns \\(\\left\\{\\gc_1 &gt; 0, \\gc_2 = 0\\right\\}\\) and \\(\\left\\{\\gc_1 = 0, \\gc_2 &gt; 0\\right\\}\\).\n\n\nStatic equilibrium demands that the forces shown in these free body diagrams be given by \\[\nk_{11} \\gc_1 = k \\gc_1, \\quad k_{21} \\gc_1 = 0, \\quad k_{22} \\gc_2 = 2k \\gc_2, \\quad k_{12} \\gc_2 = 0\n\\] from which it could be deduced that: \\[\nk_{11} = k, \\quad k_{22} = 2k, \\quad k_{12}=k_{21} = 0\n\\]\nA similar analysis could be employed in discussing the coefficients in the mass matrix. To this end we need to include d’Alembert forces in our free body diagrams to discuss ‘static’ equilibrium, and consider what happens when some acceleration is present at a generalized coordinate while all other generalized coordinates have zero accelerations. At the same time we assume that the displacements at the generalized coordinates are zero (as well as velocities, which will be important when discussing damping). When the generalized coordinates take on values of zero, the force equilibrium equation yields \\[\n\\intf = \\mmat \\ddgcvec = \\begin{bmatrix} m_{11} & m_{12} & \\cdots & m_{1n} \\\\ m_{21} & m_{22} & \\cdots & m_{2n} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ m_{n1} & m_{n2} & \\cdots & m_{nn} \\end{bmatrix} \\colmat{\\ddgc_1 \\\\ \\ddgc_2 \\\\ \\vdots \\\\ \\ddgc_n}= \\ldvec = \\colmat{\\extforce_1 \\\\ \\extforce_2 \\\\ \\vdots \\\\ \\extforce_n}\n\\] and furthermore, if \\(\\ddgc_j &gt; 0\\) while all other \\(\\ddgc_i = 0\\) for \\(i \\neq j\\), the force equilibrium demands \\[\n\\colmat{m_{1j} \\ddgc_j \\\\ m_{2j} \\ddgc_j \\\\ \\vdots \\\\ m_{nj} \\ddgc_j} = \\colmat{\\extforce_1 \\\\ \\extforce_2 \\\\ \\vdots \\\\ \\extforce_n}\n\\qquad(6.16)\\] which means that if static equilibrium is to be satisfied under these conditions, then forces equal to \\(m_{ij} \\ddgc_j\\) must be applied externally along generalized coordinates \\(\\gc_i\\). Similar to the stiffness case, we can apply such distributions successively and one at a time to all the generalized coordinates, sketch free body diagrams including d’Alembert forces and those forces that must be applied externally as per Equation 6.16, and use ‘static’ equilibrium requirements to determine the unknown coefficients.\nGoing back to our rigid bar, the free body diagrams including d’Alembert forces for cases \\[\n\\left\\{\\ddgc_1 &gt; 0, \\ddgc_2 = 0\\right\\} \\quad \\text{and} \\quad \\left\\{\\ddgc_1 = 0, \\ddgc_2 &gt; 0\\right\\}\n\\] when all other displacements (and velocities) are zero are shown in Figure 6.7.\n\n\n\nFigure 6.7: Free body diagrams of the rigid bar for acceleration patterns \\(\\left\\{\\ddgc_1 &gt; 0, \\ddgc_2 = 0\\right\\}\\) and \\(\\left\\{\\ddgc_1 = 0, \\ddgc_2 &gt; 0\\right\\}\\).\n\n\nEquilibrium demands balance of forces and balance of moments so that \\[\n\\begin{array}{c}\nm_{11} \\ddgc_1 + m_{21} \\ddgc_1 - \\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_1 \\ell = 0, \\quad\n\\ell m_{11} \\ddgc_1 - \\ratio{2 \\ell}{3} \\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_1 \\ell = 0 \\\\\nm_{12} \\ddgc_2 + m_{22} \\ddgc_2 - \\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_2 \\ell = 0, \\quad\n\\ell m_{22} \\ddgc_2 - \\ratio{2 \\ell}{3} \\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_2 \\ell = 0\n\\end{array}\n\\] from which we deduce \\[\nm_{11} = m_{22} = \\ratio{m}{3}, \\quad m_{12}=m_{21} = \\ratio{m}{6}\n\\]\n\n\n6.3.2 Equivalent Forces and Virtual Work\nThe approach discussed above could very well be cast into a question of equivalence as opposed to equilibrium, and its implicit connection to the principle of virtual work would be more directly evident. The underlying point is replacing d’Alembert forces, elastic forces and external forces, which may in general be distributed over the whole system, with equivalent sets of force systems applied along the generalized coordinates. This is an approach which structural engineers are familiar with as it is the framework within which displacement methods operate in structural analysis. While discussing equivalence, d’Alembert forces and elastic forces (and eventually damping related forces) should be explicitly accounted for as resisting forces in that they occur in opposing directions to the directions of accelerations and displacements (and velocities), respectively. This sense of direction must be taken into consideration while setting up the equivalent systems of forces. Consider again the rigid bar, and assume that we are trying to calculate the coefficients in the mass matrix. The d’Alembert forces acting on the bar and an equivalent set of forces acting along the generalized coordinates are shown in Figure 6.8. Note that we have already determined the directions of the equivalent set of forces as opposing the motion, i.e. as their direction being opposite to those of the accelerations when \\(\\ddgc_1 &gt; 0\\) and \\(\\ddgc_2 &gt; 0\\).\n\n\n\nFigure 6.8: Free body diagrams of the rigid bar for displacement patterns \\(\\left\\{\\gc_1 &gt; 0, \\gc_2 = 0\\right\\}\\) and \\(\\left\\{\\gc_1 = 0, \\gc_2 &gt; 0\\right\\}\\).\n\n\nIf two sets of forces are equivalent, then the work done by those two sets as the system goes through any arbitrary virtual or real displacements should be equal.4 Considering two arbitrary virtual displacements \\(\\virt \\gc_1\\) and \\(\\virt \\gc_2\\), equating the virtual work done by the two sets of forces leads to \\[\\begin{align*}\n- \\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_1 {\\ell} \\left(\\ratio{2}{3}\\virt \\gc_1\\right) & - \\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_2 {\\ell} \\left(\\ratio{1}{3}\\virt \\gc_1\\right) \\\\\n& - \\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_1{\\ell} \\left(\\ratio{1}{3}\\virt \\gc_2\\right) - \\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_2 {\\ell} \\left(\\ratio{2}{3}\\virt \\gc_2\\right) \\\\\n& \\phantom{XX} = - \\left[m_{11} \\ddgc_1 + m_{12} \\ddgc_2 \\right] \\virt \\gc_1 - \\left[m_{21} \\ddgc_1 + m_{22} \\ddgc_2 \\right] \\virt \\gc_2\n\\end{align*}\\] Since this work expression has to be valid for all virtual displacements (for example \\(\\left\\{\\virt \\gc_1 &gt; 0, \\virt\\gc_2 = 0\\right\\}\\) or \\(\\left\\{\\virt \\gc_1 = 0, \\virt\\gc_2 &gt; 0\\right\\}\\)) and at any instant (for example when \\(\\left\\{\\ddgc_1 &gt; 0, \\ddgc_2 = 0\\right\\}\\) or \\(\\left\\{\\ddgc_1 = 0, \\ddgc_2 &gt; 0\\right\\}\\)), this equation will be satisfied for any arbitrary setup if \\[\n\\begin{array}{c}\n\\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_1 {\\ell} \\ratio{2}{3} = m_{11}, \\quad\n\\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_2 {\\ell} \\ratio{1}{3} = m_{12} \\\\\n\\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_2 {\\ell} \\ratio{1}{3} = m_{21}, \\quad\n\\ratio{1}{2}\\ratio{m}{\\ell}\\ddgc_1 {\\ell} \\ratio{2}{3} = m_{22}\n\\end{array}\n\\] from which we deduce: \\[\nm_{11} = m_{22} = \\ratio{m}{3}, \\quad m_{12}=m_{21} = \\ratio{m}{6}\n\\] As equilibrium conditions and the principle of virtual work are completely equivalent procedures, it is no surprise that the coefficients obtained via both methods are identical. The virtual work approach, if executed for elastic forces and their equivalent system of nodal forces, may be shown easily to yield \\[\nk_{11} = k, \\quad k_{22} = 2k, \\quad k_{12}=k_{21} = 0\n\\]\nThere is yet the issue of the load vector. Whether one uses the equilibrium or the virtual work methods, the most commonly employed approach in determining the load vector is that of virtual work with which the external forces are to be accounted for with an equivalent set of loads applied along the generalized coordinates. This is also the approach that we used in Lagrange’s equations. Consider, for example, our rigid bar for which the external forces and the equivalent loads are shown in Figure 6.9. Under any arbitrary set of virtual displacements \\(\\left\\{\\virt \\gc_1, \\virt \\gc_2\\right\\}\\), the virtual work done by the load vector is  \\[\n\\left\\{ \\virt\\gc_1 \\;\\;\\; \\virt\\gc_2 \\right\\} \\colmat{\\extforce_1 \\\\ \\extforce_2} = \\virt \\gcvec^T \\ldvec\n\\] where \\((\\cdot)^T\\) denotes transpose of the matrix \\((\\cdot)\\), with \\[\n\\virt \\gcvec \\equiv \\colmat{\\virt\\gc_1 \\\\ \\virt\\gc_2}\n\\]\n\n\n\nFigure 6.9: External forces and equivalent loads.\n\n\nThis work has to be equal to the virtual work done by all the external loads as the system goes through the same virtual displacements so that for our bar, \\[\n\\ratio{\\virt \\gc_1}{2} F_2 - \\ratio{\\virt \\gc_1}{4} F_1 + \\ratio{\\virt \\gc_1 - \\virt \\gc_2}{\\ell} \\smoment - \\ratio{3 \\virt \\gc_2}{4} F_1 + \\ratio{\\virt \\gc_2}{2} F_2 = \\extforce_1 \\virt \\gc_1 + \\extforce_2 \\virt \\gc_2  \n\\] and for this equality to hold for arbitrary virtual displacements the equivalent forces should be \\[\n\\extforce_1 = \\ratio{1}{2} F_2 - \\ratio{1}{4} F_1 + \\ratio{1}{\\ell} \\smoment, \\qquad  \\extforce_2 = \\ratio{1}{2} F_2 - \\ratio{3}{4} F_1 - \\ratio{1}{\\ell} \\smoment\n\\] which are of course identical to the generalized forces that were derived before.\n\n\n\n\nTwo sets of forces are statically equivalent if they have the same resultants at any given point. As such the virtual work approach is not a necessity and equilibrium conditions could also be employed. We choose to proceed with the virtual work method in our discussions simply to present one of the ways it could be employed in analyses of multi degree of freedom systems.↩︎"
  },
  {
    "objectID": "multidof.html#coordinate-transformations",
    "href": "multidof.html#coordinate-transformations",
    "title": "6  Models for Linear Multi Degree of Freedom Systems",
    "section": "6.4 Coordinate Transformations",
    "text": "6.4 Coordinate Transformations\nChoosing a set of generalized coordinates to work with is not a problem that has a unique answer; there may be many viable choices that one may work with in any particular problem. We have already glimpsed into this issue while discussing possible choices of generalized coordinates for a 2-D rigid bar with some candidates shown in Figure 6.3. An important question therefore arises: if the equations of motion for a system is derived using a particular choice of generalized coordinates, does one have to start from scratch to derive the equations for some other set of coordinates or is there a way to directly transform the equations from one coordinate set to the other.\nWe must first note that if there are multiple sets of generalized coordinates that may completely describe the motion of a particular system, then there necessarily must be some transformation equations that relate these coordinates to each other. Consider as an example the 2-D rigid bar and two sets of generalized coordinates shown in Figure 6.10 that we may use to model its dynamics. For distinction we have denoted the two sets of coordinates as \\[\n\\gcvec = \\colmat{\\gc_1 \\\\ \\gc_2} \\quad \\text{and} \\quad \\bargcvec = \\colmat{\\gc_1' \\\\ \\gc_2'}\n\\]\n\n\n\nFigure 6.10: Two different sets of generalized coordinates that may be used to model the same 2-D rigid bar.\n\n\nThese two sets of coordinates are obviously geometrically related. With small rotations, we have \\[\n\\gc_1 = \\gc_1' - \\ell \\gc_2', \\; \\gc_2 = \\gc_1' + \\ell \\gc_2'\n\\] or in matrix notation \\[\n\\colmat{\\gc_1 \\\\ \\gc_2} = \\begin{bmatrix} 1 & -\\ell \\\\ 1 & \\ell \\end{bmatrix} \\colmat{\\gc_1' \\\\ \\gc_2'} \\quad \\rightarrow \\quad \\gcvec = \\mtrx{T} \\bargcvec\n\\] where \\(\\mtrx{T}\\) is called the transformation matrix. Such a transformation matrix will exist between any two sets of admissible generalized coordinates that may be used to model a particular linear system.\nNow assume that if we write the equations of motion in the \\(\\gcvec\\) coordinates they are given by \\[\n\\mmat \\ddgcvec (t) + \\kmat \\gcvec (t) = \\ldvec (t)\n\\] whereas if we were to write the governing equations in the \\(\\bargcvec\\) coordinates they would by given by \\[\n\\barmmat \\barddgcvec (t) + \\barkmat \\bargcvec (t) = \\barldvec (t)\n\\] Given \\(\\mmat\\), \\(\\kmat\\) and \\(\\ldvec\\), can we determine what \\(\\barmmat\\), \\(\\barkmat\\) and \\(\\barldvec\\) should be? If both sets of coordinates may be used to represent the complete dynamics of the system, then any invariant quantity should have the same value in both coordinate systems. Kinetic and potential energies are such invariant quantities since they are scalars and their values are independent of the particular choice of coordinates used to mathematically express the relevant physical displacements and velocities. The kinetic and potential energies are given by Equation 6.9 and Equation 6.11, i.e. by \\[\n\\ke = \\ratio{1}{2} \\dgcvec^T \\mmat \\dgcvec = \\ratio{1}{2} \\bardgcvec^T \\barmmat \\bardgcvec \\quad \\text{and} \\quad \\pe = \\ratio{1}{2} \\gcvec^T \\kmat \\gcvec = \\ratio{1}{2} \\bargcvec^T \\barkmat \\bargcvec\n\\] but since \\(\\gcvec = \\mtrx{T} \\bargcvec\\), we also have \\[\n\\ke = \\ratio{1}{2} \\dgcvec^T \\mmat \\dgcvec = \\ratio{1}{2} \\bardgcvec^T \\mtrx{T}^T \\mmat \\mtrx{T} \\bardgcvec \\quad \\text{and} \\quad \\pe = \\ratio{1}{2} \\gcvec^T \\kmat \\gcvec = \\ratio{1}{2} \\bargcvec^T \\mtrx{T}^T \\kmat \\mtrx{T} \\bargcvec\n\\] and so it must be true that \\[\n\\barmmat = \\mtrx{T}^T \\mmat \\mtrx{T}, \\quad \\barkmat = \\mtrx{T}^T \\kmat \\mtrx{T}\n\\] As for external excitations, we may proceed by the fact that as the system goes through any arbitrary displacement pattern, the work done by both sets of load vectors should be the same. This should be so because both sets are by definition equivalent to the general distribution of external excitations applied on the system, and therefore they are equivalent to each other as well. Consider a virtual displacement pattern given by \\(\\virt \\gcvec = \\mtrx{T} \\virt \\bargcvec\\). The work done by the two sets of load vectors are \\[\n\\vwork = \\virt \\gcvec^T \\ldvec = \\virt \\bargcvec^T \\barldvec\n\\] and since \\(\\virt \\gcvec = \\mtrx{T} \\virt \\bargcvec\\), it must be true that \\[\n\\virt \\gcvec^T \\ldvec = \\virt \\bargcvec^T \\mtrx{T}^T \\ldvec \\quad \\rightarrow \\quad \\mtrx{T}^T \\ldvec = \\barldvec\n\\] So this is how we should proceed when transforming the governing equations of motion from one set of coordinates to the other: Given the equations of motion in say \\(\\gcvec\\) coordinates as \\[\n\\mmat \\ddgcvec (t) + \\kmat \\gcvec (t) = \\ldvec (t)\n\\qquad(6.17)\\] and the relation between \\(\\gcvec\\) and \\(\\bargcvec\\) given by \\[\n\\gcvec = \\mtrx{T} \\bargcvec\n\\qquad(6.18)\\] the first step is to substitute Equation 6.18 into Equation 6.17 to obtain \\[\n\\mmat \\mtrx{T} \\barddgcvec (t) + \\kmat \\mtrx{T} \\bargcvec (t) = \\ldvec (t)\n\\qquad(6.19)\\] after which we complete the transformation by premultiplying Equation 6.19 with \\(\\mtrx{T}^T\\) to obtain \\[\n\\mtrx{T}^T \\mmat \\mtrx{T} \\barddgcvec (t) + \\mtrx{T}^T \\kmat \\mtrx{T} \\bargcvec (t) = \\mtrx{T}^T \\ldvec (t) \\quad \\rightarrow \\quad \\barmmat \\barddgcvec (t) + \\barkmat \\bargcvec (t) = \\barldvec (t)\n\\qquad(6.20)\\] This final step that takes us from Equation 6.19 to Equation 6.20 is crucial and it can not be left out.\n\nEXAMPLE 6 .1\nConsider the 2-DOF rigid bar we previously worked on. The sketches of the bar with two sets of possible generalized coordinates are shown in Figure 6.11. Coordinates \\(\\gc_1\\) and \\(\\gc_2\\) denote the vertical displacements of the two ends of the bar and the mass and stiffness matrices and the load vector in these coordinates were shown to be: \\[\n\\mmat = \\begin{bmatrix} \\ratio{m}{3} & \\ratio{m}{6} \\\\ \\ratio{m}{6} & \\ratio{m}{3} \\end{bmatrix}, \\; \\kmat = \\begin{bmatrix} k & 0 \\\\ 0 & 2k \\end{bmatrix}, \\; \\ldvec  = \\colmat{\\ratio{\\sforce_2}{2} - \\ratio{\\sforce_1}{4} + \\ratio{\\smoment}{\\ell} \\\\ \\ratio{\\sforce_2}{2} - \\ratio{3\\sforce_1}{4} - \\ratio{\\smoment}{\\ell}}\n\\]\n\n\n\nFigure 6.11: Rigid bar with two possible sets of generalized coordinates.\n\n\nAssume we want to figure out the equations of motion for the same system written using the generalized coordinates \\(\\gc_{1}'\\) and \\(\\gc_{2}'\\), which respectively denote the vertical translation of the bar’s center of mass and the bar’s rotation about the same point. Since the bar is homogeneous and uniform its center of mass is located at its midpoint; therefore \\(\\gcvec\\) and \\(\\bargcvec\\) are related through \\[\n\\gc_1 = \\gc_1' - \\frac{\\ell}{2}\\gc_2, \\quad \\gc_2 = \\gc_1' + \\frac{\\ell}{2}\\gc_2 \\quad \\rightarrow \\quad\n\\gcvec = \\begin{bmatrix} 1 & -\\ratio{\\ell}{2} \\\\ 1 & \\ratio{\\ell}{2} \\end{bmatrix} \\bargcvec = \\mtrx{T} \\bargcvec\n\\] Using the transformation given by Equation 6.20, the matrices we are seeking are calculated as: \\[\n\\barmmat = \\mtrx{T}^T \\mmat \\mtrx{T} = \\begin{bmatrix} 1 & 1 \\\\\n-\\frac{\\ell}{2}  & \\frac{\\ell}{2} \\end{bmatrix}\\begin{bmatrix} \\frac{m}{3} & \\frac{m}{6} \\\\ \\frac{m}{6} & \\frac{m}{3} \\end{bmatrix}\\begin{bmatrix} 1 & -\\frac{\\ell}{2} \\\\ 1 & \\frac{\\ell}{2} \\end{bmatrix} = \\begin{bmatrix} m & 0 \\\\ 0 & \\frac{m\\ell^2}{12} \\end{bmatrix}\n\\] \\[\n\\barkmat = \\mtrx{T}^T \\mmat \\mtrx{T} = \\begin{bmatrix} 1 & 1 \\\\\n-\\frac{\\ell}{2}  & \\frac{\\ell}{2} \\end{bmatrix}\\begin{bmatrix} k & 0 \\\\ 0 & 2k \\end{bmatrix}\\begin{bmatrix} 1 & -\\frac{\\ell}{2} \\\\ 1 & \\frac{\\ell}{2} \\end{bmatrix} = \\begin{bmatrix} 3k & \\frac{k\\ell}{2} \\\\ \\frac{k\\ell}{2} & \\frac{3k\\ell^2}{4} \\end{bmatrix}\n\\] \\[\n\\barldvec = \\mtrx{T}^T \\ldvec = \\begin{bmatrix} 1 & 1 \\\\\n-\\frac{\\ell}{2}  & \\frac{\\ell}{2} \\end{bmatrix} \\colmat{\\frac{\\sforce_2}{2} - \\frac{\\sforce_1}{4} + \\frac{\\smoment}{\\ell} \\\\ \\frac{\\sforce_2}{2} - \\frac{3\\sforce_1}{4} - \\frac{\\smoment}{\\ell}} = \\colmat{{\\sforce_2} - {\\sforce_1} \\\\ - \\frac{\\sforce_1 \\ell}{4} - {\\smoment}}\n\\] That these indeed are the matrices we desired to find may be easily verified via any of the direct methods discussed in previous sections."
  },
  {
    "objectID": "multidof.html#rigid-floor-plate-model",
    "href": "multidof.html#rigid-floor-plate-model",
    "title": "6  Models for Linear Multi Degree of Freedom Systems",
    "section": "6.5 Rigid Floor Plate Model",
    "text": "6.5 Rigid Floor Plate Model\nA model that is frequently used in structural dynamics and that has a higher level of complexity compared with the 2-DOF bar is that of a rigid flat plate (the floor) supported by massless columns. Such a system is shown in Figure 6.12. The axial rigidity of columns is significantly greater than their flexural rigidity so that neglecting the out-of-plane displacements of the floor plate is often quite acceptable. The movements of the floor plate then comprise two translations in its plane and a rotation about the axis perpendicular to the plane. The mass of the columns is generally quite small compared to that of the plate and here we choose to neglect that mass in our model. In this simple model we also neglect the torsional resistance of the columns so that the columns become analogous to massless translational springs.\n\n\n\nFigure 6.12: Rigid plate (floor) supported by columns, plan view with generalized coordinates and equivalent springs.\n\n\nThis problem has one more dimension than the rigid bar discussed in the previous sections and this dimensional increase imposes additional complexities. We first need to understand the geometry of deformation and how it relates to the degrees of freedom. To set up our problem we will choose the two displacements of the centroid of the floor plate, the directions of which are parallel to the two sides of the plate, and the rotation of the plate in its own plane about its centroid, as our generalized coordinates. Consider small amplitude motion so that arcs may still be approximated by tangent lines and angles by their tangents so that the two translations \\(\\gc_1\\) and \\(\\gc_2\\) are always assumed in the directions \\(X\\) and \\(Y\\) shown in Figure 6.12, independent of rotation \\(\\gc_3\\). The centroid of the plate is designated by \\(\\com\\) because for this particular case of homogeneous plate with constant thickness, this point actually coincides with the center of mass.\nGiven this set of generalized coordinates, the next order of business is to determine how the deformations in the columns are related to the generalized coordinates. We will assume that the floor plate is rigid enough, so that both ends of the columns may be considered fixed and that end rotations of the columns are constrained. The deformation of each column is then determined by the relative translation of its two ends. We know from structural analysis that when two ends of a linear elastic and homogeneous bar are fixed, and the bar is subjected to bending about a principal centroidal axis of its cross section as a result of which one end of the bar translates by an amount of \\(\\Delta\\) relative to its other end, then the shear forces that develop at both ends of the bar are given by5 \\[\n\\sforce = \\ratio{12 E I}{h^3} \\Delta = k \\Delta\n\\] where \\(E\\) is modulus of elasticity, \\(I\\) is the second moment of the cross sectional area about the axis of bending, and \\(h\\) is the span of the bar (in our case, height of the column). Essentially the interaction of the column with the plate is equivalent (since we ignore the bending moments at the bar ends because they do not contribute to force or moment summations along our generalized coordinates) to a translational spring with stiffness \\(k = 12 EI / h^3\\). Remember from structural analysis that a cross section will have two principal centroidal axes that are orthogonal to each other. Let’s say that the ith column’s centroid \\(c_i\\) is located at some coordinates \\((X_i,Y_i)\\) measured from the centroid of the plate (see Figure 6.12). We will denote the cross section’s principal centroidal axes as \\(\\zeta_i\\) and \\(\\eta_i\\). These local axes, defined separately for each column, may in general not coincide with the global axes \\(X\\) and \\(Y\\), defined once for the whole system. We will assume that the angle between local axis \\(\\zeta_i\\) and global axis \\(X\\) is given by \\(\\beta_i\\); since the axes come in orthogonal pairs, knowing \\(\\beta_i\\) is sufficient to define the complete relative orientation of the axes. Given this setup, we need two springs, one for each principal direction, to represent the cumulative resistance of a column to bending deformations, with stiffnesses given by \\[\nk^{\\zeta}_{i} = \\ratio{12 E_{i} I_{\\eta_i}}{h_i^3}, \\quad k^{\\eta}_{i} = \\ratio{12 E_{i} I_{\\zeta_i}}{h_i^3}\n\\] where it should be noted that a translation along \\(\\zeta_i\\) requires bending of the bar about axis \\(\\eta_i\\) and vice versa (hence the subscripts for the second moments of area). All quantities tagged with the index \\(i\\) are supposed to signify their values specific to the ith column.\n\n\n\nFigure 6.13: Relations between the generalized coordinates for the floor plate and the displacements they impose at the center of a column.\n\n\nSo how does a variation in a generalized coordinate affect the deformation in a column? To inspect the geometry, consider the sketch given in Figure 6.13. The sketch considers an arbitrary column with centroid \\(c_i\\) located at \\((X_i,Y_i)\\) measured relative to the center of mass of the plate on which the generalized coordinates are defined. It is possible to analyze the system sequentially by imposing a nonzero value for one generalized coordinate at a time while keeping the others locked at zero. For example, when there is only \\(\\gc_1 &gt; 0\\) with \\(\\gc_2 = 0\\) and \\(\\gc_3 = 0\\), the two translations of \\(c_i\\) along the columns principal centroidal axes \\(\\zeta_i\\) and \\(\\eta_i\\) are given by \\[\n\\gc_1 \\cos \\beta_i \\quad \\text{and} \\quad - \\gc_1 \\sin \\beta_i\n\\] respectively, while for \\(\\gc_2 &gt; 0\\) with \\(\\gc_1 = 0, \\gc_3 = 0\\) one has \\[\n\\gc_2 \\sin \\beta_i \\quad \\text{and} \\quad \\gc_2 \\cos \\beta_i\n\\] The translations \\(c_i\\) goes through along \\(X\\) and \\(Y\\) due to a rotation \\(\\gc_3 &gt; 0\\) of the plate about \\(\\com\\) with \\(\\gc_1 = 0, \\gc_2 = 0\\) are given by \\[\n- \\gc_3 Y_i \\quad \\text{and} \\quad  \\gc_3 X_i  \n\\] so that when these are projected along \\(\\zeta_i\\) and \\(\\eta_i\\) as in the previous two cases, the translations of \\(c_i\\) along \\(\\zeta_i\\) and \\(\\eta_i\\) are found to be \\[\n-\\gc_3 Y_i \\cos \\beta_i  + \\gc_3 X_i \\sin \\beta_i \\quad \\text{and} \\quad \\gc_3 Y_i \\sin \\beta_i + \\gc_3 X_i \\cos \\beta_i   \n\\] When all three generalized coordinates are active, the two displacements of \\(c_i\\) along local axes \\(\\zeta_i\\) and \\(\\eta_i\\) will be given by a superposition of the contributions detailed above so that \\(c_i\\) will move along \\(\\zeta_i\\) by an amount \\(\\Delta^{\\zeta}_{i}\\) given by \\[\n\\Delta^{\\zeta}_{i} = \\gc_1 \\cos \\beta_i  + \\gc_2 \\sin \\beta_i + \\gc_3 (-Y_i \\cos \\beta_i + X_i \\sin \\beta_i)\n\\] while the movement along \\(\\eta_i\\) will be of the amount \\(\\Delta^{\\eta}_{i}\\) given by \\[\n\\Delta^{\\eta}_{i} = - \\gc_1 \\sin \\beta_i + \\gc_2 \\cos \\beta_i + \\gc_3 (Y_i \\sin \\beta_i + X_i \\cos \\beta_i)\n\\] Having figured out the displacements and knowing the column stiffness, we are ready to calculate the resisting forces. Again consider a single column. If the equivalent spring stiffnesses along the column’s local (principal centroidal) axes are given by \\(k^{\\zeta}_{i}\\) and \\(k^{\\eta}_{i}\\), the resisting forces along the local axes are \\[\nF^{\\zeta}_{i}=k^{\\zeta}_{i}\\Delta^{\\zeta}_{i} = \\gc_1 k^{\\zeta}_{i} \\cos \\beta_i + \\gc_2 k^{\\zeta}_{i} \\sin \\beta_i + \\gc_3 k^{\\zeta}_{i} (-Y_i \\cos \\beta_i + X_i \\sin \\beta_i)\n\\] and \\[\nF^{\\eta}_{i}=k^{\\eta}_{i}\\Delta^{\\eta}_{i} = - \\gc_1 k^{\\eta}_{i} \\sin \\beta_i + \\gc_2 k^{\\eta}_{i}\\cos \\beta_i + \\gc_3 k^{\\eta}_{i} (Y_i \\sin \\beta_i + X_i \\cos \\beta_i)\n\\] as shown for a single column in Figure Figure 6.14. The forces along local coordinates are equivalent to the forces \\(F^{X}_{i}\\) and \\(F^{Y}_{i}\\) along global coordinates and given by \\[\nF^{X}_{i} = F^{\\zeta}_{i} \\cos \\beta_i - F^{\\eta}_{i} \\sin \\beta_i\n\\] and \\[\nF^{Y}_{i} = F^{\\zeta}_{i} \\sin \\beta_i + F^{\\eta}_{i} \\cos \\beta_i\n\\]\n\n\n\nFigure 6.14: Elastic restoring forces along local axes and global axes.\n\n\nThe recurrent terms in transformations between forces and coordinates are indeed interconnected as you might have suspected. It might be more revealing to write these relations in matrix form. The differentials \\(\\diff X\\) and \\(\\diff Y\\) are related to \\(\\diff \\zeta_i\\) and \\(\\diff \\eta_i\\) through a simple rotation and their relation may be written in matrix form as \\[\n\\colmat{\\diff \\zeta_i \\\\ \\diff \\eta_i} = \\begin{bmatrix} \\cos \\beta_i & \\sin \\beta_i \\\\ - \\sin \\beta_i & \\cos \\beta_i \\end{bmatrix} \\colmat{\\diff X \\\\ \\diff Y}\n\\] as one may show starting with the infinitesimal displacement vector written in both coordinate systems. A concise and more general way to write this expression would be the form \\[\n\\nvec{\\diff \\zeta_i} = \\mtrx{T_i} \\nvec{\\diff X}\n\\] where \\(\\nvec{\\diff X}\\) is the column matrix comprising the differential increments along the global axes, \\(\\nvec{\\diff \\zeta_i}\\) is the column matrix comprising the differential increments along the local axes of the ith column, and \\(\\mtrx{T_i}\\) is the transformation matrix that relates the two. This is the well-known transformation for vector components under orthogonal rotations. The inverse transformation is given by \\[\n\\nvec{\\diff X} = \\mtrx{T_i}^{-1} \\nvec{\\diff \\zeta_i}  \\quad \\rightarrow \\quad \\colmat{\\diff X \\\\ \\diff Y}  = \\begin{bmatrix} \\cos \\beta_i & - \\sin \\beta_i \\\\ \\sin \\beta_i & \\cos \\beta_i \\end{bmatrix} \\colmat{\\diff \\zeta_i \\\\ \\diff \\eta_i}  \n\\] where \\((\\cdot)^{-1}\\) denotes inverse of the matrix \\((\\cdot)\\). It is important to note that \\(\\mtrx{T_i}\\) is an orthogonal matrix, i.e. \\[\n\\mtrx{T_i}^{-1} = \\mtrx{T_i}^{T}\n\\] so that \\[\n\\mtrx{T_i} \\nvec{\\diff X} = \\nvec{\\diff \\zeta_i}, \\quad \\nvec{\\diff X} = \\mtrx{T_i}^{T} \\nvec{\\diff \\zeta_i}\n\\] These transformations hold for all vector components. The displacement of the ith column’s centroid may be expressed in local coordinates with components \\(\\Delta^{\\zeta}_{i}\\) and \\(\\Delta^{\\eta}_{i}\\), or in global coordinates with components \\(\\Delta^{X}_{i}\\) and \\(\\Delta^{Y}_{i}\\). The two sets of components related through \\[\n\\colmat{\\Delta^{\\zeta}_{i} \\\\ \\Delta^{\\eta}_{i}} = \\begin{bmatrix} \\cos \\beta_i & \\sin \\beta_i \\\\ - \\sin \\beta_i & \\cos \\beta_i \\end{bmatrix}  \\colmat{\\Delta^{X}_{i} \\\\ \\Delta^{Y}_{i}}  \\quad \\rightarrow \\quad {\\snvec{\\Delta}}^{L}_{i} = \\mtrx{T_i} {\\snvec{\\Delta}}^{G}_{i}\n\\] where \\({\\snvec{\\Delta}}^{L}_{i}\\) and \\({\\snvec{\\Delta}}^{G}_{i}\\) denote displacement components along the local (L) and global (G) coordinates. Similarly, elastic forces in local and global coordinates are related through \\[\n\\colmat{F^{\\zeta}_{i} \\\\ F^{\\eta}_{i}} = \\begin{bmatrix} \\cos \\beta_i &  \\sin \\beta_i \\\\ - \\sin \\beta_i & \\cos \\beta_i \\end{bmatrix}  \\colmat{F^{X}_{i} \\\\ F^{Y}_{i}} \\quad \\rightarrow \\quad {\\nvec{F}^{L}_{i}} = \\mtrx{T_i} {\\nvec{F}^{G}_{i}}\n\\] with local and global components implied again by the subscripts. Note that our choice of generalized coordinates are such that \\[\n\\Delta^{X}_{i} = \\gc_1 - Y_i \\gc_3, \\quad \\Delta^{Y}_{i} = \\gc_2 + X_i, \\gc_3\n\\] for all columns, i.e. for all i, which yields \\[\n\\colmat{\\Delta^{X}_{i} \\\\ \\Delta^{Y}_{i}} = \\colmat{\\gc_1 \\\\ \\gc_2} + \\colmat{-Y_i \\\\ X_i} \\gc_3\n\\] so that the displacements at the centroid of the ith column in local coordinates are given by \\[\n\\colmat{\\Delta^{\\zeta}_{i} \\\\ \\Delta^{\\eta}_{i}} = \\begin{bmatrix} \\cos \\beta_i & \\sin \\beta_i \\\\ - \\sin \\beta_i & \\cos \\beta_i \\end{bmatrix}  \\colmat{\\Delta^{X}_{i} \\\\ \\Delta^{Y}_{i}} = \\mtrx{T_i} \\colmat{\\gc_1 \\\\ \\gc_2} + \\mtrx{T_i} \\colmat{-Y_i \\\\ X_i} \\gc_3\n\\] Recall that the resisting elastic forces in local coordinates were given by \\[\nF^{\\zeta}_{i}=k^{\\zeta}_{i}\\Delta^{\\zeta}_{i}, \\quad F^{\\eta}_{i}=k^{\\eta}_{i}\\Delta^{\\eta}_{i}\n\\] which in matrix form may be written as \\[\n\\colmat{F^{\\zeta}_{i} \\\\ F^{\\eta}_{i}} = \\begin{bmatrix} k^{\\zeta}_{i} &  0 \\\\ 0 & k^{\\eta}_{i} \\end{bmatrix}  \\colmat{\\Delta^{\\zeta}_{i} \\\\ \\Delta^{\\eta}_{i}} \\quad \\rightarrow \\quad {\\nvec{F}^{L}_{i}} = \\mtrx{K^{L}_{i}} {\\snvec{\\Delta}}^{L}_{i}\n\\] where \\(\\mtrx{K^{L}_{i}}\\) is called the member stiffness matrix in local coordinates. If we think in terms of the global coordinates or, as in our case, the generalized coordinates for the whole system, we have \\[\n{\\nvec{F}^{L}_{i}} = \\mtrx{T_i} {\\nvec{F}^{G}_{i}} = \\mtrx{K^{L}_{i}} {\\snvec{\\Delta}}^{L}_{i} = \\mtrx{K^{L}_{i}} \\mtrx{T_i} \\colmat{\\gc_1 \\\\ \\gc_2} + \\mtrx{K^{L}_{i}} \\mtrx{T_i} \\colmat{-Y_i \\\\ X_i} \\gc_3\n\\] so that,\n\\[\n{\\nvec{F}^{G}_{i}} = \\mtrx{T_i}^{T} \\mtrx{K^{L}_{i}} \\mtrx{T_i} \\colmat{\\gc_1 \\\\ \\gc_2} + \\mtrx{T_i}^{T} \\mtrx{K^{L}_{i}} \\mtrx{T_i} \\colmat{-Y_i \\\\ X_i} \\gc_3 %= \\mtrx{K^{G}_{i}} \\colmat{\\gc_1 \\\\ \\gc_2} + \\mtrx{K^{G}_{i}} \\colmat{-Y_i \\\\ X_i} \\gc_3\n\\] which, after the components of \\(\\mtrx{T}\\) and \\(\\mtrx{K^{L}_{i}}\\) are explicitly accounted for, leads to \\[\\begin{align*}\nF^{X}_{i} & = (k^{\\zeta}_{i} \\cos^2 \\beta_i + k^{\\eta}_{i} \\sin^2 \\beta_i) \\gc_1 + \\cos \\beta_i \\sin \\beta_i (k^{\\zeta}_{i} - k^{\\eta}_{i}) \\gc_2 \\\\\n& \\qquad + \\left[- Y_i (k^{\\zeta}_{i} \\cos^2 \\beta_i + k^{\\eta}_{i} \\sin^2 \\beta_i) + X_i  \\cos \\beta_i \\sin \\beta_i (k^{\\zeta}_{i} - k^{\\eta}_{i}) \\right] \\gc_3\n\\end{align*}\\] \\[\\begin{align*}\nF^{Y}_{i} & = \\cos \\beta_i \\sin \\beta_i (k^{\\zeta}_{i} - k^{\\eta}_{i}) \\gc_1 + (k^{\\zeta}_{i} \\sin^2 \\beta_i + k^{\\eta}_{i} \\cos^2 \\beta_i) \\gc_2 \\\\\n& \\qquad + \\left[- Y_i \\cos \\beta_i \\sin \\beta_i (k^{\\zeta}_{i} - k^{\\eta}_{i})  + X_i (k^{\\zeta}_{i} \\sin^2 \\beta_i + k^{\\eta}_{i} \\cos^2 \\beta_i) \\right] \\gc_3\n\\end{align*}\\]  To derive the system stiffness matrix, let us try to use the equilibrium approach that we discussed in Section 6.3.1. Considering first the case with \\(\\left\\{ \\gc_1 = 1, \\gc_2 =0, \\gc_3 = 0 \\right\\}\\), the forces shown in Figure 6.15 will be in equilibrium when \\[\nk_{11} \\times 1 = \\sum_i F^{X}_{i}\\bigr|_{\\gc_1=1,\\gc_2=0,\\gc_3=0} = \\sum_i k^{\\zeta}_{i} \\cos^2 \\beta_i + k^{\\eta}_{i} \\sin^2 \\beta_i\n\\] \\[\nk_{21} \\times 1 = \\sum_i F^{Y}_{i}\\bigr|_{\\gc_1=1,\\gc_2=0,\\gc_3=0} = \\sum_i \\cos \\beta_i \\sin \\beta_i (k^{\\zeta}_{i} - k^{\\eta}_{i})\n\\] and \\[\\begin{align*}\nk_{31} \\times 1  & = \\sum_i (X_i F^{Y}_{i} - Y_i F^{X}_{i})\\bigr|_{\\gc_1=1,\\gc_2=0,\\gc_3=0} \\\\\n& = \\sum_i  \\left[X_i  \\cos \\beta_i \\sin \\beta_i (k^{\\zeta}_{i} - k^{\\eta}_{i}) - Y_i (k^{\\zeta}_{i} \\cos^2 \\beta_i + k^{\\eta}_{i} \\sin^2 \\beta_i) \\right]\n\\end{align*}\\] \n\n\n\nFigure 6.15: Elastic restoring forces and balancing external forces for the case \\(\\{\\gc_1=1,\\gc_2=0,\\gc_3=0\\}\\).\n\n\nWe can proceed similarly to investigate the cases of \\(\\{\\gc_1=0, \\gc_2 = 1, \\gc_3=0\\}\\) and \\(\\{\\gc_1=0, \\gc_2 = 0, \\gc_3=1\\}\\), depicted in Figure 6.16. To simplify the visuals in these figures, only the generic ith column is identified. For the first case of \\(\\{\\gc_1=0, \\gc_2 = 1, \\gc_3=0\\}\\), equilibrium considerations lead to \\[\nk_{12} \\times 1 = \\sum_i F^{X}_{i}\\bigr|_{\\gc_1=0,\\gc_2=1,\\gc_3=0} = \\sum_i \\cos \\beta_i \\sin \\beta_i (k^{\\zeta}_{i} - k^{\\eta}_{i})\n\\] \\[\nk_{22} \\times 1 = \\sum_i F^{Y}_{i}\\bigr|_{\\gc_1=0,\\gc_2=1,\\gc_3=0} = \\sum_i k^{\\zeta}_{i} \\sin^2 \\beta_i + k^{\\eta}_{i} \\cos^2 \\beta_i  \n\\] and \\[\\begin{align*}\nk_{32} \\times 1 & = \\sum_i (X_i F^{Y}_{i} - Y_i F^{X}_{i})\\bigr|_{\\gc_1=0,\\gc_2=1,\\gc_3=0} \\\\\n& = \\sum_i  \\left[X_i (k^{\\zeta}_{i} \\sin^2 \\beta_i + k^{\\eta}_{i} \\cos^2 \\beta_i) - Y_i \\cos \\beta_i \\sin \\beta_i (k^{\\zeta}_{i} - k^{\\eta}_{i}) \\right]\n\\end{align*}\\]\n\n\n\nFigure 6.16: Elastic restoring forces and balancing external forces for the cases \\(\\{\\gc_1=0,\\gc_2=1,\\gc_3=0\\}\\) and \\(\\{\\gc_1=0,\\gc_2=0,\\gc_3=1\\}\\).\n\n\nFinally, for the case of \\(\\{\\gc_1=0, \\gc_2 = 0, \\gc_3=1\\}\\) we have: \\[\\begin{align*}\nk_{13} \\times 1  & = \\sum_i F^{X}_{i}\\bigr|_{\\gc_1=0,\\gc_2=0,\\gc_3=1} \\\\\n& = \\sum_i \\left[- Y_i (k^{\\zeta}_{i} \\cos^2 \\beta_i + k^{\\eta}_{i} \\sin^2 \\beta_i) + X_i  \\cos \\beta_i \\sin \\beta_i (k^{\\zeta}_{i} - k^{\\eta}_{i})\\right]\n\\end{align*}\\] \\[\\begin{align*}\nk_{23} \\times 1  & = \\sum_i F^{Y}_{i}\\bigr|_{\\gc_1=0,\\gc_2=0,\\gc_3=1} \\\\\n& = \\sum_i \\left[- Y_i \\cos \\beta_i \\sin \\beta_i (k^{\\zeta}_{i} - k^{\\eta}_{i})  + X_i (k^{\\zeta}_{i} \\sin^2 \\beta_i + k^{\\eta}_{i} \\cos^2 \\beta_i) \\right]\n\\end{align*}\\] and \\[\\begin{align*}\nk_{33} \\times 1 & = \\sum_i (X_i F^{Y}_{i} - Y_i F^{X}_{i})\\bigr|_{\\gc_1=0,\\gc_2=0,\\gc_3=1} \\\\\n&lt;!--\n& = \\sum_i  \\left[(X_i^2 \\sin^2 \\beta_i + Y_i^2\\cos^2 \\beta_i) k^{\\zeta}_{i}  + (X_i^2 \\cos^2 \\beta_i + Y_i^2\\sin^2 \\beta_i) k^{\\eta}_{i}  - 2 X_i Y_i \\cos \\beta_i \\sin \\beta_i (k^{\\zeta}_{i} - k^{\\eta}_{i}) \\right] \\\\\n--&gt;\n& = \\sum_i  \\left[(X_i \\sin \\beta_i - Y_i \\cos \\beta_i)^2 k^{\\zeta}_{i}  + (X_i \\cos \\beta_i + Y_i \\sin \\beta_i)^2 k^{\\eta}_{i}\\right]\n\\end{align*}\\] We now have the complete stiffness matrix of the system with \\[\n\\kmat = \\begin{bmatrix} k_{11} & k_{12} & k_{13} \\\\ k_{21} & k_{22} & k_{23}  \\\\ k_{31} & k_{32} & k_{33} \\end{bmatrix}\n\\] where the coefficients \\(k_{ij}\\) are to be calculated using the equations derived above. The stiffness matrix is symmetric so that \\(k_{ij}=k_{ji}\\).\nThere are two types of coupling that occur through the stiffness matrix. One is the coupling between the translational degrees of freedom, and the other between the translational and rotational degrees of freedom. It is worthwhile to see under which circumstances these coupling terms would disappear. Let us first consider the case when the principal directions of column sections are aligned with the translational degrees of freedom. In the formulations above, this overlap could be taken to mean \\(\\beta_i = 0\\) without loss of generality for all columns. When such is the case, the cross terms between the translational terms \\(\\gc_1\\) and \\(\\gc_2\\) are zero: \\[\nk_{12}=k_{21} = \\sum_i \\cos 0 \\sin 0 (k^{\\zeta}_{i} - k^{\\eta}_{i}) = 0\n\\] Let us continue with this setup to make the point. Note that even though the translational degrees are uncoupled, it is not necessarily true that the coupling between the translational and rotational degrees of freedom is also removed, i.e. \\(k_{13}=k_{31}\\) and \\(k_{23}=k_{32}\\) are not necessarily zero. When \\(\\beta_i = 0\\), however, these terms are given by \\[\nk_{13}=k_{31}=\\sum_i \\left[- Y_i (k^{\\zeta}_{i} \\cos^2 0 + k^{\\eta}_{i} \\sin^2 0) + X_i  \\cos 0 \\sin 0 (k^{\\zeta}_{i} - k^{\\eta}_{i})\\right] = - \\sum_i Y_i k^{\\zeta}_{i}\n\\] and \\[\nk_{23} = k_{32} = \\sum_i \\left[- Y_i \\cos 0 \\sin 0 (k^{\\zeta}_{i} - k^{\\eta}_{i})  + X_i (k^{\\zeta}_{i} \\sin^2 0 + k^{\\eta}_{i} \\cos^2 0) \\right] = \\sum_i X_i k^{\\eta}_{i}\n\\] Recall that \\(X_{i}\\) and \\(Y_{i}\\) are the coordinates for the center of the ith column. It is therefore not guaranteed by any means that we should be so lucky and the point of origin we have defined is such that the summations on the right hand side turn out to be zero. On the other hand, there will always be some point such that when \\(X_i\\) and \\(Y_i\\) are measured from that point, we will have \\[\nk_{13}=k_{31}= - \\sum_i Y_i k^{\\zeta}_{i} = 0, k_{23} = k_{32} = \\sum_i X_i k^{\\eta}_{i} = 0\n\\] The special point for which this condition holds is called the center of stiffness: more particularly, the center of stiffness \\(ck\\) is that point for which the translational and rotational degrees of freedom are uncoupled when the translational and rotational coordinates are defined with respect to that point. The identification of this point becomes more tedious when the principal directions of the column stiffnesses are not aligned with the directions of the translational coordinates, i.e. when not all \\(\\beta_i\\) are equal to zero, but it is still possible and the definition is in fact applicable to all cases. We’ll include this case in an example to provide the details.\nWe had previously defined the center of mass in the introductory sections. The important point to add in the current context is the distribution of the d’Alembert forces. When the rigid body is planar, as is our floor plate, the d’Alembert forces may be shown to be equivalent to a single force, coplanar with the plane of the body, and a moment perpendicular to that plane such that each force and moment component is a function of only one acceleration component. With the generalized coordinates we have chosen to work with, the resultants of the d’Alembert forces at the center of mass would be those shown in Figure 6.17, where \\(m\\) is the total mass of the plate and \\(\\inrt\\) is its mass moment of inertia about the axis perpendicular to its plane at the center of mass.\n\n\n\nFigure 6.17: Resultants of d’Alembert forces at the center of mass of the plate.\n\n\nTo derive the mass matrix, we may proceed with the equilibrium approach as we did in the case of the stiffness matrix. To find the coefficients in the three columns of the mass matrix, we sequentially investigate the following cases shown in Figure 6.18: \\(\\{\\ddgc_1=1,\\ddgc_2=0,\\ddgc_3=0\\}\\), \\(\\{\\ddgc_1=0,\\ddgc_2=1,\\ddgc_3=0\\}\\) and \\(\\{\\ddgc_1=0,\\ddgc_2=0,\\ddgc_3=1\\}\\).\n\n\n\nFigure 6.18: d’Alembert forces and balancing external forces for the cases \\(\\{\\ddgc_1=1,\\ddgc_2=0,\\ddgc_3=0\\}\\), \\(\\{\\ddgc_1=0,\\ddgc_2=1,\\ddgc_3=0\\}\\) and \\(\\{\\ddgc_1=0,\\ddgc_2=0,\\ddgc_3=1\\}\\).\n\n\nFor each individual case, force equilibrium requires: \\[\n\\begin{array}{c}\nm_{11} = m, \\quad m_{21} = 0, \\quad m_{31} = 0 \\\\\nm_{12} = 0, \\quad m_{22} = m, \\quad m_{32} = 0 \\\\\nm_{13} = 0, \\quad m_{23} = 0, \\quad m_{33} = \\inrt\n\\end{array}\n\\] The mass matrix is therefore given by \\[\n\\mmat = \\begin{bmatrix} m & 0 & 0\\\\0 & m & 0\\\\ 0 & 0 & \\inrt\\end{bmatrix}\n\\] which is diagonal, with translational and rotational motions uncoupled. This will be true whenever the center of mass is employed, as was the case for the stiffness matrix if the center of stiffness were to be used.\nNow a trivial but necessary note: consider the simple system shown in Figure 6.19. The floor plate is supported by two identical columns located symmetrically about the \\(Y\\) axis, with stiffnesses \\(k^{\\zeta}_{1}=k^{\\zeta}_{2}=k_{\\zeta}\\), \\(k^{\\eta}_{1}=k^{\\eta}_{2}=k_{\\eta}\\). The principal directions of the column sections are along the generalized coordinates. With \\(\\beta_i = 0\\) for both columns and the two columns located symmetrically so that \\(X_2=X = -X_1\\), the general formulas we derived for \\(k_{ij}\\) yield \\[\nk_{11} = 2 k_{\\zeta}, \\quad k_{22} = 2 k_{\\eta}, \\quad k_{33} = 2 X^2 k_{\\eta}\n\\] and \\[\nk_{12} = k_{21} = 0, \\quad k_{13} = k_{31} = 0, \\quad k_{23} = k_{32} = 0\n\\] so that the mass and the stiffness matrices become \\[\n\\mmat = \\begin{bmatrix} m & 0 & 0\\\\0 & m & 0\\\\ 0 & 0 & \\inrt\\end{bmatrix}, \\kmat = \\begin{bmatrix} 2 k_{\\zeta} & 0 & 0\\\\0 & 2 k_{\\eta} & 0\\\\ 0 & 0 & 2 X^2 k_{\\eta}\\end{bmatrix}\n\\]\n\n\n\nFigure 6.19: Three independent single degree of freedom systems.\n\n\nWhat we have here is a system that has three degrees of freedom but the motion along those degrees of freedom are uncoupled so that if the system were to be set in motion along one, it would continue along that direction alone, with no motion incurred along other degrees of freedom. This is actually not a three degree of freedom system in the context of structural dynamics but rather three independent single degree of freedom systems. This complete uncoupling is the basis for the model we will consider in the next section."
  },
  {
    "objectID": "multidof.html#shear-building",
    "href": "multidof.html#shear-building",
    "title": "6  Models for Linear Multi Degree of Freedom Systems",
    "section": "6.6 Shear Building",
    "text": "6.6 Shear Building\nWhen inertial and deformational coupling are negligible, as was the case for the perfectly symmetrical plan of the previous section or for cases when such coupling is small so as to be of no significant consequence if ignored, a simple chain-like model could be used for dynamic analyses of multi-story structures. Such a model, represented in the sketch of Figure 6.20, comprises rigid floors at which all the relevant masses are collected, and columns that represent the lateral story stiffnesses, stacked on top of each other.\n\n\n\nFigure 6.20: Shear building model.\n\n\nTo set the terminology straight: the ith floor has mass \\(m_i\\), it covers the ith story which has a cumulative lateral story stiffness \\(k_i\\), the ith floor’s displacement relative to the ground is \\(\\gc_i (t)\\), and that floor is acted upon by an external lateral force \\(\\extforce_i (t)\\). There are a total of \\(n\\) floors. Vertical deformations are assumed negligible so that only lateral motion is pertinent. As there is no inertial or deformational coupling present, the lateral motion of the floors along one direction does not lead to motion in the orthogonal direction or in-plane rotations. This of course is a highly idealized simple model and various objections quickly make themselves available: The mass distribution is most probably not concentrated at the floor levels as there are columns and walls along the vertical height of each story, external forces that are assumed to act at floor levels are most likely distributed over certain areas such as wind induced loads, complete uncoupling is highly improbable and there are certain actions induced in other directions, so on and so forth. Even as such, this simple chain model has proven itself time and again capable of providing great insight into how multi story structures behave dynamically and their use is allowed even in structural codes, subject to certain limitations.\nThe equations of motion for the shear building model may easily be derived by investigating the lateral forces that act on each floor at any given instant. A free body diagram, including d’Alembert forces, of some typical ith floor is shown in Figure 6.21. Static equilibrium requires \\[\n\\extforce_i (t) + k_{i+1} (\\gc_{i+1} (t) - \\gc_{i} (t) ) - k_{i} (\\gc_{i} (t) - \\gc_{i-1} (t) ) -m_i \\ddgc_i (t) = 0\n\\] which may be rearranged to obtain \\[\nm_i \\ddgc_i (t) - k_{i} \\gc_{i-1} (t) + (k_{i} + k_{i+1}) \\gc_{i} (t) - k_{i+1} \\gc_{i+1} (t) = \\extforce_i (t)\n\\] This equation is valid for all floors, i.e. for \\(i=1,2,\\ldots,n\\), with \\(\\gc_{i-1} := 0\\) when \\(i=1\\) and \\(\\gc_{i+1} := 0\\) for \\(i=n\\).6\n\n\n\nFigure 6.21: Free body diagram of the ith floor in the shear building model.\n\n\nThe whole set of equations for all \\(n\\) floors may be written in matrix form as \\[\\begin{align*}\n& \\begin{bmatrix}\nm_1 & 0 & 0 & \\cdots & 0 & 0\\\\\n0 & m_2 & 0 & \\cdots & 0 & 0\\\\\n0 & 0 & m_3 & \\cdots & 0 & 0\\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots\\\\\n0 & 0 & 0 & \\cdots & m_{n-1} & 0\\\\\n0 & 0 & 0 & \\cdots & 0 & m_n\n\\end{bmatrix}\n\\colmat{\\ddgc_1 \\\\ \\ddgc_2 \\\\ \\ddgc_3 \\\\ \\vdots \\\\ \\ddgc_{n-1} \\\\ \\ddgc_{n}} + \\\\\n& \\phantom{XX} \\begin{bmatrix}\nk_1+k_2 & -k_2 & 0 & 0 & \\cdots & 0\\\\\n-k_2 & k_2 + k_3 & -k_3 & 0 & \\cdots & 0\\\\\n0 & -k_3 & k_3 + k_4 & -k_4 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\ddots & \\ddots & \\ddots & \\vdots\\\\\n0 & 0 & \\cdots & -k_{n-1} & k_{n-1} + k_n & -k_n\\\\\n0 & 0 & \\cdots & 0 & -k_n & k_n\n\\end{bmatrix}\n\\colmat{\\gc_1 \\\\ \\gc_2 \\\\ \\gc_3 \\\\ \\vdots \\\\ \\gc_{n-1} \\\\ \\gc_{n}}\n=\n\\colmat{\\extforce_1 \\\\ \\extforce_2 \\\\ \\extforce_3 \\\\ \\vdots \\\\ \\extforce_{n-1} \\\\ \\extforce_{n}}\n\\end{align*}\\] which, you may realize, has the same form as the chain model of Section 6.1. The mass matrix in a shear building model will always be diagonal and the stiffness matrix will always be tridiagonal. These constructive properties of the system matrices provide significant computational efficiency, which may be of great significance as the number of degrees of freedom increases to large values."
  },
  {
    "objectID": "multidof.html#sec-mdofbase",
    "href": "multidof.html#sec-mdofbase",
    "title": "6  Models for Linear Multi Degree of Freedom Systems",
    "section": "6.7 Models for Base Excited Systems",
    "text": "6.7 Models for Base Excited Systems\nAccounting for base excitation in MDOF systems is similar to its treatment in SDOF systems. In essence, when some or all of the supports/foundations of an MDOF system move, the references for rigid body motion and deformational motion have to be properly accounted for, and relevant forces must be consistently developed. To demonstrate some possible models, let us start with the simple shear building model that we discussed just above, subjected to unidirectional ground translation as shown in Figure 6.22.\n\n\n\nFigure 6.22: Shear building model subjected to unidirectional ground translation.\n\n\nThere are two components that contribute to the total displacement \\(\\adis_i (t)\\) of the ith floor: the part due to rigid body translation of the structure with the induced ground motion, indicated here by \\(\\gdist\\), and the part due the movement of the floor relative to the rigid body configuration, symbolized by \\(\\gc_i (t)\\). As in the single degree of freedom model, the deformations in the stories are governed by the relative displacements \\(\\gc_i (t)\\) whereas d’Alembert forces are governed by the absolute (total) accelerations \\(\\aacc_i (t)\\). The free body diagram of the ith floor, including d’Alembert forces, would be like the one shown in Figure 6.23. Equilibrium requires \\[\nk_{i+1} (\\gc_{i+1} (t) - \\gc_{i} (t) ) - k_{i} (\\gc_{i} (t) - \\gc_{i-1} (t) ) -m_i \\aacc_i (t) = 0\n\\] and, noting that \\[\n\\adis_i (t) = \\gdist + \\gc_i (t)\n\\] the whole set of equations for all \\(n\\) floors may be written in matrix form as \\[\\begin{align*}\n& \\begin{bmatrix}\nm_1 & 0 & 0 & \\cdots & 0 & 0\\\\\n0 & m_2 & 0 & \\cdots & 0 & 0\\\\\n0 & 0 & m_3 & \\cdots & 0 & 0\\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots\\\\\n0 & 0 & 0 & \\cdots & m_{n-1} & 0\\\\\n0 & 0 & 0 & \\cdots & 0 & m_n\n\\end{bmatrix}\n\\colmat{\\ddgc_1 + \\gacc \\\\ \\ddgc_2 + \\gacc \\\\ \\ddgc_3 + \\gacc \\\\ \\vdots \\\\ \\ddgc_{n-1} + \\gacc \\\\ \\ddgc_{n} + \\gacc} + \\\\\n& \\phantom{XX} \\begin{bmatrix}\nk_1+k_2 & -k_2 & 0 & 0 & \\cdots & 0\\\\\n-k_2 & k_2 + k_3 & -k_3 & 0 & \\cdots & 0\\\\\n0 & -k_3 & k_3 + k_4 & -k_4 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\ddots & \\ddots & \\ddots & \\vdots\\\\\n0 & 0 & \\cdots & -k_{n-1} & k_{n-1} + k_n & -k_n\\\\\n0 & 0 & \\cdots & 0 & -k_n & k_n\n\\end{bmatrix}\n\\colmat{\\gc_1 \\\\ \\gc_2 \\\\ \\gc_3 \\\\ \\vdots \\\\ \\gc_{n-1} \\\\ \\gc_{n}}\n=\n\\colmat{0 \\\\ 0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 0}\n\\end{align*}\\]\n\n\n\nFigure 6.23: Free body diagram of the ith floor in the shear building model subjected to unidirectional ground translation.\n\n\nThe task almost always is to evaluate the response of a structure subjected to a particular base motion so that the equations are often expressed with the ground motion term on the right hand side as \\[\n\\mmat \\ddgcvec (t) + \\kmat \\gcvec (t) = - \\mmat \\colmat{\\gacc (t) \\\\ \\gacc (t) \\\\ \\vdots \\\\ \\gacc (t)} = - \\mmat \\colmat{1 \\\\ 1 \\\\ \\vdots \\\\ 1} \\gacc (t) = - \\mmat \\onecol \\gacc (t)\n\\qquad(6.21)\\] where \\(\\onecol\\) is a column matrix of dimension \\(n\\) with all its elements equal to one. The similarity of this equation with that of the single degree of freedom model is quite evident, with scalar system parameters in the SDOF model becoming matrices in the MDOF model.\nThere is a trivial alternative to how the equation of motion may be stated if we were to choose to work with the absolute motion variables. Starting with \\[\n\\mmat \\aaccvec(t) + \\kmat \\gctvec = \\zerocol\n\\] and substituting \\(\\gctvec=\\adisvec (t) - \\onecol \\gdis (t)\\), one gets, after reordering, \\[\n\\mmat \\aaccvec (t) + \\kmat \\adisvec (t) = \\kmat \\onecol \\gdis (t)\n\\] and due to the structure of the stiffness matrix in the shear building model, the right hand side of the equation may be shown to yield: \\[\n\\mmat \\aaccvec (t) + \\kmat \\adisvec (t) = \\colmat{k_1 \\\\ 0 \\\\ 0 \\\\ \\vdots \\\\ 0} \\gdis (t)\n\\qquad(6.22)\\] As with the SDOF model, the choice of equations to use depends on the particular application, but often the form of Equation 6.21 is preferred since calculating deformations directly is generally the most pressing concern for analysts. On the other hand, especially when dealing with multi-support excitations under which it mat not be trivial to define the moving reference frame, it may be preferable to cast the formulations in terms of absolute motion parameters.\nNext let us consider a different scenario, albeit one that is not very common, to present a slightly different formulation. Assume that the ground motion is not translational but rotational, with rotations relatively small so that arcs may be approximated by tangents. The rigid body displacements that would occur in the system due to the ground motion would then be as shown in Figure 6.24: if the ith floor is located at a height of \\(h_i\\) from the ground, then it would translate laterally by an amount of \\(h_i \\gdis (t)\\) due to rigid body motion that would occur under a ground rotation of amount \\(\\gdis (t)\\). Such a motion that would occur at each floor would cause no deformation in the system. On top of this we include the possibility of relative motion, relative to this rigid body state, at each floor given by \\(\\gc_i (t)\\), so that the total displacement of the ith floor is given by \\[\n\\adis_i (t) = \\gc_i (t) + h_i \\gdis (t)\n\\]\n\n\n\nFigure 6.24: Shear building model subjected to uniaxial ground rotation.\n\n\nNote that the stiffness matrix is all about deformations so that there is no change in it with regards to the previous model. The mass matrix similarly remains unaltered. What changes is how the input affects the system. The equations of motion again are \\[\n\\mmat \\aaccvec(t) + \\kmat \\gctvec = \\zerocol\n\\] but now we have \\[\n\\aaccvec (t) = \\ddgctvec + \\colmat{h_1 \\\\ h_2 \\\\ \\vdots \\\\ h_n} \\gacc (t) = \\ddgctvec + \\nvec{h} \\gacc (t)\n\\]  where height vector \\(\\nvec{h}=\\left\\{h_1 \\;\\;\\; h_2 \\;\\;\\; \\cdots \\;\\;\\; h_n\\right\\}^{T}\\) is a column matrix that has floor levels (measured from the ground) as its elements (compare with the column matrix of ones in the translation case). The equation of motion of a shear building model subjected to uniaxial ground rotation may therefore be written as: \\[\n\\mmat \\ddgctvec + \\kmat \\gctvec = - \\mmat \\nvec{h} \\gacc (t)\n\\] It is of course relatively straightforward to extend this model to include both a unidirectional ground translation and a uniaxial ground rotation. Assume that the ground translation is given by \\(\\gdis_1 (t)\\) and rotation by \\(\\gdis_2 (t)\\), as shown in Figure 6.25.\n\n\n\nFigure 6.25: Shear building model subjected simultaneously to unidirectional ground translation and uniaxial ground rotation.\n\n\nWhen both ground motions are present, the absolute and relative displacements are related through \\[\n\\adisvec (t) = \\gctvec + \\onecol \\gdis_1 (t) + \\nvec{h} \\gdis_2 (t) = \\gctvec +\\begin{bmatrix} \\onecol & \\nvec{h} \\end{bmatrix} \\colmat{\\gdis_1 (t) \\\\ \\gdis_2 (t)} = \\gctvec + \\ininfmat \\gdisvec (t)\n\\] where \\(\\ininfmat\\) is a matrix that maps the relationship between inputs and generalized coordinates. We will call it the input influence matrix when it maps more than one input, and input influence vector (to be denoted \\(\\ininfvec\\)) if it is a single column mapping only one input. The determination of the input influence matrix for the support excitation/ground motion problem is, as we have seen, a geometric problem in which one tries to determine the rigid body displacements that would occur at the locations and along the directions of the generalized coordinates. With this inauguration, the equation of motion for base excited structures may be more generally expressed as7 \\[\n\\mmat \\ddgctvec + \\kmat \\gctvec = - \\mmat \\ininfmat \\gaccvec (t)\n\\] Would this formulation hold for, say, the three dimensional rigid plate model? Consider the motion of the previously investigated rigid floor plate moving in its plane under translational and rotational base motion as shown in Figure 6.26.\n\n\n\nFigure 6.26: In-plane rigid body motion of the floor plate due to ground motion.\n\n\nWe assume that the ground moves like a rigid block so that there are three components to ground motion: translational motion given by \\(\\gdis_1 (t)\\) and \\(\\gdis_2 (t)\\), and rotational motion \\(\\gdis_3 (t)\\). (Although we should note that such rotational motion is generally negligible, and its inclusion here is more for demonstration purposes.) The floor plate may itself move relative to the ground, with this relative motion defined by \\(\\gc_1 (t)\\), \\(\\gc_2 (t)\\) and \\(\\gc_3 (t)\\) as before (once again we use the center of mass as our reference point, and remind that the mass matrix is diagonal in that case). This relative motion is what may cause deformation in the system so that the restoring forces are given by \\(\\kmat \\gcvec\\). The accelerations and the related d’Alembert forces, on the other hand, are proportional to the absolute accelerations so that the equations of motion will be given by \\[\n\\mmat \\colmat{\\ddgc_1 + \\gacc_1 \\\\ \\ddgc_2 + \\gacc_2 \\\\\\ddgc_3 + \\gacc_3} + \\kmat  \\gcvec = \\zerocol\n\\] which may be written as \\[\n\\mmat \\ddgcvec (t) + \\kmat \\gcvec (t) = - \\mmat \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} \\colmat{\\gacc_1 (t) \\\\ \\gacc_2 (t) \\\\ \\gacc_3 (t)} = - \\mmat \\ininfmat \\nvec{\\gacc} (t)\n\\] with \\(\\ininfmat = \\idmat\\).\nBefore closing this section, a disclaimer may be in order. When deriving the equations of motion one does feel a sense of unease when rotations are present. If the motion amplitudes are large, rotational motion does indeed bring about increasing levels of complexities. The sketches that we use to demonstrate how systems move are, for ease of visual identifiability, almost always extreme in that the marked displacements and deformations are inadmissibly large. So these sketches should be taken with a grain of salt. The motion amplitudes which we aim to investigate herein are limited to the immediate vicinity of initial equilibrium such that in all cases arcs may be approximated by tangent lines unless otherwise explicitly stated. Direct superposition of the rigid body motion and the deformational motion in the case of the floor plate is justified only with this constraint in mind."
  },
  {
    "objectID": "multidoffreevib.html#harmonic-motion-and-the-eigenvalue-problem",
    "href": "multidoffreevib.html#harmonic-motion-and-the-eigenvalue-problem",
    "title": "7  Free Vibrations of Multi Degree of Freedom Systems",
    "section": "7.1 Harmonic Motion and the Eigenvalue Problem",
    "text": "7.1 Harmonic Motion and the Eigenvalue Problem\nSolving the coupled equations of motion of an MDOF system is not a trivial issue. If one wants to find how each generalized coordinate evolves in time, one has to find \\(n\\) many time functions in an \\(n\\)-DOF system that will somehow satisfy the coupled equations at all times. Most often this task will have to be dealt with numerically, if it can be dealt with at all. Numerical results, however, tend to be not so conducive in helping us develop physical insights, which we do need in order to be able to judge the validity of any analysis.\nSo we may ask: is there any insight or experience that we have gained from analyses of SDOF systems that may help us get started with MDOF systems. One predominant characteristic of an SDOF system was its unique period (or frequency) with which it oscillated if it were perturbed form its original equilibrium configuration. Would an MDOF system do the same, and, what does this exactly mean? By the period of the MDOF system we shall understand the period, if it exists, with which the whole system repeats its motion in that during free vibrations all generalized coordinates execute harmonic motions with the same period. Since there are multiple degrees of freedom, the motions along each may have different amplitudes, but all motion should bear the same period. Consider the three masses hung along the same rope as shown in Figure 7.1. We may intuitively feel that if we were to pull this pendulum to some initial angle and let go, the masses would move in harmony, swinging back and forth while keeping their initial relative appearance so that if we were to take consecutive snapshots, the pendulum would look pretty much as it did at the first instant albeit at smaller angles, somewhat like the sketch in Figure 7.1 (a). We may also feel that after such an initial perturbance the snapshots depicted in Figure 7.1 (b) are probably unlikely, that the masses are unlikely to do as they please and swing any way they want at any speed they want.\n\n\n\nFigure 7.1: Pendulum with three masses.\n\n\nWe can’t quit at intuition of course and so the question is whether or not such harmonic motion is mathematically possible. For the whole system to move with the same frequency but different amplitudes along the generalized coordinates, the equations of motion should admit a solution that may be expressed as \\[\n\\gctvec = \\colmat{\\gc_1 (t) \\\\ \\gc_2 (t) \\\\ \\vdots \\\\ \\gc_n (t)} = \\colmat{\\eigvecs_{1} \\\\ \\eigvecs_{2} \\\\ \\vdots \\\\ \\eigvecs_{n}} \\cosp{\\freq t - \\phs} = \\eigvec \\cosp{\\freq t - \\phs}\n\\qquad(7.1)\\] where \\(\\eigvecs_{j}\\) is the time independent amplitude at the jth generalized coordinate, \\(\\freq\\) is the frequency with which the whole system moves, and \\(\\phs\\) is some possible lag. Note that the way the system looks as it moves is governed by \\(\\eigvec\\) or, more precisely, the ratios of \\(\\eigvecs_{j}\\) to each other. As we assume these amplitudes to be time invariant, the relative shape of deformation is constant by assumption, with instantaneous positions communally regulated by the time dependent cosine component.\nAdmissibility of such a motion depends on whether the equation of motion for free vibrations, given by \\[\n\\mmat \\ddgctvec + \\kmat \\gctvec = \\zerocol\n\\qquad(7.2)\\] may be satisfied by this solution. The damping matrix is conspicuously missing of course, but we will come back to that in a little while. To see whether or not the solution works we plug the proposed expression Equation 7.1 into Equation 7.2 to get \\[\n-\\freq^2 \\mmat \\eigvec \\cosp{\\freq t - \\phs} + \\kmat \\eigvec \\cosp{\\freq t - \\phs} = \\left(\\kmat - \\freq^2 \\mmat \\right) \\eigvec \\cosp{\\freq t - \\phs} = \\zerocol\n\\qquad(7.3)\\] If such a solution is to exist, Equation 7.3 should be satisfied at all times. Obviously the cosine term can take on nonzero values, and so there are only two possibilities. It could be that \\(\\eigvec \\equiv \\zerocol\\), which means that the system is not moving at all! Equilibrium is naturally satisfied in that case (remember that initially the system is at an equilibrium state) but this is not the option we are seeking; this is called the trivial solution. The nontrivial solution is the possibility of \\[\n\\left(\\kmat - \\freq^2 \\mmat \\right) \\eigvec = \\zerocol\n\\] which means that, for a nonzero \\(\\eigvec\\), the matrix \\(\\left(\\kmat - \\freq^2 \\mmat \\right)\\) is (to borrow from linear algebra) rank deficient, i.e. its determinant is zero and its inverse does not exist; for if it did, then the only possibility would be \\(\\eigvec = \\left(\\kmat - \\freq^2 \\mmat \\right)^{-1} \\zerocol = \\zerocol\\).\nWhat does this mean? Well, we were seeking for the possibility of harmonic motion and it turns out that: yes, it is possible, but only for those values of \\(\\freq\\) which make \\[\n\\left| \\kmat - \\freq^2 \\mmat \\right| = 0\n\\qquad(7.4)\\] where \\(\\left| \\mtrx{A} \\right|\\) denotes the determinant of matrix \\(\\mtrx{A}\\). For an \\(n\\)-DOF system, \\(\\mmat\\) and \\(\\kmat\\) are \\(n \\times n\\) matrices, and the characteristic equation of Equation 7.4 is of order \\(n\\) in \\(\\freq^2\\). The characteristic equation, therefore, has \\(n\\) roots, meaning there are \\(n\\) values of \\(\\freq\\) which may make the determinant zero. From a more physical perspective: an MDOF system has multiple frequencies, as many as the number of degrees of freedom, with which it may execute harmonic motion.\nIn linear algebra, this problem is usually cast as the generalized eigenvalue problem: find all \\(\\freq^2\\) and \\(\\eigvec\\) for which \\[\n\\freq^2 \\mmat \\eigvec = \\kmat \\eigvec\n\\qquad(7.5)\\] is satisfied. When matrix dimensions are very small, it may be possible to solve this problem by hand. After a while it becomes tedious and outright impossible to proceed by hand and so the eigenvalue problems are almost always solved numerically.1 In the structural dynamics jargon, the eigenvalues of Equation 7.5, or rather their positive square roots the \\(\\freq\\)’s, are called the natural frequencies or modal frequencies, and its eigenvectors the \\(\\eigvec\\)’s are called the mode shapes of the system. This terminology is well established and we will adhere to it.\nTo give a flavor of what this all means, let us work on the two-story shear building shown in Figure 7.2. It is relatively easy to show that the mass and stiffness matrices for this simple model are given by \\[\n\\mmat = \\begin{bmatrix} m_1 & 0 \\\\ 0 & m_2 \\end{bmatrix}, \\quad \\kmat = \\begin{bmatrix} k_1 + k_2 & -k_2 \\\\ -k_2 & k_2 \\end{bmatrix}\n\\]\n\n\n\nFigure 7.2: Two story shear building.\n\n\nLet us simplify the algebra by considering a particular case with \\(m_1 = m_2 = m\\), \\(k_1 = 2k\\) and \\(k_2 = k\\). The eigenvalue problem becomes \\[\n\\left(\\begin{bmatrix} 3k & -k \\\\ -k & k \\end{bmatrix} - \\freq^2 \\begin{bmatrix} m & 0 \\\\ 0 & m \\end{bmatrix}\\right) \\eigvec = \\zerocol\n\\qquad(7.6)\\] with the characteristic equation given by \\[\n\\left| \\kmat - \\freq^2 \\mmat \\right| =\\left| \\begin{bmatrix} 3k-\\freq^2 m & -k \\\\ -k & k - \\freq^2 m \\end{bmatrix} \\right| = m^2 (\\freq^2)^2 - 4 {k}{m} \\freq^2 + 2 k^2 = 0\n\\qquad(7.7)\\] which yields the following two roots via the well-known quadratic formula: \\[\n\\freq_1^2 = (2 - \\sqrt{2}) \\ratio{k}{m}, \\quad \\freq_2^2 = (2 + \\sqrt{2}) \\ratio{k}{m}\n\\] By convention, when numbering the multiple frequencies of a system, they are numbered in increasing order so that \\[\n\\freq_1 \\leq \\freq_2 \\leq \\ldots \\leq \\freq_{n-1} \\leq \\freq_n\n\\] This convention is almost always adhered to, with the lowest frequency \\(\\freq_1\\) generally referred to as the fundamental frequency of the system; the corresponding period \\(\\period_1 = 2 \\pi/ \\freq_1\\), which happens to be the longest period of the system, is analogously called the fundamental period. Experience has shown that in most cases the largest amplitudes of motion occur in relation to this fundamental period, and therefore its proper estimation is of prime importance.\nSo what kind of a deformed shape does the system take on while moving with any of these frequencies; in other words, what are the corresponding \\(\\eigvec\\)’s? We have to go back to Equation 7.7 and try to figure out the \\(\\eigveci{i}\\) that accompanies the particular frequency \\(\\freq_i\\). For our system we have two frequencies and two such mode shapes. We will denote the related mode shapes by \\(\\eigveci{1}\\) and \\(\\eigveci{2}\\), and their components as \\[\n\\eigveci{1} = \\colmat{\\eigvecs_{11} \\\\ \\eigvecs_{21}}, \\quad \\eigveci{2} = \\colmat{\\eigvecs_{12} \\\\ \\eigvecs_{22}}\n\\] where we take \\(\\eigvecs_{ji}\\) to mean the jth component of the ith mode shape. In short, \\(\\eigvecs_{ji}\\) is the relative amplitude at generalized coordinate j while the system moves in mode i. For \\(\\freq_1^2\\), the eigenvalue equation is given by \\[\n\\left(\\begin{bmatrix} 3k & -k \\\\ -k & k \\end{bmatrix} - \\freq_1^2 \\begin{bmatrix} m & 0 \\\\ 0 & m \\end{bmatrix}\\right) \\eigveci{1} = \\begin{bmatrix}3k - (2-\\sqrt{2})k & -k \\\\ -k & k - (2-\\sqrt{2})k \\end{bmatrix} \\colmat{\\eigvecs_{11} \\\\ \\eigvecs_{21}} = \\zerocol\n\\] which seemingly yields two equations as \\[\n(1+\\sqrt{2}) \\eigvecs_{11} - \\eigvecs_{21} = 0, \\quad \\eigvecs_{11} - (1 -\\sqrt{2}) \\eigvecs_{21} = 0\n\\] but these two equations are in fact one and the same: \\[\n\\eigvecs_{21} = 2.414 \\eigvecs_{11}\n\\] How do we determine two unknowns with one equation? We can’t. Mathematically this result is to be expected since, for the eigenvalue problem to work out, \\(\\eigvec\\) must lie in the null space of the rank deficient coefficient matrix \\((\\kmat-\\freq^2 \\mmat)\\); consequently, if some \\(\\eigvec\\) satisfies \\((\\kmat-\\freq^2 \\mmat)\\eigvec=\\zerocol\\), then so does \\(a\\eigvec\\) where \\(a\\) is an arbitrary multiplier. Does this make sense physically? Think about it this way: What we have determined is the relative shape the system maintains as it moves with a certain frequency, but the absolute amplitude of motion should depend on the initial conditions (e.g. how large is the initial perturbation?). We have not considered such information yet and it will have to wait until we discuss the initiation of motion. Until then, we have to be satisfied with only the relative ratios of what will occur along the generalized coordinates. We may therefore choose to represent the relative amplitudes according to any particular scaling at this point. We may, for example, assign a magnitude of one to a particular generalized coordinate; say we assign \\(\\eigvecs_{11}=1\\), in which case we have \\[\n\\eigveci{1}=\\colmat{1 \\\\ 2.414}\n\\] Alternatively we may adjust the values of the coefficients so that the mode shape has unit magnitude, i.e. \\({\\eigveci{1}^T}\\eigveci{1}=1\\), in which case we would have \\[\n\\eigveci{1}=\\colmat{0.383 \\\\ 0.924}\n\\] Both of these choices are fine in that the actual response that we will observe as the system oscillates with the fundamental frequency will be given by \\[\n\\gctvec = A_1 \\eigveci{1} \\cosp{\\freq_1 t - \\phs_1}\n\\] where, depending on the particular scaling we choose, the coefficient \\(A_1\\) may take on different values, but at the end all choices will yield the same \\(\\gctvec\\).\n\n\n\nFigure 7.3: Mode shapes of the two story shear building.\n\n\nThere is also a second frequency with which harmonic motion is possible. The mode shape corresponding to \\(\\freq_2\\) is prescribed by \\[\n\\left(\\begin{bmatrix} 3k & -k \\\\ -k & k \\end{bmatrix} - \\freq_2^2 \\begin{bmatrix} m & 0 \\\\ 0 & m \\end{bmatrix}\\right) \\eigveci{2} = \\begin{bmatrix}3k - (2+\\sqrt{2})k & -k \\\\ -k & k - (2+\\sqrt{2})k \\end{bmatrix} \\colmat{\\eigvecs_{12} \\\\ \\eigvecs_{22}} = \\zerocol\n\\] which yields the following relationship: \\[\n\\eigvecs_{22} = -0.414 \\eigvecs_{12}\n\\] If we again assign a unit amplitude to the first generalized coordinate, we have \\[\n\\eigveci{2}=\\colmat{1 \\\\ -0.414}\n\\] Finally as there are two possibilities of harmonic motion, the general solution is the superposition the two, giving as the final answer the following expression for our example of the two story shear building: \\[\n\\gctvec = A_1 \\eigveci{1} \\cosp{\\freq_1 t - \\phs_1} + A_2 \\eigveci{2} \\cosp{\\freq_2 t - \\phs_2}\n\\qquad(7.8)\\] Before we move on, it is worthwhile to visualize the mode shapes for such a structure, schematically sketched in Figure 7.3. In the fundamental mode, the relative movements of the masses are such that the building sways to one side as a whole. The second mode, on the other hand, comprises movement of masses in opposite directions, with one sign change or one cross-over. We’ll see in numerous cases that such modal motions are typical of many similar systems, with number of crossovers increasing with increasing mode numbers and the fundamental mode comprising a unidirectional movement."
  },
  {
    "objectID": "multidoffreevib.html#footnotes",
    "href": "multidoffreevib.html#footnotes",
    "title": "7  Free Vibrations of Multi Degree of Freedom Systems",
    "section": "",
    "text": "A true classic in the field of classical mechanics, “The Theory of Sound” by Lord Rayleigh (formerly/also known as John William Strutt) was originally published in two volumes in 1877 and 1878, respectively.↩︎"
  },
  {
    "objectID": "multidoffreevib.html#orthogonality-of-modes",
    "href": "multidoffreevib.html#orthogonality-of-modes",
    "title": "7  Free Vibrations of Multi Degree of Freedom Systems",
    "section": "7.2 Orthogonality of Modes",
    "text": "7.2 Orthogonality of Modes\nA property known as orthogonality of the mode shapes leads to a very well-known and extremely useful analyses tool for MDOF systems. To demonstrate this property, let us assume we have an n-DOF system with symmetric \\(\\mmat\\) and \\(\\kmat\\), with frequencies \\(\\freq_i\\) and mode shapes \\(\\eigveci{i}\\) for \\(i=1,2,\\ldots,n\\). For ease of proof let us further consider the case with no repeated roots so that \\(\\freq_i \\neq \\freq_j\\) for \\(i \\neq j\\); in structural dynamics this is almost always the case except when there is perfect symmetry so that the structure has identical periods in two directions but even in such cases the following conclusions will hold.\nFor such a system, the eigenvalue problem for two different modes, modes \\(i\\) and \\(j\\), will be given by the following equations: \\[\n\\kmat\\eigveci{i} = \\freq_i^2 \\mmat \\eigveci{i}\n\\qquad(7.9)\\] \\[\\kmat\\eigveci{j} = \\freq_j^2 \\mmat \\eigveci{j}\n\\qquad(7.10)\\] If we pre-multiply Equation 7.9 by \\(\\eigveci{j}^T\\) and Equation 7.10 by \\(\\teigveci{i}\\), we obtain: \\[\n\\eigveci{j}^T \\kmat\\eigveci{i} = \\eigveci{j}^T \\freq_i^2 \\mmat \\eigveci{i}\n\\qquad(7.11)\\] \\[\n\\teigveci{i} \\kmat\\eigveci{j} = \\freq_j^2 \\teigveci{i}  \\mmat \\eigveci{j}\n\\qquad(7.12)\\] Since the mass and stiffness matrices are symmetric, the transpose of Equation 7.12 yields \\[\n(\\teigveci{i} \\kmat\\eigveci{j})^T = \\eigveci{j}^T \\kmat^T\\eigveci{i} = \\eigveci{j}^T \\kmat \\eigveci{i} = \\freq_j^2 \\eigveci{j}^T  \\mmat \\eigveci{i}\n\\qquad(7.13)\\] so that the difference of Equation 7.11 and Equation 7.13 leads to: \\[\n0 = (\\freq_i^2 - \\freq_j^2) \\eigveci{j}^T  \\mmat \\eigveci{i}\n\\qquad(7.14)\\] The equality in Equation 7.14 demands that either \\((\\freq_i^2 - \\freq_j^2)=0\\) or \\(\\eigveci{j}^T \\mmat \\eigveci{i}=0\\); but if there are no repeated roots, \\(\\freq_i^2 - \\freq_j^2 \\neq 0\\) and so it must be true that \\[\n\\eigveci{j}^T  \\mmat \\eigveci{i} = 0\n\\qquad(7.15)\\] whenever \\(i \\neq j\\). This condition also implies by the eigenvalue equation that \\[\n\\eigveci{j}^T  \\kmat \\eigveci{i} = 0 \\quad \\text{for } i\\neq j.\n\\qquad(7.16)\\] When \\(i=j\\), on the other hand, these products may yield nonzero values. Let us denote those values by \\[\n\\teigveci{i}  \\mmat \\eigveci{i} = \\modm_i, \\quad \\teigveci{i}  \\kmat \\eigveci{i} = \\modk_i\n\\qquad(7.17)\\] where \\(\\modm_i\\) is called the modal mass and \\(\\modk_i\\) the modal stiffness for the i-th mode. The orthogonality conditions are generally expressed more concisely via the Kronecker-\\(\\delta\\) \\(\\delta_{ij}\\) defined as \\[\n\\delta_{ij} = \\begin{cases}1 & i=j \\\\ 0 & i \\neq j \\end{cases}\n\\] so that modal orthogonality may be simply written as follows: \\[\n\\eigveci{j}^T  \\mmat \\eigveci{i} = \\modm_i \\delta_{ij}, \\quad \\eigveci{j}^T  \\kmat \\eigveci{i} = \\modk_i \\delta_{ij}\n\\qquad(7.18)\\] It is important to note that these relations imply a formulation to calculate the frequencies. Considering the eigenvalue equation for the i-th mode and premultiplying it with \\(\\teigveci{i}\\) we have \\[\n\\teigveci{i} \\kmat\\eigveci{i} = \\freq_i^2 \\teigveci{i} \\mmat \\eigveci{i} \\rightarrow \\freq_i^2 = \\ratio{\\teigveci{i} \\kmat\\eigveci{i}}{\\teigveci{i} \\mmat\\eigveci{i}} = \\ratio{\\modk_i}{\\modm_i}\n\\qquad(7.19)\\] The particular values of the modal masses and stiffnesses will naturally depend on the particular scaling chosen for the mode shapes. Consider for example the two story shear building of Figure 7.2 discussed previously, with the mass and stiffness matrices given by \\[\n\\mmat = \\begin{bmatrix} m & 0 \\\\ 0 & m \\end{bmatrix}, \\quad \\kmat = \\begin{bmatrix} 3k & -k \\\\ -k & k \\end{bmatrix}  \n\\] One option that was considered was to scale the mode shapes so that the amplitude corresponding to the first generalized coordinate was of unit magnitude, leading to \\[\n\\eigveci{1}=\\colmat{1 \\\\ 2.414}, \\quad \\eigveci{2}=\\colmat{1 \\\\ -0.414}\n\\] With these mode shapes, Equation 7.18 yields \\[\n\\modm_1 = \\eigveci{1}^T \\mmat \\eigveci{1} = 6.83 m, \\quad \\modm_2 = \\eigveci{2}^T \\mmat \\eigveci{2} = 1.17 m, \\quad \\eigveci{1}^T \\mmat \\eigveci{2} = 0\n\\] and \\[\n\\modk_1 = \\eigveci{1}^T \\kmat \\eigveci{1} = 4 k, \\quad \\modk_2 = \\eigveci{2}^T \\kmat \\eigveci{2} = 4k, \\quad \\eigveci{1}^T \\kmat \\eigveci{2} = 0\n\\] One way to check the algebra is to make sure that the modal masses and stiffness lead to the calculated frequencies: \\[\n\\ratio{\\modk_1}{\\modm_1} = 0.586 \\frac{k}{m} = \\freq_1^2, \\quad \\ratio{\\modk_2}{\\modm_2} = 3.41 \\frac{k}{m} = \\freq_2^2\n\\] An alternative scaling for the first mode shape was also considered subject to \\(\\eigveci{1}^T\\eigveci{1} = 1\\) in which case the mode shapes were given by \\[\n\\eigveci{1}=\\colmat{0.383 \\\\ 0.924}, \\quad \\eigveci{2}=\\colmat{1 \\\\ -0.414}\n\\] so that with these mode shapes, the orthogonality conditions would in this case yield \\[\n\\modm_1 = \\eigveci{1}^T \\mmat \\eigveci{1} = m, \\quad \\modm_2 = \\eigveci{2}^T \\mmat \\eigveci{2} = 1.17 m, \\quad \\eigveci{1}^T \\mmat \\eigveci{2} = 0\n\\] and \\[\n\\modk_1 = \\eigveci{1}^T \\kmat \\eigveci{1} = 0.586 k, \\quad \\modk_2 = \\eigveci{2}^T \\kmat \\eigveci{2} = 4k, \\quad \\eigveci{1}^T \\kmat \\eigveci{2} = 0\n\\] and once again we have \\[\n\\ratio{\\modk_1}{\\modm_1} = 0.586 \\frac{k}{m} = \\freq_1^2, \\quad \\ratio{\\modk_2}{\\modm_2} = 3.41 \\frac{k}{m} = \\freq_2^2\n\\] as we should. If the mode shapes are scaled so that the modal masses are equal to \\(1\\), then the mode shapes are said to be mass normalized. Recall that scaling of a mode shape is essentially multiplying it with a non-zero scalar. If \\(\\eigveci{i}\\) is the arbitrarily scaled mode shape for the \\(i\\)-th mode, the mass normalized mode shape \\(\\meigveci{i}\\) for that mode is related to \\(\\eigveci{i}\\) through \\(\\meigveci{i}=s_i \\eigveci{i}\\) where \\(s_i\\) is some scalar. To find out what it should be, we can use the condition that mass normalized mode shapes should lead to unit modal masses, so that \\[\n\\meigveci{i}^T \\mmat \\meigveci{i} = 1 = s_i^2 \\teigveci{i} \\mmat  \\eigveci{i} = s_i^2 \\modm_i \\quad \\rightarrow \\quad s_i = \\ratio{1}{\\sqrt{\\modm_i}}\n\\qquad(7.20)\\] Our aim is to introduce the terminology of mass normalized mode shapes and to show how they can be constructed. From now on we will refrain from introducing a special symbol for mass normalized mode shapes in an effort to curb symbolic overcrowding and simply state, if necessary, whether a particular mode shape is mass normalized.\nFinally, we should note that the eigenvalue problem may be collectively stated for all the modes with a relatively simple matrix notation. Collecting the eigenvalue equation for each mode in consecutive columns we get \\[\n\\left[ \\kmat \\eigveci{1} \\; \\kmat \\eigveci{2} \\; \\cdots \\; \\kmat \\eigveci{n} \\right] = \\left[ \\mmat \\eigveci{1} \\freq_1^2 \\; \\kmat \\eigveci{2} \\freq_2^2 \\; \\cdots \\; \\kmat \\eigveci{n}\\freq_n^2 \\right]\n\\] which may also be written as \\[\n\\kmat \\left[ \\eigveci{1} \\; \\eigveci{2} \\; \\cdots \\; \\eigveci{n}\\right] = \\mmat \\left[ \\eigveci{1} \\; \\eigveci{2} \\; \\cdots \\; \\eigveci{n}\\right] \\begin{bmatrix} \\freq_1^2 & 0 & 0 & \\cdots & 0 \\\\ 0 & \\freq_2^2 & 0 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\cdots & \\vdots \\\\ 0 & 0 & \\cdots & \\freq_{n-1}^2 & 0\\\\ 0 & 0 & 0 & \\cdots & \\freq_n^2\\end{bmatrix}\n\\] Defining the mode shape matrix (or the modal matrix as it is referred to in linear algebra) \\(\\modmat\\) as \\[\n\\modmat = \\left[ \\eigveci{1} \\; \\eigveci{2} \\; \\cdots \\; \\eigveci{n}\\right]\n\\] and the diagonal spectral matrix \\(\\spectmat\\) as \\[\n\\spectmat = \\begin{bmatrix} \\freq_1^2 & 0 & 0 & \\cdots & 0 \\\\ 0 & \\freq_2^2 & 0 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\cdots & \\vdots \\\\ 0 & 0 & \\cdots & \\freq_{n-1}^2 & 0\\\\ 0 & 0 & \\cdots & 0 & \\freq_n^2\\end{bmatrix}\n\\] the eigenvalue problem may be collectively expressed as \\[\n\\kmat \\modmat = \\mmat \\modmat \\spectmat\n\\qquad(7.21)\\] Furthermore, the orthogonality conditions may now be expressed as \\[\n\\modmat^T \\mmat \\modmat = \\begin{bmatrix} \\modm_1 & 0 & 0 & \\cdots & 0 \\\\ 0 & \\modm_2 & 0 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\cdots & \\vdots \\\\ 0 & 0 & \\cdots & \\modm_{n-1} & 0\\\\ 0 & 0 & 0 & \\cdots & \\modm_n\\end{bmatrix} = \\modmmat, \\quad \\modmat^T \\kmat \\modmat = \\begin{bmatrix} \\modk_1 & 0 & 0 & \\cdots & 0 \\\\ 0 & \\modk_2 & 0 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\cdots & \\vdots \\\\ 0 & 0 & \\cdots & \\modk_{n-1} & 0\\\\ 0 & 0 & 0 & \\cdots & \\modk_n\\end{bmatrix} = \\modkmat\n\\] where the diagonal matrices \\(\\modmmat\\) and \\(\\modkmat\\) are called the modal mass matrix and the modal stiffness matrix, respectively."
  },
  {
    "objectID": "multidoffreevib.html#coordinate-transformations-and-the-eigenvalue-problem",
    "href": "multidoffreevib.html#coordinate-transformations-and-the-eigenvalue-problem",
    "title": "7  Free Vibrations of Multi Degree of Freedom Systems",
    "section": "7.3 Coordinate Transformations and the Eigenvalue Problem",
    "text": "7.3 Coordinate Transformations and the Eigenvalue Problem\nDo coordinate transformations affect frequencies and mode shapes? The answer is probably relatively easy to reason: frequencies characterize how fast the harmonic motions of the whole system take place and therefore they should not depend on which coordinates are used to describe the motion; mode shapes, on the other hand, depict what the system looks like so that different coordinates may require different coefficients to specify the shape of the system. How shall we approach this issue mathematically? Consider two sets of generalized coordinates, \\(\\gcvec\\) and \\(\\gcvec'\\), both of which may be used to define the dynamics of a system. Assume these two coordinate sets are related through \\[\n\\gcvec = \\mtrx{T} \\gcvec'\n\\] with the eigenvalue problem in \\(\\gcvec\\) coordinates given by: \\[\n(\\kmat -\\freq^2 \\mmat) \\eigvec = \\zerocol\n\\] Remembering that \\(\\matabs{\\mtrx{A}\\mtrx{B}\\mtrx{C}}=\\matabs{\\mtrx{A}}\\matabs{\\mtrx{B}}\\matabs{\\mtrx{C}}\\), we note that the characteristic equation \\[\n\\matabs{\\kmat -\\freq^2 \\mmat} = 0\n\\] will have the same roots as \\[\n\\matabs{\\mtrx{T}^{-T}\\mtrx{T}^{T}(\\kmat -\\freq^2 \\mmat)\\mtrx{T}\\mtrx{T}^{-1}}=0\n\\] since \\(\\mtrx{T}\\mtrx{T}^{-1}=\\mtrx{T}^{-T}\\mtrx{T}^{T}=\\idmat\\) where \\(\\idmat\\) is the identity matrix (the determinant of which is equal to 1) and \\(\\mtrx{T}^{-T}\\) is the inverse of \\(\\mtrx{T}^{T}\\). Proceeding with this line of inquiry, we have \\[\n\\mtrx{T}^{-T} (\\mtrx{T}^{T}\\kmat\\mtrx{T} -\\freq^2 \\mtrx{T}^{T}\\mmat\\mtrx{T}) \\mtrx{T}^{-1}\\eigvec = \\mtrx{T}^{-T} (\\barkmat -\\freq^2 \\barmmat) \\mtrx{T}^{-1}\\eigvec = \\zerocol\n\\] which implies \\[\n\\mtrx{T}^{-T} (\\barkmat -\\freq^2 \\barmmat) \\mtrx{T}^{-1}\\eigvec = \\zerocol \\quad \\rightarrow \\quad (\\barkmat -\\freq^2 \\barmmat) \\mtrx{T}^{-1}\\eigvec = \\zerocol\n\\qquad(7.22)\\] since \\(\\mtrx{T}^{-T} \\neq \\zeromat\\). Noting that the eigenvalue problem in the transformed coordinates would be given by, \\[\n(\\barkmat -(\\freq')^2 \\barmmat) \\eigvec' = \\zerocol\n\\qquad(7.23)\\] we conclude, by comparing Equation 7.22 and Equation 7.23, that \\[\n(\\freq')^2 = \\freq^2\n\\] and hence the eigenvalues are unique; i.e., the values of the frequencies of a system are independent of the generalized coordinates employed in writing the equations of motion. It also follows by comparison that \\[\n\\eigvec' = \\mtrx{T}^{-1}\\eigvec\n\\] so that in general the mode shapes in the transformed coordinates will be different than those in the original coordinate as we had foreseen."
  },
  {
    "objectID": "multidoffreevib.html#modal-analysis-of-free-vibrations",
    "href": "multidoffreevib.html#modal-analysis-of-free-vibrations",
    "title": "7  Free Vibrations of Multi Degree of Freedom Systems",
    "section": "7.4 Modal Analysis of Free Vibrations",
    "text": "7.4 Modal Analysis of Free Vibrations\nAs in the SDOF case, free vibrations in the context of MDOF systems refers to motion that takes place due to some initial perturbation from the system’s original equilibrium configuration, with no other external disturbance present. Let’s first consider an undamped system subjected to a set of initial displacements and velocities at time \\(t=0\\): \\[\n\\mmat \\ddgctvec + \\kmat \\gctvec = \\zerocol, \\quad \\{\\gcvec (0) = \\gcvecic, \\dgcvec (0) = \\dgcvecic\\}\n\\] where \\[\n\\gcvecic = \\colmat{\\gc_{1o} \\\\ \\gc_{2o} \\\\ \\vdots \\\\ \\gc_{no}}, \\quad \\dgcvecic = \\colmat{\\dgc_{1o} \\\\ \\dgc_{2o} \\\\ \\vdots \\\\ \\dgc_{no}}\n\\] are the generalized coordinate and generalized velocity vectors (column matrices), respectively, at time \\(t=0\\); we will refer to these two collectively as the initial conditions for the MDOF system. Since this matrix equation is a coupled set of equations, coming up with solutions simultaneously for all generalized coordinates directly is not an easy feat and in most cases simply not feasible. One way to approach this problem is to inquire if there is any way we can decouple the \\(n\\) equations of motion describing our system. Let’s imagine an alternative set of coordinates, \\[\n\\modcorvec (t) = \\begin{bmatrix} \\modcor_1(t) \\\\ \\modcor_2(t) \\\\ \\vdots \\\\ \\modcor_N(t) \\end{bmatrix}\n\\] such that if the equations were to be written in these coordinates, the mass and stiffness matrices would all become perfectly diagonal. In that case, the first equation would only involve terms with \\(\\modcor_1\\) and \\(\\ddmodcor_1\\), the second equation with \\(\\modcor_2\\) and \\(\\ddmodcor_2\\), and so forth. If this were possible, one would essentially have \\(n\\)-many uncoupled single degree of freedom systems, each of which would execute simple harmonic motions due to their initial conditions. We have implicitly solved this problem when we derived the eigenvalue problem. Recall that we had asked if it were possible for an MDOF system to execute simple harmonic motion, and the answer we got was that the system had certain frequencies and mode shapes with which it indeed could execute such motion. Furthermore we also showed that these mode shapes were orthogonal in that \\[\n\\modmat^T \\mmat \\modmat = \\modmmat, \\quad \\modmat^T \\kmat \\modmat = \\modkmat\n\\] where \\(\\modmmat\\) and \\(\\modkmat\\) were diagonal matrices! If we recall the coordinate transformation rules given by Equation 6.20, we may guess where this discussion is going. Let us define a set of coordinates \\(\\modcorvec (t)\\) such that \\[\n\\gctvec = \\modmat \\modcorvec (t)\n\\] The equations of motion when transformed to these coordinates would yield \\[\n\\modmat^T \\mmat \\modmat \\ddmodcorvec (t) + \\modmat^T \\kmat \\modmat \\modcorvec (t) = \\modmmat \\ddmodcorvec (t) + \\modkmat \\modcorvec (t) = \\zerocol, \\quad \\{\\modcorvec (0) = \\modcorvecic, \\dmodcorvec (0) = \\dmodcorvecic\\}\n\\] where \\[\n\\modcorvecic = \\colmat{\\modcor_{1o} \\\\ \\modcor_{2o} \\\\ \\vdots \\\\ \\modcor_{no}}, \\quad \\dmodcorvecic = \\colmat{\\dmodcor_{1o} \\\\ \\dmodcor_{2o} \\\\ \\vdots \\\\ \\dmodcor_{no}},\n\\] are the initial conditions in the \\(\\modcorvec\\) coordinates. These will have to be calculated via the initial conditions in the \\(\\gcvec\\) coordinates: since the two sets of coordinates are related through the same transformation at all times, we have \\[\n\\gcvecic = \\modmat \\modcorvecic \\; \\rightarrow \\; \\modcorvecic = \\modmat^{-1} \\gcvecic\n\\] and \\[\n\\dgcvecic = \\modmat \\dmodcorvecic \\; \\rightarrow \\; \\dmodcorvecic = \\modmat^{-1} \\dgcvecic\n\\] Calculating the initial conditions via matrix inversion is costly, especially if the dimensions are large; furthermore, it may be that we are interested in only a handful of coordinates \\(\\modcor_i\\) (for reasons that will be soon discussed), for which evaluating the whole set by inverting the mode shape matrix is too inefficient. Instead we may proceed as follows: the orthogonality of the mode shapes lead to \\[\\begin{align*}\n\\teigveci{i} \\mmat \\gcvecic & = \\teigveci{i} \\mmat \\modmat \\modcorvecic \\\\\n& = \\colmat{\\teigveci{i} \\mmat \\eigveci{1}^T \\;\\; \\teigveci{i} \\mmat \\eigveci{2} \\;\\; \\cdots \\;\\; \\teigveci{i} \\mmat \\teigveci{i} \\;\\; \\cdots \\;\\; \\teigveci{i} \\mmat \\eigveci{n}} \\modcorvecic \\\\\n& = \\colmat{0 \\;\\; 0 \\;\\; \\cdots \\;\\; \\modm_{i} \\;\\; \\cdots \\;\\; 0} \\modcorvecic\\\\\n\\teigveci{i} \\mmat \\gcvecic & = \\modm_i \\modcor_{io}\n\\end{align*}\\] so that \\[\n\\modcor_{io} = \\ratio{\\teigveci{i} \\mmat \\gcvecic}{\\modm_i}\n\\qquad(7.24)\\] and similarly, \\[\n\\dmodcor_{io} = \\ratio{\\teigveci{i} \\mmat \\dgcvecic}{\\modm_i}\n\\qquad(7.25)\\] Both these equations may be collectively written for all modal coordinates via matrix notation as \\[\n\\modcorvecic = \\modmmat^{-1} \\modmat^{T} \\mmat \\gcvecic, \\quad \\dmodcorvecic = \\modmmat^{-1} \\modmat^{T} \\mmat \\dgcvecic\n\\qquad(7.26)\\] This looks like a lot of work compared to a one-step matrix inversion but we must remember that with increasing dimensions, matrix multiplication becomes much less costly compared to matrix inversions (since the modal mass matrix is diagonal, its inversion is trivial). Keeping in mind that the mass matrix is frequently diagonal, the approach summarized above, which also allows for picking specific subsets, turns out to be quite an efficient way to calculate the initial conditions in the transformed coordinates.\nIn any case, this is the brief summary of what happened so far: we aim to solve for the free vibration response of an MDOF system, governed by \\[\n\\mmat \\ddgctvec + \\kmat \\gctvec = \\zerocol \\, ; \\quad \\{\\gcvec (0) = \\gcvecic, \\dgcvec (0) = \\dgcvecic\\}\n\\qquad(7.27)\\] and we attempt the solution via the transformation \\[\n\\gcvec (t) = \\modmat \\modcorvec (t)\n\\qquad(7.28)\\] with the governing equations in the new coordinates given by \\[\n\\modmmat \\ddmodcorvec (t) + \\modkmat \\modcorvec (t) = \\zerocol \\, ; \\quad \\{\\modcorvec (0) = \\modcorvecic, \\dmodcorvec (0) = \\dmodcorvecic\\}\n\\qquad(7.29)\\] It may be better to introduce some terminology to reduce the burden of keeping track of which coordinates are which. When we initially write the equations of motion, the generalized coordinates that we employ almost always have a physical correspondence; for example, a generalized coordinate may be the displacement of a particular point or a rotation of a rigid body about a particular axis. Therefore we will call the initial set of generalized coordinates \\(\\gcvec\\) that we use to derive the governing equations of motion the physical coordinates. In contrast, the transformation of Equation 7.28 relates these physical coordinates to a set of coordinates that have no direct physical correspondence; the \\(\\modcorvec\\) coordinates are essentially a set of abstract variables which help us uncouple the initial set of equations. We will refer to this set of coordinates which are related to the physical coordinates via the mode shape matrix the modal coordinates.\nWe already discussed that the mass and stiffness matrices in the modal coordinates are diagonal by virtue of mode shape orthogonality conditions. The set of equations of Equation 7.29 are therefore \\(n\\) uncoupled equations, each of the form: \\[\n\\modm_i \\ddmodcor_i (t) + \\modk_i \\modcor_i (t) = 0 \\, ; \\quad \\{\\modcor_i (0) = \\modcor_{io}, \\dmodcor_i (0) = \\dmodcor_{io} \\}\n\\] So by transforming to modal coordinates, we have converted our \\(n\\)-DOF system to \\(n\\) uncoupled SDOF systems! The good news is that we have solved the SDOF problem before: the free vibration response of an undamped SDOF system is given by Equation 2.11 or equivalently by Equation 2.14, which may be written for the \\(i\\)-th modal coordinate as \\[\n\\modcor_i (t) = \\modcor_{io} \\cosp{\\freq_i t} + \\frac{\\dmodcor_{io}}{\\freq_i} \\sinp{\\freq_i t} = \\modcoramp_i \\cosp{\\freq_i t - \\phs_i}\n\\qquad(7.30)\\] where \\[\n\\freq_i = \\sqrt{\\ratio{\\modk_i}{\\modm_i}}, \\quad \\modcoramp_i = \\sqrt{\\modcor_{io}^2 + \\left(\\frac{\\dmodcor_{io}}{\\freq_i}\\right)^2}, \\quad \\tan \\phs_i = \\frac{\\left(\\dmodcor_{io}/{\\freq_i}\\right)/\\modcoramp_i}{\\modcor_{io}/\\modcoramp_i}\n\\qquad(7.31)\\] We are not done yet. What we want is the response of the system in physical coordinates, i.e. the solution to the original set of equations of Equation 7.27. Hence we must transform back to the physical coordinates via \\[\n\\begin{array}{rcl}\n\\gcvec (t) & \\!\\!\\! = & \\!\\!\\! \\modmat \\modcorvec (t) = \\eigveci{1} \\modcor_1 (t) + \\eigveci{2} \\modcor_2 (t) + \\cdots + \\eigveci{n} \\modcor_n (t) \\\\\n& \\!\\!\\! = & \\!\\!\\! \\modcoramp_1 \\eigveci{1} \\cosp{\\freq_1 t - \\phs_1}+ \\modcoramp_2 \\eigveci{2} \\cosp{\\freq_2 t - \\phs_2} + \\cdots + \\modcoramp_n \\eigveci{n} \\cosp{\\freq_n t - \\phs_n}\n\\end{array}\n\\qquad(7.32)\\] and we should note that the solution in Equation 7.32 is essentially the same (except for the number of modes involved) as the one we obtained at first when we were seeking the possibility of harmonic motion, i.e. Equation 7.8.\nThe expansion \\[\n\\gcvec (t) = \\modmat \\modcorvec (t) =  \\sum_{i=1}^{n} \\eigveci{i} \\modcor_{i} (t)\n\\] is generally referred to as the modal expansion. This equation provides a particular interpretation of the response as being the superposition of some variables which are in some sense independent, this said independence being related to the orthogonality of the mode shapes. Consider, for example, what would happen if the system were to be set in motion via an initial displacement pattern that looked like one of the mode shapes, say the \\(j\\)th mode shape; i.e. consider the following initial conditions: \\[\n\\gcvecic = \\epsilon \\eigveci{j}, \\; \\dgcvecic = \\zerocol\n\\] where \\(\\epsilon\\) is a non-zero real number. The initial conditions in modal coordinates are then given by \\[\n\\modcor_{io} = \\ratio{\\teigveci{i} \\mmat \\gcvecic}{\\modm_i} = \\ratio{\\teigveci{i} \\mmat \\epsilon \\eigveci{j}}{\\modm_i} = \\epsilon \\delta_{ij}\n\\] since \\(\\teigveci{i} \\mmat \\eigveci{j} = \\modm_{i} \\delta_{ij}\\) due to the orthogonality conditions. The initial velocities in modal coordinates, i.e. \\(\\modcorvecic\\), are zero since all initial velocities in physical coordinates are zero. Therefore, when the initial displacements are a scaled version of the \\(j\\)th mode shape, the only non-zero response comes from the \\(j\\)th modal coordinate, and it is given by \\[\n\\modcor_{j} (t) = \\epsilon \\cosp{\\freq_j t}\n\\] with all other \\(\\modcor_{i} (t) \\equiv 0\\) for \\(i \\neq j\\). The response of the system is then given by \\[\n\\gcvec (t) = \\sum_{i=1}^{n} \\eigveci{i} \\modcor_{i} (t) = \\epsilon \\eigveci{j} \\cosp{\\freq_j t}\n\\] This result is important and it is worthwhile to state it again in plain language: if an MDOF system is set in motion by an initial perturbation that coincides with one of the mode shapes of the system, then the system will oscillate with only the frequency of that particular mode to which that mode shape belongs. No other mode will contribute to the response. It is yet speculative but somewhat foreseeable that if an initial displacement pattern does not fully comply with a particular mode shape but mostly resembles it, than the biggest contribution to the response may be expected to come from that particular mode, with smaller but possibly non-zero contributions from the others. This pattern we shall demonstrate through some examples.\n\nEXAMPLE 7 .1\n\n\n\nFigure 7.4: Two DOF system subject to free-vibration.\n\n\nConsider a 2-DOF system with masses and spring constants defined as shown in Figure 7.4. We would like to calculate its free vibration response to initial conditions \\[\n\\gcvec (0) = \\colmat{Q/2\\\\ Q} = Q \\colmat{1/2\\\\ 1}, \\; \\dgcvec(0) = \\colmat{0 \\\\ 0}\n\\] We first have to derive the governing equations of motion. Say we use the Lagrangian approach to construct the mass and stiffness matrices. The kinetic and potential energies are given by \\[\n\\ke = \\frac{1}{2} 2m \\dgc_1^2 + \\frac{1}{2} m \\dgc_2^2, \\quad \\pe = \\frac{1}{2} 2k \\gc_1^2 + \\frac{1}{2} k (\\gc_2 - \\gc_1)^2\n\\] so that, by Equation 6.8 and Equation 6.10, \\[\nm_{11} = \\ratio{\\partial^2 \\ke}{\\partial \\dgc_1 \\partial \\dgc_1} = 2m, \\; m_{22} = \\ratio{\\partial^2 \\ke}{\\partial \\dgc_2 \\partial \\dgc_2} = m, \\, m_{12} = \\ratio{\\partial^2 \\ke}{\\partial \\dgc_1 \\partial \\dgc_2} = 0 = m_{21}\n\\] and \\[\nk_{11} = \\ratio{\\partial^2 \\pe}{\\partial \\gc_1 \\partial \\gc_1} = 3k, \\; k_{22} = \\ratio{\\partial^2 \\pe}{\\partial \\gc_2 \\partial \\gc_2} = k, \\, k_{12} = \\ratio{\\partial^2 \\pe}{\\partial \\gc_1 \\partial \\gc_2} = -k = k_{21}\n\\] The equations governing the free vibration are therefore given by \\[\n\\begin{bmatrix} 2m & 0 \\\\ 0 & m \\end{bmatrix} \\colmat{\\ddgc_1 \\\\ \\ddgc_2} + \\begin{bmatrix} 3k & -k \\\\ -k & k \\end{bmatrix} \\colmat{\\gc_1 \\\\ \\gc_2} = \\colmat{0 \\\\ 0}\n\\] Next, we find the eigenvalues by solving the characteristic equation that is obtained from \\(\\left|\\kmat -\\freq^2 \\mmat \\right|=0\\). The characteristic equation is given by \\[\n\\left|\\begin{bmatrix} 3k & -k \\\\ -k & k \\end{bmatrix} -\\freq^2 \\begin{bmatrix} 2m & 0 \\\\ 0 & m \\end{bmatrix}\\right| = (3k-\\freq^2 2m)(k-\\freq^2 m)-k^2 = 2m(\\freq^2)^2 - 5 k m \\freq^2 + 2 k^2= 0\n\\] or equivalently by \\[\n(\\freq^2)^2 - \\frac{5 k}{2 m} \\freq^2 + \\left(\\frac{k}{m}\\right)^2 = 0\n\\] and therefore the squares of the frequencies are calculated as \\[\n\\freq_1^2 = \\ratio{1}{2}\\ratio{k}{m}, \\quad \\freq_2^2 = 2 \\ratio{k}{m}\n\\] The mode shapes are computed by plugging back each eigenvalue into the equation one at a time and solving for the corresponding eigenvector. For the first one we have \\[\n\\left[\\begin{bmatrix}3k & -k \\\\ -k & k \\end{bmatrix} -\\ratio{1}{2}\\ratio{k}{m} \\begin{bmatrix} 2m & 0 \\\\ 0 & m \\end{bmatrix}\\right]\\colmat{\\eigvecs_{11} \\\\ \\eigvecs_{21}} = \\colmat{0 \\\\ 0}\n\\] leading to: \\[\n\\eigvecs_{21} = 2 \\eigvecs_{11}\n\\] If per choice we set \\(\\eigvecs_{11} = 1\\), we get \\[\n\\eigveci{1} = \\colmat{1 \\\\ 2}\n\\] Similarly for the second mode shape we have \\[\n\\left[\\begin{bmatrix}3k & -k \\\\ -k & k \\end{bmatrix} -2\\ratio{k}{m} \\begin{bmatrix} 2m & 0 \\\\ 0 & m \\end{bmatrix}\\right]\\colmat{\\eigvecs_{12} \\\\ \\eigvecs_{22}} = \\colmat{0 \\\\ 0}\n\\] so that \\[\n\\eigvecs_{22} = - \\eigvecs_{12}\n\\] and with \\(\\eigvecs_{12} = 1\\) we get \\[\n\\eigveci{2} = \\colmat{1 \\\\ -1}\n\\] The modal masses with these mode shapes are given by \\[\n\\modmmat = \\modmat^T \\mmat \\modmat = \\begin{bmatrix} 1 & 2 \\\\ 1 & -1 \\end{bmatrix} \\begin{bmatrix} 2m & 0 \\\\ 0 & m \\end{bmatrix} \\begin{bmatrix} 1 & 1 \\\\ 2 & -1 \\end{bmatrix} = \\begin{bmatrix} 6m & 0 \\\\ 0 & 3m \\end{bmatrix}\n\\] and the modal stiffnesses are given by \\[\n\\modkmat = \\modmat^T \\kmat \\modmat = \\begin{bmatrix} 1 & 2 \\\\ 1 & -1 \\end{bmatrix} \\begin{bmatrix} 3k & -k \\\\ -k & k \\end{bmatrix} \\begin{bmatrix} 1 & 1 \\\\ 2 & -1 \\end{bmatrix} = \\begin{bmatrix} 3k & 0 \\\\ 0 & 6k\n\\end{bmatrix}\n\\] whence we can check \\[\n\\freq_1^2 = \\ratio{\\modk_1}{\\modm_1}=\\ratio{1}{2}\\ratio{k}{m}, \\quad \\freq_2^2 = \\ratio{\\modk_2}{\\modm_2}=2\\ratio{k}{m}\n\\] If instead we would like to work with mass normalized mode shapes, those we can obtain by scaling the mode shapes above according to Equation 7.20 so that \\[\n\\meigveci{1}=\\ratio{1}{\\sqrt{6m}}\\colmat{1 \\\\ 2}, \\quad \\meigveci{2}=\\ratio{1}{\\sqrt{3m}}\\colmat{1 \\\\ -1}\n\\] and the modal mass and stiffness matrices in this case would be given by \\[\n\\modmmat = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}, \\quad \\modkmat = \\begin{bmatrix} \\frac{1}{2}\\frac{k}{m} & 0 \\\\ 0 & 2\\frac{k}{m} \\end{bmatrix}\n\\] Since there is no particular advantage to use mass normalized mode shapes for this system, we will proceed with our original set of mode shapes.\nTo solve for the response in modal coordinates, we must find the initial conditions in those coordinates. By Equation 7.24 and Equation 7.25 we have, \\[\n\\modcor_{1o} = \\frac{1}{\\modm_1}\\eigveci{1}^T \\mmat \\gcvecic = \\frac{1}{6m} \\left\\{1 \\;\\;\\; 2\\right\\} \\begin{bmatrix} 2m & 0 \\\\ 0 & m \\end{bmatrix} \\colmat{Q/2 \\\\ Q} = \\ratio{Q}{2}\n\\] and \\[\n\\modcor_{2o} = 0, \\quad \\dmodcor_{1o} = \\dmodcor_{2o} = 0\n\\] which the reader may easily verify. This result should, of course, be expected as per our discussion preceding this example: the initial condition shape coincides with the first mode in that \\(\\gcvecic = (Q/2) \\eigveci{1}\\), and therefore it sets in motion only the corresponding first mode and does not induce any motion in the other mode. The amplitudes and the phase angles in modal coordinates are calculated via Equation 7.31 to obtain \\[\n\\modcoramp_1 = \\frac{Q}{2}, \\quad \\phs_1 = \\arctan \\ratio{0}{1} = 0, \\quad \\modcoramp_2 = 0\n\\] so that \\[\n\\modcor_1 (t) = \\ratio{Q}{2} \\cosp{\\freq_1 t}, \\quad \\modcor_2 (t) \\equiv 0\n\\] The response in physical coordinates is then given by \\[\n\\gcvec (t) = \\colmat{\\gc_1 (t) \\\\ \\gc_2 (t)} = \\eigveci{1} \\modcor_1 (t) + \\eigveci{2} \\modcor_2 (t) = Q \\colmat{1/2 \\\\ 1} \\cosp{\\freq_1 t} = \\colmat{\\frac{Q}{2} \\cosp{\\freq_1 t} \\\\ Q \\cosp{\\freq_1 t}}\n\\] The response of the two masses are shown Figure 7.5, plotted against dimensionless time \\(\\tau = t/\\period_1 = (\\freq_1 t)/(2 \\pi)\\). Due to the given initial conditions both masses move in phase, but the displacement of the first mass is half of that of the second mass.\n\n\n\nFigure 7.5: Free vibration response for the system shown in Figure 7.4, subject to initial conditions \\(\\gcvecic = \\left\\{Q/2 \\;\\;\\; Q\\right\\}^T, \\;\\; \\dgcvecic = \\zerocol\\). The plots show time histories with respect to normalized time \\(\\tau = t/\\period_1\\).\n\n\nWhat if the system was subjected to some other initial conditions? Consider first what would happen if the initial displacement pattern didn’t exactly match one of the modes but was given by \\[\n\\gcvecic = \\colmat{2Q/3 \\\\ Q}, \\quad \\dgcvecic = \\zerocol\n\\] Note that the initial displacement pattern still resembles the first mode more than the second one. In this case the initial conditions in modal coordinates will be given by \\[\\begin{align*}\n\\modcor_{1o} & = \\frac{1}{6m} \\left\\{1 \\;\\;\\; 2\\right\\} \\begin{bmatrix} 2m & 0 \\\\ 0 & m \\end{bmatrix} \\colmat{2Q/3 \\\\ Q} = \\ratio{5}{9}Q \\\\  \n\\modcor_{2o} & = \\frac{1}{3m} \\left\\{1 \\;\\;\\; -1\\right\\} \\begin{bmatrix} 2m & 0 \\\\ 0 & m \\end{bmatrix} \\colmat{2Q/3 \\\\ Q} = \\ratio{1}{9}Q\n\\end{align*}\\] and \\(\\dmodcor_{1o} = \\dmodcor_{2o} = 0\\). The modal amplitudes and phase angles will be \\[\n\\modcoramp_1 = \\frac{5}{9}Q, \\quad \\phs_1 = \\arctan \\ratio{0}{1} = 0, \\quad \\modcoramp_2 = \\frac{1}{9}Q, \\quad \\phs_2 =\\arctan \\ratio{0}{1} = 0\n\\] with the modal responses given by \\[\n\\modcor_1 (t) = \\ratio{5}{9}Q \\cosp{\\freq_1 t}, \\quad \\modcor_2 (t) =\\ratio{1}{9}Q \\cosp{\\freq_2 t}\n\\] leading to the following displacement time histories for the two masses: \\[\n\\gcvec (t) = \\colmat{\\gc_1 (t) \\\\ \\gc_2 (t)} = \\eigveci{1} \\modcor_1 (t) + \\eigveci{2} \\modcor_2 (t) = \\colmat{\\frac{5}{9}Q \\cosp{\\freq_1 t} + \\frac{1}{9}Q \\cosp{\\freq_2 t} \\\\ \\frac{10}{9}Q \\cosp{\\freq_1 t} - \\frac{1}{9}Q \\cosp{\\freq_2 t}}\n\\] In terms of normalized time \\(\\tau = t/\\period_1 = (\\freq_1 t)/(2 \\pi)\\), the responses are given by \\[\n\\colmat{\\gc_1 (\\tau) \\\\ \\gc_2 (\\tau)} = \\colmat{\\frac{5}{9}Q \\cosp{2 \\pi \\tau} + \\frac{1}{9}Q \\cosp{4 \\pi \\tau} \\\\ \\frac{10}{9}Q \\cosp{2 \\pi \\tau} - \\frac{1}{9}Q \\cosp{4 \\pi \\tau}}\n\\] wherein we have incorporated the information that for our system, \\(\\freq_2 = 2 \\freq_1\\). These displacement time histories plotted against normalized time \\(\\tau\\) are shown in Figure 7.6. It is noteworthy that even though there is no exact match between the initial displacement pattern and the first mode, they are relatively similar and therefore most of the physical response is contributed by the first mode.\n\n\n\nFigure 7.6: Free vibration response for the system shown in Figure 7.4, subject to initial conditions \\(\\gcvecic = \\left\\{2Q/3 \\;\\;\\; Q\\right\\}^T, \\dgcvecic = \\zerocol\\). The plots show time histories with respect to normalized time \\(\\tau = t/\\period_1\\).\n\n\nFinally, consider what would happen if the system were now given a set of initial velocities, so that the initial conditions are given by \\[\n\\gcvecic = \\zerocol, \\; \\dgcvecic = \\colmat{v \\\\ -v} = v \\colmat {1 \\\\ -1}\n\\] In this case the initial conditions in modal coordinates are calculated to be \\(\\modcor_{1o} = \\modcor_{2o}=0\\), \\[\\begin{align*}\n\\dmodcor_{1o} & = \\frac{1}{6m}\\left\\{1 \\;\\;\\; 2\\right\\} \\begin{bmatrix} 2m & 0 \\\\ 0 & m \\end{bmatrix} \\colmat{1 \\\\ -1} v = 0\\\\\n\\dmodcor_{2o} & = \\frac{1}{3m} \\left\\{1 \\;\\;\\; -1\\right\\} \\begin{bmatrix} 2m & 0 \\\\ 0 & m \\end{bmatrix} \\colmat{1 \\\\ -1}v = v\n\\end{align*}\\] so that modal amplitudes and phase angles obtained via Equation 7.31 are \\[\n\\modcoramp_1 = 0, \\quad \\modcoramp_2 = \\frac{v}{\\freq_2}, \\quad \\phs_2 = \\arctan \\ratio{1}{0} = \\frac{\\pi}{2}\n\\] leading to \\[\n\\modcor_1 (t) \\equiv 0, \\quad \\modcor_2 (t) = \\frac{v}{\\freq_2} \\cosp{\\freq_2 t - \\frac{\\pi}{2}} = \\frac{v}{\\freq_2} \\sinp{\\freq_2 t}\n\\] As the initial velocity distribution coincides with the second mode shape (i.e. since \\(\\modcorvecic = \\zerocol\\) and \\(\\dmodcorvecic = v \\eigveci{2}\\)), only the second mode gets excited and the first mode does not get excited at all. Accordingly, the displacements of the two masses will be given by \\[\n\\colmat{\\gc_1 (t) \\\\ \\gc_2 (t)} = \\underbrace{\\eigveci{1} \\modcor_1 (t)}_{\\equiv \\zerocol} + \\eigveci{2} \\modcor_2 (t) = \\colmat{\\frac{v}{\\freq_2} \\sinp{\\freq_2 t}\\\\ - \\frac{v}{\\freq_2} \\sinp{\\freq_2 t}}\n\\] the plots of which are shown in Figure 7.7. In this case the two masses start to move in opposite directions with the initial velocities imposed on them and oscillate with frequency \\(\\freq_2\\), with no contribution form the first mode.\n\n\n\nFigure 7.7: Free vibration response for the system shown in Figure 7.4, subject to initial conditions \\(\\gcvecic = \\zerocol, \\dgcvecic = \\left\\{v \\;\\;\\; -v\\right\\}^T\\). The plots show time histories with respect to normalized time \\(\\tau = t/\\period_1\\), with \\(\\period_2 = \\period_1 / 2\\)."
  },
  {
    "objectID": "multidoffreevib.html#approximations-for-frequencies",
    "href": "multidoffreevib.html#approximations-for-frequencies",
    "title": "7  Free Vibrations of Multi Degree of Freedom Systems",
    "section": "7.5 Approximations for Frequencies",
    "text": "7.5 Approximations for Frequencies\n\n7.5.1 Rayleigh’s Quotient\nConsider a particular mode of an MDOF system, with mode shape \\(\\eigveci{i}\\) and frequency \\(\\freq_i\\). We have already seen that the following equation holds exactly true for undamped systems: \\[\n\\freq_i^2 = \\ratio{\\modk}{\\modm} = \\ratio{\\teigveci{i} \\kmat \\eigveci{i}}{\\teigveci{i} \\mmat \\eigveci{i}}\n\\qquad(7.33)\\] Note that this ratio is also a statement about the equality of maximum kinetic and potential energies that the system attains as it oscillates harmonically in the \\(i\\)-th mode. When the system oscillates as such, the generalized displacements and velocities are given by \\[\n\\gcvec (t) = A_i \\eigveci{i} \\cosp{\\freq_i t - \\phs_i}, \\quad \\dgcvec (t) = -\\freq_i A_i \\eigveci{i} \\sinp{\\freq_i t - \\phs_i}\n\\] so that the kinetic energy and potential energy at any instant are calculated as \\[\\begin{align*}\n\\ke  & = \\frac{1}{2} \\dgcvec^T \\mmat \\dgcvec = \\frac{1}{2} A_i^2 \\freq_i^2 \\teigveci{i} \\mmat \\eigveci{i}  \\sin^2\\left(\\freq_i t - \\phs_i\\right)\\\\\n\\pe  & = \\frac{1}{2} \\gcvec^T \\mmat \\gcvec = \\frac{1}{2} A_i^2 \\teigveci{i} \\kmat \\eigveci{i}  \\cos^2\\left(\\freq_i t - \\phs_i\\right)\n\\end{align*}\\] The energies will reach their respective maximum values when the sine and cosine terms are equal to unity; note also that whenever the kinetic energy is at a maximum the potential energy is zero and vice versa. The maximum values are therefore given by\n\\[\n\\ke_{\\max} = \\frac{1}{2} A_i^2 \\freq_i^2 \\teigveci{i} \\mmat \\eigveci{i}, \\quad \\pe_{\\max} = \\frac{1}{2} A_i^2 \\teigveci{i} \\kmat \\eigveci{i}\n\\] and if there is no energy feed or loss, conservation of energy requires \\[\n\\ke_{\\max} = \\pe_{\\max} \\quad \\rightarrow \\quad \\frac{1}{2} A_i^2 \\freq_i^2 \\teigveci{i} \\mmat \\eigveci{i} = \\frac{1}{2} A_i^2 \\teigveci{i} \\kmat \\eigveci{i}\n\\] so that \\[\n\\freq_i^2 = \\ratio{\\teigveci{i} \\kmat \\eigveci{i}}{\\teigveci{i} \\mmat \\eigveci{i}}\n\\] Now assume we do not exactly know the mode shape but maybe we have an estimate of what it may look like. This is not so unexpected, especially as an analyst gains experience over different models. Even at an introductory stage we may feel, for example, that if there was a beam with a few heavy masses attached to it, or a tall building that could be approximated by a shear building model, their fundamental mode shapes would look reasonably like those shown in Figure 7.8. Yes, we probably will not know the exact mode shape, but a decent estimate may be possible; and yes, all this is somewhat vague.\n\n\n\nFigure 7.8: Some deformation shapes estimates: a beam carrying heavy masses and a tall shear building.\n\n\nAssume that our estimate for the mode shape is denoted by \\(\\rayvec\\) and it is called the shape vector. We may at least require for consistency that were the system to oscillate harmonically with such a shape, the conservation of energy should still hold. If the frequency of oscillation is denoted by \\(\\rayfreq\\), going through a similar set of steps, we find that conservation of energy requires: \\[\n(\\rayfreq (\\rayvec))^2 = \\ratio{\\trayvec \\kmat \\rayvec}{\\trayvec \\mmat \\rayvec}\n\\qquad(7.34)\\] This ratio is called Rayleigh’s Quotient. At this point we hope that the similarity of Equation 7.34 to Equation 7.33 is sufficient to claim that if \\(\\rayvec\\) is similar to \\(\\eigveci{i}\\), then \\(\\rayfreq\\) will provide an acceptable estimate for \\(\\freq_i\\). The resemblance of the expressions to those discussed in Section 2.5 in the context of generalized single degree of freedom systems is not coincidental: the generalized SDOF approach is essentially the broader version of Rayleigh’s approach. Rayleigh’s Quotient generally works well and it is used in numerical methods to iteratively refine eigenvector estimates to solve an eigenvalue problem.\nLet us try to further investigate what it is that we are investigating. The mode shapes of an n-DOF system provide a set of bases in the n-dimensional space due to the orthogonality relations. For some set of coefficients \\(a_i\\) (for \\(i=1,2,\\ldots,n\\)), we may express the shape column \\(\\rayvec\\) as\n\\[\n\\rayvec = a_1 \\kmat \\eigveci{1}+a_2 \\kmat \\eigveci{2}+\\cdots+a_n \\kmat \\eigveci{n} = \\sum_{i=1}^n a_i \\kmat \\eigveci{i} = \\sum_{i=1}^n a_i \\freq_i^2 \\mmat \\eigveci{i}\n\\] where the last equality follows from the eigenvalue problem, i.e. \\(\\kmat \\eigveci{i} = \\freq_i^2 \\mmat \\eigveci{i}\\). The coefficients \\(a_i\\) are unique and may be evaluated as \\[\n\\teigveci{i}\\rayvec = \\teigveci{i}\\left(\\sum_{j=1}^n a_j \\kmat \\eigveci{j}\\right) = \\sum_{j=1}^n a_j \\modk_j \\delta_{ij} = a_i \\modk_i = a_i \\freq_i^2 \\modm_i\n\\] where \\(\\teigveci{i}\\kmat\\eigveci{j}=\\modk_j\\delta_{ij}\\) and \\(\\teigveci{i}\\mmat\\eigveci{j}=\\modm_j\\delta_{ij}\\) are the orthogonality relations we had previously shown. With these expansions, we have \\[\\begin{align*}\n\\trayvec\\kmat\\rayvec & = \\left(\\sum_{i=1}^n a_i \\kmat \\eigveci{i}\\right)^T \\kmat \\left(\\sum_{j=1}^n a_j \\kmat \\eigveci{j}\\right) \\\\\n& = \\sum_{i=1}^n\\sum_{j=1}^n a_i a_j \\modk_i \\delta_{ij} = \\sum_{i=1}^n a_i^2 \\modk_i = \\sum_{i=1}^n a_i^2 \\freq_i^2 \\modm_i\n\\end{align*}\\] and similarly \\[\n\\trayvec\\mmat\\rayvec = \\sum_{i=1}^n a_i^2 \\modm_i\n\\] so that Rayleigh’s Quotient may be expressed as \\[\n(\\rayfreq)^2 = \\ratio{\\trayvec\\kmat\\rayvec}{\\trayvec\\mmat\\rayvec} = \\ratio{\\sum_{i=1}^n a_i^2 \\freq_i^2 \\modm_i}{\\sum_{i=1}^n a_i^2 \\modm_i}\n\\] As \\(\\freq_i \\geq \\freq_1\\) for all \\(i\\), if we express Rayleigh’s Quotient as \\[\n(\\rayfreq)^2 = \\ratio{\\freq_1^2 \\sum_{i=1}^n a_i^2 \\ratio{\\freq_i^2}{\\freq_1^2} \\modm_i}{\\sum_{i=1}^n a_i^2 \\modm_i}\n\\] we can argue that \\[\n\\ratio{\\sum_{i=1}^n a_i^2 \\frac{\\freq_i^2}{\\freq_1^2} \\modm_i}{\\sum_{i=1}^n a_i^2 \\modm_i} \\geq 1\n\\] since \\((\\freq_i/\\freq_1)\\geq 1\\) for all \\(i\\). Therefore we may conclude that for any arbitrary (non-zero of course) shape vector \\(\\rayvec\\), \\[\n(\\rayfreq (\\rayvec))^2 \\geq \\freq_1^2\n\\] so that Rayleigh’s Quotient always provides an upper bound to the lowest frequency. Going through a similar argument we may also show that it will provide a lower bound to the highest frequency.\n\n\n7.5.2 Rayleigh-Ritz Method\nAn extension of Rayleigh’s Quotient is achieved by considering more than one shape factor and thereby introducing more flexibility in achieving optimality. Consider using in Rayleigh’s Quotient a shape vector that is composed of \\(r\\) different candidates, i.e., \\[\n\\rayvec = a_1 \\ritzcandvec{1} + a_2 \\ritzcandvec{2} + \\cdots + a_r \\ritzcandvec{r} = \\ritzmat \\nvec{a}\n\\] where \\[\n\\ritzmat = \\begin{bmatrix} \\ritzcandvec{1} & \\ritzcandvec{2} & \\cdots \\ritzcandvec{r} \\end{bmatrix}, \\quad \\nvec{a} = \\colmat{a_1 \\\\ a_2 \\\\ \\vdots \\\\ a_r}\n\\] We may think of this approach as an attempt to approximate multiple modes simultaneously where we pick candidate shapes \\(\\ritzcandvec{i}\\) and try to adjust the coefficients \\(a_i\\) to somehow get the best possible result. For a given set of \\(\\ritzcandvec{i}\\), the value of Rayleigh’s Quotient will depend on \\(a_i\\)’s since \\[\n(\\rayfreq)^2 = \\ratio{\\trayvec \\kmat \\rayvec}{\\trayvec \\mmat \\rayvec}  = \\ratio{\\nvec{a}^T \\ritzmat^T \\kmat \\ritzmat \\nvec{a}}{\\nvec{a}^T \\ritzmat^T \\mmat \\ritzmat \\nvec{a}} = \\ratio{\\nvec{a}^T \\ritzkmat \\nvec{a}}{\\nvec{a}^T \\ritzmmat \\nvec{a}}  \n\\] where \\[\n\\ritzkmat = \\ritzmat^T \\kmat \\ritzmat \\quad \\text{and} \\quad \\ritzmmat = \\ritzmat^T \\mmat \\ritzmat\n\\] are both symmetric and of dimensions \\(r \\times r\\). As Rayleigh’s Quotient provides an upper bound for the lowest frequency, it should make sense that we ought to seek values of \\(a_i\\) which will make Rayleigh’s Quotient a minimum for the given set of candidate shapes so that we have the best possible estimate. In other words, we shall seek those values of \\(a_i=a_i^{\\ast}\\) for which \\[\n\\ratio{\\partial (\\rayfreq)^2}{\\partial a_i}\\biggr|_{a_i=a_i^{\\ast}} = 0 \\quad \\text{for } i=1,2,\\ldots r\n\\] This condition may be expressed in matrix form as \\[\n\\ratio{\\partial (\\rayfreq)^2}{\\partial \\nvec{a}}\\biggr|_{\\nvec{a}=\\nvec{a{\\ast}}} = \\zerocol  \n\\] and when we use matrix differentiation rules we obtain \\[\n\\ratio{\\partial \\nvec{a}^T \\ritzmmat \\nvec{a}}{\\partial \\nvec{a}} = 2 \\ritzmmat \\nvec{a}, \\quad \\ratio{\\partial \\nvec{a}^T \\ritzkmat \\nvec{a}}{\\partial \\nvec{a}} = 2 \\ritzkmat \\nvec{a}\n\\] so that \\[\n\\ratio{\\partial (\\rayfreq)^2}{\\partial \\nvec{a}}\\biggr|_{\\nvec{a}=\\nvec{a{\\ast}}} = \\ratio{2}{\\nvec{a^{\\ast}}^T \\ritzmmat \\nvec{a^{\\ast}}} \\left[\\ritzkmat \\nvec{a^{\\ast}} - \\ratio{\\nvec{a^{\\ast}}^T \\ritzmmat \\nvec{a^{\\ast}}}{\\nvec{a^{\\ast}}^T \\ritzmmat \\nvec{a^{\\ast}}} \\ritzmmat \\nvec{a^{\\ast}} \\right]= \\zerocol  \n\\] Since by definition \\[\n(\\rayfreq)^2 = \\ratio{\\nvec{a}^T \\ritzkmat \\nvec{a}}{\\nvec{a}^T \\ritzmmat \\nvec{a}}\n\\] the condition that must be satisfied by \\(a_i\\) to yield the minimum value of Rayleigh’s Quotient may be expressed as: \\[\n\\left(\\ritzkmat - (\\rayfreq)^2 \\ritzmmat \\right) \\nvec{a^{\\ast}} = \\zerocol\n\\qquad(7.35)\\] Well, this is an eigenvalue problem, reminiscent of our original eigenvalue problem; but we must note that this new problem is of dimension \\(r\\), with possibly \\(r &lt;&lt; n\\), so that computationally it is much more feasible. As with any such problem, there will be \\(r\\) eigenvalues and eigenvectors that satisfy Equation 7.35. The eigenvalues will yield \\(r\\) natural frequency estimates, \\[\n\\ritzfreq{1}, \\ritzfreq{2},\\ldots,\\ritzfreq{r}\n\\] such that \\[\n\\ritzfreq{i} \\geq \\freq_i, \\quad \\text{for } i=1,2,\\ldots r\n\\] with estimates improving with better selection of candidate shapes. The eigenvectors obtained from Equation 7.35 are to be used in calculating estimates of the mode shapes of the system so that \\[\n\\ritzvec{i} = \\ritzmat \\nvec{a^{\\ast}_i} \\approx \\eigveci{i}\n\\]\n\nEXAMPLE 7 .2\nWhat we have is a taut string, subject to a high tension \\(N\\), and five equal masses attached to it, as shown in Figure 7.9. Due to the high level of tensile force, the masses will move mainly along the vertical, with a total of five degrees of freedom for the system. We would like to estimate the fundamental frequency of the system with Rayleigh’s Quotient.\n\n\n\nFigure 7.9: A taut string bearing five equal masses.\n\n\nThe first order of business is to derive the mass and stiffness matrices. With the generalized coordinates \\(\\gc_i\\) denoting the translation of each mass and with masses concentrated at a point, it should be obvious that the mass matrix will be diagonal, with the values of the masses appearing on the diagonal. We may see that this should be so by considering a nonzero acceleration \\(\\ddgc_i\\) while all other accelerations are zero and see what external forces would be required for equilibrium; the only external force required in that case would be \\(m \\ddgc_i\\) acting along the \\(i\\)th generalized coordinate.\nTo construct the stiffness matrix, let us try to identify the stiffness influence coefficients via the force equilibrium approach discussed in Section 6.3.1. What would be the forces required to keep the system in equilibrium when \\(\\gc_i &gt; 0\\) with all other generalized coordinates locked at zero? The free body diagrams of three consecutive masses, with the \\(i\\)th mass at the center, are shown in Figure 7.10. Due to the imposed displacement, there will be some deformation in the string resulting in a change \\(\\Delta N\\) in the tensile force. It makes a big difference how high the initial tensile force and how big the imposed displacement are. If the considered displacement were to be large, then horizontal effects would have to be included, for otherwise equilibrium would not be possible. For small displacements we can consider only vertical forces so that \\[\nk_{ii} \\gc_i = 2 (N + \\Delta N) \\sin \\theta, \\quad k_{i(i-1)} \\gc_i = k_{i(i+1)} \\gc_i = - (N + \\Delta N) \\sin \\theta\n\\] anf furthermore, since for \\(\\gc_i \\ll 1\\) we would have \\[\n\\sin \\theta \\approx \\tan \\theta = \\ratio{\\gc_i}{\\ell/5}\n\\] we get \\[\nk_{ii} \\gc_i = 2 (N + \\Delta N) \\ratio{\\gc_i}{\\ell/5}, \\quad k_{i(i-1)} \\gc_i = k_{i(i+1)} \\gc_i = - (N + \\Delta N) \\ratio{\\gc_i}{\\ell/5}\n\\] Note that with \\(\\gc_{i(i-1)}\\) and \\(\\gc_{i(i+1)}\\) locked, no force needs to be applied along any other generalized coordinate since there will be no deformations in their neighborhoods.\n\n\n\nFigure 7.10: Stiffness influence coefficients: Free body diagrams of the ith mass and its neighbors for \\(\\gc_i &gt; 0\\) and all other \\(\\gc_j = 0\\) for \\(j \\neq i\\).\n\n\nWhen the initial tension in the string is large and the imposed displacement is small, the change \\(\\Delta N\\) due to deformations will remain very small compared to the initial tension and we may neglect \\(\\Delta N\\) compared to \\(N\\) for an acceptable approximation. Therefore the stiffness coefficients will be given by \\[\nk_{ii}  =  \\ratio{10 N}{\\ell}, \\quad k_{i(i-1)} = k_{i(i+1)} = - \\ratio{5 N}{\\ell}\n\\] and repeating this analysis for all the generalized coordinates, the stiffness matrix may be shown to be given by: \\[\n\\kmat = \\ratio{5 N}{\\ell}\n\\begin{bmatrix}\n2 & -1 & 0 & 0 & 0\\\\\n-1 & 2 & -1 & 0 & 0\\\\\n0 & -1 & 2 & -1 & 0\\\\\n0 & 0 & -1 & 2 & -1\\\\\n0 & 0 & 0 & -1 & 2\n\\end{bmatrix}\n\\] Now we are ready to start our investigation of the frequencies. To use Rayleigh’s Quotient we need to estimate what the first mode of vibration might look like. Considering what we would expect if such masses were hung on a string, a sagged cable shape seems a reasonable guess. We will therefore use the two shapes shown in Figure 7.11 as two different shape vectors to employ in Rayleigh’s Quotient: \\[\n\\ritzvec{1} = \\colmat{1/3 \\\\ 2/3 \\\\ 1 \\\\ 2/3 \\\\ 1/3}, \\quad \\ritzvec{2} = \\colmat{1/2 \\\\ 3/4 \\\\ 1 \\\\ 3/4 \\\\ 1/2}\n\\]\n\n\n\nFigure 7.11: Two different shape columns for Rayleigh’s Quotient.\n\n\nThese shape vectors lead to \\[\\begin{align*}\n(\\rayfreq (\\ritzvec{1}))^2 & = \\ratio{\\tritzvec{1} \\kmat \\ritzvec{1}}{\\tritzvec{1} \\mmat \\ritzvec{1}} = \\ratio{(10 N) /(3 \\ell)}{19 m/9} = \\ratio{30 N}{19 m \\ell} \\\\\n(\\rayfreq (\\ritzvec{2}))^2 & = \\ratio{\\tritzvec{2} \\kmat \\ritzvec{2}}{\\tritzvec{2} \\mmat \\ritzvec{2}} = \\ratio{(15 N) /(4 \\ell)}{21 m/8} = \\ratio{30 N}{21 m \\ell}\n\\end{align*}\\] so that the two upper bound estimates for the first mode frequency obtained from these respectively are \\[\n\\rayfreq (\\ritzvec{1}) = 1.27 \\sqrt{\\frac{N}{m \\ell}} \\quad \\text{and} \\quad \\rayfreq (\\ritzvec{2}) = 1.20 \\sqrt{\\frac{N}{m \\ell}}\n\\] and the smaller of the two is our best estimate yet for the first frequency of the system: \\[\n\\freq_1 \\approx 1.20 \\sqrt{\\frac{N}{m \\ell}}\n\\] We could try many different shapes and see if this upper bound may be further refined but it turns out that the estimate above is pretty good: the exact first two frequencies and mode shapes of the system are \\[\\begin{align*}\n\\freq_1  & = 1.16 \\sqrt{\\frac{N}{m \\ell}}, \\quad \\eigveci{1} = \\left\\{0.50 \\;\\;\\; 0.87 \\;\\;\\; 1 \\;\\;\\; 0.87 \\;\\;\\; 0.50\\right\\}^{T} \\\\\n\\freq_2 & = 2.24 \\sqrt{\\frac{N}{m \\ell}}, \\quad \\eigveci{2} = \\left\\{-1 \\;\\;\\; -1 \\;\\;\\; 0 \\;\\;\\; 1 \\;\\;\\; 1\\right\\}^{T}\n\\end{align*}\\] so that the estimate we get for the fundamental frequency from Rayleigh’s Quotient is quite good for many practical purposes.\n\n\nEXAMPLE 7 .3\nTo illustrate an application of the Rayleigh-Ritz approach, let us consider the 8 story shear building shown in Figure 7.12. Based on our previous discussions regarding shear buildings, we may expect the first mode to have no crossovers and the second mode to have only one crossover. Candidate shapes \\(u_1\\) and \\(u_2\\) shown in Figure 7.12 seem reasonable enough to be used in our analysis: \\[\n\\ritzmat = \\left[\\ritzcandvec{1} \\quad \\ritzcandvec{2} \\right] = \\begin{bmatrix} 1/8 &  1/3 \\\\ 2/8 & 2/3 \\\\ 3/8 & 1 \\\\ 4/8 & 2/3 \\\\ 5/8 & 1/3 \\\\ 6/8 & 0\\\\ 7/8 & -1/3 \\\\ 1 & -2/3\\end{bmatrix}\n\\]\n\n\n\nFigure 7.12: Eight story shear building model and two candidate vectors to be used in the Rayleigh-Ritz approach.\n\n\nThe mass and stiffness matrices are relatively easy to derive. The mass matrix is diagonal as in all shear building models, with all diagonal elements equal to \\(m\\) in this case. The stiffness matrix will follow the classic progression of shear building models as well and it will be given in this case by \\[\n\\kmat = \\begin{bmatrix} 4k & -2k & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n-2k & 4k & -2k & 0 & 0 & 0 & 0 & 0 \\\\\n0 & -2k & 3k & -k & 0 & 0 & 0 & 0 \\\\\n0 & 0 & -k & 2k & -k & 0 & 0 & 0 \\\\\n0 & 0 & 0 & -k & 2k & -k & 0 & 0 \\\\\n0 & 0 & 0 & 0 & -k & 2k & -k & 0 \\\\\n0 & 0 & 0 & 0 & 0 & -k & 2k & -k \\\\\n0 & 0 & 0 & 0 & 0 & 0 & -k & k \\\\ \\end{bmatrix}\n\\] We now have to set up the eigenvalue problem whose solution will help us determine the frequency estimates and the coefficients \\(\\nvec{a_{i}^{\\ast}}\\) which we will use in constructing our mode shape estimates. To this end we first calculate \\[\n\\ritzkmat = \\ritzmat^T \\kmat \\ritzmat =  \\begin{bmatrix} \\ratio{11 k}{64} & \\ratio{k}{24} \\\\ \\ratio{k}{24} & \\ratio{11k}{9}\\end{bmatrix}, \\quad \\ritzmmat = \\ritzmat^T \\mmat \\ritzmat =  \\begin{bmatrix} \\ratio{51 m}{16} & \\ratio{m}{6} \\\\ \\ratio{m}{6} & \\ratio{8m}{3}\\end{bmatrix}\n\\] and then use these matrices in the eigenvalue problem \\[\n\\left(\\ritzkmat - (\\ritzfreq{i})^2 \\ritzmmat \\right) \\nvec{a_i^{\\ast}} = \\zerocol\n\\] to obtain \\[\n(\\ritzfreq{1})^2 = 0.054 \\ratio{k}{m}, \\quad (\\ritzfreq{2})^2 = 0.459 \\ratio{k}{m}, \\quad \\nvec{a_1^{\\ast}} = \\colmat{-0.561 \\\\ 0.017}, \\quad \\nvec{a_2^{\\ast}} = \\colmat{-0.016 \\\\ 0.613}\n\\] Therefore our estimates for the frequencies of the first two modes become \\[\n\\ritzfreq{1} = 0.232 \\sqrt{\\ratio{k}{m}} \\quad \\text{and} \\quad \\ritzfreq{2} = 0.677 \\sqrt{\\ratio{k}{m}}\n\\] and for the mode shape estimates we get, after scaling them so that their component at the top floor is equal to one, \\[\n\\ritzvec{1} = \\ritzmat \\nvec{a_1^{\\ast}} = = \\colmat{0.11 \\\\ 0.23\\\\ 0.34\\\\ 0.47\\\\ 0.60\\\\ 0.74\\\\ 0.87\\\\ 1.00}, \\quad \\text{and} \\quad \\ritzvec{2} = \\ritzmat \\nvec{a_2^{\\ast}} = \\colmat{-0.48 \\\\ -0.95 \\\\ -1.43 \\\\ -0.94 \\\\ -0.46 \\\\ 0.03 \\\\ 0.51 \\\\ 1.00}\n\\] It turns out that these estimates are quite acceptable since the exact frequencies and mode shapes are given by \\[\n\\freq_1 = 0.222 \\sqrt{\\ratio{k}{m}}, \\quad \\freq_2 = 0.623 \\sqrt{\\ratio{k}{m}}, \\quad \\eigveci{1} = \\colmat{0.12 \\\\ 0.23 \\\\ 0.34 \\\\ 0.54 \\\\ 0.72 \\\\ 0.85 \\\\ 0.95 \\\\ 1.00}, \\quad \\eigveci{2} = \\colmat{-0.44 \\\\ -0.79 \\\\ -0.99 \\\\ -1.01 \\\\ -0.63 \\\\ -0.01 \\\\ 0.61 \\\\ 1.00}\n\\] The errors in the frequency estimates and the first mode estimate are quite small, but the errors in the second mode estimate somewhat more pronounced. The success of this approach in general depends on how well the candidate shapes resemble the actual modes and how many such shapes are taken into consideration. If, say, we were to include three candidate vectors, with the addition of \\[\n\\ritzcandvec{3} = \\left\\{\\ratio{1}{3} \\;\\;\\; \\ratio{2}{3} \\;\\;\\; 1 \\;\\;\\; \\ratio{2}{3} \\;\\;\\; -\\ratio{1}{3} \\;\\;\\; 0 \\;\\;\\; \\ratio{1}{3} \\;\\;\\; \\ratio{2}{3}\\right\\}^T\n\\] so that with \\(\\ritzmat = [\\ritzcandvec{1} \\; \\; \\ritzcandvec{2} \\;\\; \\ritzcandvec{3} ]\\), the estimates for the first two modes will be (note that there will also be an estimate for the third mode which we do note report) \\[\n\\ritzfreq{1} = 0.227 \\sqrt{\\ratio{k}{m}}, \\quad \\ritzfreq{2} = 0.668 \\sqrt{\\ratio{k}{m}}, \\quad \\ritzvec{1} = \\colmat{0.11 \\\\ 0.23\\\\ 0.34\\\\ 0.49\\\\ 0.69\\\\ 0.79\\\\ 0.90\\\\ 1.00}, \\quad \\ritzvec{2} = \\colmat{-0.38 \\\\ -0.77 \\\\ -1.15 \\\\ -0.79 \\\\ -0.57 \\\\ -0.05 \\\\ 0.48 \\\\ 1.00}\n\\] A quick overview of results will immediately reveal that increasing the number of candidate shapes have improved both the frequency and the mode shape estimates for the first two modes."
  },
  {
    "objectID": "multidoffreevib.html#sec-mdofdampfree",
    "href": "multidoffreevib.html#sec-mdofdampfree",
    "title": "7  Free Vibrations of Multi Degree of Freedom Systems",
    "section": "7.6 Free Vibration Response of Damped Systems",
    "text": "7.6 Free Vibration Response of Damped Systems\n\n7.6.1 Damping in MDOF Systems\nDamping. Well, at this point we can’t avoid the issue any further so let’s get into it. We already had a few words to say in Section 2.4 and we will again promote the linear viscous damping model as the model of choice for energy dissipation in small amplitude vibrations, with energy dissipated due to post-yield deformations to be accounted for separately. There is, however, an added level of complexity that damping brings into analysis of MDOF systems: would one be able to uncouple the equations of motion by transforming to modal coordinates in the presence of damping?\nThe answer is: not necessarily, but for many applications we will assume that is the case. To remind ourselves the mathematical structure on which we base our discussion, the equation of motion of free vibrations for a viscously damped linear MDOF system will be given by: \\[\n\\mmat \\ddgcvec (t) + \\cmat \\dgcvec (t) + \\kmat \\gcvec (t) = \\zerocol \\, ; \\quad \\{\\gcvec (0) = \\gcvecic, \\dgcvec (0) = \\dgcvecic \\}\n\\qquad(7.36)\\] If \\(\\modmat\\) is the matrix of eigenvectors (i.e. mode shapes) obtained from the undamped eigenvalue problem \\[\n\\kmat \\modmat = \\mmat \\modmat \\spectmat\n\\qquad(7.37)\\] then we know from previous discussions that a coordinate transformation of the form \\[\n\\gcvec (t) = \\modmat \\modcorvec (t)\n\\] will lead to \\[\n\\modmmat \\ddmodcorvec (t) + \\modmat^T \\cmat \\modmat \\dmodcorvec (t) + \\modkmat \\modcorvec (t) = \\zerocol \\, ; \\quad \\{\\modcorvec (0) = \\modcorvecic, \\dmodcorvec (0) = \\dmodcorvecic \\}\n\\] where \\(\\modmmat\\) and \\(\\modkmat\\) are diagonal matrices. So the question is: is \\(\\modmat^T \\cmat \\modmat\\) a diagonal matrix? If so, then transformation to modal coordinates would successfully uncouple all equations; but if not, then equations would be coupled and the modal analysis approach discussed previously would have to be modified if not altogether abandoned.\nIf transformation to modal coordinates uncouples also the damping terms so that the damping matrix in modal coordinates, given by \\[\n\\modcmat = \\modmat^T \\cmat \\modmat\n\\] is a diagonal matrix, the system is said to be classically damped, and the damping mechanism is classified as classical. There is no necessity that this should be the normative case. On the other hand it is by far the dominant model employed in analyses because it is simple to work with and its critical parameters may be estimated from (in other words, fit to) experimental observations. The eigenvalue problem that must be dealt with in classically damped systems is the undamped eigenvalue problem of Equation 7.37. If, on the other hand, one would like to obtain eigenvectors that would simultaneously uncouple \\(\\mmat\\), \\(\\kmat\\) and \\(\\cmat\\), one would have to solve the damped eigenvalue problem defined by \\[\n(\\eigval^2 \\mmat + \\eigval \\cmat + \\kmat)\\deigvec = \\zerocol\n\\qquad(7.38)\\] where \\(\\eigval\\) is called the damped eigenvalue and \\(\\deigvec\\) is called the damped eigenvector or the damped modeshape. We shall not pursue the non-classical model further in this section and limit the current discussion to classically damped systems. We note in passing that if the system is classically damped, then the eigenvalues and eigenvectors obtained from Equation 7.38 will be equivalent to those that will be obtained from the undamped eigenvalue problem of Equation 7.37.2\n\n\n\n\nThe wording (“equivalent”) is suspiciously vague but on purpose so: without going into details now, we just note that for symmetric, positive definite matrices of dimensions \\(n \\times n\\) the damped eigenvalue problem will lead to \\(2n\\) eigenvalues and eigenvectors that will appear in complex-conjugate pairs and the undamped eigenvalue problem will lead to \\(n\\) real valued eigenvalues and eigenvectors. If the system is classically damped, the complex conjugate pairs of the damped eigenvalue problem may be easily transformed to the real valued eigenparameters of the undamped eigenvalue problem.↩︎\n\n\n\n7.6.2 Modal Analysis of Classically Damped Systems\nIf an \\(n\\)-DOF system is classically damped, the equations of motion given by Equation 7.36, when transformed to model coordinates, will yield \\[\n\\modmmat \\ddmodcorvec (t) + \\modcmat \\dmodcorvec (t) + \\modkmat \\modcorvec (t) = \\zerocol \\, ; \\quad \\{\\modcorvec (0) = \\modcorvecic, \\dmodcorvec (0) = \\dmodcorvecic \\}\n\\qquad(7.39)\\] where \\[\n\\begin{array}{c}\n\\modmmat = \\begin{bmatrix}\\modm_1 & 0 & \\cdots & 0 \\\\ 0 & \\modm_2 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & \\cdots & 0 & \\modm_n \\end{bmatrix}, \\quad \\modcmat = \\begin{bmatrix}\\modc_1 & 0 & \\cdots & 0 \\\\ 0 & \\modc_2 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & \\cdots & 0 & \\modc_n \\end{bmatrix}, \\\\  \n\\modkmat = \\begin{bmatrix}\\modk_1 & 0 & \\cdots & 0 \\\\ 0 & \\modk_2 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & \\cdots & 0 & \\modk_n \\end{bmatrix}\n\\end{array}\n\\] arr all diagonal so that Equation 7.39 comprises \\(n\\)-many uncoupled equations of the form \\[\n\\modm_i \\ddmodcor_i (t) + \\modc_i \\dmodcor_i (t) + \\modk_i \\modcor_i (t) = 0 \\, ; \\quad \\{\\modcor_i (0) = \\modcoric{i}, \\dmodcor_i (0) = \\dmodcoric{i} \\}\n\\qquad(7.40)\\] This is obviously the equation of motion for a viscously damped linear oscillator, same as the one we discussed in much detail starting with its introduction in Section 2.4. As we did in the analysis of SDOF systems, it is beneficial to rewrite this equation dividing through by the modal mass so that \\[\n\\ddmodcor_i (t) + 2 \\damp_i \\freq_i \\dmodcor_i (t) + \\freq_i^2 \\modcor_i (t) = 0 \\, ; \\quad \\{\\modcor_i (0) = \\modcoric{i}, \\dmodcor_i (0) = \\dmodcoric{i} \\}\n\\qquad(7.41)\\] where \\[\n\\damp_i = \\ratio{1}{2\\freq_i} \\ratio{\\modc_i}{\\modm_i}\n\\] is called the modal damping ratio. Preference of \\(\\damp_i\\) over \\(\\modc_i\\) (perhaps we could call this the modal damping coefficient) is based on the same reasons that we preferred \\(\\damp\\) over \\(c\\) in SDOF systems: \\(\\damp_i\\) is a parameter that may be estimated from vibration data and its physical interpretation is more direct.\nThe solution of Equation 7.41 was derived previously for SDOF systems and it may be expressed (based on Equation 2.23, Equation 2.24, Equation 2.25 and Equation 2.26) as \\[\n\\modcor_i (t)  = \\expon{-\\damp_i \\freq_i t }\\left[\\modcoric{i} \\cosp{\\dfreq_i t} + \\frac{\\dmodcoric{i}+ \\damp_i \\freq_i \\modcoric{i}}{\\dfreq_i} \\sinp{\\dfreq_{i} t} \\right]\n= \\expon{-\\damp_i \\freq_i t } \\modcoramp_{i} \\cosp{\\dfreq_i t - \\phs_i}\n\\qquad(7.42)\\] where \\[\\begin{align*}\n\\modcoramp_i & = \\frac{\\sqrt{(\\modcoric{i})^2 + 2 \\damp \\modcoric{i} \\left(\\ratio{\\dmodcoric{i}}{\\freq}\\right)  + \\left(\\ratio{\\dmodcoric{i}}{\\freq}\\right)^2}}{\\sqrt{1-\\damp^2}} \\\\\n\\phs_i  & = \\arctan \\frac{\\sin \\phs_i}{\\cos \\phs_i}= \\arctan\\ratio{(\\dmodcoric{i}+\\damp_i\\freq_i\\modcoric{i}) / (\\dfreq_i \\modcoramp_i)}{\\modcoric{i} / \\modcoramp_i}\n\\end{align*}\\] and the damped modal frequency of the ith mode, \\(\\dfreq_i\\), given by \\[\n\\dfreq_i = \\freq_i \\sqrt{1-\\damp_i^2}\n\\] Once the solutions for modal coordinates are obtained, the response in physical coordinates is given by modal superposition as for the undamped case: \\[\n\\gcvec (t) = \\modmat \\modcorvec (t) = \\sum_{i=1}^{n} \\eigveci{i} \\modcor_i (t)\n\\]\n\n\n7.6.3 Constructing Damping Matrices in Classically Damped Systems\nWhat should the structure of the damping matrix \\(\\cmat\\) be so that the system will be classically damped? Or better yet: do we need a damping matrix at all? If we are to perform linear analysis and the system has a relatively uniform distribution of energy dissipation so that the classical damping model is acceptable, we need only estimate modal damping ratios. In classical modal analysis we may write the equations of motion for the system assuming it is undamped, transform to modal coordinates, and then simply add the damping term to the modal equations. As a relatively few modes generally will suffice to give a decent estimate of the response, we will not even need to estimate damping for all the modes and definitely will not need a full order damping matrix. There are instances however when such a damping matrix in physical coordinates is necessary. Clearly any attempt to numerically integrate the equations of motion in physical coordinates needs such a matrix. Such an approach will be especially important if one were to analyze nonlinear systems, say in structures which undergo yielding and hysteretic behavior under large demands.\nThere are a few ways to go about this problem, some of which are discussed next.\n\n\n7.6.3.1 Rayleigh Damping\nAs the mode shapes obtained from the undamped eigenvalue problem diagonalize both the mass and the stiffness matrices, they will also diagonalize any third matrix that may be written as a superposition of the two. There are two extreme points in this approach: the damping is said to be mass proportional if the damping matrix is given by  \\[\n\\cmat=\\beta_M \\mmat\n\\qquad(7.43)\\] Here, \\(\\beta_M\\) is a proportionality constant (scalar) with units \\(1/\\punit{[unit \\; of \\; time]}\\). With mass proportional damping we have \\[\n\\modmat^T \\cmat \\modmat = \\modcmat = \\beta_M \\modmat^T \\mmat \\modmat = \\beta_M \\modmmat\n\\] so that for the ith mode \\[\n{\\modc_i} = 2 \\damp_i \\freq_i {\\modm_i} = \\beta_M {\\modm_i} \\quad \\rightarrow \\quad \\damp_i = \\ratio{\\beta_M}{2 \\freq_i}\n\\] This construct therefore imposes a decreasing damping ratio with increasing mode number so that higher modes are damped much less than lower modes. The other extreme is when the damping is assumed to be stiffness proportional so that \\[\n\\cmat=\\beta_K \\kmat\n\\qquad(7.44)\\]  where \\(\\beta_K\\) is a proportionality constant with units of \\([\\punit{unit \\; of \\; time}]\\). In this case we have \\[\n\\modmat^T \\cmat \\modmat = \\modcmat = \\beta_K \\modmat^T \\kmat \\modmat = \\beta_K \\modkmat\n\\] so that for the ith mode \\[\n{\\modc_i} = 2 \\damp_i \\freq_i {\\modm_i} = \\beta_K {\\modk_i} = \\beta_K \\freq_i^2 {\\modm_i}  \\quad \\rightarrow \\quad \\damp_i = \\ratio{\\beta_K \\freq_i}{2}\n\\] and therefore we end up with much higher modal damping percentages assigned to higher modes compared to those for lower modes. A superposition of the two cases imposes a more uniform range for damping ratios, at least for some portion of the modes, given by \\[\n\\cmat = \\beta_M \\mmat + \\beta_K \\kmat \\quad \\rightarrow \\quad  \\damp_i = \\beta_M \\ratio{1}{2 \\freq_i} + \\beta_K \\ratio{\\freq_i}{2}\n\\]\n\n\n\nFigure 7.13: Qualitative variation of modal damping ratios with frequency in mass proportional, stiffness proportional and (combined) Rayleigh damping models.\n\n\nThis model is often called Rayleigh Damping after Lord Rayleigh who promoted it.3 The implication of this equation, which is a combination of inversely proportional (\\(1/\\freq_i\\)) and proportional (\\(\\freq_i\\)) terms is that the lower and higher frequency modes will possibly have larger damping ratios compared to intermediate modes, as sketched in Figure 7.13. The two free parameters of the Rayleigh Damping model, \\(\\beta_M\\) and \\(\\beta_K\\), could be determined by prescribing damping ratios for two modes: given \\(\\damp_i\\) and \\(\\damp_j\\), we have \\[\n\\colmat{\\damp_i \\\\ \\damp_j} = \\begin{bmatrix} 1/(2 \\freq_i) & \\freq_i / 2 \\\\\n1 / (2 \\freq_j) & \\freq_j / 2\\end{bmatrix} \\colmat{\\beta_M \\\\ \\beta_K}\n\\] so that \\[\n\\colmat{\\beta_M \\\\ \\beta_K} = \\ratio{2\\freq_i\\freq_j}{\\freq_j^2 - \\freq_i^2}\\begin{bmatrix} \\freq_j & -\\freq_i \\\\\n- \\ratio{1}{\\freq_j} & \\ratio{1}{\\freq_i}\\end{bmatrix} \\colmat{\\damp_i \\\\ \\damp_j}\n\\qquad(7.45)\\] A common practice is to assume that the damping ratios of two modes, say modes \\(i\\) and \\(j\\), are equal so that \\(\\damp_i = \\damp_j = \\damp\\), in which case\n\\[\n\\beta_M = \\frac{2 \\freq_i \\freq_j}{\\freq_j + \\freq_i}\\damp,  \\quad  \\beta_K =  \\frac{2}{\\freq_j + \\freq_i}\\damp\n\\qquad(7.46)\\] In practice, the two modes at which the damping ratio is set equal to \\(\\damp\\) are the fundamental (lowest frequency) mode and one of the modes in the high frequency range that still contributes significantly to the response. This choice effectively damps out contributions from higher frequencies, whereas intermediate frequencies will have slightly lower damping ratios than the fundamental frequency.\nThe obvious issue with Rayleigh Damping is the possibly unwanted variation of damping percentages in the modes other than those for which the damping ratios are prescribed. If one wants to prescribe damping ratios to more than two modes, other approaches should be considered.\n\n\n\n\nA true classic in the field of classical mechanics, “The Theory of Sound” by Lord Rayleigh (formerly/also known as John William Strutt) was originally published in two volumes in 1877 and 1878, respectively.↩︎\n\n\n\n7.6.3.2 Caughey Damping\nThe Rayleigh Damping approach could be extended to prescribe the damping ratios of more than two modes. In what is generally called Caughey Damping or Extended Rayleigh Damping, the damping matrix is written as a linear combination of some powers of mass and stiffness matrices. Consider the undamped eigenvalue problem given by \\[\n\\kmat \\eigveci{i} = \\freq_i^2 \\mmat \\eigveci{i}\n\\qquad(7.47)\\] with orthogonality conditions \\[\n\\teigveci{j} \\kmat \\eigveci{i} = \\modk_i \\delta_{ij}, \\quad \\teigveci{j} \\mmat \\eigveci{i} = \\modm_i \\delta_{ij}\n\\qquad(7.48)\\] If we premultiply Equation 7.47 by \\(\\teigveci{j} \\kmat \\mmat^{-1}\\), we get \\[\n\\teigveci{j} \\kmat \\mmat^{-1} \\kmat \\eigveci{i} = \\freq_i^2 \\teigveci{j} \\kmat \\mmat^{-1} \\mmat \\eigveci{i} = \\freq_i^2 \\teigveci{j} \\kmat \\eigveci{i} = \\freq_i^2 \\modk_i \\delta_{ij}\n\\] which means that the eigenvalues of the undamped eigenvalue problem diagonalize also the matrix \\(\\kmat \\mmat^{-1} \\kmat\\). But if that is the case, then premultiplying Equation 7.48 with \\(\\teigveci{j} \\kmat \\mmat^{-1} \\kmat \\mmat^{-1}\\) leads to \\[\\begin{align*}\n\\teigveci{j} \\kmat \\mmat^{-1} \\kmat \\mmat^{-1} \\kmat \\eigveci{i} & = \\freq_i^2 \\teigveci{j} \\kmat \\mmat^{-1} \\kmat \\mmat^{-1} \\mmat \\eigveci{i} = \\teigveci{j} \\kmat \\mmat^{-1} \\kmat \\eigveci{i} \\\\\n& = \\freq_i^4 \\modk_i \\Delta_{ij}\n\\end{align*}\\] and therefore, by induction, it can be shown that \\[\n\\teigveci{j} \\kmat \\left(\\mmat^{-1} \\kmat \\right)^s \\eigveci{i} = \\teigveci{j} \\left(\\kmat \\mmat^{-1}\\right)^s \\kmat  \\eigveci{i} = \\freq_i^{2s} \\modk_i \\delta_{ij} \\quad \\text{for } s \\geq 0\n\\qquad(7.49)\\] Similarly, if we start by premultiplying Equation 7.48 by \\(\\teigveci{j} \\mmat \\kmat^{-1}\\), we have \\[\n\\teigveci{j} \\mmat \\kmat^{-1} \\kmat \\eigveci{i} = \\modm_{i} \\delta_{ij} = \\freq_i^2 \\teigveci{j} \\mmat \\kmat^{-1} \\mmat \\eigveci{i}\n\\] which means that the eigenvalues of the undamped eigenvalue problem diagonalize also the matrix \\(\\mmat \\kmat^{-1} \\mmat\\). Consequently, premultiplying Equation 7.48 with \\(\\teigveci{j} \\mmat \\kmat^{-1} \\mmat \\kmat^{-1}\\) leads to \\[\n\\teigveci{j} \\mmat \\kmat^{-1} \\mmat \\kmat^{-1} \\kmat \\eigveci{i}  = \\teigveci{j} \\mmat \\kmat^{-1} \\mmat \\eigveci{i} = \\ratio{1}{\\freq_i^2}\\modm_{i} \\delta_{ij} \\\\\n  = \\freq_i^2 \\teigveci{j} \\mmat \\kmat^{-1} \\mmat \\kmat^{-1} \\mmat \\eigveci{i}\n\\] so that \\[\n\\teigveci{j} \\mmat \\kmat^{-1} \\mmat \\kmat^{-1} \\mmat \\eigveci{i} = \\ratio{1}{\\freq_i^4}\\modm_{i} \\delta_{ij}\n\\] and by induction it may be shown that \\[\n\\teigveci{j} \\left(\\mmat \\kmat^{-1}\\right)^s \\mmat \\eigveci{i} = \\teigveci{j} \\mmat \\left(\\kmat^{-1} \\mmat\\right)^s \\eigveci{i} = \\ratio{1}{\\freq_i^{2s}}\\modm_{i} \\delta_{ij} \\quad \\text{for } s \\geq 0\n\\qquad(7.50)\\] Equation 7.49 and Equation 7.50 may be combined in a single expression by allowing the powers to take on both positive and negative values as \\[\n\\teigveci{j} \\mmat \\left(\\mmat^{-1} \\kmat\\right)^s \\eigveci{i} = {\\freq_i^{2s}}\\modm_{i} \\delta_{ij} \\quad \\text{for } - \\infty &lt; s  &lt;\\infty\n\\qquad(7.51)\\] Note that the classical orthogonality relationships may recovered from Equation 7.51 using \\(s = 0\\) and \\(s=1\\).\nThe point of this exercise is: any damping matrix that has the form \\[\n\\mmat \\left(\\mmat^{-1} \\kmat\\right)^s\n\\] will be diagonalized by the undamped mode shapes! A superposition of such matrices corresponding to various powers, which may be expressed as \\[\n\\cmat = \\mmat \\sum_{s} \\beta_s \\left(\\mmat^{-1} \\kmat\\right)^s\n\\] will therefore yield a damping matrix \\(\\cmat\\) that will lead to a classically damped system. The coefficients \\(\\beta_s\\) are the free variables we may adjust to prescribe damping ratios for different modes. Consider, for example, the \\(i\\)-th mode of the system for which (knowing that \\(\\cmat\\) is diagonalized by the mode shapes and via Equation 7.51) we have \\[\n\\teigveci{j} \\cmat \\eigveci{i} = 2 \\damp_i \\freq_i \\modm_i \\delta_{ij} = \\sum_{s} \\beta_s {\\freq_i^{2s}}\\modm_{i} \\delta_{ij}\n\\] so that \\[\n\\damp_i = \\ratio{1}{2 \\freq_i} \\sum_{s} \\beta_s {\\freq_i^{2s}}\n\\qquad(7.52)\\] When trying to prescribe the damping ratios for \\(n'\\)-many modes (with \\(n' \\leq n\\)) we should use \\(n'\\)-many terms in the summation and therefore \\(n'\\)-many coefficients \\(\\beta_i\\). Therefore we will have \\(n'\\)-many equations given by Equation 7.52, containing \\(n'\\)-many unknowns \\(\\beta_s\\) which we solve for using these equations. The question is: which powers of \\(s\\) should be included? This is important since a particularly egregious error would be to end up with unphysical negative damping ratios, which turns out to be a common issue if an odd number of damping constants are prescribed. In practice it is generally recommended to include an even number of terms, with powers as close to zero as possible. It is straightforward to show that summing over just the two powers \\(s=0\\) and \\(s=1\\) will yield the Rayleigh Damping model.\n\n\nEXAMPLE 7 .4\nAs an exercise, let us consider the 5-DOF system of masses on a taut string, shown in Figure 7.14. Recall that we had worked on this system before and shown that the mass and stiffness matrices were given by \\[\n\\mmat =  \n\\begin{bmatrix}\nm & 0 & 0 & 0 & 0\\\\\n0 & m & 0 & 0 & 0\\\\\n0 & 0 & m & 0 & 0\\\\\n0 & 0 & 0 & m & 0\\\\\n0 & 0 & 0 & 0 & m\n\\end{bmatrix}, \\quad\n\\kmat = \\ratio{N}{\\ell}\n\\begin{bmatrix}\n10 & -5 & 0 & 0 & 0\\\\\n-5 & 10 & -5 & 0 & 0\\\\\n0 & -5 & 10 & -5 & 0\\\\\n0 & 0 & -5 & 10 & -5\\\\\n0 & 0 & 0 & -5 & 10\n\\end{bmatrix}\n\\] To turn this into a completely numerical problem, assume \\(m=10 \\unit{kg}\\), \\(N = 1000 \\unit{N}\\) and \\(\\ell = 1 \\unit{m}\\) so that \\[\n\\mmat =  \n\\begin{bmatrix}\n10 & 0 & 0 & 0 & 0\\\\\n0 & 10 & 0 & 0 & 0\\\\\n0 & 0 & 10 & 0 & 0\\\\\n0 & 0 & 0 & 10 & 0\\\\\n0 & 0 & 0 & 0 & 10\n\\end{bmatrix}, \\quad\n\\kmat =\n\\begin{bmatrix}\n10000 & -5000 & 0 & 0 & 0\\\\\n-5000 & 10000 & -5000 & 0 & 0\\\\\n0 & -5000 & 10000 & -5000 & 0\\\\\n0 & 0 & -5000 & 10000 & -5000\\\\\n0 & 0 & 0 & -5000 & 10000\n\\end{bmatrix}\n\\]\n\n\n\nFigure 7.14: A taut string bearing five equal masses.\n\n\nEigenvalue analysis yields the following values for the five frequencies of the system: \\[\n\\begin{array}{c}\n\\freq_1 = 11.575 \\unit{rad/s}, \\; \\freq_2 = 22.361 \\unit{rad/s}, \\; \\freq_3 = 31.623 \\unit{rad/s}, \\\\\n\\freq_4 = 38.730 \\unit{rad/s}, \\; \\freq_5 = 43.198 \\unit{rad/s}\n\\end{array}\n\\] First say we want to prescribe a damping ratio of \\(5\\%\\) to the first and the fifth modes (i.e. we want \\(\\damp_1 = \\damp_5 = \\damp = 0.05\\)). Since we want to prescribe only two values we may use the Rayleigh Damping model. According to Equation 7.46, the coefficients that should multiply the mass and stiffness matrices are given by \\[\n\\beta_M = \\frac{2 \\freq_1 \\freq_5}{\\freq_1 + \\freq_5}\\damp = 0.91287,  \\quad  \\beta_K =  \\frac{2}{\\freq_1 + \\freq_5}\\damp = 0.00183\n\\] so that \\[\n\\cmat = \\beta_M \\mmat + \\beta_K \\kmat = \\begin{bmatrix}\n27.386 & -9.1287 & 0 & 0 & 0\\\\\n-9.1287 & 27.386 & -9.1287 & 0 & 0\\\\\n0 & -9.1287 & 27.386 & -9.1287 & 0\\\\\n0 & 0 & -9.1287 & 27.386 & -9.1287\\\\\n0 & 0 & 0 & -9.1287 & 27.386\n\\end{bmatrix}\n\\] Now this damping matrix will lead to the following damping ratios: \\[\n\\damp_1 = 5.0 \\%, \\; \\damp_2 = 4.1 \\%, \\; \\damp_3 = 4.3 \\%, \\; \\damp_4 = 4.7 \\%, \\; \\damp_5 = 5.0 \\%\n\\] While we have prescribed only the first and the fifth mode damping ratios, the other three have come out relatively close to those two. If we had instead prescribed the damping ratios for the first and the second modes as \\(\\damp_1 = \\damp_2 = 5\\%\\), the same procedure would yield \\[\n\\beta_M = \\frac{2 \\freq_1 \\freq_2}{\\freq_1 + \\freq_2}\\damp = 0.76268,  \\quad  \\beta_K =  \\frac{2}{\\freq_1 + \\freq_2}\\damp = 0.00295\n\\] and the damping ratios would be obtained as \\[\n\\damp_1 = 5.0 \\%, \\; \\damp_2 = 5.0 \\%, \\; \\damp_3 = 5.9 \\%, \\; \\damp_4 = 6.7 \\%, \\; \\damp_5 = 7.2 \\%\n\\] If there were more modes, the higher ones would get increasing damping values so that one has to be careful. High value of damping in a mode will effectively render the contribution of that mode to the response insignificant: this may be something that is preferred by the analyst but it may also be the source of significant error.\nTo prescribe the damping ratios for more than two modes we will use the Caughey Damping model. Assume we would like to prescribe the damping ratios for modes 1, 2 and 3 \\(5 \\%\\). The first issue that must be addressed is which powers to include in the summation of Equation 7.52. Since we want to prescribe three damping values, the summation should include four terms (for three coefficients \\(\\beta_s\\)). Assume, for no particular reason, that we would like to use the powers \\(s=-4\\), \\(s=1\\) and \\(s=6\\). In this case, the coefficients \\(\\beta_s\\) will have to be determined from the following three equations: \\[\\begin{align*}\n\\damp_1 & = 0.05  = \\ratio{1}{2 \\freq_1} \\left(\\beta_{-4} {\\freq_1^{-8}} + \\beta_{1} {\\freq_1^{2}} + \\beta_{6} {\\freq_1^{12}} \\right) \\\\\n\\damp_2 & = 0.05  = \\ratio{1}{2 \\freq_2} \\left(\\beta_{-4} {\\freq_2^{-8}} + \\beta_{1} {\\freq_2^{2}} + \\beta_{6} {\\freq_2^{12}} \\right) \\\\\n\\damp_3 & = 0.05  = \\ratio{1}{2 \\freq_3} \\left(\\beta_{-4} {\\freq_3^{-8}} + \\beta_{1} {\\freq_3^{2}} + \\beta_{6} {\\freq_3^{12}} \\right)\n\\end{align*}\\] Solving for \\(\\beta_s\\) we get \\[\n\\beta_{-4} = 1.783\\times 10^{8}, \\quad \\beta_{1} = 4.509 \\times 10^{-3}, \\quad \\beta_{6} = 0\n\\] The damping matrix will then be given by \\[\n\\cmat = \\mmat \\left( \\beta_{-4} \\left(\\mmat^{-1} \\kmat\\right)^{-4} + \\beta_{1} \\left(\\mmat^{-1} \\kmat\\right)^{1} + \\beta_{6} \\left(\\mmat^{-1} \\kmat\\right)^{6}\\right)\n\\] which will lead to the following damping ratios for all modes: \\[\n\\damp_1 = 5.0 \\%, \\; \\damp_2 = 5.0 \\%, \\; \\damp_3 = 5.0 \\%, \\; \\damp_4 = -11.1 \\%, \\; \\damp_5 = -56.1 \\%\n\\] Obviously the damping values thus obtained are unacceptable for the last two modes. If instead we use the powers \\(s=-1\\), \\(s=0\\) and \\(s=1\\), we would solve for the unknown \\(\\beta_s\\) values using the equations \\[\\begin{align*}\n\\damp_1 = 0.05  = \\ratio{1}{2 \\freq_1} \\left(\\beta_{-1} {\\freq_1^{-2}} + \\beta_{0} {\\freq_1^{0}} + \\beta_{1} {\\freq_1^{2}} \\right) \\\\\n\\damp_2 = 0.05  = \\ratio{1}{2 \\freq_2} \\left(\\beta_{-1} {\\freq_2^{-2}} + \\beta_{0} {\\freq_2^{0}} + \\beta_{1} {\\freq_2^{2}} \\right) \\\\\n\\damp_3 = 0.05  = \\ratio{1}{2 \\freq_3} \\left(\\beta_{-1} {\\freq_3^{-2}} + \\beta_{0} {\\freq_3^{0}} + \\beta_{1} {\\freq_3^{2}} \\right)\n\\end{align*}\\] from which we find \\[\n\\beta_{-1} = -84.65, \\quad \\beta_{0} = 1.5638, \\quad \\beta_{1} = 0.0017\n\\] and the damping matrix given by \\[\n\\cmat = \\mmat \\left( \\beta_{-1} \\left(\\mmat^{-1} \\kmat\\right)^{-1} + \\beta_{0} \\left(\\mmat^{-1} \\kmat\\right)^{0} + \\beta_{1} \\left(\\mmat^{-1} \\kmat\\right)^{1}\\right)\n\\] leads to \\[\n\\damp_1 = 5.0 \\%, \\; \\damp_2 = 5.0 \\%, \\; \\damp_3 = 5.0 \\%, \\; \\damp_4 = 5.2 \\%, \\; \\damp_5 = 5.4 \\%\n\\] which are quite acceptable. As a final case, let us try to set the damping ratios for modes \\(2\\), \\(3\\) and \\(5\\) at \\(5 \\%\\) using powers \\(s=-1\\), \\(s=0\\) and \\(s=1\\). Now the equations become \\[\\begin{align*}\n\\damp_2 & = 0.05  = \\ratio{1}{2 \\freq_2} \\left(\\beta_{-1} {\\freq_2^{-2}} + \\beta_{0} {\\freq_2^{0}} + \\beta_{1} {\\freq_2^{2}} \\right) \\\\\n\\damp_3 & = 0.05  = \\ratio{1}{2 \\freq_3} \\left(\\beta_{-1} {\\freq_3^{-2}} + \\beta_{0} {\\freq_3^{0}} + \\beta_{1} {\\freq_3^{2}} \\right) \\\\\n\\damp_5 & = 0.05  = \\ratio{1}{2 \\freq_5} \\left(\\beta_{-1} {\\freq_5^{-2}} + \\beta_{0} {\\freq_5^{0}} + \\beta_{1} {\\freq_5^{2}} \\right)\n\\end{align*}\\] from which we obtain \\[\n\\beta_{-1} = -352.36, \\quad \\beta_{0} = 2.3669, \\quad \\beta_{1} = 0.00115\n\\] and the damping matrix obtained via these values leads to \\[\n\\damp_1 = -0.5 \\%, \\; \\damp_2 = 5.0 \\%, \\; \\damp_3 = 5.0 \\%, \\; \\damp_4 = 4.97 \\%, \\; \\damp_5 = 5.0 \\%\n\\] where the first mode is seen to have an unacceptable damping value."
  },
  {
    "objectID": "multidofforcedvib.html#modal-analysis-for-forced-vibration-response",
    "href": "multidofforcedvib.html#modal-analysis-for-forced-vibration-response",
    "title": "8  Forced Vibrations of Linear Multi Degree of Freedom Systems",
    "section": "8.1 Modal Analysis for Forced Vibration Response",
    "text": "8.1 Modal Analysis for Forced Vibration Response\n\n8.1.1 General Flow\nNow that we have established the basic principles of modal analysis while discussing free vibrations, we will outline the procedure for its application to forced vibrations. Consider an MDOF system, with \\(n\\) degrees of freedom, subject to time dependent excitations acting along various generalized coordinates and collected in a column matrix \\(\\ldtvec\\), so that the equations of motion for the system are given by: \\[\n\\mmat \\ddgcvec (t) + \\cmat \\dgcvec (t) + \\kmat \\gcvec (t) =\\ldvec (t)\n\\qquad(8.1)\\] Assume that the eigenvalue problem is solved so that mode shapes \\(\\eigveci{i}\\) and frequencies \\(\\freq_i\\) are known. For a classically damped system, transformation from physical coordinates \\(\\gcvec\\) to modal coordinates \\(\\modcorvec\\) via \\[\n\\gcvec (t) = \\modmat \\modcorvec (t) = \\sum_{i} \\eigveci{i} \\modcor_i (t)\n\\qquad(8.2)\\] leads to \\[\n\\modmat^T \\mmat \\modmat \\ddmodcorvec + \\modmat^T \\cmat \\modmat  \\dmodcorvec + \\modmat^T \\kmat \\modmat \\modcorvec =  \\modmat^T \\ldvec (t)\n\\qquad(8.3)\\] which may be written as \\[\n\\modmmat \\ddmodcorvec (t) + \\modcmat \\dmodcorvec (t) + \\modkmat \\modcorvec (t) = \\modldvec (t)\n\\qquad(8.4)\\] where we have defined the modal load vector \\(\\modldvec\\) as \\(\\modldvec (t) \\equiv \\modmat^T \\ldvec (t)\\). Equation 8.4 is a collection of \\(n\\)-many uncoupled equations, each of the form \\[\n\\modm_i \\ddmodcor_i (t) + \\modc_i \\dmodcor_i (t) + \\modk_i \\modcor_i (t) = \\modextforce_i (t) \\quad \\text{for } i=1,2,\\ldots n\n\\qquad(8.5)\\] where \\[\n\\modm_i = \\teigveci{i} \\mmat \\eigveci{i}, \\;\n\\modc_i = \\teigveci{i} \\cmat \\eigveci{i}, \\;\n\\modk_i = \\teigveci{i} \\kmat \\eigveci{i}, \\;\n\\modextforce_i (t) = \\teigveci{i} \\ldvec (t)\n\\] Dividing by modal mass \\(\\modm_i\\) leads to \\[\n\\ddmodcor_i (t) + 2\\zeta_i \\freq_i \\dmodcor_i (t) + \\freq_i^2 \\modcor_i (t) =\\frac{\\modextforce_i (t)}{\\modm_i} \\quad \\text{for } i=1,2,\\ldots n\n\\qquad(8.6)\\]\nEquation 8.6 is the equation for a viscously damped SDOF system. The solution of such equations have been discussed in detail in Chapter 3 and Chapter 4. Once these equations are solved, we can combine the contributions from different modes to compute the response in physical coordinates via \\[\n\\gcvec (t) = \\sum_{i=1}^{n} {\\modgcvec{i} (t)} = \\sum_{i=1}^{n} {\\eigveci{i} \\modcor_i (t) }  \n\\qquad(8.7)\\] where \\[\n\\modgcvec{i} (t) = \\eigveci{i} \\modcor_i (t)\n\\qquad(8.8)\\] is the contribution of the \\(i\\)-th mode to the generalized displacements. Such a dissolution is employed in analyzing the particular contributions of modes to many response quantities. We will use the terminology modal [response quantity] to refer to such contributions; for example, we will call the vector \\(\\modgcvec{i}\\) in Equation 8.8 the modal displacements. We shall eventually refer other quantities such as modal base shear, modal interstory drift, modal equivalent static loads, etc.\nIn summary, the procedure to solve MDOF forced vibration problems with modal analysis can be summarized as follows:\n\n\n\n\n\n\nModal Analysis\n\n\n\n\nConstruct \\(\\mmat, \\kmat\\) (for example via the methods of Chapter 6).\nObtain \\(\\freq_i\\), \\(\\eigveci{i}\\).\nTransform the equations to modal coordinates.\nSolve for \\(\\modcor_i\\) from Equation 8.6.\nCalculate the modal responses (e.g.modal displacements via Equation 8.8).\nCalculate physical response quantities (e.g. generalized displacements via Equation 8.7).\n\n\n\nIn principle, for an \\(n\\)-DOF system, it may not be necessary to include all \\(n\\) modal responses while calculating a response quantity since some (or even many) of the modal contributions may be negligible and therefore not worthwhile to spend resources on, especially in solving the eigenvalue problem and the response calculations in modal coordinates. The answer to the question of how many and which modes to include, however, is not trivial since the acceptable subset to use will depend on both the spatial and temporal distributions of the inputs. We will revisit this issue in more detail while discussing earthquake response analysis.\n\n\n8.1.2 Derived Response Quantities\nWhen modal analysis is used to analyze the response of a system, any response quantity we may seek to find will depend on the modal coordinate responses. We have seen an example of this in Equation 8.7 where the displacement responses in physical coordinates were expressed as a superposition of the modal displacements which in turn were functions of modal coordinates \\(\\modcor_i\\). In this section we will introduce a few derived quantities which are deemed important for design and control purposes, and try to evaluate the modal conributions to each.\nConsider, as an example, a multi-story shear building. We choose to analyze this model because certain response quantities are relatively easily visualized on this model. The structure is shown in Figure 8.1 (a), and we assume that it is subjected to a unidirectional ground motion given by \\(\\gdis (t)\\). The response quantities we are about to introduce are frequently employed in earthquake related analyses but the formulations could be generalized to any external excitation with proper modifications.\n\n\n\nFigure 8.1: Shear building: (a) unidirectional ground motion model, (b) d’Alembert forces, (c) equivalent static loads. Note that vertical forces (weights and ground reaction) are not shown here since only lateral effects are analyzed but they do exist and they may have to be accounted for in certain analyses.\n\n\nOne of the design parameters often referred to in structural codes is the base shear, denoted here by \\(\\baseshear\\). This is the total shear force that must be transmitted to the fixed base by the columns attached to the foundation. It may be calculated via the cumulative d’Alembert forces or the equivalent static loads as follows: At any time during its motion, the free body diagram of the whole shear building, including the d’Alembert forces, will be like the one shown in Figure 8.1 (b) (the free body diagram also includes the overturning moment \\(\\overturn\\) which will be subsequently introduced). Equilibrium demands that the net horizontal force shall be zero so that \\[\n\\baseshear (t) = - \\sum_{i=1}^{n} m_i \\aacc_i (t) = - \\onecol^T \\mmat \\aaccvec (t)\n\\qquad(8.9)\\] Alternatively, we define equivalent static loads \\[\n\\estatvec (t) = \\colmat{\\estati{1} (t) \\\\ \\estati{2} (t)\\\\ \\vdots \\\\ \\estati{n}(t)} = \\kmat \\gcvec (t)\n\\qquad(8.10)\\] as the set of external loads that should be appplied to a fixed base structure to induce the displecement pattern \\(\\gcvec (t)\\) at time \\(t\\). The structure with these forces is shown in Figure 8.1 (c). The reasoning is that since \\(\\gcvec (t)\\) is imposed, the internal force distribution related to deformation (stiffness) elements must be compatible with that which would occur under external loads \\(\\estatvec = \\kmat \\gcvec\\); this in turn implies that a static analysis under applied loads \\(\\estatvec\\) could be used to solve for internal forces. Under the action of \\(\\estatvec\\) shown in Figure 8.1 (c), the base shear will be simply equal to the sum of these forces so that it is given by \\[\n\\baseshear (t) = \\onecol^T \\kmat \\gcvec (t) = \\onecol^T \\estatvec (t)\n\\qquad(8.11)\\] which may be shown to be equal to \\(\\baseshear = k_1 \\gc_1\\). It is important to note that there are no such external forces that actually act on the system; the equivalent static force \\(\\estatvec\\) is a conceptual device that simply helps us in calculations and allows us to think about a problem as we are accustomed to do in our experience with static analyses. The expression in Equation 8.10 is the same as that with which we have previously defined \\(\\stff\\) but these two sets of forces have a subtle conceptual difference and we feel that difference should be reflected in the symbolism. In any case we should note that if the system is undamped, then equations Equation 8.9 and Equation 8.11 actually yield the same results since by the equation of motion for a shear building subject to unidirectional ground motion we have \\[\n\\mmat \\aaccvec (t) + \\kmat \\gcvec (t) = \\zerocol \\quad \\rightarrow \\quad \\kmat \\gcvec (t) = - \\mmat \\aaccvec (t)\n\\] In the presence of damping, a portion of d’Alembert forces would be balanced with damping forces so that the values obtained from the two expressions would differ; for small values of damping, however, the difference may not have a significant impact on design. Due to its direct link with methods of static analysis, the equivalent static force formulation is often preferred.\nHow do we calculate the base shear with modal analysis? If we replace the generalized displacement vector in Equation 8.10 with its modal expansion given in Equation 8.2 we get \\[\n\\begin{array}{rcl}\n\\estatvec (t)  & \\!\\!\\! = & \\!\\!\\! \\kmat \\gcvec (t) = \\kmat \\left(\\sum_i \\eigveci{i} \\modcor_i (t) \\right) \\\\\n& \\!\\!\\! = & \\!\\!\\! \\kmat \\eigveci{1} \\modcor_1 (t) + \\kmat \\eigveci{2} \\modcor_2 (t) + \\cdots + \\kmat \\eigveci{n} \\modcor_n (t) \\\\\n& \\!\\!\\! = & \\!\\!\\! \\modestatvec{1} (t) + \\modestatvec{2} (t) + \\cdots + \\modestatvec{n} (t)\n\\end{array}\n\\qquad(8.12)\\] where \\[\n\\modestatvec{i} (t) = \\kmat \\eigveci{i} \\modcor_i (t)\n\\qquad(8.13)\\] is the modal equivalent static force for the \\(i\\)-th mode, i.e. the contribution of the \\(i\\)-th mode to the equivalent static force at time \\(t\\). Consequently, the base shear may be written in the form \\[\n\\begin{array}{rcl}\n\\baseshear (t) & \\!\\!\\! = & \\!\\!\\!  \\onecol^T \\estatvec (t) = \\onecol^T\\modestatvec{1} (t) + \\onecol^T\\modestatvec{2} (t) + \\cdots + \\onecol^T \\modestatvec{n} (t) \\\\\n& \\!\\!\\! = & \\!\\!\\! \\modbaseshear{1} (t) + \\modbaseshear{2} (t) + \\cdots + \\modbaseshear{n} (t)\n\\end{array}\n\\qquad(8.14)\\] where \\[\n\\modbaseshear{i} (t) = \\onecol^T\\modestatvec{i} (t) = \\onecol^T\\kmat \\eigveci{i} \\modcor_i (t)\n\\qquad(8.15)\\] is the modal base shear for the \\(i\\)-th mode, i.e. the contribution of the \\(i\\)-th mode to the base shear.\nAnother design variable commonly referred to is the overturning moment \\(\\overturn\\), which is the total moment generated during at the base of the structure. We may calculate this quantity as follows: assume that the \\(i\\)-th floor is located at a height of \\(h_i\\) measured from the base. Condsidering the equivalent static loads, the overturning moment may be derived from moment equilibrium as \\[\n\\overturn (t) = h_1 \\estati{1} + h_2 \\estati{2} + \\cdots + h_n \\estati{n} = \\nvec{h}^T \\estatvec (t)\n\\] where \\(\\nvec{h} = \\left\\{h_1 \\;\\;\\; h_2 \\;\\;\\; \\cdots \\;\\;\\; h_n\\right\\}^T\\) is a column matrix that contains the heights, and it is generally referred to as the height vector. Considering modal expansion of the equivalent static loads given in Equation 8.12 we get \\[\n\\begin{array}{rcl}\n\\overturn (t) & \\!\\!\\! = & \\!\\!\\! \\nvec{h}^T \\estatvec (t) = \\nvec{h}^T\\modestatvec{1} (t) + \\nvec{h}^T\\modestatvec{2} (t) + \\cdots + \\nvec{h}^T \\modestatvec{n} (t) \\\\\n& \\!\\!\\! = & \\!\\!\\! \\modoverturn{1} (t) + \\modoverturn{2} (t) + \\cdots + \\modoverturn{n} (t)\n\\end{array}\n\\qquad(8.16)\\] with \\[\n\\modoverturn{i} (t) = \\nvec{h}^T \\modestatvec{i} (t) = \\nvec{h}^T\\kmat \\eigveci{i} \\modcor_i (t)\n\\qquad(8.17)\\] denoting the modal overturning moment for the \\(i\\)-th mode, i.e. the contribution of the \\(i\\)-th mode to the overturning moment at time \\(t\\).\nOne could contrive many other response quantities that may depend on displacements, deformations, and their time derivatives. The simple fact is that if a system has \\(n\\) degrees of freedom, then it should be possible to express any of these quantities as some function of at most \\(n\\)-many generalized coordinates and/or their time derivatives. Whenever modal analyses is possible, it will be convenient to express such response quantities via summation of modal contributions, and it will be possible to isolate and discuss the contribution of a specific mode to a particular response quantity. Such modal expansions of response quantities play important roles in determining how many modes to include in an analysis, or whenever it is not possible to obtain full time histories but estimates of maximum responses are available. We will visit these issues further down the text.\n\n\n8.1.3 Harmonic Excitations\nWith the modal analysis procedure described above, we can examine how systems will respond to time varying external forces \\(\\ldvec (t)\\). As in the case of SDOF systems, the excitation may be impulsive, periodic, harmonic or random in nature. The preferred analysis method for each scenario may differ. Most generally, time-stepping based numerical approaches can be used to compute the response for a broad range of excitations. For simple loading scenarios such as a harmonic excitation distributed to nodes, the modal analysis technique allows us to obtain analytical solutions with relative ease. In addition, response of MDOF systems to harmonic excitations gives us a window through which we can observe how concepts such as resonance translate to MDOF systems.\nA particularly relevant class of problems involves situations where the whole system is excited with a single frequency harmonic excitation but with excitation amplitudes varying at each node. The equation of motion for this system is given by \\[\n\\mmat \\ddgcvec (t) + \\cmat \\dgcvec (t) + \\kmat \\gcvec (t) = \\ldvec \\sinp{\\extfreq t - \\extphs}\n\\qquad(8.18)\\] wherein the load vector is expressed as \\(\\ldvec (t) = \\ldvec \\sinp{\\extfreq t}\\) to separate the time varying harmonic component and time invariant amplitude distribution of the loading. Let’s recall the modal equations for forced excitations, Equation 8.4, where the modal load vector is obtained as \\(\\modldvec (t)= \\modmat^T \\ldvec (t)\\). For each mode then we have, \\[\n\\modm_i \\ddmodcor_i (t)+ \\modc_i \\dmodcor_i (t)+ \\modk_i \\modcor_i (t)= \\modextforce_i (t) \\quad \\text{for } i=1,2,\\ldots,n\n\\] where, for our harmonic force, \\[\n\\modextforce_i (t)= \\eigveci{i}^T \\ldvec \\sinp{\\extfreq t - \\extphs}\n\\qquad(8.19)\\] so that the equation of motion for the \\(i\\)-th mode, after dividing through by its modal mass, may be written as \\[\n\\ddmodcor_i (t)+ 2\\damp_i \\freq_i \\dmodcor_i (t)+\\freq_i^2 \\modcor_i(t)=\\frac{\\eigveci{i}^T \\ldvec}{\\modm_i} \\sinp{\\extfreq t - \\extphs}\n\\qquad(8.20)\\]\nEquation 8.20 is the equation of motion for an SDOF system subjected to harmonic excitation and we have solved this problem before: the solution is given by Equation 3.39, which may be adapted to the modal SDOF equation as \\[\n\\begin{array}{rcl}\n\\modcor_i (t) & \\!\\!\\! = & \\!\\!\\! \\frac{\\eigveci{i}^T \\ldvec}{\\freq_i^2 \\modm_i} \\dynamp_i \\expon{-\\damp_i \\freq_i t} \\biggl[\\sinp{\\extphs + \\phs_i} \\cos \\dfreq_i t\n+ \\biggl(\\frac{\\damp_i \\sinp{\\extphs + \\phs_i}-\\ratfreq_i \\cosp{\\extphs + \\phs_i}}{\\sqrt{1-\\damp_i^2}}\\biggr) \\sin \\dfreq_i t \\biggr] \\\\\n& & \\quad + \\frac{\\eigveci{i}^T \\ldvec}{\\freq_i^2 \\modm_i} \\dynamp_i\\sinp{\\extfreq t - \\extphs - \\phs_i}\n\\end{array}\n\\qquad(8.21)\\] where \\[\n\\begin{array}{c}\n\\dfreq_i = \\freq_i \\sqrt{1-\\damp_i^2} \\; ;  \\quad \\ratfreq_i = \\ratio{\\extfreq}{\\freq_i} \\\\\n\\dynamp_i = \\ratio{1}{\\sqrt{\\left(1 - \\ratfreq_i^2 \\right)^2 + \\left(2 \\damp_i \\ratfreq_i \\right)^2}} \\; ; \\quad \\tan \\phs_i = \\ratio{ ({2 \\damp_i \\ratfreq_i})/{\\dynamp_i}}{({1-\\ratfreq_i^2})/{\\dynamp_i}}\n\\end{array}\n\\] Once the response in modal coordinates are evaluated, the response time histories in physical coordinates are obtained via modal superposition, i.e. Equation 8.7.\nIt is difficult to make sense of what the solution looks like by investigating the equations alone, so let us try to investigate a relatively simple case to gain some physical insight. Consider what the response would be when the system is subjected to a sinusoidal excitation with unit amplitudes, i.e. for the case with \\[\n\\ldvec (t) = \\onecol \\sinp{\\extfreq t}\n\\] As the response will eventually comprise only the steady state solution let us focus solely on that part, so that the response of the \\(i\\)-th mode will be given by \\[\n\\modcor_i (t) = \\frac{\\eigveci{i}^T \\onecol}{\\freq_i^2 \\modm_i} \\dynamp_i\\sinp{\\extfreq t - \\phs_i}\n\\qquad(8.22)\\] and the responses in physical coordinates will be given by \\[\n\\gcvec (t) = \\sum_{i=1}^{n} \\eigveci{i} \\frac{\\eigveci{i}^T \\onecol}{\\freq_i^2 \\modm_i} \\dynamp_i\\sinp{\\extfreq t - \\phs_i}\n\\] There are two distinct contributions to the amplitude of the modal response. One is the term \\[\n\\frac{\\eigveci{i}^T \\onecol}{\\freq_i^2 \\modm_i}\n\\] which is in part associated with the spatial distribution of the excitation and in part by the modal stiffness (i.e. \\(\\modk_i =\\freq_i^2 \\modm_i\\)). As we get to higher modes the number of sign changes in a mode shape increases, and so it is forseeable that \\(\\eigveci{i}^T \\onecol\\) will most likely decrease with increasing mode number. This decrease is also exacerbated with the increase in the value of the frequency as the mode number increases (recall that by convention we order modes in increasing frequency values). The second contribution, however, comes from the dynamic amplification factor \\(\\dynamp_i\\), which is a function of \\(\\ratfreq_i\\) and \\(\\damp_i\\). Whenever the excitation frequency approaches the frequency of a particular mode, the dynamic amplification factor for that mode will increase significantly (theoretically it will asymptotically reach an infinitely large value for an undamped system), and in that case the response will be dominated by that mode. It is the interplay of the spatial and temporal components that eventually determines the dominance of a mode in the response.\n\nEXAMPLE 8 .2\nLet’s consider a special case of an undamped 2-DOF system subject to a harmonic excitation on the first mass only. A question we can immediately ask is: how does the presence of the second mass and spring affect the response of the first mass? In other words, imagine an SDOF system with mass \\(m\\) and stiffness \\(k\\); could we attach a second mass-spring unit to reduce or altogether suppress the motion of this system, assuming we can adjust \\(m_d\\) and \\(k_d\\) as we like? The answer is yes, and in fact this is commonly utilized in engineering practice to dampen out structural vibrations. These systems are broadly called tuned mass damper (TMD) systems, where unlike viscous damping, the vibration amplitudes are reduced by the addition of a well-calibrated mass-spring system.\n\n\n\nFigure 8.2: A tuned-mass damper system consisting of two masses and no dashpots.\n\n\nThe SDOF system with the mass-spring attachement is shown in Figure 8.2. For the combined system the matrix equation of motion is\n\\[\n\\begin{bmatrix}\nm & 0\\\\ 0 & m_d \\end{bmatrix} \\colmat{\\ddgc_1 (t)\\\\ \\ddgc_2 (t)} + \\begin{bmatrix}  k +k_d & -k_d \\\\ -k_d & k_d \\\\ \\end{bmatrix} \\colmat{\\gc_1 (t) \\\\ \\gc_2 (t)}= \\colmat{\\sforce \\\\ 0} \\sinp {\\extfreq t} = \\ldvec \\sinp{\\extfreq t}\n\\] The two equations are coupled through \\(\\kmat\\). This system is simple enough that we can either solve it by assuming a sinusoidal solution in physical coordinates. The equation of motion for each mode will be \\[\n\\ddmodcor_i (t) +\\freq_i^2 \\modcor_i (t)=\\frac{\\eigveci{i}^T \\ldvec}{\\modm_i} \\sinp{\\extfreq t}\n\\] Noting that \\[\n\\eigveci{i}^T \\ldvec = \\left\\{\\eigvecs_{1i} \\;\\;\\; \\eigvecs_{2i}\\right\\}\\colmat{\\sforce \\\\ 0} = \\eigvecs_{1i}\\sforce   \n\\] and that \\[\n\\dynamp = \\ratio{1}{\\sqrt{(1-\\ratfreq_i^2)^2}} \\; ;\\quad \\phs = \\begin{cases} 0 & \\text{if }\\ratfreq &lt; 1 \\\\ \\pi & \\text{if } \\ratfreq &gt; 1\\end{cases}\n\\] the steady state solution for the \\(i\\)-th mode may be derived via Equation 8.21 to obtain\n\\[\n\\modcor_i (t) = \\frac{\\eigvecs_{1i} \\sforce}{\\freq_i^2 \\modm_{i}} \\ratio{1}{1-\\ratfreq_i^2} \\sinp{\\extfreq t}\n\\] Summing up the contributions of the two modes, the response of the primary mass (the original SDOF system) is obtained as \\[\n\\gc_1 (t) =\\left[ \\frac{\\eigvecs_{11} \\eigvecs_{11} }{\\modk_1 (1-\\ratfreq_1^2)} + \\frac{\\eigvecs_{12} \\eigvecs_{12} }{\\modk_2 (1-\\ratfreq_2^2)} \\right] \\sforce \\sinp{\\extfreq t}\n\\] where \\(\\modk_i = \\freq_i^2 \\modm_i\\).\nLet’s consider a simple numerical case to illustrate the response. Intuitively, we can imagine that if the second mass-spring complex is tuned to move out of phase with the first during steady-state response, this will result in reduced motion of the first mass. Defining the natural frequency of the isolated SDOF primary system as \\(\\freq = \\sqrt{k/m}\\), we will investigate how the response amplitude varies for different values of \\(\\extfreq/\\freq\\). Let’s consider a special case where we define a mass ratio of \\(m_d / m=0.1\\), and use the same ratio to scale the stiffnesses as \\(k_d / k = m_d / m = 0.1\\)) such that both the primary and the damper system would, if they were considered as two separate SDOF systems, have the same natural frequency. In this case, \\[\n\\mmat = m \\begin{bmatrix} 1 & 0 \\\\ 0 & 0.1 \\end{bmatrix}, \\quad \\kmat = k \\begin{bmatrix} 1.1 & -0.1 \\\\ -0.1 & 0.1 \\end{bmatrix}\n\\] so that solving the eigenvalue problem, we get the natural frequencies as \\[ \\omega_1^2 = 0.7298 \\omega^2 \\; , \\quad \\omega_2^2 = 1.3702\\omega^2 \\] and a set of mode shapes given by \\[\n\\eigveci{1} = \\colmat{-0.6495 \\\\ -2.4043} \\; , \\quad \\eigveci{2} = \\colmat{-0.7603 \\\\ 2.0541}\n\\]\n\n\n\nFigure 8.3: The steady state displacement response amplitude (normalized by \\(\\sforce/k\\)) of the primary mass in a tuned mass damper system with mass ratio \\(m_d / m =0.1\\), plotted here against excitation frequencies \\(\\extfreq\\) normalized by the primary system’s resonant frequency \\(\\freq = \\sqrt{k/m}\\).\n\n\nWith these mode shapes, the modal mass and stifness values are calculated as \\[\n\\modm_1 = \\modm_2 = m \\; ; \\quad \\modk_1 = 0.7298 k, \\; \\modk_2 = 1.3702 k\n\\] The absolute value of the displacement response amplitude \\(Q_1\\) of the primary mass, normalized with \\(\\sforce/k\\) (as in static deflection under \\(\\sforce\\)) is then given by \\[\n\\abs{\\ratio{Q_1}{\\sforce/k}} = \\abs{\\ratio{0.578}{1-\\rho_1^2} + \\frac{0.422}{1-\\rho_2^2}}\n\\]\nThe normalized response amplitude plotted in Figure 8.3 shows that the response was completely suppressed at the original natural frequency of the primary system. Even in damped systems, for the critical scenario where the primary system would exhibit resonance, we will have a significantly diminished response, with the displacements being much smaller than static response. In the damped scenarioes, the lowest amplification happens near but not exactly at \\(\\extfreq/\\freq\\). It can be shown that by increasing the mass ratio \\(m_d / m\\), it would be possible to broaden the operational frequency range (e.g. the range where response is less than static equivalent) and further reduce the resonant amplitude (considering primary only), but such an increase becomes practically challenging given the need to add a substantial amount of weight to the system. An additional constraint is the displacement bounds on the second mass which may reach excessive amplitudes. Designs typically consider these criteria and try to determine optimal solutions under viable constraints imposed on both variables."
  },
  {
    "objectID": "multidofforcedvib.html#sec-modalcomb",
    "href": "multidofforcedvib.html#sec-modalcomb",
    "title": "8  Forced Vibrations of Linear Multi Degree of Freedom Systems",
    "section": "8.2 Modal Combination Rules",
    "text": "8.2 Modal Combination Rules\nObtaining response time histories with modal analysis requires a complete characterisation of how the excitation varies in time. This may simply not be possible under certain types of loads or analyses, a prime example of which is the analysis frequently encountered in design of structures for earthquakes. Recall that the concept of earthquake spectra was developed specifically for such an issue since the actual time history of a future earthquake is impossible to estimate but some bounds on the response of SDOF systems may be estimated. So the question is, how may we proceed when we do not know the full excitation but may estimate peak values of some modal response quantities?\nThis question is not so trivial since there is no precise approach suitable for all cases although one is more likely to err by over-estimating. Let us first clarify what the problem is: consider an analytically tractable problem such as a 3-DOF shear building subject to a harmonic ground motion given by \\(\\gacc (t) = \\sinp{\\extfreq t}\\). Assume we would like to calculate the peak response for the first floor displacement \\(\\gc_1\\) that will be observed during steady state vibrations. By peak response we shall refer to that value of the response quantity whose absolute value would be the maximum of all the absolute values of that response quantity for a particular excitation and/or duration; in other words, the peak value \\(\\overline {R}\\) of a response quantity \\(R (t)\\) is its value at time \\(t=t'\\), i.e. \\(\\overline {R} = R (t')\\) such that \\(\\abs{R (t')}\\) is the maximum of all \\(\\abs{R (t)}\\). The sign of a peak response quantity may be positive or negative, and this sign will be prescribed by the definition of the response quantity as will be evident later on. There is a slight but consequential difference between the peak response that we have defined and the peak response that is often refferred to which represents a maximum absolute quantity. For example, a spectral quantity like the pseudo-acceleration or the deformation that will be obtained from a given spectrum, which denotes a maximum response or sometimes a maximum excitation value, will always have a positive value by definition, since by definition we would have \\(\\overline {R} = \\abs{R (t')}\\). If differentiation is necessary, we will refer to such maxima as peak absolute response or peak spectral response. Recall that ground motion parameters such as peak ground acceleration introduced previously in Chapter 5 are in fact also quantities of this sort.\n\n\n\nFigure 8.4: Steady state response (extracts) of modal coordinates for the 3-DOF shear building subjected to harmonic ground motion.\n\n\nFor the problem at hand, the steady state vibrations of the modal coordinates \\(\\modcor_i\\) will have the time histories shown in part in Figure 8.4. If the time histories are known, then straightforward superposition leads to \\[\n\\gc_1 (t) = \\eigvecs_{11} \\modcor_1 (t) + \\eigvecs_{12} \\modcor_2 (t) + \\eigvecs_{13} \\modcor_3 (t)\n\\] and the peak first floor displacement \\(\\overline{Q}_1\\) that is observed during steady state vibrations may be directly identified from the time history of \\(\\gc_1 (t)\\). What if we do not have the time histories but only estimates of the amplitudes of steady state vibrations of modal coordinates, i.e. estimates for \\(\\overline{\\modcoramp}_1\\), \\(\\overline{\\modcoramp}_2\\) and \\(\\overline{\\modcoramp}_3\\) shown in Figure 8.4? Such esimates could be available from a given spectrum, for example in the form of a graph of dynamic amplification, which shows how vibration amplitude varies with the ratio \\(\\extfreq/\\freq\\).\nEstimating \\(\\overline{Q}_1\\) from \\(\\overline{\\modcoramp}_1\\), \\(\\overline{\\modcoramp}_2\\) and \\(\\overline{\\modcoramp}_3\\) alone is not a trivial issue. The obvious problem is the phase difference. If we look at the time histories we will see that when \\(\\modcor_1(t)\\) reaches a maximum, \\(\\modcor_2(t)\\) is near zero and \\(\\modcor_3 (t)\\) is almost at its minimum. Therefore if we were to superpose the time histories, the sign differences would most likely lead to a peak value less than what we would obtain by superposing the modal peak values, i.e. \\[\n\\overline{Q}_1 \\leq \\abs{\\eigvecs_{11} \\overline{\\modcoramp}_1} + \\abs{\\eigvecs_{12} \\overline{\\modcoramp}_2} + \\abs{\\eigvecs_{13} \\overline{\\modcoramp}_3}\n\\] If phase information is not available this may be an option but most likely it is a very conservative estimate. The absolute values are in fact there to ensure that our estimation error does not lead to increased risk of safety; if errors can not be avoided, we should at least make sure that we remain conservative and not give way to any unwarranted concerns.\nThe estimation issue we have tried to exemplify is generally investigated under the heading modal combination rules. The concise form of the problem is as follows: Assume there is a response quantity \\(R (t)\\) generated in a system under a certain load, and that its peak value is \\(\\overline {R}\\). The contribution of mode \\(i\\) to this response quantity is given by \\(R^{(i)} (t)\\) and its peak value is \\(\\overline{R^{(i)}}\\), with \\(i = 1,2,\\ldots,n' \\leq n\\) where \\(n'\\) is the number of modes that will be included in the analysis; this number may be less that the total number of modes \\(n\\) if it is known that the contribution of some modes may be neglected. The question is: knowing \\(\\overline{R^{(i)}}\\), how could we produce an estimate of \\(\\overline{R}\\)? There could obviously be many ways of doing this but we will discuss only three of the most commonly used combination rules.\n\n8.2.1 Absolute Sum (ABSSUM)\nThe most obvious and most conservative way to combine the modal response is to consider the worst case scenario where all modal peaks occur at the same time with the same sign so that \\[\n\\overline{R} \\approx \\abs{\\overline{R^{(1)}}} + \\abs{\\overline{R^{(2)}}} + \\cdots + \\abs{\\overline{R^{(n')}}} = \\sum_i^{n' \\leq n} \\abs{\\overline{R^{(i)}}}\n\\] It is rarely if ever possible that such a complete concurrence occurs and therefore this modal combination is generally considered to be over-conservative.\n\n\n8.2.2 Square Root of the Sum of Squares (SRSS)\nInitially considered as a less conservative combination that favors the larger contributions more, the square root of the sum of squares (SRSS) rule estimates the peak response via \\[\n\\overline{R} \\approx \\sqrt{\\Bigl(\\overline{R^{(1)}}\\Bigr)^2 + \\Bigl(\\overline{R^{(2)}}\\Bigr)^2 + \\cdots + \\Bigl(\\overline{R^{(n')}}\\Bigr)^2} = \\biggl(\\sum_i^{n' \\leq n} \\Bigl(\\overline{R^{(i)}}\\Bigr)^2 \\biggr)^{1/2}\n\\] Theoretical justification of the SRSS may be given via random vibration analysis and it has been shown that SRSS works best when modes are well separated; in any case it is not so overly conservative as the ABSSUM. When, however, the majority of the estimate is contributed by close modes, the results are more questionable and the complete quadratic combination rule may be considered as an alternative with a stronger theoretical justification.\n\n\n8.2.3 Complete Quadratic Combination (CQC)\nIt may not be possible to specify a single combination rule that would be optimum for all arbitrary inputs but certain types of excitations are conducive for classification. Stationary random excitations are one such set which, although quite idealized, may be used to model certain inputs such as wind and earthquake excitations. Neither of the two are in fact stationary and their probabilistic characteristics are always time dependent; in any case, analysis of response to stationary excitations have provided very useful theoretical frameworks and some practical results that have been employed with satisfactory accuracy. In the analysis of earthquake excitations, for example, considering the ground motion to be a stationary random process have helped tracking how modal response may vary with respect to each other and how this variation affects the response. This investigation have led to the modal combination rule known as the complete quadratic combination which proposes\n\\[\n\\overline{R} \\approx \\biggl(\\sum_i^{n' \\leq n} \\sum_j^{n' \\leq n} \\ccor{ij}\\overline{R^{(i)}} \\; \\overline{R^{(j)}} \\biggr)^{1/2}\n\\qquad(8.23)\\]\nParameter \\(\\ccor{ij}\\), called the correlation coefficient, provides in general a measure of the reciprocal relationship between two random variables, and in this particular case it provides a measure of temporal reciprocity between mode i and mode j. There are different estimates for this coeefficient all of which depend on some measure of separation between the frequencies of the two modes. For example, a frequently cited proposal is1 \\[\n\\ccor{ij} = \\ratio{8 \\sqrt{\\damp_i \\damp_j}(\\damp_i r_{ij} + \\damp_j)r_{ij}^{3/2}}{(1-r_{ij}^2)^2 + 4 \\damp_i \\damp_j r_{ij} (1+r_{ij}^2)+ 4 (\\damp_i^2 + \\damp_j^2)r^2_{ij}}\n\\qquad(8.24)\\] where \\(r_{ij} = \\freq_i / \\freq_j\\). It may be easily shown that \\(0 &lt; \\ccor{ij} \\leq 1\\), \\(\\ccor{ij} = \\ccor{ji}\\), and \\(\\ccor{ii} = 1\\). In a simpler version, if two modes have the same damping ratios with \\(\\damp_i = \\damp_j = \\damp\\), then Equation 8.24 reduces to \\[\n\\ccor{ij} = \\ratio{8 \\damp^2 (1 + r_{ij})r_{ij}^{3/2}}{(1-r_{ij}^2)^2 + 4 \\damp^2 r_{ij} (1+r_{ij})^2}\n\\qquad(8.25)\\]\n\n\n\nFigure 8.5: Variation of the correlation coefficient of Equation 8.25 with the ratio of frequencies for three different modal dmaping values.\n\n\nThe correlation coefficient depends very much on the separation of the two frequencies and this trend is most readily observed in a simple plot like the one in Figure 8.5 which shows the variation of the correlation coefficient between two modes \\(i\\) and \\(j\\) with the ratio of the modal frequencies \\(\\freq_i / \\freq_j\\). For simplicity we have assumed both modes to have the same damping ratio \\(\\damp\\) and have provided curves for three different values of modal dmaping ratio. Two things are immediately identified: i. the correlation coefficient steeply decreases from its maximum value of 1 as the separation of the frequencies increases, ii. the correlation coefficient is quite sensitive to damping and the more lightly damped the modes are, the steeper is the decent from the peak value. These observation support the use of SRSS in many application as well. If we note that \\(\\ccor{ii} = 1\\) and write the CQC rule given by Equation 8.23 in the form \\[\n\\overline{R} \\approx \\biggl(\\sum_i^{n' \\leq n} \\Bigl(\\overline{R^{(i)}}\\Bigr)^2 + \\sum_i^{n' \\leq n} \\sum_{j \\neq i}^{n' \\leq n} \\ccor{ij}\\overline{R^{(i)}} \\; \\overline{R^{(j)}} \\biggr)^{1/2}\n\\qquad(8.26)\\] then it is obvious that the first part comprising the single summation is the SRSS rule and the second part comprising the double summation is the additional contribution brought about by the CQC. If the modal frequencies are sufficiently separated then \\(\\ccor{ij} \\approx 0\\) and the difference between SRSS and CQC becomes negligible.\n\n\n\n\nE.L. Wilson, A. Der Kiureghian and E.P. Bayo, ``A Replacement for the SRSS Method in Seismic Analysis’’, Earthquake Engineering and Structural Dynamics, Vol. 9, pp. 187-194, 1981.↩︎"
  },
  {
    "objectID": "multidofforcedvib.html#footnotes",
    "href": "multidofforcedvib.html#footnotes",
    "title": "8  Forced Vibrations of Linear Multi Degree of Freedom Systems",
    "section": "",
    "text": "E.L. Wilson, A. Der Kiureghian and E.P. Bayo, ``A Replacement for the SRSS Method in Seismic Analysis’’, Earthquake Engineering and Structural Dynamics, Vol. 9, pp. 187-194, 1981.↩︎"
  },
  {
    "objectID": "multidofforcedvib.html#response-to-ground-motion",
    "href": "multidofforcedvib.html#response-to-ground-motion",
    "title": "8  Forced Vibrations of Linear Multi Degree of Freedom Systems",
    "section": "8.3 Response to Ground Motion",
    "text": "8.3 Response to Ground Motion\nExtension of the discussions and formulation hereto presented to structures subjected to ground motoions is both trivial and not-so-simple. It is trivial because mathematically the equations of motion for a system subjected to ground motion, as discussed in detail in Section 6.7, are analogous to the equations discussed in the current chapter. For a linear, classically damped system these equations are of the form \\[\n\\mmat \\ddgcvec (t) + \\cmat \\dgcvec (t) + \\kmat \\gcvec (t) = - \\mmat \\ininfmat \\gaccvec (t)\n\\qquad(8.27)\\] as was developed in Section 6.7, with the current addition of the damping term. This equation is identical to Equation 8.1 where \\(\\ldvec (t) \\equiv - \\mmat \\ininfmat \\gaccvec (t)\\); in fact, due to this analogy, the term \\(- \\mmat \\ininfmat \\gaccvec (t)\\) is sometimes referred to as the effective earthquake force. When the system is classically damped, all that we have said about modal analysis is valid and the time history of any response quantity may be determined provided that the input signal \\(\\gaccvec (t)\\) is known. But therein lies the difficulty. The primary example of ground motion is earthquakes, generally governing the design of a structure in earthquake prone areas. As was discussed in the context of SDOF systems, it is impossible to preciely predict what a future earthquake will look like, and therefore the design procedure is often based on a design spectrum that is established from historical analysis of past earthquakes and that hopefully represents the typical earthquake loads that may be expected in the lifetime of a structure considering its location and ground conditions. Use of a spectrum necessitates the use of modal combination rules that were discussed in Section 8.2. Uncertainty in the input is ever present in earthquake resistant design and still the subject of many reasearch effrots.\n\n8.3.1 Modal Response to Ground Motion\nTo walk through the basic steps involved in analyses and introduce some terminology, let us consider the simple shear building shown in Figure 8.6, subject to a 1-D translational ground motion \\(\\gdis (t)\\). The position of the masses can be defined in response to an inertial frame of reference in absolute terms by \\(\\adisvec (t)\\), or relative to the ground by \\(\\gcvec (t)\\), while the ground itself is displaced by an amount \\(\\gdis (t)\\). As shown in Section 6.7, the absolute and relative displacements of the masses are related through \\[\n\\adisvec (t) = \\gcvec (t) + \\onecol \\gdis (t)\n\\] where \\(\\onecol\\) is the \\(1 \\times n\\) column matrix of ones. Differentiating with respect to time yields \\[\n\\aaccvec (t) = \\ddgcvec (t) + \\onecol \\gacc (t)\n\\] and the equation of motion governing the relative displacements are given by \\[\n\\mmat \\ddgcvec (t) + \\cmat \\dgcvec (t) + \\kmat \\gcvec (t) = - \\mmat \\onecol \\gacc (t)\n\\qquad(8.28)\\]\n\n\n\nFigure 8.6: 3 story shear building subject to unidirectional base excitation.\n\n\nWe might recall that this version was generally preferred over the equations regarding the absolute displacements since the relative displacements are more directly associated with deformations; also note that ground motions from earthquakes are often recorded as time-histories of accelerations, typically captured by means of seismometers. It should also be noted that this equation is essentially the same as Equation 8.27 with \\(\\gaccvec (t) \\equiv \\gacc (t)\\) and \\(\\ininfmat \\equiv \\onecol\\), with dimension reductions due to the fact that we have a single ground motion component in the current example.\nTransforming to modal coordinates with \\(\\gcvec (t) = \\modmat \\modcorvec (t)\\), equations in modal coordinates are obtained as \\[\n\\ddmodcor_i (t) + 2\\damp_i \\freq_i \\dmodcor_i (t) +\\freq_i^2 \\modcor_i (t)= - \\frac{\\excifact_i}{\\modm_i} \\gacc (t)\n\\qquad(8.29)\\] where the scalar coefficient \\(\\excifact_i\\), referred to as the earthquake excitation factor, is given by \\[\n\\excifact_i = {\\teigveci{i}} \\mmat \\onecol\n\\qquad(8.30)\\] The earthquake excitation factor provides some measure of the extent the ground motion excites a particular mode although it is not the only determinant in the contributio of a mode to the overall response. In any case there is a trend that is relatively easily spotted. Recall that as the mode number increases (in accordance with our convention of ordering modes in increasing order of frequency), the number of sign changes in the mode shape also increases. For an \\(n\\)-story shear building for which the mass matrix will be diagonal with floor masses \\(m_j\\), for example, we have\n\\[\n\\excifact_i = {\\teigveci{i}} \\mmat \\onecol = \\sum_{j}^n \\eigvecs_{ij} m_j\n\\] so that for the first mode we will have all positive terms in the summation but for the second mode onward we will have both positive and negative terms. The earthquake excitation factor therefore tends to decrease with increasing mode number. Furthermore, consider a conjugate SDOF system that has the same frequency and damping ratio as the \\(i\\)-th mode, subjected to the same ground motion \\(\\gdis (t)\\); this system’s equation of motion will given by \\[\n\\ddot{d}_i (t) + 2 \\damp_i \\freq_i \\dot{d}_i (t)+ \\freq^2 d_i (t) = - \\gacc (t)\n\\] where \\(d_i (t)\\) is the generalized coordinate for the conjugate SDOF system of the \\(i\\)-th mode. Since the equations of motion are linear, the response of the \\(i\\)-th mode and the response of the conjugate SDOF system are related through \\[\n\\modcor_i (t) = \\frac{\\excifact_i}{\\modm_i} d_i (t)\n\\qquad(8.31)\\] since, due to linearity, a scaling of the input leads directly to a scaling of the output with the same factor. Consequently, if the peak absolute displacement of the conjugate system is given by \\[\n\\dspec_i = \\max_t \\abs{d_i (t)}\n\\] such that \\(\\dspec_i\\) may be calculated or read from a spectrum, then we may estimate the peak modal coordinate response as \\[\n\\overline{\\modcoramp_i} = \\frac{\\excifact_i}{\\modm_i} \\dspec_i\n\\] Once the response in modal coordinates is known, the response in physical coordinates may be obtained via modal superposition so that, for example, displacements are given by \\[\n\\gcvec (t) = \\modmat \\modcorvec (t) = \\sum_i \\eigveci{i} \\frac{\\excifact_i}{\\modm_i} d_i (t)\n\\]\n\n\n8.3.2 Base Shear and Overturning Moment\nBase shear \\(\\baseshear\\) and overturning moment \\(\\overturn\\) play such an important role in aseismic design that it is worthwhile to revisit them even though we had previously introduced them in Section 8.1.2. The equivalent static loads for our simple shear building are sketched in Figure 8.7. Recall that these forces are given by \\[\n\\estatvec (t) = \\kmat \\gcvec (t)\n\\] and that the base shear, which may be obtained for a shear building as the sum of the equivalent static loads, is given by \\[\n\\baseshear (t) = \\onecol^T \\estatvec (t) = \\onecol^T \\kmat \\gcvec (t)\n\\]\n\n\n\nFigure 8.7: Equaivelent static forces, base shear and overturning moment for the shear building of Figure 8.6.\n\n\nModal expansion of the physical displacements as \\(\\gcvec (t) = \\modmat \\modcorvec (t)\\) allows us to express equivalent static loads as \\[\n\\estatvec (t) = \\kmat \\modmat \\modcorvec (t) = \\kmat \\eigveci{1} \\modcor_1 + \\kmat \\eigveci{2} \\modcor_2 + \\ldots = \\modestatvec{1} + \\modestatvec{2} + \\ldots\n\\] where, with the use of the conjugate SDOF response and Equation 8.31, \\[\n\\modestatvec{i} (t) = \\kmat \\eigveci{i} \\modcor_i = \\kmat \\eigveci{i} \\frac{\\excifact_i}{\\modm_i} d_i (t)\n\\] is the equivalent static force that would be associated with the \\(i\\)-th mode alone. Since \\[\n\\kmat \\eigveci{i} = \\mmat \\eigveci{i}\\freq_i^2\n\\] we may also use \\[\n\\modestatvec{i} (t) = \\mmat \\eigveci{i} \\frac{\\excifact_i}{\\modm_i} \\freq_i^2 d_i (t)\n\\] to calculate the modal equivalent static force for the \\(i\\)-th mode. Now the base shear may be expressed as \\[\n\\baseshear (t) = \\onecol^T \\estatvec (t) = \\onecol^T \\modestatvec{1} + \\onecol^T \\modestatvec{2} + \\ldots = \\modbaseshear{1} (t) + \\modbaseshear{2} (t) + \\ldots\n\\] where \\[\n\\modbaseshear{i} (t) = \\onecol^T \\modestatvec{i} = \\onecol^T \\kmat \\eigveci{i} \\frac{\\excifact_i}{\\modm_i} d_i (t)  = \\onecol^T \\mmat \\eigveci{i} \\frac{\\excifact_i}{\\modm_i} \\freq_i^2 d_i (t)\n\\] is the contribution of the \\(i\\)-th mode to the base shear. Furthermore, since \\[\n\\excifact_i = {\\teigveci{i}} \\mmat \\onecol = \\onecol^T \\mmat \\eigveci{i}\n\\] we have \\[\n\\modbaseshear{i} (t) = \\frac{\\excifact_i^2}{\\modm_i} \\freq_i^2 d_i (t)\n\\] which is the simplest expression for modal base shear. The factor \\(\\excifact_i^2/\\modm_i\\) is referred to as the effective modal mass. This nomenclature is more mnemonic than physical and it aims to help via resemblance to force being the product of mass (in this context, \\(\\excifact_i^2/\\modm_i\\), with units of mass) and acceleration (in this context, \\(\\freq_i^2 d_i (t)\\), with units of acceleration).\nIn shear buildings, the sum of effective modal masses equals the total mass of the structure; i.e., for an \\(n\\)-story shear building we will have \\[\n\\sum_i^n \\frac{\\excifact_i^2}{\\modm_i} = \\onecol^T \\colmat{\\ratio{\\excifact_1^2}{\\modm_1} \\\\ \\ratio{\\excifact_2^2}{\\modm_2} \\\\ \\vdots \\\\ \\ratio{\\excifact_n^2}{\\modm_n}} = \\onecol^T \\mmat \\onecol = \\sum_i^n m_i\n\\qquad(8.32)\\] That this is so may be shown via writing the column matrix of ones as a linear combination of the mode shapes so that \\[\n\\onecol = \\modmat \\colmat{e_1 \\\\ e_2 \\\\ \\vdots \\\\ e_n} = \\modmat \\nvec{e}\n\\] To find out what the coefficients \\(e_i\\) should be we can use the orthogonality of the mode shapes whereby we get \\[\n\\teigveci{i} \\mmat \\onecol = \\teigveci{i} \\mmat \\modmat \\colmat{e_1 \\\\ e_2 \\\\ \\vdots \\\\ e_n} = \\modm_i e_i\n\\] and since \\(\\teigveci{i} \\mmat \\onecol = \\excifact_i\\), we obtain \\(e_i = {\\excifact_i}/{\\modm_i}\\) and \\[\n\\nvec{e} = \\left\\{\\frac{\\excifact_1}{\\modm_1} \\;\\;\\; \\frac{\\excifact_2}{\\modm_2} \\;\\;\\; \\cdots \\;\\;\\; \\frac{\\excifact_n}{\\modm_n}\\right\\}^T\n\\] Therefore we have \\[\n\\sum_i^n m_i = \\onecol^T \\mmat \\onecol =  \\nvec{e} ^T \\modmat^T \\mmat \\modmat \\nvec{e} =\n\\nvec{e} ^T \\modmmat \\nvec{e} = \\sum_i^n \\frac{\\excifact_i^2}{\\modm_i}\n\\] as was the claim. This equality has presented itself as the basis for a commonly used criterion in modal analysis regarding how many modes to include: it is possible to state a normalized target such as to include as many modes as necessary so that effective modal masses represent \\(90\\%\\) (or more or less) of the total mass of the building.\nWe could proceed along similar lines to develop relationships regarding the overturning moment. Multiplying equivalent static loads with their respective heights leads to \\[\\begin{align*}\n\\overturn (t)  & = \\left\\{h_1 \\;\\;\\; h_2 \\;\\;\\; \\ldots\\right\\} \\colmat{\\estati{1} (t) \\\\ \\estati{2} (t) \\\\ \\vdots} = \\nvec{h}^T \\estatvec (t) \\\\\n& = \\nvec{h}^T \\modestatvec{1} (t) + \\nvec{h}^T \\modestatvec{2} (t) + \\ldots  = \\modoverturn{1} (t) + \\modoverturn{2} (t) + \\ldots\n\\end{align*}\\] where \\[\n\\modoverturn{i} (t) = \\nvec{h}^T \\modestatvec{i} (t) = \\nvec{h}^T \\mmat \\eigveci{i} \\frac{\\excifact_i}{\\modm_i} \\freq_i^2 d_i (t)\n\\] is the modal overturning moment for the \\(i\\)-th mode, i.e. the contribution of the \\(i\\)-th mode alone to the overturning moment.\n\n\n\nFigure 8.8: A 2-DOF system with translational and rotational degrees of freedom, and the equivalent static loads associated with the ground motion.\n\n\nIt should be noted that the formulations for base shear and overturning moment developed above have to be modified for arbitrary systems. Obtaining the base shear via the direct sum of all the equivalent static loads is a consequence of their common lateral direction. If rotational or vertical degrees of freedom were present, a direct sum of all equivalent static loads would not be meaningful. Consider as a simple example a heavy rigid bar supported by a single column of negligible mass as shown in Figure 8.8. Even if the bar is assumed axially rigid, the system has two degrees of freedom such that the center of mass may translate laterally and the rigid bar may rotate about its center of mass. The equivalent static loads \\(\\estatvec = \\kmat \\gcvec\\) in this case would be a lateral force and a moment, also shown in Figure 8.8, and the base shear and overturning moment would be given by \\[\n\\baseshear = \\estati{1} \\quad \\text{and} \\quad \\overturn = h \\estati{1} + \\estati{2}\n\\] and it should be clear that these expressions differ from the previously derived ones. On the other hand, in any case, the base shear and the overturning moment will be given by some linear combination of the equivalent static loads. In an effort to generalize the formulations we shall use the notation \\(\\nvec{b}_{{V}}\\) and \\(\\nvec{b}_{{M}}\\) to denote the column matrices comprising the coefficients that multiply the equivalent static loads to obtain the base shear and the overturning moment, respectively, so that in general \\[\n\\baseshear = \\nvec{b}_{{V}}^T \\estatvec \\quad \\text{and} \\quad \\overturn = \\nvec{b}_{{M}}^T \\estatvec\n\\] In the case of a shear building we will have \\(\\nvec{b}_{{V}} = \\onecol\\) and \\(\\nvec{b}_{{M}} = \\nvec{h}\\), whereas for example in the case of the column supported slab of Figure 8.8 we will have \\[\n\\nvec{b}_{{V}} = \\colmat{1 \\\\ 0} \\; ; \\nvec{b}_{{M}} = \\colmat{h \\\\ 1}\n\\]\n\n\n8.3.3 Spectral Analysis and Modal Combination\nWhen the time history of base excitation is known, the modal analysis approach hereto detailed allows us to derive the time history of any response quantity. In earthquake analyses, however, the ground motion is more often than not unknown. The concepts of response and design spectra were introduced previously in Chapter 5. Here we will try to discuss how the use of such spectra may help in analysis of MDOF systems.\nTo remind ourselves the basic terminology and notation, assume that a spectrum for some ground motion \\(\\gdis (t)\\) is available. Such a spectrum would give the variation(s) of peak response(s) for a SDOF system governed by \\[\n\\ddot{d} (t) + 2 \\damp \\freq \\dot{d} (t) + \\freq^2 d (t) = - \\gacc (t)\n\\] The displacement spectrum \\(\\dspec = \\dspec (\\period,\\damp)\\) would show the variation of the maximum absolute relative displacement (deformation), defined by \\[\n\\dspec = \\max_t \\abs{d (t)}\n\\] as the period of the system varies for different values of damping ratio. The pseudo-velocity \\(\\vspec\\) and the pseudo-acceleration \\(\\aspec\\) are defined through \\[\n\\freq \\dspec  = \\vspec = \\ratio{\\aspec}{\\freq}\n\\] so that knowing one, the other two may be easily calculated.\n\n\n\nFigure 8.9: A pesudo-acceleration response spectrum.\n\n\nSay that we have the pseudo-acceleration spectrum \\(\\aspec\\) for a specific value of the damping ratio, as shown in Figure 8.9. For simplicity assume all modes have the same damping ratio with \\(\\damp = 0.05\\) so that this single spectrum is sufficient for the system we are investigating. Our 3-DOF system of Figure 8.6 will have three periods, say \\(\\period_1\\), \\(\\period_2\\) and \\(\\period_3\\), corresponding to three frequencies \\(\\freq_1\\), \\(\\freq_2\\) and \\(\\freq_3\\), respectively. Each period is associated with a modal equation in the form \\[\n\\ddmodcor (t) + 2 \\damp_i \\freq_i \\dmodcor (t) + \\freq_i^2 \\modcor (t) = -\\ratio{\\excifact_i}{\\modm_i} \\gacc (t)\n\\] and for each period, the corresponding pseudo-acceleration value will be read from the spectrum as \\(\\aspec_1\\), \\(\\aspec_2\\) and \\(\\aspec_3\\). With these values, the peak modal coordinate responses will be estimated by \\[\n\\overline{\\modcoramp_1} = \\ratio{\\excifact_1}{\\modm_1} \\ratio{\\aspec_1}{\\freq_1^2} , \\quad \\overline{\\modcoramp_2} = \\ratio{\\excifact_2}{\\modm_2} \\ratio{\\aspec_2}{\\freq_2^2}, \\quad \\overline{\\modcoramp_3} = \\ratio{\\excifact_3}{\\modm_3} \\ratio{\\aspec_3}{\\freq_3^2}\n\\] Now we have to make a choice: how do we want to combine the modal responses to estimate a specific response quantity? Assume we would like to estimate the maximum deformation suffered by the third story, i.e. the interstory drift between floors 2 and 3. The quantity we are trying to estimate is the peak value of \\[\n\\Delta_{23} (t)= \\gc_3 (t) - \\gc_2 (t) = \\left[\\sum_i \\eigvecs_{3i} \\modcor_i (t) \\right] - \\left[\\sum_i \\eigvecs_{2i} \\modcor_i (t) \\right]\n\\] where, to remind ourselves, \\(\\eigvecs_{ji}\\) denotes the component of the \\(i\\)-th mode along the \\(j\\)-th generalized coordinate. We first have to figure out the contribution of each mode to the interstory drift. Modal expansion of the displacements lead to \\[\n\\Delta_{23} (t) = (\\eigvecs_{31} - \\eigvecs_{21}) \\modcor_1 (t) + (\\eigvecs_{32} - \\eigvecs_{22}) \\modcor_2 (t) + (\\eigvecs_{33} - \\eigvecs_{23}) \\modcor_3 (t)\n\\] The contributions of each of the modes to the interstory drift \\(\\Delta_{23}\\) are therefore given by \\[\n\\Delta_{23}^{(1)} = (\\eigvecs_{31} - \\eigvecs_{21}) \\modcor_1, \\quad  \\Delta_{23}^{(2)} = (\\eigvecs_{32} - \\eigvecs_{22}) \\modcor_2, \\quad \\Delta_{23}^{(3)} = (\\eigvecs_{33} - \\eigvecs_{23}) \\modcor_3\n\\] The peak values for each of the modal contributions are then given by \\[\\begin{align*}\n\\overline{\\Delta_{23}^{(1)}}  & = (\\eigvecs_{31} - \\eigvecs_{21}) \\overline{\\modcoramp_1} = (\\eigvecs_{31} - \\eigvecs_{21}) \\ratio{\\excifact_1}{\\modm_1} \\ratio{\\aspec_1}{\\freq_1^2}  \\\\  \n\\overline{\\Delta_{23}^{(2)}}  & = (\\eigvecs_{32} - \\eigvecs_{22}) \\overline{\\modcoramp_2} = (\\eigvecs_{32} - \\eigvecs_{22}) \\ratio{\\excifact_2}{\\modm_2} \\ratio{\\aspec_2}{\\freq_2^2} \\\\\n\\overline{\\Delta_{23}^{(3)}}  & = (\\eigvecs_{33} - \\eigvecs_{23}) \\overline{\\modcoramp_3} = (\\eigvecs_{33} - \\eigvecs_{23}) \\ratio{\\excifact_3}{\\modm_3} \\ratio{\\aspec_3}{\\freq_3^2}\n\\end{align*}\\] where we note that the peak modal interstory drifts \\(\\overline{\\Delta_{23}^{(i)}}\\) may be positive or negative valued. Next step is to pick the method with which we would like to combine these peak values. If, for example, we would like to use the SRSS approach we have: \\[\n\\overline{\\Delta_{23}}  = \\sqrt{\\biggl(\\overline{\\Delta_{23}^{(1)}}\\biggr)^2 + \\biggl(\\overline{\\Delta_{23}^{(2)}}\\biggr)^2 + \\biggl(\\overline{\\Delta_{23}^{(3)}}\\biggr)^2}\n\\]\n\nEXAMPLE 8 .3\nA three-story shear building model has story stiffnesses and masses as shown in Figure 8.10 with \\(m = 100 \\unit{kg}\\), and \\(k = 9870 \\unit{N/m}\\). System is assumed to be classically damped with all modes having a damping ratio of \\(\\damp = 5\\%\\). The ground motion \\(\\gacc (t)\\) this structure will be subjected to is defined by the spectrum also shown in Figure 8.10, scaled for a peak ground acceleration (PGA) of 0.5 g. We want to find, using the SRSS combination rule, (i) an estimate for the maximum top displacement, (ii) an estimate for the maximum deformation in the second story columns, (iii) an estimate for maximum base shear.\n\n\n\nFigure 8.10: Three story shear building model.\n\n\n\nFind the natural modes of vibration for this structure, as well as the modal masses and stiffnesses:\n\nIn order to find the vibration modes, we will need to determine the mass and stiffness matrices and then solve the eigenvalue problem. The mass matrix \\(\\mmat\\) is given by \\[\n\\mmat = 100 \\begin{bmatrix}\n    1 & 0 & 0\\\\\n    0 & 1 & 0\\\\\n    0 & 0 & 1/3\n\\end{bmatrix} \\unit{kg}\n\\] and the stiffness matrix \\(\\kmat\\) by \\[\n\\kmat= 9870 \\left[ \\begin{array}{rrr}\n7 & -3 & 0 \\\\\n-3 & 4 & -1 \\\\\n0 & -1 & 1\n\\end{array} \\right] \\unit{N/m}\n\\] The eigenvalue problem we have to solve to find the natural frequencies and mode shapes is \\[\n[\\kmat-\\freq_i^2 \\mmat] {\\eigvec}_{i}  = 0\n\\] which yields\n\\[\\begin{align*}\n\\freq_1  & = \\pi \\sqrt{10} \\unit{rad/s}, \\quad \\period _1 = 0.63 \\unit{s} \\\\\n\\freq_2  & = 2 \\pi \\sqrt{10} \\unit{rad/s}, \\quad \\period _2 = 0.32 \\unit{ s}\\\\\n\\freq_3  & = 3\\pi \\sqrt{10} \\unit{rad/s}, \\quad  \\period _3 = 0.21 \\unit{ s}\n\\end{align*}\\] with mode shapes given in Table 8.1 and illustrated in Figure 8.11. These mode shapes are scaled so that their largest (in absolute value) componenent is equal to unity. Table 8.1 also includes the modal mass and stiffness values calculated with these mode shapes.\n\n\nTable 8.1: Results from modal analysis.\n\n\n\n\n\n\n\n\n\n\n\n\n\\(i\\)\n\\(\\freq_i\\) \\([\\punit{rad/s}]\\)\n\\(\\period_i\\) \\([\\punit{s}]\\)\n\\(\\eigvecs_{1i}\\)\n\\(\\eigvecs_{2i}\\)\n\\(\\eigvecs_{3i}\\)\nmodal mass \\([\\punit{kg}]\\)\nmodal stiffness \\([\\punit{N / m}]\\)\n\n\n\n\n1\n\\(\\pi \\sqrt{10}\\)\n0.63\n0.33\n0.67\n1.00\n88.89\n8773.33\n\n\n2\n\\(2\\pi \\sqrt{10}\\)\n0.32\n-0.33\n-0.33\n1.00\n55.56\n21933.33\n\n\n3\n\\(3\\pi \\sqrt{10}\\)\n0.21\n1.00\n-0.67\n0.33\n148.15\n131600.00\n\n\n\n\n\n\n\nFigure 8.11: Mode shapes of the shear building of Figure 8.10.\n\n\n\nDetermine the peak modal responses:\n\nFor the three periods of our system, the spectral accelerations we read from the spectrum of Figure 8.10 scaled to \\(0.5\\gravity\\) peak ground acceleration are\n\\[\\begin{align*}\n0.25 \\unit{s} &lt; \\period_1 = 0.63 \\unit{s} \\leq 1 \\unit{s} \\;\\;\\; \\quad & \\rightarrow \\quad \\aspec_1 = \\left(\\ratio{0.5 \\gravity}{1 \\gravity} \\right) \\left(2 \\gravity \\right) = 1 \\gravity  \\\\\n0.25 \\unit{s} &lt; \\period_2 = 0.32 \\unit{s} \\leq 1 \\unit{s} \\;\\;\\; \\quad & \\rightarrow \\quad \\aspec_2 = \\left(\\ratio{0.5 \\gravity}{1 \\gravity} \\right) \\left(2 \\gravity \\right) = 1 \\gravity  \\\\\n\\period_3 = 0.21 \\unit{s} \\leq 0.25 \\unit{s} \\;\\;\\;  \\quad & \\rightarrow \\quad \\aspec_3 = \\left(\\ratio{0.5 \\gravity}{1 \\gravity} \\right) \\left(1 \\gravity + \\ratio{2 \\gravity - 1 \\gravity}{0.25 \\unit{s}} 0.21 \\unit{s} \\right) = 0.92 \\gravity  \n\\end{align*}\\] whence the spectral displacements are calculated as: \\[\n\\dspec_1 = \\ratio{\\aspec_1}{\\freq_1^2} = 0.0994 \\unit{m}, \\quad \\dspec_2 = \\ratio{\\aspec_2}{\\freq_2^2} = 0.0248 \\unit{m}, \\quad \\dspec_3 = \\ratio{\\aspec_3}{\\freq_3^2} = 0.0102 \\unit{m}\n\\]\nThe earthquake excitation factors are given by \\[\n\\excifact_1 = \\teigveci{1} \\mmat \\onecol = 133.33 \\unit{kg}, \\quad \\excifact_2 = \\teigveci{2} \\mmat \\onecol = -33.33 \\unit{kg}, \\quad \\excifact_3 = \\teigveci{3} \\mmat \\onecol = 44.44 \\unit{kg}\n\\] so that the peak modal coordinate responses are calculated as \\[\n\\overline{\\modcoramp_1} = \\frac{\\excifact_1}{\\modm_1} \\dspec_1 = 0.1491 \\unit{m}, \\quad \\overline{\\modcoramp_2} = \\frac{\\excifact_2}{\\modm_2} \\dspec_2 = -0.0149 \\unit{m}, \\quad \\overline{\\modcoramp_3} = \\frac{\\excifact_3}{\\modm_3} \\dspec_3 = 0.0030 \\unit{m}\n\\]\n\nDetermine the estimates for the maximum responses:\n\n\nThe maximum top displacement is the maximum relative (to the ground) displacement of the third floor (i.e. the floor at the top). The time history of this displacement is given by \\[\n\\gc_3 (t) = \\eigvecs_{31} \\modcor_1 (t) + \\eigvecs_{32} \\modcor_2 (t) + \\eigvecs_{33} \\modcor_3 (t)\n\\] so that the peak modal top displacements are given by \\[\n\\overline{\\gc_3^{(1)}} = \\eigvecs_{31} \\overline{\\modcoramp_1} = 0.1491 \\unit{m}, \\quad \\overline{\\gc_3^{(2)}} = \\eigvecs_{32} \\overline{\\modcoramp_2} = -0.0149 \\unit{m}, \\quad \\overline{\\gc_3^{(3)}} = \\eigvecs_{33} \\overline{\\modcoramp_3} = 0.0010 \\unit{m}\n\\] and the estimate we calculate via the SRSS rule for the maximum top displacement is: \\[\n\\overline{\\gc_3} = \\sqrt{\\left(\\overline{\\gc_3^{(1)}}\\right)^2 + \\left(\\overline{\\gc_3^{(2)}}\\right)^2 + \\left(\\overline{\\gc_3^{(3)}}\\right)^2} = 0.1498 \\unit{m}\n\\] Note that this estimate is very close to the estimate we would obtain using only mode 1, and the error we would make by not including mode 3 is completely negligible.\nThe maximum deformation of the second story columns is governed by the interstory drift that occurs between the first and second floors. This interstory drift is given by \\[\n\\Delta_{12} = (\\eigvecs_{21} - \\eigvecs_{11}) \\modcor_1 (t) + (\\eigvecs_{22} - \\eigvecs_{12}) \\modcor_2 + (\\eigvecs_{23} - \\eigvecs_{13}) \\modcor_3 (t)\n\\] so that peak modal interstory drifts are calculated as \\[\\begin{align*}\n\\overline{\\Delta_{12}^{(1)}}  & = (\\eigvecs_{21} - \\eigvecs_{11}) \\overline{\\modcoramp_1} = 0.0497 \\unit{m} \\\\\n\\overline{\\Delta_{12}^{(2)}}  & = (\\eigvecs_{22} - \\eigvecs_{12}) \\overline{\\modcoramp_2} = 0 \\unit{m} \\\\\n\\overline{\\Delta_{12}^{(3)}}  & = (\\eigvecs_{23} - \\eigvecs_{13}) \\overline{\\modcoramp_3} = - 0.0051 \\unit{m}\n\\end{align*}\\] and the SRSS estimate for the maximum interstory drift is given by: \\[\n\\overline{\\Delta_{12}} = \\sqrt{\\left(\\overline{\\Delta_{12}^{(1)}}\\right)^2 + \\left(\\overline{\\Delta_{12}^{(2)}}\\right)^2 + \\left(\\overline{\\Delta_{12}^{(3)}}\\right)^2} = 0.050 \\unit{m}\n\\]\nThe base shear is calculated via \\[\n\\baseshear (t) = \\onecol^T \\estatvec (t) = \\onecol^T \\modestatvec{1} + \\onecol^T \\modestatvec{2} + + \\onecol^T \\modestatvec{3} = \\modbaseshear{1} (t) + \\modbaseshear{2} (t) + \\modbaseshear{3} (t)\n\\] and we showed previously that for shear building systems the peak modal base shears may be calculated as \\[\n\\overline{\\modbaseshear{i}} = \\frac{\\excifact_i^2}{\\modm_i} \\freq_i^2 \\dspec_i = \\frac{\\excifact_i^2}{\\modm_i} \\aspec_i  \n\\] so that \\[\n\\overline{\\modbaseshear{1}} = \\frac{\\excifact_1^2}{\\modm_1} \\aspec_1 = 1962 \\unit{N}, \\quad \\overline{\\modbaseshear{2}} = \\frac{\\excifact_2^2}{\\modm_2} \\aspec_2 = 196.2 \\unit{N}, \\quad \\overline{\\modbaseshear{3}} = \\frac{\\excifact_3^2}{\\modm_3} \\aspec_3 = 120.3 \\unit{N}\n\\] The SRSS estimate for the maximum base shear is therefore given by \\[\n\\overline{\\baseshear} = \\sqrt{\\left(\\overline{\\modbaseshear{1}}\\right)^2 + \\left(\\overline{\\modbaseshear{2}}\\right)^2 + \\left(\\overline{\\modbaseshear{3}}\\right)^2} = 1975.5 \\unit{N} = 0.86 W\n\\] where \\(W\\) is the total weight of the structure."
  }
]